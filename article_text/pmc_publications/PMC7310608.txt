LICENSE: This file is available for text mining. It may also be used consistent with the principles of fair use under the copyright law.


0370625
1170
Biometrics
Biometrics
Biometrics
0006-341X
1541-0420

31544958
7310608
10.1111/biom.13156
NIHMS1593433
Article
Simultaneous confidence corridors for mean functions in functional data analysis of imaging data
Wang Yueying 1
Wang Guannan 2
Wang Li 1
Ogden R. Todd 3
1 Department of Statistics, Iowa State University, Ames, Iowa
2 Department of Mathematics, College of William and Mary, Williamsburg, Virginia
3 Department of Biostatistics, Columbia University, New York, New York
Correspondence: Li Wang, Department of Statistics, Iowa State University, Ames, IA 50011. lilywang@iastate.edu
22 5 2020
06 11 2019
6 2020
23 6 2020
76 2 427437
This file is available for text mining. It may also be used consistent with the principles of fair use under the copyright law.
Motivated by recent work involving the analysis of biomedical imaging data, we present a novel procedure for constructing simultaneous confidence corridors for the mean of imaging data. We propose to use flexible bivariate splines over triangulations to handle an irregular domain of the images that is common in brain imaging studies and in other biomedical imaging applications. The proposed spline estimators of the mean functions are shown to be consistent and asymptotically normal under some regularity conditions. We also provide a computationally efficient estimator of the covariance function and derive its uniform consistency. The procedure is also extended to the two-sample case in which we focus on comparing the mean functions from two populations of imaging data. Through Monte Carlo simulation studies, we examine the finite sample performance of the proposed method. Finally, the proposed method is applied to analyze brain positron emission tomography data in two different studies. One data set used in preparation of this article was obtained from the Alzheimer’s Disease Neuroimaging Initiative (ADNI) database.

bivariate splines
functional principal component analysis
image analysis
semiparametric efficiency
triangulation

1 | INTRODUCTION

In recent years, as digital technology advanced significantly, valuable imaging data of body structures and organs can be easily collected during routine clinical practice. This new paradigm presents new opportunities to innovate in both research and clinical settings. Medical imaging technology has revolutionized health care over the past three decades, allowing doctors to find or detect tumors and other abnormalities and evaluate the effectiveness of treatment. Functional data analysis (FDA) provides modern analytical tools for imaging data, which can be viewed as realizations of random functions. Let Ω be a two-dimensional bounded domain, and z = (z1, z2) be a point in Ω. The model we consider is (1) Yi(z)=μ(z)+ηi(z)+σ(z)εi(z),i=1,…,n,z∈Ω,

which is one instance of the general function-on-scalar regression model. In model (1), Yi (z) denotes the imaging measurement at location z ∈ Ω; ηi (z) is a stochastic process indexed by z, which characterizes subject-level image variations; and σ (z) is a positive deterministic function. We assume that ηi (z) and εi (z) are mutually independent, ηi (z) are i.i.d. copies of a L2 stochastic process η(z) with mean zero and covariance function Gη(z, z′), εi (z) are i.i.d. instances of a stochastic process of ε(z) with mean zero, and covariance function Cov{ε(z), ε(z′)} = I (z = z′).

For biomedical imaging data, the objects (eg, tumor tissues, brain regions, etc) appearing in the images are typically irregularly shaped. Many smoothing methods in the literature, such as tensor product smoothing, kernel smoothing, and wavelet smoothing, suffer from the problem of “leakage” across the complex domains, that is, poor estimation over difficult regions as a result of smoothing inappropriately across boundaries of features.

In this article, we endeavor to address these challenges by applying bivariate splines over triangulations (Lai and Wang, 2013) to preserve important features (shape, smoothness) of imaging data. Spline functions defined this way offer more flexibility and varying amounts of smoothness, allowing us to better approximate the mean functions. We study the asymptotic properties of the spline estimators of μ(z) by using bivariate penalized splines (BPS) defined on triangulations and show that our estimator is consistent and asymptotically normal.

In addition, when analyzing biomedical imaging data, such as brain images, typical questions lie in estimating the mean function, μ(z), together with quantifying the estimation uncertainty and making comparisons between populations. However, making a statistically rigorous inference for imaging data is challenging, and one of the main obstacles is the complicated spatial correlation structure. The prevailing analytic technique, termed the “mass univariate” approach, involves regarding each pixel/voxel as a unit, and for each unit, making a traditional univariate statistical inference, such as a simple t test. The obvious multiple comparisons issue can be dealt with in many ways; popular approaches include the Bonferroni correction, the random field theory (Worsley et al., 2004; Adler and Taylor, 2007; Siegmund et al., 2011), and the cluster threshold-based approach (Forman et al., 1995).

However, many of the multiple testing methods are ad hoc methods, which involve setting the threshold by eye, based on the practitioner’s experience and knowledge. Our simulation study in Supporting Information Appendix A also demonstrates that those ad hoc methods heavily depend on the choice of the threshold. In this article, we propose an alternative approach that treats the imaging data as an instance of functional data, regarded as being continuously defined but observed on a regular grid. If we consider the imaging data as being functional, attention naturally turns from considering each pixel/voxel as the basic analytical unit toward analyzing the entire image simultaneous, for instance, calculating simultaneous confidence corridors (SCCs; also called “simultaneous confidence bands” or “uniform confidence band/region”). As pointed out in Choi and Reimherr (2018) and Degras (2017), conventional multiple comparison methods are less useful in the functional data setup because the infinite cardinality of the domain would lead to unbounded confidence regions.

In statistics, SCCs are vital and fundamental tools for inference on the global behavior of functions (Degras, 2017). However, they have received relatively little attention in the literature of FDA. Moreover, existing SCC work for FDA has concentrated on the one-dimensional case. For the development of SCCs for mean curves of functional data, see the simulation-based techniques (Degras, 2011; Cao et al., 2012; Zheng et al., 2014; Cao and Wang, 2018), the functional principal component (FPC) decomposition-based approach (Goldsmith et al., 2013), and the geometric approach by Choi and Reimherr (2018) in Hilbert spaces. Zhu et al. (2012) proposed SCCs for the regression coefficient functions for multivariate varying coefficient model for functional responses. Gu et al. (2014) and Chang et al. (2017) proposed the SCC for coefficient functions in the function-on-scalar regression model. However, there is scant literature on SCCs for imaging data or other more general two-dimensional (2D) functions. Although the geometric method in Choi and Reimherr (2018) can be used to construct SCCs in Hilbert spaces over rectangular domains, it doesn’t work well for objects over complex domains with arbitrary shape, which are very common in biomedical imaging studies. In addition, the geometric method is conservative because it is essentially based on a modification of Scheffé’s method.

In this article, we derive SCCs with exact coverage probability for the 2D functional mean function μ(z), z ∈ Ω, in (1) via the extreme value theory of Gaussian processes (Adler, 1990) and approximating mean functions with bivariate splines. Our simulation studies indicate that the proposed SCCs are computationally efficient and have the correct coverage probability for finite samples. We also show that the spline estimator and the accompanying SCC are asymptotically the same as if all the images are observed without noise.

Motivated by the need to statistically quantify the difference between two imaging data sets arising in medical imaging studies, we further consider two-sample inference and extend our SCC construction procedure to a two-sample problem. Specifically, we focus on constructing SCC for the difference of the mean functions from two independent samples. The comparison of mean functions is particularly useful for imaging analysis in some biomedical settings such as comparing imaging outcomes for groups randomized either to placebo or to active treatment. Any mean differences may be localized and irregularly shaped, and so an estimation method should be flexible enough to allow for such differences. The approach developed here allows comparison of treatments simultaneously across the entire domain of interest.

We organize our article as follows. Section 2 describes the BPS estimators, and establishes their asymptotic properties for imaging data. Section 3 proposes asymptotic pointwise confidence intervals and SCCs that are constructed based on the BPS estimators. In Section 4, we discuss how to estimate the unknown components involved in the SCC construction and other issues of implementation. Section 5 reports findings from a simulation study. In Section 6, we apply the proposed methods to two real brain imaging data sets. In Section 7, we conclude the article with some discussions. Proofs of the theoretical results and additional numerical results are provided in Supporting Information.

2 | MODELS AND ESTIMATION METHOD

In practice, the functional imaging response variable, Yi (⋅), is only measured on a regular grid of pixels, zj ∈ Ω, j = 1, …, N. For notational simplicity, we let Yij = Yi (zj) be the imaging response of subject i at location j, and the actual data set consists of {(Yij, zj)}, i = 1, …, n, j = 1, …, N, which can be modeled as (2) Yij=μ(zj)+ηi(zj)+σ(zj)εij.

2.1 | Bivariate spline basis approximation over triangulations

For model (2), we first consider the estimation of the mean function, μ(⋅). Medical imaging data are typically observed on an irregular domain Ω. We approximate the mean function in (2) by the bivariate splines that are piecewise polynomial functions over a 2D triangulated domain; see Lai and Wang (2013). In the following, we briefly introduce the techniques of triangulations and describe the BPS smoothing method.

Triangulation is an effective tool for handling data distributed on irregular regions with complex boundaries and/or interior holes. In the following, we use T to denote a triangle which is a convex hull of three points that are not collinear. A collection Δ = {T1, …, TM} of M triangles is called a triangulation of Ω=∪m=1MTm if any nonempty intersection between a pair of triangles in Δ is either a shared vertex or a shared edge. Given a triangle T ∈ Δ, let|T| be its longest edge length, then the size of Δ is defined as |Δ| := max {|T|, T ∈ Δ}, that is, the length of the longest edge of all triangles in Δ.

For an integer r ⩾ 0, let Cr(Ω) be the collection of all r-th continuously differentiable functions over Ω. Given a triangulation Δ, let Sdr(Δ)={s∈Cr(Ω):s|T∈ℙd(T),T∈Δ} be a spline space of degree d and smoothness r over triangulation Δ, where s|T is the polynomial piece of spline s restricted on triangle T, and ℙd is the space of all polynomials of degree less than or equal to d. We use Bernstein basis polynomials to represent the bivariate splines. For any triangle T ∈ Δ and any fixed point z ∈ Ω, let b1, b2 and b3 be the barycentric coordinates of z relative to T. Then, the Bernstein basis polynomials of degree d relative to triangle T are defined as BijkT,d(z)=(i!j!k!)−1d!b1ib2jb3k, i + j + k = d. Let {Bm}m∈M be the set of degree-d bivariate Bernstein basis polynomials for Sdr(Δ), where M stands for an index set of Bernstein basis polynomials. Denote by B the evaluation matrix of Bernstein basis polynomials, where the jth row of B is given by BΤ(zj) = {Bm (zj), m ∈ M}, for j = 1, …, N. We can approximate the mean function μ(z) by μ(z) ≈ BΤ(z)γ, where γΤ = (γm, m ∈ M) is the spline coefficient vector. The above bivariate spline basis can be easily constructed via the R package BPST.

To define the penalized spline method, for any function g(z) and direction zh, h = 1,2, let ∇zhvg(z) denote the v-th order derivative in the direction zh at the point z. We consider the following penalized least squares problem: ming∈Sdr(Δ)∑i=1n∑j=1N{Yij−g(zj)}2+ρnE(g), where E(s)=∑T∈Δ∫T∑i+j=2(2i)(∇z1i∇z2js)2dz1dz2 is the roughness penalty, and ρn is the roughness penalty parameter. To meet the smoothness requirement of the splines, we need to impose some linear constraints on the spline coefficients γ: Hγ = 0 to be specific. See Section B.2 of the Supplementary Material of Yu et al. (2019) for a simple example of H. Thus, we have to minimize ∑i=1n∑j=1N{Yij−BT(zj)γ}2+ρnγTPγ, subject to Hγ = 0, where P is the block diagonal penalty matrix satisfying γΤPγ = ε(Bγ).

We first remove the constraint via QR decomposition of HT:HT=QR=(Q1Q2)(R1R2), where Q is orthogonal and R is upper triangular, the submatrix Q1 is the first p columns of Q, where p is the rank of H, and R2 is a matrix of zeros. Next, we reparametrize using γ = Q2θ for some θ, then it is guaranteed that Hγ = 0. The minimization problem is thus converted to a conventional unrestricted penalized regression problem: (3) ∑i=1n∑j=1N{Yij−B˜T(zj)Q2θ}2+ρnθTQ2TPQ2θ,

where B˜(z)=Q2TB(z). Denote Y¯⋅,j=n−1∑i=1nYij, Y¯=(Y¯⋅,1,…,Y¯⋅,N)T, U = BQ2, and D=Q2TPQ2. Then, minimizing (3) is equivalent to minimizing ‖Y¯−BQ2θ‖2+n−1ρnθTQ2TPQ2θ=‖Y¯−Uθ‖2+n−1ρnθTDθ,

and the solution is given by θ^={UTU+n−1ρnD}−1UTY¯. Thus, the estimator of γ and μ(⋅) are: γ^=Q2θ^, μ^(z)=B(z)Tγ^.

2.2 | Functional principal component analysis

For the second component, ηi (z), in model (2), we consider a spectral decomposition of its covariance function Gη(z, z′). Denote the eigenvalue and eigenfunction sequences of the covariance operator Gη(z, z′) as {λk}k=1∞ and {ψk(z)}k=1∞, in which λ1⩾λ2⩾⋯⩾0,∑k=1∞λk&lt;∞, and {ψk}k=1∞ form an orthonormal basis of L2 (Ω). It follows from spectral theory that Gη(z,z′)=∑k=1∞λkψk(z)ψk(z′). The ith stochastic process {ηi (z), z ∈ Ω} allows the Karhunen-Loéve L2 representation: ηi(z)=∑k=1∞ξikϕk(z), where ϕk (z) = (λk)1/2ψk (z), and the coefficients ξik’s are uncorrelated random variables with mean 0 and E (ξik ξik′) = I k( = k′), referred to as the kth FPC score of the ith subject in classical functional principal component analysis (FPCA). Thus, the response measurements in (2) can be represented as follows: Yij=μ(zj)+∑k=1∞ξikϕk(zj)+σ(zj)εij.

Next, we describe the method of estimating the FPCA: the variance-covariance function Gη(z, z′) and its eigenvalues and eigenfunctions. For any i = 1, …, n, j = 1, …, N, let R^ij=Yij−μ^(zj) be the residual. We estimate ηi (z) individually by employing the bivariate spline smoothing method to {(R^ij,zj)}j=1N. To be more specific, for each i = 1, …, n, we define the spline estimator of ηi (z) as η^i(z)=argmingi∈Sdr(Δ*)∑j=1N{R^ij−gi(zj)}2+ρn*E(gi), where the triangulation Δ* and smoothness penalty ρn* may be different from those introduced in Section 2 when estimating μ(z). Next, define the estimator of Gη(z, z′) as (4) G^η(z,z′)=n−1∑i=1nη^i(z)η^i(z′),

and we estimate the eigenfunctions ψk (⋅) using the following eigenequations: (5) ∫ΩG^η(z,z′)ψ^k(z)dz=λ^kψ^k(z′),

where ψ^k’s are subject to ∫Ωψ^k2(z)dz=1 and ∫Ωψ^k(z)ψ^k′(z)dz=0 for k′ &lt; k. If N is sufficiently large, the left hand side of can be (5) approximated by ∑j=1NG^(zj,zj′)ψ^k(zj)A(zj), where A(zj) is the area of the pixel zj.

2.3 | Theoretical properties of the estimators

We investigate the asymptotic properties of the proposed spline estimators. To discuss these properties, we introduce some notation first. For any function g over the closure of domain Ω, denote by ‖g‖L2(Ω)2=∫Ωg2(z)dz the regular L2 norm of g, and by ‖g‖∞,Ω=supz∈Ω|g(z)| the supremum norm of g. Let |g|v,∞,Ω=maxi+j=v‖∇z1i∇z2jg‖∞,Ω be the maximum norms of all the υ th order derivatives of g over Ω. For notational simplicity, we suppress the subscript Ω below. Given random variables Sn for n ⩾ 1, we write Sn = OP (bn) if limc→∞ lim supnP (|Sn| ⩾ cbn) = 0. Similarly, we write Sn = oP (bn) if limnP(|Sn| ⩾ cbn) = 0, for any constant c &gt; 0.

The following theorem provides the L2 and uniform convergence rate of μ^(⋅). The detailed proofs of this theorem are given in Web Appendix B.3 of Supporting Information.

Theorem 1. Suppose Assumptions (A1) to (A4) in Web Appendix B of Supporting Information hold, and N1/2|Δ| → ∞ as N → ∞. Then the bivariate penalized spline estimator μ^(⋅) is consistent and satisfies ‖μ^−μ‖L2=OP{ρnnN|Δ|3‖μ‖2,∞+(1+ρnnN|Δ|5)|Δ|d+1‖μ‖d+1,∞+1n+1nN|Δ|}.

In addition, if Assumptions (A1) to (A5) hold, we have ‖μ^−μ‖∞=oP{(n−1log(n))1/2} and ‖μ^−μ‖L2=OP(n−1/2).

Theorem 2 characterizes the uniform weak convergence of G^η(z,z′) and the convergence of ψ^k and λ^k.

Theorem 2. Under Assumptions (A1) to (A7) in Web Appendix B of Supporting Information, we have the following results: (a) The spline estimator G^η(z,z′) in (4) uniformly converges to Gη(z, z′) in probability, that is, sup(z,z′)∈Ω2|G^η(z,z′)−Gη(z,z′)|=oP(1); (b) ‖ψ^k−ψk‖=oP(1), |λ^k−λk|=oP(1), for k = 1, …, κ.

Although, in theory, the Karhunen-Loéve representation of the covariance function consists of an infinite number of terms. In applications, it is typical to truncate the spectral decomposition to an integer chosen so as to account for some predetermined proportion of the variance. One can select the number of principal components using the Akaike information criterion (AIC; Yao et al., 2005) or Bayesian information criterion (BIC; Li et al., 2013).

3 | SIMULTANEOUS CONFIDENCE CORRIDORS

3.1 | One sample

Let Gη(⋅,⋅) be a positive definite function defined as Gη(z,z′)=∑k=1κλkψk(z)ψk(z′), z, z′ ∈ Ω. Denote by ζ (z), z ∈ Ω a standardized Gaussian process such that Eζ (z) = 0, Eζ2 (z) = 1 with covariance function Eζ (z)ζ (z′) = Gη(z, z′){Gη(z, z)Gη(z′, z′)}−1/2, z, z′ ∈ Ω. Denote by q1−α the 100(1 − α)th percentile of the distribution of the absolute maximum of ζ (z), z ∈ Ω, that is P{supz∈Ω |ζ (z)| ⩽ q1−α} = 1 − α, α ∈ (0,1).

Define the “oracle” estimator μ¯(z)=μ(z)+n−1∑i=1nηi(z), which is infeasible due to the finite pixel grid {zj: j = 1, …, N} and the measurement error. The following theorem presents the asymptotic properties of μ¯(z) and shows that the difference between the BPS estimator μ^(z) and the “oracle” smoother μ¯(z) is uniformly bounded at an oP (n1/2) rate.

Theorem 3. Under Assumptions (A1) to (A6) in Web Appendix B of Supporting Information, for any α ∈ (0,1), as N → ∞, n → ∞, P{supz∈Ωn1/2|μ¯(z)−μ(z)|Gη(z,z)−1/2⩽q1−α}→1−α,andsupz∈Ω|μ¯(z)−μ^(z)|=oP(n−1/2).

Based on Theorems 1 and 3, we obtain the following asymptotic SCCs for μ(z), z ∈ Ω.

Corollary 1. Under the assumptions of Theorem 3, for any α ∈ (0,1), as N → ∞, n → ∞, an asymptotic 100(1 − α)% exact SCC for μ(z) is μ^(z)±n−1/2q1−αGη(z,z)1/2.

3.2 | Extension to two-sample case

While one-sample SCCs are of primary interest in many situations, in some brain imaging analysis, interest lies in comparing two groups, for example, patients and normal control subjects. Next, we extend our method to two-sample problems, constructing SCCs for the difference between mean functions from two independent groups, analogous to a two-sample t test.

Given two groups of imaging observations with sample sizes n1 and n2, respectively, defined on a common region Ω. For H = 1, 2, let GHη(z,z′)=∑k=1κHϕHk(z)ϕHk(z′) be a positive definite function and μ^H be the spline estimates for the group mean function μH. Let V (z, z′) = G1η(z, z′) + τG2η(z, z′), where τ=limn1→∞n1/n2. Denote by W (z), z ∈ Ω, a standardized Gaussian process such that EW (z) = 0, EW2 (z) = 1 with covariance E[W (z) W (z′)] = {V (z, z)}−1/2V (z, z′){V (z′, z′)}−1/2. Denote q12,α the (1 − α)th quantitle of the absolute maximal distribution of W (z), z ∈ Ω.

Theorem 4. Under Assumptions (A1) to (A6) in Web Appendix B of Supporting Information, for any α ∈ (0,1), as N → ∞, n1 → ∞, P{supz∈Ωn11/2|(μ^1−μ^2)(z)−(μ1−μ2)(z)|V(z,z)⩽q12,α}→1−α.

Theorem 4 suggests that an asymptotic 100(1 − α)% exact SCC for (μ1 − μ2)(z) can be constructed as (μ^1−μ^2)(z)±n1−1q12,α{V(z,z)}1/2.

4 | IMPLEMENTATION

Without loss of generality, we describe the implementation of the proposed SCCs for the one-sample case. The procedure can be similarly adopted to the two-sample mean cases.

4.1 | Quantile estimation and smoothing parameter selection

The quantile q1−α used to construct the SCCs in Corollary 1 cannot be obtained analytically; however, it can be approximated by numerical simulation as follows: first, we simulate ζb(z)=G^η−1/2(z,z)∑k=1κλ^k1/2Zk,bψ^k(z), where Zk,b are i.i.d standard normal variables with 1 ⩽ k ⩽ κ and b = 1, …, B for a preset large integer B. Then, we estimate the quantile q1−α by the corresponding empirical quantile of these maximum values by taking the maximal absolute value for each copy of ζb (z). To construct the SCC for the two-sample case, denote V^(z,z′)=G^1η(z,z′)+τG^2η(z,z′). We simulate W^b(z)={V^(z,z)}−1/2{∑k=1κ1λ^1k1/2Z1k,bψ^1k(z)−(n1/n2)1/2∑k=1κ2λ^2k1/2Z2k,bψ^2k(z)}, z ∈ Ω. Then, q12,α can be estimated by the empirical quantile of the B simulated ||W^b||∞’s, b = 1, …, B.

Next, for a good fit of the data, it is necessary to choose a suitable value of the smoothing parameter ρn. A large value of ρn enforces a smoother fitted function with larger fitting errors, while a small ρn may result in overfitting of the data. Since the in-sample fitting errors cannot gauge the prediction accuracy of the fitted function, we select a criterion function that attempts to measure the out-ofsample performance of the fitted model. Minimizing the generalized cross-validation (GCV) criterion is one computationally efficient approach to selecting smoothing parameters that also has good theoretical properties. We choose the smoothing parameter by minimizing the following GCV(ρn)=‖Y¯−S(ρn)Y¯‖2/[N{1−tr{S(ρn)}/N}2] over a grid of values of ρn, where S(ρn) = U(UΤU + n−1ρnD)−1UΤ.

4.2 | Spline basis and triangulation selection

To construct the SCC, we need to choose the spline basis functions and triangulation used in the BPS, a notoriously difficult task for constructing nonparametric pointwise confidence intervals or simultaneous confidence bands.

When the resolution of the imaging is relatively high and the mean imaging seems to be a realization from some smooth function without sharp edges, we suggest using smooth parameter r = 1 with degree d ⩾ 4. When d ⩾ 5, the proposed spline achieves full estimation power asymptotically (Lai and Wang, 2013). It is generally believed that subject-level image variation ηis are less smooth than the mean function. Thus, we suggest considering lower order splines, such as d = 2, when estimating the ηis.

An optimal triangulation is a partition of the domain which is best according to some criterion that measures the shape, size or number of triangles. For example, a “good” triangulation usually refers to those with well-shaped triangles, no small angles or/and no obtuse angles. We suggest building the triangulated meshes using typical triangulation construction methods such as Delaunay Triangulation (De Loera et al., 2010). The Matlab code DistMesh and R package Triangulation can be used to construct the triangulation. When estimating the mean function μ(⋅), we suggest choosing the triangulation Δμ based on leave-images-out k-fold cross-validation (CV). In the estimation of the ηi (⋅)’s, we suggest choosing the triangulation Δη so as to minimize a bootstrap estimator of the coverage error of the SCCs. In Algorithm A1 in Supporting Information, we describe our selection scheme for the one-sample case, which can be extended straightforwardly to the two-sample case.

4.3 | Variance estimation for measurement errors and SCC adjustment

For certain imaging types and modalities, our Assumptions (A2) and (A3) about the measurement errors may not be completely satisfied. We propose a modification to the SCC procedure in Section 3 to deal with images with relatively large measurement errors.

For the one-sample SCC, for any j = 1, …, N, let ε^ij=R^ij−η^i(zj), and we estimate σ2(zj) by σ^2(zj)=n−1∑i=1nε^ijε^ij. Next, denote ε^(z)=(nN)−1B˜(z)TΓN,ρ−1∑i=1n∑j=1NB˜(zj)σ(zj)εij. We estimate the variance-covariance function of ε^(z), G˜ε(z,z′)=Cov{ε^(z),ε^(z′)}, by G^ε(z,z′)=n−1N−2B˜(z)TΓN,ρ−1{∑j=1NB˜(zj)σ^2(zj)B˜(zj)T}×ΓN,ρ−1B˜(z′),

where ΓN,ρ is given in (B.5) in Supporting Information.

Denote Σ^(z,z′)=G^η(z,z′)+nG^ε(z,z′). We adjust the approximation procedure of quantile q1−α as follows: first, we simulate ζb(z)=Σ^−1/2(z,z){∑k=1κλ^k1/2ψ^k(z)Zk,ξ(b)+N−1B˜(z)TΓN,ρ−1∑j=1NB˜(zj)σ^(zj)Zj,ε(b)},

where Zk,ξ(b) and Zj,ε(b) are i.i.d standard normal variables with 1 ⩽ k ⩽ κ, 1 ⩽ j ⩽ N; next, we estimate the quantile q1−α by the corresponding empirical quantile of the B simulated ‖ζb‖∞; finally, we construct the SCC as μ^(z)±n−1/2q1−αΣ^(z,z)1/2,z∈Ω.

For the two-sample case, we can similarly modify the procedure by defining Σ^H(z,z′)=G^η,H+nHG^ε,H, for H = 1, 2, and Ξ^(z,z′)=Σ^1(z,z′)+n1/n2Σ^2(z,z′). Let σ^H(z) be the estimator of σH (z), for H = 1, 2. To estimate q12,α, we simulate W^b(z)={Ξ^(z,z)}−1/2{∑k=1κ2λ^1k1/2Z1k,ξ(b)ψ^1k(z)−(n1n2)1/2∑k=1κ2λ^2k1/2Z2k,ξ(b)ψ^2k(z)+B˜(z)TΓN,ρ1−11N∑j=1NB˜(zj)σ^1(zj)Z1j,ε(b)−(n1n2)1/2B˜(z)TΓN,ρ2−11N∑j=1NB˜(zj)σ^2(zj)Z2j,ε(b)},

where ZHk,ξ(b) and ZHj,ε(b) are i.i.d standard normal variables with 1 ⩽ k ⩽ κH, 1 ⩽ j ⩽ N for H = 1, 2. Then, q12,α can be estimated by the empirical quantile of the B simulated ‖W^b‖∞’s, b = 1, …, B. A modified SCC for μ1(z) − μ2(z) can thus be constructed as (μ^1−μ^2)(z)±n1−1/2q12,α{Ξ^(z,z)}1/2.

5 | SIMULATION STUDIES

In this section, we describe two Monte Carlo simulations to examine the finite sample performance of the proposed method.

5.1 | One sample SCC

In this simulation study, the measurements on the images are generated from the model: Yij=μ(zj)+∑k=12λk1/2ξijψk(zj)+σ(zj)εij,i=1,…,n,j=1,…,N,

where zj = (z1j, z2j) ∈ Ω ⊂ [0,1]2, and Ω is the same as the domain of the brain images shown in Section 6. To demonstrate the practical performance of our theoretical results, we consider the following four mean functions: (quadratic) μ(z) = 20{(z1 − 0.5)2 + (z2 − 0.5)2},

(exponential) μ(z) = 5 exp[−15{(z1 − 0.5)2 + (z2− 0.5)2}] + 0.5,

(cubic) μ(z) = 3.2(−z13 + z23) + 2.4,

(sine) μ(z) = −10[sin{5π (z1 + 0.22)} − sin {5π (z2 − 0.18)}] + 2.8,

shown in the first column of Figures A1 to A6 in Supporting Information.

To simulate the within-image dependence, we generate ξik∼i.i.dN(0,1), for k = 1,2. For the eigenvalues, we set λ1 = 0.5, λ2 = 0.2. For the eigenfunctions, we let ψ1(z) = c1 sin(πz1) + c2, ψ2 (z) = c3 cos(πz2) + c4, where c1 = 0.988, c2 = 0.5, c3 = 2.157, and c4 = −0.084 to guarantee that the eigenfunctions are orthonormal. We generate heterogenous measurement errors with σ (z) = 0.25{1 − (z1 − 0.5)2 − (z2 − 0.5)2}. We consider n = 50, 100, 200, and for each image, we consider two types of resolution: 40 × 40 and 79 × 79 with N = 921 and 3682 pixels falling inside the domain, respectively.

To apply our method, we consider three different triangulations which are also shown in the first column of Figures A1 to A6 in Supporting Information. The first triangulation (Δ1) contains 49 triangles and 38 vertices; the second triangulation (Δ2) contains 80 triangles and 54 vertices; while the third triangulation (Δ3) contains 144 triangles and 87 vertices. The estimated mean function based on these three triangulations are shown in the second columns of Figures A1 to A6, and the corresponding 99% SCCs are given in the last two columns. From these figures, one can see that all three triangulations result in almost the same estimates and SCCs. One can also see that even when the number of images is moderately large, the estimation is very accurate regardless of the type of underling mean functions.

Table 1 and Table A1 in Supporting Information summarize the estimated coverage rate of the SCCs based on 1000 replications for N = 921 and 3682, respectively. The number in parenthesis represents the average width of the SCCs. These two tables also confirm that there is little difference among the three triangulations and that the coverage rate is closer to the nominal confidence level for larger values of n.

5.2 | Two-sample simultaneous confidence corridor

In this simulation study, we examine the power of detecting a difference in mean images based on the proposed two-sample SCC. Two group of images are generated from the model YH,ij=μH(zj)+∑k=1κλk1/2ξijψk(zj)+σ(zj)εij,H=1,2,

where ψk’s are generated as in the simulation in Section 5.1. We consider the following: (6) H0:μ1(z)=μ2(z),forallz∈ΩvsHa:μ1(z)≠μ2(z)forsomez∈Ω.

The mean functions for two groups considered here are μ1(z) = 20{(z1 − 0.5)2 + (z2 − 0.5)2}, and μ2(z)=μ1(z)+δ(−z13+z23). The value of δ controls the difference between the two groups. The eigenvalues λk’s, eigenfunctions ψk’s and the measurement errors εij’s are generated in the same way as in the simulation presented in Section 5.1, and we set σ(z) = 0.1.

Figure 1 and Table A2 in Supporting Information summarize the estimated probability of rejecting H0 in (6) with nominal level α = 0.10, 0.05, and 0.01. When δ = 0, the probability should be close to the nominal level, and when δ is large, the estimated power should be close to 1. From Figure 1 and Table A2, one can see even when the numbers of the images n1 and n2 are moderately large, the size of the test is very close to the nominal level. The estimated power increases quickly as n1 and n2 increase. The performance of the procedure is similar and consistent for different triangulations.

6 | APPLICATIONS TO BRAIN IMAGING DATA

In this section, we implement the proposed SCCs to analyze brain imaging data. In particular, we consider data taken from positron emission tomography (PET) studies with two different settings: one using the tracer [C11]WAY100635 that has an affinity for the serotonin 1 A receptor in a study of major depressive disorder (MDD); and one using the fluorodeoxyglucose tracer [F18]FDG, a glucose analog, in a study of dementia. The imaging data are naturally three-dimensional in each case, but we focus here on one strategically selected slice in each setting. For the MDD study, we select the horizontal slice which passes through the midbrain and the amygdala, two regions implicated in MDD (Parsey et al., 2010). As pointed out by Marcus et al. (2014), within the brain, the anatomical regions that are commonly affected by Alzheimer diseases are the bilateral superior medial frontal, anterior, middle cingulate and bilateral parietal cortices, while the regions such as the bilateral medial temporal lobes are usually less affected. Therefore, for the [F18]FDG study, we focus on the 48th horizontal slice of the brain since it passes through the frontal and parietal lobes. In each case, we consider the hypotheses in (6) for the difference between two mean functions.

For the [C11]WAY100635 data, we have 40 subjects who are classified as normal controls and 26 who have been diagnosed with MDD (Parsey et al., 2006). Figure 2 displays the results of the application of the proposed procedure to these data. The portions of the SCCs not containing zero can be seen in (A); the estimation of the mean difference betweentowards the two groups is shown in (B), and the lower and upper SCCs are shown in (C) and (D).

Next, we illustrate these procedures using the PET data from the Alzheimer’s Disease Neuroimaging Initiative (ADNI; adni.loni.usc.edu). One of the primary goals of the ADNI study is to test whether PET and some other biological markers can be combined to measure the progression of mild cognitive impairment (MCI) and early Alzheimer’s disease (AD).

We use the proposed method in Section 4.2 to choose the triangulation and spline basis functions. Among the three triangulations (Δ1−Δ3) considered in simulation studies, we choose Δ3 when estimating the mean functions, and Δ1 when estimating the covariance functions. We use smooth parameter r = 1 with degree d = 5 for the estimation of mean function and d = 2 for the estimation of ηi’s. The first row of Figure 3 displays the areas in which zero is not contained within the 95% SCC comparing each pair of diagnostic groups. This suggests that the AD group has widespread mean differences from each of the other two groups. We also stratify the data according to sex and age, and the breakdowns of these data in terms of these variables are given in Table A1 in Supporting Information. Within each stratum, we examine the SCC for the difference between all pairs of diagnostic groups, and the results are also shown in Figure 3. The large apparent differences in the full group analysis can be seen (but to a lesser extent) in the comparisons among the males and among the relatively younger population, but are less pronounced in the other subgroup analyses.

7 | DISCUSSION

We develop SCCs for mean functions of imaging data in the functional data framework. We show that the proposed procedure has desirable statistical properties: the estimators are asymptotically efficient as if all images were observed with no error. One main advantage of our method is its computational efficiency and feasibility for large-scale imaging data. It greatly enhances the application of SCCs to imaging data in biomedical studies.

A few more issues still merit further research. For instance, the triangulation selection using the CV and wild bootstrap works well in practice, but a stronger theoretical justification for their use is still needed. In recent years, there has been a great deal of work on functional regression. It is interesting to extend the proposed methodology to functional regression models. The construction of SCCs in such models is a significant challenge and requires more in-depth investigation. Last but not least, it is also interesting to develop SCCs for large-scale longitudinal imaging data, in which accounting for the dependence within the subject as well as for the longitudinal design is crucial for making inference.

Supplementary Material

biom13156-sup-0003-FDA_Image_SCC_R2_supporting_information.pdf

biom13156-sup-0001-Eg1_OneSample.R

biom13156-sup-0002-Eg2_TwoSample.R

ACKNOWLEDGMENTS

The authors are truly grateful to the editor, the associate editor, and two reviewers for their constructive suggestions that led to significant improvement of the article. Li Wang’s research was supported in part by NSF awards DMS-1916204 and DMS-1542332. Todd Ogden’s work was partially supported by NIH grants 5 R01 EB024526 and 2 P50 MH090964. Data used in preparation of this article were obtained from the ADNI database (adni.loni.usc.edu). As such, the investigators within the ADNI contributed to the design and implementation of ADNI and/or provided data but did not participate in analysis or writing of this report. A complete listing of ADNI investigators can be found at: http://adni.loni.usc.edu/wp-content/uploads/how_to_apply/ADNI_Acknowledgement_List.pdf.

Funding information

National Institute of Biomedical Imaging and Bioengineering, Grant/Award Number: EB024526; National Institute of Mental Health, Grant/Award Number: MH090964; Division of Mathematical Sciences, Grant/Award Numbers: 1542332, 1916204

FIGURE 1 Type I error and empirical power of two-sample tests for different α’s: (A) α = 0.10, (B) α = 0.05, and (C) α = 0.01

FIGURE 2 Simultaneous confidence corridor (SCC) for comparison between normal control (CON) and major depressive disorder (MDD): (A) coverage of zero, (B) μ^MDD−μ^CON, (C) lower simultaneous confidence corridor (SCC), and (D) upper SCC. In (A), yellow color indicates zero falls above the upper SCC and blue color indicates zero falls beneath the lower SCC

FIGURE 3 Coverage of zero of simultaneous confidence corridor (SCC) for pairwise comparisons among CON, mild cognitive impairment (MCI) and Alzheimer’s disease (AD). Yellow color indicates zero falls above the upper SCC and blue color indicates zero falls beneath the lower SCC

TABLE 1 Empirical coverage rates and average widths of the simultaneous confidence corridors (N = 921)

	α = 0.10	α = 0.05	α = 0.01	
n	Δ1	Δ2	Δ3	Δ1	Δ2	Δ3	Δ1	Δ2	Δ3	
μ (z) = 20{(z1 − 0.5)2 + (z2 − 0.5)2}								
50	0.858 (0.651)	0.860 (0.651)	0.874 (0.659)	0.928 (0.739)	0.929 (0.739)	0.935 (0.747)	0.977 (0.908)	0.981 (0.908)	0.981 (0.916)	
100	0.891 (0.473)	0.893 (0.473)	0.897 (0.474)	0.944 (0.535)	0.947 (0.535)	0.949 (0.537)	0.979 (0.657)	0.979 (0.657)	0.980 (0.659)	
200	0.896 (0.335)	0.897 (0.336)	0.897 (0.337)	0.942 (0.379)	0.949 (0.380)	0.948 (0.381)	0.987 (0.465)	0.988 (0.466)	0.988 (0.467)	
μ (z) = 5 exp[−15{(z1 − 0.5)2 + (z2 − 0.5)2}] + 0.5							
50	0.877 (0.664)	0.879 (0.666)	0.879 (0.667)	0.939 (0.752)	0.941 (0.754)	0.937 (0.755)	0.983 (0.921)	0.983 (0.923)	0.982 (0.924)	
100	0.888 (0.473)	0.892 (0.474)	0.892 (0.474)	0.942 (0.535)	0.944 (0.536)	0.945 (0.537)	0.979 (0.657)	0.980 (0.658)	0.980 (0.659)	
200	0.904 (0.341)	0.890 (0.336)	0.902 (0.342)	0.947 (0.385)	0.942 (0.381)	0.949 (0.386)	0.986 (0.470)	0.986 (0.466)	0.986 (0.472)	
μ(z)=3.2(−z13+z23)+2.4								
50	0.876 (0.639)	0.879 (0.639)	0.880 (0.639)	0.934 (0.727)	0.937 (0.728)	0.938 (0.728)	0.980 (0.896)	0.981 (0.896)	0.981 (0.897)	
100	0.870 (0.455)	0.876 (0.455)	0.884 (0.457)	0.929 (0.517)	0.935 (0.517)	0.938 (0.519)	0.979 (0.639)	0.980 (0.640)	0.980 (0.642)	
200	0.890 (0.326)	0.889 (0.325)	0.906 (0.329)	0.941 (0.370)	0.942 (0.370)	0.953 (0.373)	0.984 (0.456)	0.986 (0.456)	0.985 (0.459)	
μ (z) = −10[sin {5π (z1 + 0.22)} − sin {5π (z2 − 0.18)}] + 2.8						
50	0.882 (0.734)	0.869 (0.740)	0.879 (0.754)	0.937 (0.821)	0.930 (0.828)	0.939 (0.843)	0.981 (0.989)	0.976 (0.996)	0.980 (1.011)	
100	0.886 (0.522)	0.901 (0.534)	0.880 (0.536)	0.938 (0.584)	0.946 (0.596)	0.935 (0.598)	0.982 (0.705)	0.983 (0.718)	0.982 (0.721)	
200	0.877 (0.370)	0.891 (0.378)	0.887 (0.384)	0.937 (0.414)	0.951 (0.423)	0.947 (0.429)	0.985 (0.499)	0.986 (0.508)	0.984 (0.514)	

SUPPORTING INFORMATION

Web Appendices, Tables, and Figures referenced in Sections 1, 5, and 6 are available with this article at the Biometrics website on Wiley Online Library. The R package for the proposed method ImageSCC is available at https://github.com/funstatpackages/ImageSCC. For the implementations of R packages of Triangulation and BPST, see https://github.com/funstatpackages/Triangulation and https://github.com/funstatpackages/BPST.


REFERENCES

Adler RJ (1990) An Introduction to Continuity, Extrema, and Related Topics for General Gaussian Processes. Hayward, CA: Institute of Mathematical Statistics.
Adler RJ and Taylor JE (2007) Random Fields and Geometry. New York: Springer.
Cao G and Wang L (2018) Simultaneous inference for the mean of repeated functional data. Journal of Multivariate Analysis, 165 , 279–295.
Cao G , Yang L and Todem D (2012) Simultaneous inference for the mean function based on dense functional data. Journal of Nonparametric Statistics, 24 , 359–377.22665964
Chang C , Lin X and Ogden RT (2017) Simultaneous confidence bands for functional regression models. Journal of Statistical Planning and Inference, 188 , 67–81.
Choi H and Reimherr M (2018) A geometric approach to confidence regions and bands for functional parameters. Journal of the Royal Statistical Society: Series B (Statistical Methodology), 80 , 239–260.
De Loera JA , Rambau J and Santos F (2010) Triangulations Structures for Algorithms and Applications. Berlin: Springer.
Degras DA (2011) Simultaneous confidence bands for nonparametric regression with functional data. Statistica Sinica, 21 , 1735–1765.
Degras DA (2017) Simultaneous confidence bands for the mean of functional data. Wiley Interdisciplinary Reviews: Computational Statistics, 9 , e1397.
Forman SD , Cohen JD , Fitzgerald M , Eddy WF , Mintun MA and Noll DC (1995) Improved assessment of significant activation in functional magnetic resonance imaging (fMRI): use of a clustersize threshold. Magnetic Resonance in medicine, 33 , 636–647.7596267
Goldsmith J , Greven S and Crainiceanu C (2013) Corrected confidence bands for functional data using principal components. Biometrics, 69 , 41–51.23003003
Gu L , Wang L , Härdle WK and Yang L (2014) A simultaneous confidence corridor for varying coefficient regression with sparse functional data. Test, 23 , 806–843.
Lai MJ and Wang L (2013) Bivariate penalized splines for regression. Statistica Sinica, 23 , 1399–1417.
Li Y , Wang N and Carroll RJ (2013) Selecting the number of principal components in functional data. Journal of the American Statistical Association, 108 , 1284–1294.
Marcus C , Mena E and Subramaniam RM (2014) Brain pet in the diagnosis of Alzheimer’s disease. Clinical Nuclear Medicine, 39 , e413.25199063
Parsey RV , Ogden RT , Miller JM , Tin A , Hesselgrave N and Goldstein E (2010) Higher serotonin 1a binding in a second major depression cohort: modeling and reference region considerations. Biological Psychiatry, 68 , 170–178.20497898
Parsey RV , Oquendo MA , Ogden RT , Olvet DM , Simpson N , Huang YY (2006) Altered serotonin 1a binding in major depression: a [carbonyl-c-11] way100635 positron emission tomography study. Biological Psychiatry, 59 , 106–113.16154547
Siegmund D , Zhang N and Yakir B (2011) False discovery rate for scanning statistics. Biometrika, 98 , 979–985.
Worsley KJ , Taylor JE , Tomaiuolo F and Lerch J (2004) Unified univariate and multivariate random field theory. Neuroimage, 23 , S189–S195.15501088
Yao F , Müller H-G and Wang J-L (2005) Functional data analysis for sparse longitudinal data. Journal of the American Statistical Association, 100 , 577–590.
Yu S , Wang G , Wang L , Liu C and Yang L (2019) Estimation and inference for generalized geoadditive models. Journal of the American Statistical Association, 1–27.
Zheng S , Yang L and Härdle WK (2014) A smooth simultaneous confidence corridor for the mean of sparse functional data. Journal of the American Statistical Association, 109 , 661–673.
Zhu H , Li R and Kong L (2012) Multivariate varying coefficient model for functional responses. The Annals of Statistics, 40 , 2634–2666.23645942
