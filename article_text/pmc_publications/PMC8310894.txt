LICENSE: This file is available for text mining. It may also be used consistent with the principles of fair use under the copyright law.


0370625
1170
Biometrics
Biometrics
Biometrics
0006-341X
1541-0420

33501651
8310894
10.1111/biom.13427
NIHMS1679584
Article
Joint model for survival and multivariate sparse functional data with application to a study of Alzheimer’s Disease
Li Cai http://orcid.org/0000-0002-5624-3031
1
Xiao Luo http://orcid.org/0000-0001-8707-0914
2
Luo Sheng http://orcid.org/0000-0003-4214-5809
3
1 Department of Biostatistics, Yale University, New Haven, Connecticut, USA
2 Department of Statistics, North Carolina State University, Raleigh, North Carolina, USA
3 Department of Biostatistics and Bioinformatics, Duke University, Durham, North Carolina, USA
Correspondence Cai Li, Department of Biostatistics, Yale University, New Haven, CT 06511, USA. cai.li@yale.edu
5 3 2021
6 2022
05 2 2021
06 7 2022
78 2 435447
This file is available for text mining. It may also be used consistent with the principles of fair use under the copyright law.
Studies of Alzheimer’s disease (AD) often collect multiple longitudinal clinical outcomes, which are correlated and predictive of AD progression. It is of great scientific interest to investigate the association between the outcomes and time to AD onset. We model the multiple longitudinal outcomes as multivariate sparse functional data and propose a functional joint model linking multivariate functional data to event time data. In particular, we propose a multivariate functional mixed model to identify the shared progression pattern and outcome-specific progression patterns of the outcomes, which enables more interpretable modeling of associations between outcomes and AD onset. The proposed method is applied to the Alzheimer’s Disease Neuroimaging Initiative study (ADNI) and the functional joint model sheds new light on inference of five longitudinal outcomes and their associations with AD onset. Simulation studies also confirm the validity of the proposed model. Data used in preparation of this article were obtained from the ADNI database.

EM algorithm
functional mixed model
multivariate longitudinal data
smoothing
survival

pmc1 | INTRODUCTION

Alzheimer’s disease (AD) is the most prevalent neurodegenerative disorder, can often be characterized by accelerated metal degradation over time, and may ultimately progress to dementia. In the year of 2017, AD was the sixth leading cause of death in the United States with 121,494 recorded deaths (Alzheimer’s Association, 2019). Great efforts have been dedicated to advancing early detection of AD.

The motivating data are from the Alzheimer’s Disease Neuroimaging Initiative (ADNI) with the primary goal of investigating whether multimodal data can be combined to measure the progression of AD (Weiner et al., 2017). We are interested in jointly modeling clinical variables, multiple longitudinal outcomes measured intermittently and time to AD onset or drop-out. Throughout the paper, AD onset refers to a clinical declaration of probable AD based on cognitive symptoms. We consider five longitudinal biomarkers commonly measured in AD studies. Among the five biomarkers, high values of Disease Assessment Scale-Cognitive 13 items (ADAS-Cog 13) and Functional Assessment Questionnaire (FAQ) reflect severe cognitive decline, whereas low values of Rey Auditory Verbal Learning Test immediate recall (RAVLT-immediate), Rey Auditory Verbal Learning Test learning curve (RAVLT-learn) and Mini-Mental State Examination (MMSE) indicate a high risk for developing AD.

Figure 1 presents spaghetti plots of the five longitudinal biomarkers and highlights profiles and time to AD onset for two subjects. Subject A has a more acute cognitive decline compared to Subject B. Indeed, subject A has faster increasing values of ADAS-Cog 13 and FAQ, faster decreasing values of RAVLT-immediate, RAVLT-learn, and MMSE as well as an earlier AD onset around month 40. The plots motivate our research: (a) subjects with more severe cognitive impairment seem more likely to progress to AD; and (b) the multiple longitudinal outcomes may be correlated. In addition, the observations do not always show clear linear trends and the trends across outcomes may not be synchronized, suggesting of potentially heterogeneous patterns.

Parametric models are often used in the joint modeling literature (Tsiatis and Davidian, 2004). De Gruttola and Tu (1994) introduced a shared random effects model, which links longitudinal data to event time data via a set of time-invariant random effects. Wulfsohn and Tsiatis (1997) proposed a shared latent process model, which models the instantaneous effect of longitudinal data to event time data. Extensions of the univariate joint models to multiple longitudinal outcomes include Henderson et al. (2000) and Lin et al. (2002). However, limitations exist: (1) the parametric models are incapable of modeling complex nonlinear trends of longitudinal outcomes; (2) assuming a specific structure of the correlation may be subject to model misspecification. Recently, joint modeling of event time data and functional data has drawn some attention. Yao (2007) proposed a shared latent process model. Yan et al. (2017) proposed a shared random effect model with a two-step estimation, and Ye et al. (2015) proposed a model for baseline longitudinal patterns and interval-censored event time data. To clarify, joint modeling here refers to the situation where the domain of function is longitudinal time. By contrast, Cox regression models where functional data are used as baseline covariates have been extensively studied; see Kong et al. (2018) and references therein. Nevertheless, none of the above works considered joint modeling of multivariate functional data and event time data.

To capture the heterogeneity of patterns in the outcomes as well as correlations among them, a popular method is multivariate functional principal component analysis (Happ and Greven, 2018). Then a Cox regression model may be adopted to link the outcomes and AD onset via the functional principal component scores. However, there exist serious computational issues for joint model estimation. Multivariate functional principal component analysis (MFPCA) models the mean functions, auto-covariance functions for within-function correlations, and cross-covariances for between-function correlations nonparametrically. Thus, for J-dimensional functional data, there are J univariate functions and J2 bivariate functions to estimate. If we use tensor product splines to approximate the bivariate functions and each marginal basis is of dimension c, then it leads to J2c2 parameters to estimate, which is computationally prohibitive for joint model estimation if J is more than 2 and infeasible for large J. Moreover, MFPCA is mostly used for dimension reduction and the resulting multivariate eigenfunctions and associated scores are often difficult to interpret. In particular, MFPCA does not explicitly model the correlation between outcomes as is often done in parametric models for multivariate longitudinal data (Verbeke et al., 2014).

We propose a new multivariate functional mixed model (MFMM) for multivariate functional data and subsequently a new functional joint model for linking multivariate functional data and event time data. The advantages of the proposed methods include: (1) the MFMM retains the flexibility of functional data methods for capturing nonlinear patterns in longitudinal outcomes and models the correlation between outcomes via a shared latent process; (2) compared to J2 bivariate covariance functions for MFPCA, MFMM requires only two bivariate covariance functions, which makes joint model estimation feasible; (3) MFMM explicitly separates the shared latent process, common to all outcomes, from the outcome-specific latent processes, unique to each outcome, and thus greatly enhances model interpretability; (4) MFMM enables a flexible Cox regression model, which not only evaluates the effects of the shared latent process to survival risk but also identifies the additional contribution of each outcome to survival risk.

The remainder of the paper is organized as follows. Section 2 introduces the proposed MFMM as well as the joint model for disease progression and survival. Section 3 describes a two-step estimation method and the proposed joint estimation method. Section 4 presents model selection for the proposed model. Section 5 applies the proposed model to the ADNI data. Section 6 examines the numerical properties of the proposed method through simulations. Section 7 concludes this work with some discussion. Technical details and extra results for numerical studies are included in the Web Appendices.

2 | MODEL

Let Yijk be the kth observation of the jth outcome (biomarker) measured intermittently at time tijk for subject i with 1 ≤ k ≤ mij, 1 ≤ j ≤ J, and 1 ≤ i ≤ n. So there are n subjects and subject i has mij observations for the jth outcome. In our data application, we model the five longitudinal outcomes ADAS-Cog 13, RAVLT-immediate, RAVLT-learn, MMSE, and FAQ (plotted in Figure 1) as Yijk with j = 1, …, 5, respectively. The survival time for the ith subject is denoted by Si and is assumed to be subject to independent right censoring with censoring time denoted by Ci. Let Ti = min(Si, Ci) and Δi=1{Si≤Ci}. Note that tijk ∈ [0, Ti], meaning no observations after Ti. Assume Ti ≤ τ for all i, where τ is the length of study follow-up. Denote by zi=(Zi1,…,ZiP)∈ℝP the vector of baseline covariates.

2.1 | Multivariate functional mixed model

We propose a MFMM for the multivariate latent process {Xi1(t), …, XiJ(t)}. The MFMM is of the form (1) Yijk=Xij(tijk)+ϵijk,   Xij(t)=μj(t)+βj{Ui(t)+Wij(t)},

where ϵijk are random noises so that the longitudinal outcome Yijk is a proxy observation of the true latent stochastic process Xij(t) evaluated at time tijk. The smooth latent process Xij(t) is decomposed into three components. First, μj(t) is the fixed mean function for outcome j. For simplicity, we assume that the mean function only depends on the longitudinal time but it may depend on the baseline covariates, which can be incorporated easily using, for example, additive models. The continuous latent profile Ui(t), common to multiple outcomes, is a subject-specific random deviation from the mean functions. Ui(t) captures the subject-specific disease progression pattern and correlation among outcomes. It represents subject i’s unique latent disease status at time t manifested by multiple outcomes and can be specified so that a higher value indicates more severe status. The outcome-specific scaling parameter βj is the expected increase in outcome j for one unit increase in Ui(t). If two outcomes are negatively correlated, their βjs have different signs. Wij(t) is the subject- and outcome-specific random deviation from the outcome-specific mean, and it characterizes subject i’s outcome-specific progression pattern. By multiplying the scaling parameters βj, Wij(t) are comparable across outcomes.

We model Ui(·) and Wij(·) via two zero-mean Gaussian processes with covariance functions C0(s, t) = Cov{Ui(s), Ui(t)} and C1(s, t) = Cov{Wij(s), Wij(t)}, respectively. Consider the spectral decomposition of the covariance functions, C0(s, t) = ∑ℓ d0ℓϕℓ(s)ϕℓ(t) and C1(s, t) = ∑ℓ d1ℓψℓ(s)ψℓ(t), where d0 1 ≥ d02 ≥ ⋯ and d11 ≥ d12 ≥ ⋯ are the ordered eigenvalues, and ϕℓ(·) and ψℓ(·) are the associated orthonormal eigenfunctions satisfying ∫0τϕl(t)ϕl′(t)dt=∫0τψl(t)ψl′(t)dt=1{l=l′}. Then the Karhunen–Loève representations of Ui(t) and Wij(t) are Ui(t)=∑l≥1ϕl(t)ξil, Wij(t)=∑l≥1ψl(t)ζijl, where ξil~N(0,d0l) are eigen scores and independent over ℓ, and ζijl~N(0,d1l) are defined similarly and independent over j and ℓ. The eigenfunctions ϕℓ(t) and ψℓ(t) represent the changing patterns of the latent disease profiles, and the random scores ξiℓ and ζijℓ determine how strongly subject i’s latent disease profile follows those patterns. In practice, we assume there are only a finite number of patterns so that Ui(t)=∑l=1L0ϕl(t)ξil, Wij(t)=∑l=1L1ψl(t)ζij, where L0 and L1 are finite numbers. We shall treat L0 and L1 as tuning parameters and select them through data adaptive methods; see Section 4 for details. We assume that the random noises ϵijk are independent and normally distributed with zero mean and variance σj2. Finally, Ui(t), Wij(t), and ϵijk are assumed independent between subjects and across each other.

We illustrate the proposed MFMM by fitting five biomarkers in the ADNI study and present two outcomes ADAS-Cog 13 and RAVLT-immediate in Figure 2; see Section 5 for model fitting details. In Figure 2, the estimate or prediction of each component in model (1) is visualized for the two outcomes of one subject. To make model identifiable, we set β1 = 1 for the outcome ADAS-Cog 13. Figures 2(A) and 2(E) present the fitted latent processes by MFMM for both outcomes. The subject shows steady worsening in cognitive function Xi1(t) (increasing ADAD-Cog 13 in Figure 2(A)), which can be decomposed into increasing mean cognitive function μ1(t) (Figure 2(B)), deteriorating (increasing) latent disease profile Ui(t) (Figure 2(C)), and positive outcome-specific progression Wi1(t) (Figure 2(D)). Similar interpretation can be made to the outcome RAVLT-immediate and decreasing patterns indicate AD progression.

Model (1) allows us to explicitly model the shared latent disease profile Ui(t) between the outcomes and outcome-specific profile Wij(t). While it has a similar multilevel decomposition structure as in multilevel FPCA (Di et al., 2009), there exist significant differences. The proposed MFMM accommodates outcome heterogeneity: (1) The scaling parameters reduce heterogeneity of the multiple functions, which may measure quantitatively very different features of subjects. For example, β2 for RAVLT-immediate is estimated as a negative number and it changes the direction of Ui(t) so that it is negatively correlated with ADAS-Cog 13; and (2) the outcome-specific progression further accommodates data heterogeneity, such as, β1Wi1(t) shows larger deviation from zero toward AD onset as compared with β2Wi2(t), suggesting more severe disease progression in ADAS-Cog 13 than in RAVLT-immediate of the subject. Compared with multivariate FPCA, MFMM borrows its idea but further accounts for outcome-specific patterns, which leads to theoretical and practical advantages: (1) MFMM gives a more interpretable model of multiple outcomes by separating the shared component, which models the correlation between outcomes, from outcome-specific components, which model the patterns of outcomes that are uncorrelated from other outcomes. By contrast, MFPCA only considers the shared component by reducing the multiple outcomes into a set of uncorrelated scores; and (2) by imposing a parsimonious model, the number of auto- and cross-covariance functions to be estimated is not increasing with the number of outcomes. This is a reasonable compromise between computability and medical fidelity, which greatly alleviates computational burden and thus makes the joint estimation feasible. In addition, MFMM may be regarded as a nonparametric extension of parametric multilevel decomposition model for multivariate longitudinal data (Verbeke et al., 2014).

We derive from (1) that (2) Cjj′(s,t):=Cov{Xij(s),Xij′(t)}=βjβj′C0(s,t)+βj21{j=j′}C1(s,t).

If j ≠ j′, Cjj′(s, t) = βjβj′C0(s, t). For model identifiability, we let β1 = 1. Then it can be shown that for J ≥ 2, βj and C0(·, ·) can be uniquely determined by (2) using the equations with j ≠ j′. (See Web Appendix A for proofs and Web Appendix B for the covariance structure relating MFMM to MFPCA.)

2.2 | Joint model for disease progression and survival

To model the survival time, we use the proportional hazards model (3) hi(t)=h0(t) exp{zi⊤γz+F(xi,t)},

where h0(·) is the baseline hazard function, γz is the coefficient vector corresponding to baseline covariates zi, xi is the collection of all outcomes for subject i, and F(xi,t) is the regression term of multiple latent processes at time t. We consider the framework of shared random effects models (Wu and Carroll, 1988; De Gruttola and Tu, 1994) as it takes into account the entire history of the latent processes and let F(xi,t)=∑l=1L0ξilγ0l+∑j=1J∑l=1L1ζijlγ1jl, where γ0ℓ and γ1jℓ are the coefficients corresponding to the shared and outcome-specific latent profiles, respectively. The hazard model extends the model in Yan et al. (2017) for univariate functional data to multivariate functional data.

2.3 | Likelihood of joint model

For model estimation, we now derive the likelihood function of the multivariate longitudinal outcomes and the event time data.

We shall introduce some notation, which will be used throughout the rest of the paper. Let ξi=(ξi1,…,ξiL0)⊤ be the vector of scores for the shared latent profile Ui(t). Then ξi~N(0,D0), where D0∈ℝL0×L0 is a diagonal matrix with d0ℓ the ℓth diagonal element. Let ζij=(ζij1,…,ζijL1)⊤ be the vector of scores for the outcome-specific latent profiles Wij(t). Then ζij~N(0,D1), where D1∈ℝL1×L1 is a diagonal matrix with d1ℓ the ℓth diagonal element. Similarly, let yij=(Yij1,…,Yijmi)⊤ be the vector of observations for the jth outcome and yi=(yi1⊤,…,yiJ⊤)⊤. Let μij={μij(ti1),…,μij(timi)}⊤ be the vector of the jth mean function at the observed time points. Let Φ(t)={ϕ1(t),…,ϕL0(t)}⊤ and Ψ(t)={ψ1(t),…,ψL1(t)}⊤. Then let Φi={Φ(ti1),…,Φ(timi)}⊤ and Ψi={Ψ(ti1),…,Ψ(timi)}⊤ be the matrices of eigenfunctions evaluated at the observed time points. Denote by xij={Xij(ti1),…,Xij(timi)}⊤ the vector of the jth outcome evaluated at the observed time points without measurement errors, note that xij = βj(Φiξi + Ψiζij), and xi=(xi1⊤,…,xiJ⊤)⊤. Finally, let ti=(ti1,…,timi)⊤ be the vector of the observed time points, and Σi=blockdiag(σ12Imi,…,σJ2Imi).

First, the conditional likelihood of multivariate longitudinal data is (4) f(yi∣xi,ti,Σi)=(|2πΣi|)−12 exp{−12(yi−xi)⊤Σi−1(yi−xi)}

and f(ξi∣D0)=(|2πD0|)−12 exp(−12ξi⊤D0−1ξi), f(ζij∣D1)=(|2πD1|)−12 exp(−12ζij⊤D1−1ζij). Next, the conditional likelihood of time-to-event data is given by (5) f(Ti,Δi∣h0,zi,xi,γz,γη)={h0(Ti) exp(zi⊤γz+ηi⊤γη)}Δi exp{−∫0Tih0(u) exp(zi⊤γz+ηi⊤γη)du},

where ηi=(ξi⊤,ζi1⊤,…,ζiJ⊤)⊤, γη=(γ0⊤,γ11⊤,…,γ1J⊤)⊤, γ0=(γ01,…,γ0L0)⊤ and γ1j=(γ1j1,…,γ1jL1)⊤ for all j. As the multivariate longitudinal data and the time-to-event data are conditionally independent given the latent process xi, the marginal likelihood is given by (6) ∏i=1n[∫f(yi∣xi,ti,Σi)f(ξi∣D0){∏j=1Jf(ζij∣D1)}×f(Ti,Δi∣h0,zi,xi,γz,γη)dηi].

3 | MODEL ESTIMATION

3.1 | Two-Step method

A naive estimation method would be to use a two-step method by first predicting the scores from the longitudinal data model (1) and then doing plug-in for the Cox regression model (3). The first step is nontrivial, so we shall provide some details.

First, for each longitudinal biomarker, the mean function is estimated by penalized splines (Eilers and Marx, 1996). Next, we adopt the fast covariance estimation method for multivariate sparse functional data in Li et al. (2020) to obtain estimates of the auto- and cross-covariance functions, C^jj′, and error variances, σ^j2, via bivariate penalized splines. Finally, we treat the estimates as true auto- and cross-covariances and estimate βj as in Web Appendix A. Once β^j are obtained, C^0 can be solved by least squares using Equation (2) with j ≠ j′. Then, C^1 can be solved similarly using the same equation with j = j′. The negative eigenvalues will be discarded to ensure that the covariances are positive semidefinite. We then use the conditional expectation approach for predicting the scores, a popular approach in traditional joint modeling (Wulfsohn and Tsiatis, 1997) and sparse functional data analysis (Yao et al., 2005); see Web Appendix C for details. Finally, the predicted scores, E^(ηi∣yi), where the estimates of fixed quantities are plugged in, will be used in the Cox regression.

Despite its computational advantage, the two-step method has some well-known drawbacks: (1) it is a marginal approach that ignores the inherent correlation between the longitudinal and survival process and often leads to inferior statistical efficiency; (2) the predicted scores in the first step are usually biased, and the estimation error will propagate into the subsequent Cox regression. Nevertheless, we shall compare the two-step method with the proposed estimation method below and demonstrate the superiority of the latter one in the numerical study. In addition, the estimates from the two-step method can be used as initial values for the joint estimation method.

3.2 | Monte Carlo EM method

3.2.1 | Reduced rank splines

Following Yao (2007) and Huang et al. (2014), we use reduced rank splines for modeling the smooth mean functions and covariance functions. Let b(t) = {B1(·), …, Bc(·)}⊤ be the vector of B-spline basis functions in the unit interval (de Boor, 1978), where c is the number of equally spaced interior knots plus the order (degree plus 1) of the B-splines. We model the mean function μj(t) by b(t)⊤αj, where αj is the coefficient vector of the jth mean function. Let G=∫b(t)b(t)⊤dt∈ℝc×c, which is positive definite (Zhou et al., 1998). Then b˜(t)=G−12b(t) are orthonormal B-spline bases. For the covariance functions C0 and C1, we approximate their ℓth eigenfunctions ϕℓ(t) and ψℓ(t) by b˜(t)⊤θ0l and b˜(t)⊤θ1, respectively, where θ0ℓ and θ1ℓ are coefficient vectors. Let Θ1=[θ01,…,θ0L0] and Θ1=[θ11,…,θ1L1]. Then the orthonormality of eigenfunctions gives the constraints, Θ0⊤Θ0=IL0×L0 and Θ1⊤Θ1=IL1×L1. These constraints are equivalent to θ0l⊤θ0l′=θ1l⊤θ1l′=1{l=l′}.

3.2.2 | E-Step

Although nonparametric functions are components of the proposed model, their spline representations allow a parametric estimation based on the EM algorithm. The full data likelihood depends on the latent random variables ηi and can be optimized via the EM method, which treats ηi as missing values and iterates between E-steps and M-steps until convergence. Such a strategy is often deployed in parametric joint modeling (Wulfsohn and Tsiatis, 1997). We shall use the Monte Carlo EM algorithm, an alternative to the Gaussian–Hermite quadrature, to approximate the numerical integrals in the E-step.

Let α=(α1⊤,…,αJ⊤)⊤ be the vector of spline coefficients for the mean functions, β = (β1, …, βJ)⊤ the vector of scaling parameters and σ2=(σ12,…,σJ2)⊤ the vector of error variances. Denote by Ω = {h0, β, γz, γη, D0, D1, α, Θ0, Θ1, σ2} the set of parameters and Ω^={h^0,β^,γ^z,γ^η,D^0,D^1,α^,Θ^0,Θ^1,σ^2} the estimate. Let g(·) be any smooth function of ηi, then the conditional expectation E{g(ηi)∣Ti,Δi,zi,yi,ti,Ω^} is given by ∫g(ηi)f(Ti,Δi∣h^0,zi,ηi,γ^z,γ^η)f(ηi∣yi,ti,α^,β^,Θ^0,Θ^1,D^0,D^1,σ^2)dηi∫f(Ti,Δi∣h^0,zi,ηi,γ^z,γ^η)f(ηi∣yi,ti,α^,β^,Θ^0,Θ^1,D^0,D^1,σ^2)dηi,

where f(Ti,Δi∣h^0,zi,ηi,γ^z,γ^η) is the conditional likelihood in (5), and the second part of the denominator can be obtained from the joint normality of ηi and yi, given the data and parameter estimates; see Web Appendix C. We now use Ei{g(ηi)} to denote the conditional expectation for convenience. In the E-step, because the integrals for the conditional expectations have no closed form solution, we use Monte Carlo approximation Ei{g(ηi)}≈∑q=1Qg(ηi(q))f(Ti,Δi∣h^0,zi,ηi(q),γ^z,γ^η)∑q=1Qf(Ti,Δi∣h^0,zi,ηi(q),γ^z,γ^η),

where ηi(q) is the qth sample from the normal distribution f(ηi∣yi,ti,α^,β^,Θ^0,Θ^1,D^0,D^1,σ^2), and Q random samples are drawn. To accelerate the convergence, we use the estimates from the two-step method as the initial values of the parameters.

3.2.3 | M-Step

Estimates of the current iteration can be obtained by optimizing separate parts of the joint likelihood (6) in the M-step, because each part only involves disjoint sets of parameters. Specifically, α, β, Θ0, Θ1, and σ2 can be estimated iteratively by minimizing the expected negative log likelihood of the longitudinal process (4), ∑i=1n∑j=1J[mi2log(2πσj2)+12σj2Ei{yij−Biαj−βj(B˜iΘ0ξi+B˜iΘ1ζij)}2].

We adopt an iterative algorithm to cyclically estimate the columns of Θ0 and Θ1 and deploy an ad hoc step to satisfy the orthonormality constraints on the parameter matrices. The parameters in the diagonal matrices D0 and D1 are estimated by minimizing the expected negative logarithm of ∏i=1nf(ξi∣D0) and ∏i=1n∏j=1jf(ζij∣D1), respectively. The baseline hazard function h0 and the parameter vectors γz and γη in the Cox regression can be estimated according to the expected negative log likelihood of the survival process (5), ∑i=1n[−Δi{logh0(Ti)+zi⊤γz+Ei(ηi⊤γη)}+∫0Tih0(u)×Ei{exp(zi⊤γz+ηi⊤γη)}du].

In particular, the baseline hazard h0 is estimated nonparametrically by the Breslow estimator, and γz and γη are updated by a one-step Newton–Raphson algorithm inside the loop. The estimated standard errors of the Cox regression coefficients can be obtained by inverting the observed information matrix. We defer the technical details to Web Appendix D.

4 | MODEL SELECTION

As described in Section 3.2, cubic B-splines are used for approximating mean functions and eigenfunctions. We use equally spaced knots for constructing the splines and for simplicity, we use the same number of knots for all spline functions. Following Huang et al. (2014), we use the asymptotic theory in Li and Hsing (2010) to determine the number of basis functions according to the sample size. For the simulation and data application, we use nine spline bases (c = 9) which is found to work well; see Web Appendix E for implementation details.

The number of eigenfunctions is an important tuning parameter since it determines the functional characteristics of the latent stochastic process. We use information criteria for model selection, which requires an evaluation of the model complexity, the degrees of freedom of the model. It can be shown that the negative log likelihood is given by ln=−2∑i=1n[log f(yi∣Ω^)+log E{f(Ti,Δi∣zi,ηi,Ω^)}], where f(yi∣Ω^) is a normal density with the covariance described in Web Appendix C, and the expectation can be approximated by Q−1∑q=1Qf(Ti,Δi∣h^0,zi,ηi(q),γ^z,γ^η).

We approximate the degrees of freedom via the number of effective parameters, df:=Jc+(L0+L1)(c+1)+P+L0+JL1+2J−1−L0(L0+1)2−L1(L1+1)2,

where Jc is the number of parameters for estimating the mean functions, (L0 + L1)(c + 1) is corresponding to the eigen pairs, P + L0 + JL1 is the number of coefficients in Cox regression, 2J − 1 is corresponding to the error variance σj2 and the scaling factor βj, and the last two terms are due to orthonormality constraints on Θ0 and Θ1, the matrix of spline coefficients for eigenfunctions (see Section 3.2.1). Therefore, we may calculate AIC = ℓn + 2 · df, and BIC = ℓn + log n · df. We shall use a two-dimensional grid for selecting the two tuning parameters L0 and L1.

5 | DATA ANALYSIS

We apply the proposed functional joint model (denoted as FJM) to the ADNI data for jointly characterizing the varying patterns of the multivariate longitudinal outcomes and their association with time to diagnosis of AD. The data are from the first two phases of ADNI, which contain 803 participants with amnestic mild cognitive impairment (MCI, a transition risk state between normal state and AD state) at baseline who had at least one follow-up visit. Participants of the first phase were scheduled to be assessed at baseline, 6, 12, 18, 24, and 36 months with additional annual follow-ups included in the second phase. Note that the exact follow-up times can actually vary. Thus, for the combined data, the average number of visits is 4.72. For the analysis, the following variables are used as baseline covariates: baseline age (mean: 74.4, standard deviation: 7.3, range 55.1–89.3), gender (36.1% female), years of education (mean: 15.6, standard deviation: 3.0, range 4–20), and the number of apolipoprotein E ϵ4 alleles (APOE4, 56% ≧ 1), given their potential effects on AD progression (Fleisher et al., 2007).

We consider various models listed in Table 1, including the proposed functional joint model and its variants. The hazard model is specified as hi(t)=h0(t) exp {Ageiγa+Genderiγg+Educationiγe+APOE4iγϵ+F(xi,t)}

and the form of F(xi,t) is given in Table 1. Reduced models A and B share the same MFMM submodel (1) as FJM. Reduced model A is a special case of the proposed model with only shared components ξi contributing to survival risk. Reduced model B is another special case with only outcome-specific components ζij contributing to survival risk. Compared to FJM, reduced model C only has shared components ξi in both submodels. To fit FJM, we use the settings of splines described in Section 4. The number of Monte Carlo samples and stopping criteria are set as described in Web Appendix E. We select the numbers of eigenfunctions according to BIC as we shall show in Section 6 that it performs well for model selection. The three reduced models can be estimated similarly as the full FJM using the proposed MCEM approach, and model selection can be similarly carried out using BIC. In addition, we consider the parametric multivariate joint linear model (denoted as MJM) proposed by Henderson et al. (2000) and implemented in R package joineRML (Hickey et al., 2018). With slight abuse of notation, we denote by β0j and β1j the fixed effects, and b0ij and b1ij the random intercept and slope in a linear mixed effects model for the jth outcome. For MJM, the corresponding Cox coefficient for the jth outcome is γj.

Table 1 presents the overall performance of the various models. First, FJM has the highest likelihood and smallest AIC and BIC, which compares favorably against the other models. Second, Reduced model A is the closest to FJM in terms of the three criteria, followed by Reduced model B and Reduced model C. We shall see later that the shared components play a major role in determining AD risk, and hence Reduced model A outperforms Reduced model B. Reduced model C not only overlooks the outcome-specific components in Cox regression, but also ignores that heterogeneity in modeling longitudinal outcomes, which explains why its performance is inferior to Reduced models A and B. Furthermore, MJM is outperformed by all other models, indicating that it gains to model the longitudinal outcomes nonlinearly. Finally, we include the concordance index (Harrell, 2015) for evaluating the predictive ability of survival models as an additional criterion. Again, FJM has the highest concordance index, while other models are slightly inferior to it. It is not surprising to see that Reduced model B is ranked last among the competitors since the shared components are primary contributors to hazard risk.

As suggested by one reviewer, a partial functional linear model (PFL) might be adopted proposed if the survival part is the primary interest (Kong et al., 2016). PFL treats the functional outcomes as cross-sectional covariates and uses a linear combination of eigen scores of each functional variable as the predictor in Cox regression. Despite the potential multicollinearity of the scores, this model is similar to using Wij(t) in MFMM but does not separate the shared component from the outcome-specific components. One primary objective of joint modeling is to understand the associations between features of the longitudinal outcomes and time to disease progression (Tsiatis and Davidian, 2004), and it is known that multicollinearity may be an issue for this objective. Nonetheless, we have compared MFMM, MFPCA, and PFL for survival prediction and found that MFMM performs best in terms of the concordance index and PFL is outperformed by MFPCA. The above models are also compared for fitting the longitudinal outcomes further showing advantages of MFMM; see Web Appendix F for details.

Table 2 summarizes the estimated Cox coefficients from the functional joint model. We have the following remarks. (1) The results show that APOE4 is significantly associated with AD risk at level 0.05, which is consistent with existing AD studies. In particular, the presence of APOE4 allele increases the hazard of AD diagnosis by 39.10% while adjusting for other covariates. (2) The parameters γ01, γ02 capture the effects of the latent disease process Ui(t) manifested by the five biomarkers. The significance of these effects indicates the contribution of the latent profile shared among the longitudinal outcomes to the hazard of AD conversion, after adjusting for baseline clinical covariates. The result agrees with the excellent predictive performance of the five biomarker reported in Li et al. (2017). (3) The proposed functional joint model sheds new insight on the AD study by successfully identifying important associations between individual longitudinal outcomes and the survival. In Table 2, the individual effects of RAVLT-immediate γ21, γ22 are significant, while others are not. These results suggest that the progression patterns of the longitudinal outcomes (ADAS-Cog 13, RAVLT-learn, MMSE, and FAQ) contribute to AD diagnosis mainly through the shared latent profile, not through their outcome-specific progression. By contrast, RAVLT-immediate contributes through the outcome-specific progression in addition to the shared latent progression. Our findings are again supported by an independent study (Li et al., 2019), which applied a penalized method and consistently selected RAVLT-immediate as the only significant risk factor of AD conversion.

Figure 3 presents the estimated mean functions of longitudinal outcomes by three methods. Both FJM and MJM are based on joint estimation and show a similar trend: the mean curves are progressing toward mental deterioration over the months, suggesting an increased risk of developing AD. These findings confirm the intuition since the participants in the study suffer from MCI, which causes cognitive decline toward dementia. Moreover, FJM can further characterize the nonlinear pattern of the biomarkers. Although MJM only provides linear estimates, it correctly identifies the deteriorating trend. The two-step method (denoted as 2-step) fails in capturing such a degenerate trend since the curves are relatively stable during the study period; this might be because the estimates are biased due to its marginal nature.

Additional results for the ADNI data are presented in Web Appendix F.

6 | SIMULATIONS

6.1 | Simulation settings

In this section, we compare the performance of the joint estimation, and the two-step method, of the proposed model. We consider two cases of data generation and replicate each for 100 times. Here, we focus on case 1, which is a realistic setting with data generated according to the fitted model of the ADNI study in Web Appendix G; see Web Appendix H for case 2 which is an alternative setting, but its results show a similar pattern as case 1.

The longitudinal data are generated according to MFMM (1) with two outcomes J = 2. The outcome-specific mean functions, scaling parameters, and error variances are derived from the estimates of ADAS-Cog 13 and RAVLT-immediate. We set two principal components for both two covariances, and the eigenfunctions are specified as the estimates of C0(s, t) and C1(s, t). The eigen scores ξiℓs are generated from a normal distribution N(0,d0l) with d01 = 95.41 and d02 = 5.04. The outcome-specific eigen scores ζijℓs are generated similarly with d11 = 21.90 and d12 = 2.05. We set the scaling parameters β1 = 1 and β2 = −1.44. The white noise ϵijks are sampled from a normal distribution N(0,σj2), where σ12=9.49 and σ22=21.98. The observed time points tijk = tik are 11 fixed time points of the ADNI study mapped to the interval [0,1].

The time-to-event data are generated according to Cox regression (3) with the coefficients set as the estimates of the common components and outcome-specific components of ADAS-Cog 13 and RAVLT-immediate. We use the baseline hazard function h0(t) = 1 and specify the linear hazard rate function as ∑l=12ξilγ0l+∑j=12∑l=12ζijlγ1jl, where the Cox coefficients are γ0 = (0.33, 0.31)⊤, γ11 = (0.01, −0.27)⊤, and γ12 = (0.25, 0.80)⊤. Then failure times are drawn independently from a standard exponential distribution. Censoring times Cis are generated independently from a uniform distribution on [0, c0], where c0 is a constant and the final truncation time τ = 1 is used so that the censoring rate is around 65%. For each subject, only measurements at tik ≤ Ti are retained. We generate data with 803 subjects, and the average number of observations per subject is around 5.5. All of these settings are close to the real case of the ADNI study.

6.2 | Simulation results

We use the settings of model fitting described in Web Appendix E. First, we fix the number of principal components as the truth L0 = L1 = 2 and estimate model components. In most of the replications, FJM converges within 200 iterations. The first two rows of Figure 4 present the estimated mean functions and eigenfunctions for ϕ2(t) and ψ2(t). While the medians of FJM are close to the truth, the two-step method has significant bias over the time. Furthermore, we obtain the point-wise confidence bands based on the quantiles of all the replications. The 95% confidence bands of FJM are able to cover the truth, but this is not the case for the two-step method since the true means lie outside its 95% confidence bands. The last two rows of Figure 4 summarize the estimates of the Cox coefficients. FJM is reasonably close to the truth, but the two-step method shows significant bias.

Finally, we use AIC and BIC to select the number of eigenfunctions in the covariances and evaluate the performance of the proposed approaches. One may define the candidate ranks of the covariance by the proportion of variance explained in the marginal MFMM stage since the two-step method is used for providing initial values. For the two-step method, the number of principal components can be selected by using either AIC or BIC solely based on Cox regression as in Kong et al. (2018). For the two-step method, the rates of correctly selecting two principal components for the covariances are 0.40 and 0.38 using BIC, respectively. By contrast, the proposed approach for FJM achieves excellence in practice, the correct selection rates are 1.00 for all using BIC. For both the two methods, the rates of AIC are slightly lower than those of BIC, so we use BIC for rank selection in the data application.

In summary, FJM shows very competitive performance and is superior to the two-step method in terms of estimation and rank selection in all scenarios. Additional simulation results are included in Web Appendix H.

7 | DISCUSSION

Our work can be extended in several directions. First, the MFMM framework is flexible to further account for heterogeneity across multiple longitudinal outcomes. For example, one might use two different scaling parameters multiplying Ui(t) and Wij(t) in model (1). Moreover, one might model Wij(t) with heterogeneous covariances to incorporate any prior information. We have adopted model (1) with homogeneous covariances in this paper as it is found to better fit the ADNI data. Second, it is worth developing a joint integrative modeling framework to incorporate imaging, genetic, and longitudinal biomarkers into the Cox regression (3) and comparing it with a predictive model proposed by Kong et al. (2015), which treats time to AD as the survival outcomes and uses multimodal data to predict AD progression. Finally, the theoretic properties of the proposed joint model are unclear, which warrant avenues for future research.

Supplementary Material

Supplement

ACKNOWLEDGEMENTS

The authors thank the editor, the associate editor, and the three reviewers for their constructive and helpful comments, which greatly improved the article. This work was partially supported by the NIH grants R56 AG064803 (CL, LX, and SL), R01 AG064803 (LX and SL), and R01 NS112303 (LX). Data used in preparation of this article were obtained from the Alzheimer’s Disease Neuroimaging Initiative (ADNI) database (http://adni.loni.usc.edu). As such, the investigators within the ADNI contributed to the design and implementation of ADNI and/or provided data but did not participate in analysis or writing of this report. A complete listing of ADNI investigators can be found at http://adni.loni.usc.edu/wp-content/uploads/how_to_apply/ADNI_Acknowledgement_List.pdf.

Funding information

NIH, Grant/Award Numbers: R56 AG064803, R01 AG064803, R01 NS112303

FIGURE 1 Five observed longitudinal biomarkers of two subjects. Vertical lines: time to AD onset; gray lines: longitudinal outcomes for 20 other subjects

FIGURE 2 Estimate of each component in model (1) for outcomes ADAS-Cog 13 (A–D) and RAVLT-immediate (E–H) for one subject in the ADNI study. (A) and (E): observed ADAS-Cog 13 and RAVLT-immediate values (black dots) and the latent processes Xij(t); (B) and (F): mean functions μj(t); (C) and (G): shared latent disease profile Ui(t) multiplied by βj; (D) and (H): outcome-specific deviations Wij(t) multiplied by βj

FIGURE 3 Estimated mean functions. Gray lines: longitudinal outcomes

FIGURE 4 Estimated functions/parameters of 100 replications. The first row: estimated mean functions; the second row: estimated eigenfunctions; the last two rows: estimated Cox coefficients. Red lines: true functions/parameters; gray lines: estimated functions; blue lines: medians of estimates; dashed purple lines: 95% point-wise confidence bands

TABLE 1 Model comparison. The “best model” row gives selected number(s) of eigenfunctions by BIC

	FJM	Reduced A	Reduced B	Reduced C	MJM	
Xij(t)	MFMM	MFMM	MFMM	μj(t) + βjUi(t)	β0j + β1jt + b0ij + b1ijt	
F(xi,t)	∑l=1L0ξilγ0l+∑j=1J∑l=1L1ζijlγ1jl	∑l=1L0ξilγ0l	∑j=1J∑l=1L1ζijlγ1jl.	∑l=1L0ξilγ0l	∑j=1J(b0ij+b1ijt)γj	
Best model	(L0, L1) = (2, 2)	(L0, L1) = (2, 2)	(L0, L1) = (2, 2)	L0 = 2	NaN	
log likelihood	−37773.30	−37849.41	−37954.25	−39718.01	−47249.77	
AIC	75754.60	75906.83	76116.50	79590.03	94657.54	
BIC	76242.19	76394.42	76604.09	79951.03	95272.71	
Concordance	0.86	0.85	0.77	0.84	0.85	

TABLE 2 Estimates (standard errors) of Cox regression coefficients from functional joint model. An asterisks indicates significance at level 0.05

FJM	Coefficient	Estimate (standard error)	p-value	
Age	γ a	−0.01 (0.01)	0.06	
Gender (female)	γ g	0.27 (0.23)	0.25	
Education	γ e	0.03 (0.03)	0.29	
APOE4	γ ϵ	0.33 (0.15)*	0.03	
Shared latent progression	γ 01	0.33 (0.02)*	3e − 51	
γ 02	0.29 (0.09)*	0.01	
ADAS-Cog 13 progression	γ 11	0.00 (0.08)	0.97	
γ 12	−0.24 (0.22)	0.28	
RAVLT-immediate progression	γ 21	0.20 (0.08)*	0.01	
γ 22	0.73 (0.19)*	9e − 5	
RAVLT-learn progression	γ 31	0.03 (0.08)	0.74	
γ 32	−0.06 (0.29)	0.83	
MMSE progression	γ 41	−0.04 (0.06)	0.51	
γ 42	−0.26 (0.28)	0.35	
FAQ progression	γ 51	0.09 (0.07)	0.16	
γ 52	−0.21 (0.20)	0.29	

DATA AVAILABILITY STATEMENT

The Alzheimer’s Disease Neuroimaging Initiative data that support the findings in this paper are openly available at http://adni.loni.usc.edu.

SUPPORTING INFORMATION

Web Appendices A, B, C, D, E, F, G, and H referenced in Section 2, 3, 4, 5, and 6 and code implementing the proposed method are available with this paper at the Biometrics website on Wiley Online Library.


REFERENCES

Alzheimer’s Association, (2019) 2019 Alzheimer’s disease facts and figures. Alzheimer’s &amp; Dementia, 15 , 321–387.
de Boor C (1978) A Practical Guide to Splines. Berlin, Germany:Springer.
De Gruttola V and Tu XM (1994) Modelling progression of CD4-lymphocyte count and its relationship to survival time. Biometrics, 50 , 1003–1014.7786983
Di C-Z , Crainiceanu CM , Caffo BS and Punjabi NM (2009) Multilevel functional principal component analysis. The Annals of Applied Statistics, 3 , 458–488.20221415
Eilers P and Marx B (1996) Flexible smoothing with B-splines and penalties (with discussion). Statistical Science, 11 , 89–121.
Fleisher A , Sowell B , Taylor C , Gamst A , Petersen RC , Thal L (2007) Clinical predictors of progression to Alzheimer disease in amnestic mild cognitive impairment. Neurology, 68 , 1588–1595.17287448
Happ C and Greven S (2018) Multivariate functional principal component analysis for data observed on different (dimensional) domains. Journal of the American Statistical Association, 113 , 649–659.
Harrell FE Jr (2015) Regression Modeling Strategies: with Applications to Linear Models, Logistic and Ordinal Regression, and Survival Analysis. Berlin, Germany: Springer.
Henderson R , Diggle P and Dobson A (2000) Joint modelling of longitudinal measurements and event time data. Biostatistics, 1 , 465–480.12933568
Hickey GL , Philipson P , Jorgensen A and Kolamunnage-Dona R (2018) joineRML: a joint model and software package for time-to-event and multivariate longitudinal outcomes. BMC Medical Research Methodology, 18 , 50.29879902
Huang H , Li Y , and Guan Y (2014) Joint modeling and clustering paired generalized longitudinal trajectories with application to cocaine abuse treatment data. Journal of the American Statistical Association, 109 , 1412–1424.
Kong D , Giovanello KS , Wang Y , Lin W , Lee E , Fan Y , (2015) Predicting Alzheimer’s disease using combined imaging-whole genome SNP data. Journal of Alzheimer’s Disease, 46 , 695–702.
Kong D , Ibrahim JG , Lee E and Zhu H (2018) FLCRM: functional linear Cox regression model. Biometrics, 74 , 109–117.28863246
Kong D , Xue K , Yao F and Zhang HH (2016) Partially functional linear regression in high dimensions. Biometrika, 103 , 147–159.
Li C , Xiao L and Luo S (2020) Fast covariance estimation for multivariate sparse functional data. Stat, 9 , e245.34262756
Li K , Chan W , Doody RS , Quinn J and Luo S (2017) Prediction of conversion to Alzheimer’s disease with longitudinal measures and time-to-event data. Journal of Alzheimer’s Disease, 58 , 361–371.
Li S , Wu Q and Sun J (2019) Penalized estimation of semipara-metric transformation models with interval-censored data and application to Alzheimer’s disease. Statistical Methods in Medical Research, 29 , 2151–2166.31718478
Li Y and Hsing T (2010) Uniform convergence rates for non-parametric regression and principal component analysis in functional/longitudinal data. The Annals of Statistics, 38 , 3321–3351.
Lin H , McCulloch CE and Mayne ST (2002) Maximum likelihood estimation in the joint analysis of time-to-event and multiple longitudinal variables. Statistics in Medicine, 21 , 2369–2382.12210621
Tsiatis AA and Davidian M (2004) Joint modeling of longitudinal and time-to-event data: An overview. Statistica Sinica, 14 , 809–834.
Verbeke G , Fieuws S , Molenberghs G and Davidian M (2014) The analysis of multivariate longitudinal data: A review. Statistical Methods in Medical Research, 23 , 42–59.22523185
Weiner MW , Veitch DP , Aisen PS , Beckett LA , Cairns NJ , Green RC (2017) Recent publications from the Alzheimer’s disease neuroimaging initiative: reviewing progress toward improved ad clinical trials. Alzheimer’s &amp; Dementia, 13 , e1–e85.
Wu MC and Carroll RJ (1988) Estimation and comparison of changes in the presence of informative right censoring by modeling the censoring process. Biometrics, 44 , 175–188.
Wulfsohn MS and Tsiatis AA (1997) A joint model for survival and longitudinal data measured with error. Biometrics, 53 , 330–339.9147598
Yan F , Lin X and Huang X (2017) Dynamic prediction of disease progression for leukemia patients by functional principal component analysis of longitudinal expression levels of an oncogene. The Annals of Applied Statistics, 11 , 1649–1670.
Yao F (2007) Functional principal component analysis for longitudinal and survival data. Statistica Sinica, 17 , 965–983.
Yao F , Müller H-G and Wang J-L (2005) Functional data analysis for sparse longitudinal data. Journal of the American Statistical Association, 100 , 577–590.
Ye J , Li Y and Guan Y (2015) Joint modeling of longitudinal drug using pattern and time to first relapse in cocaine dependence treatment data. The Annals of Applied Statistics, 9 , 1621–1642.
Zhou S , Shen X and Wolfe D (1998) Local asymptotics for regression splines and confidence regions. The Annals of Statistics, 26 , 1760–1782.
