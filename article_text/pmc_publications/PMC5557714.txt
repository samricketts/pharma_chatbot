LICENSE: This file is available for text mining. It may also be used consistent with the principles of fair use under the copyright law.


9212457
2625
Stat Methods Med Res
Stat Methods Med Res
Statistical methods in medical research
0962-2802
1477-0334

28750578
5557714
10.1177/0962280217722177
NIHMS891511
Article
Dynamic Predictions in Bayesian Functional Joint Models for Longitudinal and Time-to-Event Data: An Application to Alzheimer’s Disease
Li Kan PhD candidate, Department of Biostatistics, The University of Texas Health Science Center at Houston

Luo Sheng *Associate Professor, Department of Biostatistics, The University of Texas Health Science Center at Houston, 1200 Pressler St, Houston, TX 77030, USA

* Corresponding author: sheng.t.luo@uth.tmc.edu; Phone: 713-500-9554
12 7 2017
28 7 2017
2 2019
01 7 2018
28 2 327342
This file is available for text mining. It may also be used consistent with the principles of fair use under the copyright law.
In the study of Alzheimer’s disease (AD), researchers often collect repeated measurements of clinical variables, event history, and functional data. If the health measurements deteriorate rapidly, patients may reach a level of cognitive impairment and are diagnosed as having dementia. An accurate prediction of the time to dementia based on the information collected is helpful for physicians to monitor patients’ disease progression and to make early informed medical decisions. In this article, we first propose a functional joint model (FJM) to account for functional predictors in both longitudinal and survival submodels in the joint modeling framework. We then develop a Bayesian approach for parameter estimation and a dynamic prediction framework for predicting the subjects’ future outcome trajectories and risk of dementia, based on their scalar and functional measurements. The proposed Bayesian FJM provides a flexible framework to incorporate many features both in joint modeling of longitudinal and survival data and in functional data analysis. Our proposed model is evaluated by a simulation study and is applied to the motivating Alzheimer’s Disease Neuroimaging Initiative (ADNI) study.

ADNI study
Functional data analysis
Markov Chain Monte Carlo
penalized B-Spline
personalized prediction

1 Introduction

Joint modeling of longitudinal and survival data is a popular framework to appropriately analyze datasets with repeated measurements and time-to-event outcomes1,2. The principle is to define two submodels (a mixed effects submodel for the longitudinal outcome and a Cox submodel for the survival outcome) and link them using a common latent structure. This modeling approach analyzes the two types of outcomes simultaneously and is able to reduce the bias of parameter estimates and improve the efficiency of statistical inference. A novel use of joint models, which has gained increasing interest in recent years, is to obtain dynamic personalized prediction of future longitudinal outcome trajectories and risks of survival events at any time, given the subject-specific outcome profiles up to the time of prediction. A key feature of the dynamic prediction frameworks is that the predictive measures can be dynamically updated as additional longitudinal measurements become available for the target subjects, providing instantaneous risk assessment, e.g., Rizopoulos3 and Taylor et al.4 The practical impact of these dynamic prediction tools can be dramatic for the neurodegenerative diseases because they provide unique insight and valuable guidance for clinical decision making on treatment selection, patient prognosis, and counseling to facilitate a targeted treatment. However, current state-of-the-art joint models do not incorporate functional data, which are increasingly collected in public health and medical studies, to better understand many complex diseases.

Functional data consist of a sample of functions that provide information about curves, surfaces or anything else varying over a continuum. These functions are usually defined on a one-dimensional time domain, such as growth curve data, heart rate monitor data, and electroencephalogram (EEG) data. A growing volume of functional data are also collected on higher dimensional domains such as magnetic resonance imaging (MRI), positron emission tomography (PET), and functional MRI (fMRI). Functional data is closely related to multivariate data because functions are highly multivariate objects5. The main distinction between functional data and multivariate data is the natural ordering (in time or space) within a function. The high dimensionality and the complex structure in functional data pose challenges in both statistical theory and computation6,7.

Functional regression, especially functional predictor regression, is an active area of functional data analysis in the past decade. Although there is a rich literature in functional predictor regression to model the relationship between a scalar outcome and functional predictors8–13, most of the work focuses on cross-sectional data. Goldsmith et al.14 proposed a penalized functional regression model to handle longitudinal measurements in both the response variable and functional predictors by incorporating scalar random effects. Gertheiss et al.15 improved the longitudinal model to allow for different effects of subject-specific curves. More recently, Gellar et al.16 extended the Cox proportional hazards model to incorporate functional predictors and estimated the parameters via penalized partial likelihood approach. Lee et al.17 developed a Bayesian functional Cox regression model with both functional and scalar covariates, but used different regularization approaches. However, these works focus on the statistical inference instead of prediction. To the best of our knowledge, there are no studies of dynamic prediction based on functional regression modeling that simultaneously analyze the longitudinal measurements and time-to-event data. By using functional data as predictors in the dynamic prediction framework using a joint model, the rich information in functional data may increase the model’s power of predicting disease progression in clinical practice.

In this article, we propose a novel joint model that incorporates the growing volume of functional data in the longitudinal-survival setting. Specifically, we develop a functional joint model (FJM), where outcomes consist of a longitudinal measure and a time-to-event variable, and the exposure variables include both scalar predictors and functional predictors. The key idea of characterizing FJM is to treat each functional predictor as a single structured object rather than a collection of data points7, in contrast to the scalar predictor. Thus, the FJM needs to handle the complex structure within each function and the association between different data types. In addition, the coefficient for a functional predictor in the FJM is also a function, which increases the difficulty for estimation and inference. We estimate the coefficient functions for the functional predictors using penalized spline approach. We develop a Bayesian approach for statistical inference of our FJM and a dynamic prediction framework for the predictions of target patients’ future outcome trajectories and risks of event. These important predictive measures can provide valuable information to discover and validate prognostic biomarkers which may advance the design of future clinical trials.

The rest of the article is organized as follows. In Section 2, we describe the motivating Alzheimer’s Disease Neuroimaging Initiative (ADNI) study and the data structure. In Section 3, we discuss the joint longitudinal-survival model with functional predictors, Bayesian inference procedure, and dynamic prediction framework. In Section 4, we apply the proposed method to the ADNI study. In Section 5, we conduct a simulation study to examine the performance of the proposed Bayesian FJM. Concluding remarks and discussion is presented in Section 6.

2 A Motivating Clinical Study

The methodology development is motivated by the Alzheimer’s Disease Neuroimaging Initiative (ADNI) study. The primary goal of the study is to test whether serial magnetic resonance imaging (MRI), positron emission tomography (PET), cerebrospinal fluid (CSF) markers, and neuropsychological assessments can be combined to measure the progression of AD. The phase one of the ADNI study (ADNI-1) recruited more than 800 adults, of which about 200 cognitively normal individuals, 400 mild cognitive impairment (MCI) patients, and 200 early AD patients. Participants were reassessed at 6, 12, 18, 24 and 36 months, and additional follow-ups were conducted annually as part of ADNI-2. At each visit, various neuropsychological assessments, brain image, and clinical measures were collected. Detailed information about the ADNI study procedures, including participant inclusion and exclusion criteria and complete study protocol can be found at http://www.adni-info.org.

Because MCI is commonly considered as a transitional stage between normal cognition and Alzheimer’s disease, numerous recent studies assess various clinical markers and neuroimaging techniques to predict AD diagnosis among MCI patients18. To this end, our analysis focuses on 355 MCI patients in the ADNI-1 study without missing data in covariates of interests, and we consider AD diagnosis among MCI patients to be the survival event of interest. In the ADNI-1 study, the 355 MCI patients were followed up for a mean of 3.2 years (SD 2.6; range 0.4–9.3) before AD diagnosis or censoring. Among them, 180 patients were diagnosed with AD (survival event) and 175 had stable MCI over a mean follow-up period of 2.3 years and 4.2 years, respectively.

Moreover, the longitudinal Alzheimer Disease Assessment Scale-Cognitive (ADAS-Cog) score was reported to be the strongest predictor of time from MCI-to-AD19. It is an important clinical measure for cognitive functions and it manifests disease status. It is usually reported as a composite score of the 11 items (ADAS-Cog 11), with a total score of 70 and higher score indicating poor cognitive function. Figure 1 displays the lowess smoothing curve20 of ADAS-Cog 11 scores over time for the MCI patients, with follow-up time less than 3 years (203 patients), 3–6 years (82 patients), and more than 3 years (70 patients), in addition to 95% pointwise confidence intervals. Figure 1 suggests that the ADASCog 11 scores of patients in all three groups increase with time, which indicates the deteriorating of cognitive functions. The patients with shorter follow-up time tend to have higher ADAS-Cog 11 scores, indicating that patients with more severe cognitive impairment were more likely to progress to AD or censoring. This phenomenon manifests strong correlation between the longitudinal ADASCog 11 values and the time to AD diagnosis, and is often referred to as “dependent censoring” or “informative censoring” in the literature of joint modeling21. However, many studies22,23 designed to explore the association between longitudinal measures and disease progression of MCI patients analyzed the two processes separately. Their approaches failed to account for such informative censoring and resulted into biased inference.

Furthermore, the degree of atrophy within the medial temporal lobe structures, especially within the hippocampus, was reported to be associated with the AD progression24. Most of the current analysis was based on volumes of brain regions24–26. For example, AD patients and MCI patients have been shown to have 27% and 11% smaller hippocampal volumes, respectively, as compared with normal age-matched elderly24. However, some research27,28 demonstrated that the surface-based morphology analysis offers more advantages because this method studies patterns of subregion atrophy and produce detailed pointwise correlation between atrophy and cognitive functions. In these surface-based analyses, the hippocampus is modeled as a surface model which is a mesh of triangles. Each triangle is known as a face and the place where the corners of the triangles meet is called a vertex. The coordinate of each vertex is determined during image processing and allows one to compute many morphometric measures based on it. In this article, we propose a Bayesian personalized prediction model based on the functional joint model (FJM) of longitudinal ADAS-Cog 11 score and the time to AD diagnosis, accounting for the clinical covariates and MRI imaging measures. We include as a functional predictor the hippocampal radial distance (HRD) of vertices on bilateral hippocampal surfaces. The HRD measures the distance from the medial core to each surface vertex and represents the hippocampal thickness. The HRD is calculated based on the surface model and the image processing procedure is detailed in the Web Supplement.

3 Methods

3.1 Functional joint model (FJM) framework

For each subject i (i = 1, . . . , I) at visit j (j = 1, . . . , Ji), we observe data {yij, xij, gi(x)(s)}, where yij = yi(tij) is a scalar outcome recorded at time tij from the study onset. Vector xij is a p-dimensional covariate vector. Function gi(x)(s) is a time-invariant functional predictor defined over a 1D domain s ∈ [0, Smax] = S. The domain of the functional predictor S, is not the same as the time domain t, over which the survival event is followed. For the ease of illustration, we only incorporate a single time-invariant functional predictor, such as the baseline MRI measure, in both the longitudinal and survival submodels, while the FJM can readily accommodate multiple functional predictors. We use superscript (x) and (w) to denote the functional predictors in the longitudinal and survival submodels, respectively. The longitudinal submodel is

(1) yi(tij)=mi(tij)+εij,mi(tij)=β0+xij⊤β+∫Sgi(x)(s)B(x)(s)ds+zij⊤ui,

where mi(tij) is the unobserved true value of the longitudinal outcome at time tij, β0 is the intercept, and β is the regression coefficient vector. Coefficient function B(x)(s) (defined on the same domain as gi(x)(s)) determines a pointwise association between gi(x)(s) and yi(tij). Vector zij is a q-dimensional covariates corresponding to random effects ui, which is assumed to have ui ~ N(0,Σu) to account for the within-subject correlation. The measurement error εij~N(0,σε2) is independent from ui. To allow flexibility and smoothness in modeling the effects of some covariates, smooth functions using splines can also be included in model (1).

The event history is recorded for each subject i with observed event time Ti=min(Ti∗,Ci) and the event indicator δi=I(Ti∗≤Ci), where Ti∗ and Ci are the true event time and censoring time, respectively. The survival submodel is

(2) hi(t)=h0(t)exp{wi⊤γ+∫Sgi(w)(s)B(w)(s)ds+αmi(t)},

where h0(t) is the baseline hazard function, and wi is a vector of time-independent covariates with regression coefficient vector γ. Functional predictor gi(w)(s) may be the same or different from its counterpart gi(x)(s) in model (1). Functional log hazard ratio B(w)(s) measures the overall contribution of gi(w)(s) towards the event hazard. The association parameter α quantifies the strength of correlation between the unobserved true longitudinal function mi(t) and the event hazard at the same time point t. Models (1) and (2) consist of the functional joint model (FJM) framework.

To build the functional regression model, we adopt a penalized approach to incorporate functional components into functional predictor regression model14,16. We first express the time-invariant functional predictor gi(x)(s) in model (1) using the Karhunen-Loève decomposition. Let μ(x)(s) be the mean of gi(x)(s) and ∑(x)(s,s′)=cov{gi(x)(s),gi(x)(s′)} be the covariance function between two locations (s and s′) of the functional predictor. The spectral decomposition of the covariance function is given by ∑(x)(s,s′)=∑l=1∞λl(x)ϕl(x)(s)ϕl(x)(s′), where λ1(x)≥λ2(x)≥⋯≥0 are non-increasing eigenvalues and ϕl(x)(s)’s are the corresponding orthonormal eigenfunctions. The Karhunen-Loève expansion of gi(x)(s) is gi(x)(s)=μ(x)(s)+∑l=1∞ξil(x)ϕl(x)(s), where the functional principal component (FPC) scores ξil(x)=∫S{gi(x)(s)-μ(x)(s)}ϕl(x)(s)ds are uncorrelated random variables with mean zero and variance λl(x). In practice, we adopt a truncated approximation for gi(x)(s) given by gi(x)(s)≈μ(x)(s)+∑l=1Kxξil(x)ϕl(x)(s).

In the second step, we express coefficient function B(x)(s) in model (1) in term of a cubic B-spline basis functions ψ(x)(s)=[ψ1(x)(s),⋯,ψKB(x)(s)]⊤, so that B(x)(s)=∑l=1KBBl(x)ψl(x)(s). The basis function ψ(s)(x) is evaluated over the domain S on which function gi(x)(s) is observed. The coefficients Bl(x) are unknown parameters that need to be estimated. We denote the vector of FPC scores as ξi(x)=[ξi1(x),…,ξiKx(x)]⊤, the vector of eigenfunctions as ϕ(x)(s)=[ϕ1(x)(s),…,ϕKx(x)(s)]⊤, and the vector of coefficients as B(x)=[B1(x),…,BKB(x)]⊤. Then we have

∫Sgi(x)(s)B(x)(s)ds≈∫Sμ(x)(s)B(x)(s)ds+∫S(ξi(x))⊤ϕ(x)(s)ψ(x)(s)⊤B(x)ds=∫Sμ(x)(s)B(x)(s)ds+(ξi(x))⊤∫Sϕ(x)(s)ψ(x)(s)⊤dsB(x)=∫Sμ(x)(s)B(x)(s)ds+(ξi(x))⊤Jϕ,ψ(x)B(x).

Note that Jϕ,ψ(x) is a Kx × KB matrix with the (k,l)th entry equal to ∫Sϕk(x)(s)ψl(x)(s)⊤ds. The integrals are computed by numeric integration and Jϕ,ψ(x) is a fixed term in the model. The number of components Kx can be determined using the proportion of explained variance (PEV). Specifically, Kx may be chosen as the minimum number of functional principal components such that ∑l=1Kxλ^l(x)/∑l=1∞λ^l(x)≥L, where L is a pre-specified PEV, e.g., L = 80%, 90%, or 95%. However, the selected number Kx can explain the majority of the variability in the functional predictor but it may not adequately represent the coefficient function. Thus in this paper, we refer to Ruppert (2002)29 and choose Kx and KB sufficient large (e.g., 20) to capture the complexity in both functional predictors and coefficient functions, with the identifiability constrain Kx ≥ KB.

Similarly, the functional predictor g(w)(s) in model (2) can be expressed as gi(w)(s)≈μ(w)(s)+∑l=1Kwξil(w)ϕl(w)(s) and the coefficient function B(w)(s)=∑l=1KBBl(w)ψl(w)(s), where ψl(w)(s)’s are B-spline basis functions defined on the same domain of g(w)(s). Thus, ∫Sg(w)(s)B(w)(s)ds≈∫Sμ(w)(s)B(w)(s)ds+(ξi(w))⊤Jϕ,ψ(w)B(w), with μ(w)(s), ξil(w),ϕl(w)(s),Jϕ,ψ(w), and B(w) have the same meanings as μ(x)(s), ξil(x),ϕl(x)(s),Jϕ,ψ(x), and B(x), respectively. Thus, the FJM is rewritten as

(3) yi(t)=mi(t)+εij,wheremi(t)=β0′+xij⊤β+(ξi(x))⊤Jϕ,ψ(x)B(x)+zij⊤ui,

(4) andhi(t)=h0∗(t)exp{wi⊤γ+(ξi(w))⊤Jϕ,ψ(w)B(w)+αmi(t)},

where β0′=β0+∫Sμ(x)(s)B(x)(s)ds and h0∗(t)=h0(t)exp{∫Sμ(w)(s)B(w)(s)ds}. For notational ease and without ambiguity, we replace the approximation sign (≈) by the equal sign. Note that models (3) and (4) are similar to a linear mixed submodel for the longitudinal scalar response variable and a Cox submodel for the survival outcome, respectively, in a standard joint model framework2. And FPC scores ξi(x) and ξi(w) can be treated as scalar covariates. Similar to mixed models, our FJM can readily handle unbalanced data in the longitudinal measurement of yi(t).

Let θ=[β0′,β⊤,(B(x))⊤,vech(∑u)⊤,γ⊤,(B(w))⊤,α,σε2,θh0∗⊤]⊤ be the parameter vector, where vech(Σu) is the vector being formed by vectorizing the lower triangular part of covariance matrix Σu, vector θh0∗ denotes the parameters in the baseline hazard function h0∗(·). The conditional likelihood from the longitudinal data yi = [yi1, · · ·, yiJi ]⊤ is

p(yi∣θ,ui)=(2πσε2)-Ji/2exp{-12σε2∑j=1Ji[yij-(β0′+xij⊤β+(ξi(x))⊤Jϕ,ψ(x)B(x)+zij⊤ui)]2},

and the density function of the random effects ui is p(ui∣θ)=(2π)-q/2∣∑u∣-1/2exp(-12ui⊤∑u-1ui), where q is the dimension of the covariance matrix Σu. The conditional likelihood from the survival data is

p(Ti,δi,∣θ,ui)=hi(Ti∣θ,ui)δiSi(Ti∣θ,ui)=hi(Ti∣θ,ui)δiexp[-∫0Tihi(t∣θ,ui)dt],

where hi(Ti∣θ,ui)=h0∗(Ti)exp{wi⊤γ+(ξi(w))⊤Jϕ,ψ(w)B(w)+αmi(Ti)}, and function h0∗(·) can be approximated by a piecewise-constant function or a B-spline function.

Under the local independence assumption (i.e., conditional on the random effect vector ui, all components in yi and Ti are independent), the joint likelihood function is

(5) L(θ)=∏i=1Ip(yi,Ti,δi∣θ)=∏i=1I∫p(yi∣θ,ui)p(Ti,δi,∣θ,ui)p(ui∣θ)dui.

To prevent overfitting, we adopt penalization technique to estimate spline coefficients B(x) and B(w) and to introduce smoothness in the resulting coefficient function. The penalized log-likelihood is formed by subtracting the penalty terms from the log-likelihood,

(6) l(θ)=logL(θ)-1σB(x)2(B(x))⊤B(x)-1σB(w)2(B(w))⊤B(w),

where σB(x)2 and σB(w)2 are smoothing parameters. Instead of fitting the model by direct maximization of the penalized likelihood, we adopt a Bayesian penalization approach detailed in Section 3.2.

3.2 Bayesian inference

In practice, the functional predictors such as gi(x)(s) are measured over finite grids in domain S and often with measurement error, i.e., the observed functional predictor gi(x′)(s)=gi(x)(s)+εi(s), where measurement error εi(s)~N(0,σε2) is a white noise process. The mean function μ(x)(s) is estimated by μ^(x)(s)=∑i=1Igi(x′)(s)/I, and the empirical covariance function is estimated by ∑^(x)(s,s′)=∑i=1I{gi(x′)(s)-μ^(x)(s)}{gi(x′)(s′)-μ^(x)(s′)}/(I-1). We apply kernel smoothing to the off-diagonal elements of Σ̂x(s, s′) to remove the effects from measurement errors30,31. Then the estimated eigenvalues λ^l(x) and the corresponding estimated eigenfunctions ϕ^l(x)(s), where l = 1, . . . , Smax, are calculated based on the decomposition of the smoothed covariance function. Finally, the estimated FPC scores for each subject are calculated as ξ^il(x)=∫S{gi(x′)(s)-μ^(x)(s)}ϕ^l(x)(s)ds, and the integral can be approximated by the Riemann sum. We choose the first Kx estimated eigenfunctions and FPC scores, and denote them as ϕ^(x)(s)=[ϕ^1(x)(s),…,ϕ^Kx(x)(s)]⊤ and ξ^i(x)=[ξ^i1(x),…,ξ^iKx(x)]⊤, respectively. In a similar fashion, functional predictor gi(w)(s) can be obtained and the components ϕ̂(w)(s) and ξ^i(w) can be defined.

For model fitting, we propose a Bayesian approach based on Markov Chain Monte Carlo (MCMC) posterior simulations, which provides a flexible way for statistical inference. In Bayesian framework, unknown parameters are considered as random variables with appropriate prior distributions. We use vague prior distributions on all elements in parameter vector θ. Specifically, the prior distributions of parameters β, γ, α are N(0, 100), and Inverse-Gamma(0.01, 0.01) for all variance parameters. We impose smoothness on coefficient function estimates through the prior specification on B(x) and B(w). We replace the penalty terms in the penalized likelihood (6) by their stochastic analogues, and assume a random walk prior distribution on the Bl(x) and Bl(w), for l = 1, · · ·,KB32. Specifically, we use a first order random prior distribution for Bl+1(x)~N(Bl+1(x),σB(x)2), for l = 1, · · ·,KB − 1, where B1(x) is treated as a fixed unknown parameter. Then the variance component σB(x)2 is assigned Inverse- Gamma(0.01, 0.01) as prior distribution. A similar approach is applied to Bl(w). We have investigated other selections of prior distributions and hyper parameters and have obtained very similar results.

The model fitting is performed in Stan by specifying the full likelihood function and the prior distributions of all unknown parameters. Stan adopts a No-U-Turn sampler33, which offers faster convergence and parameter space exploration compared with other MCMC algorithms such as Gibbs sampler. We use the history plots and view the absence of apparent trend in the plot as evidence of convergence. In addition, we use the Gelman-Rubin diagnostic to ensure the scale reduction R̂ of all parameters are smaller than 1.134. After fitting the model to the training dataset (the dataset used to build the model) using Bayesian approaches, we obtain D (e.g., D=2,000 after burn-in) samples for the parameter vector denoted by {θ(d), d = 1, · · · ,D}. All estimations can then be obtained by calculating simple summaries (e.g., mean, variance, quantiles) of the posterior distributions of D samples {θ(d), d = 1, · · · ,D}. Based on the estimated coefficient vector B̂(x) (posterior mean), the estimated coefficient function is calculated by B̂(x)(s) = (B̂ (x))⊤ψ(x)(s). The Bayesian approach allows for the easy construction of posterior credible intervals for the coefficient function B(x)(s) as [q̂B,0.025(s), q̂B,0.975(s)], where q̂B,p(s) is the p-quartile of the MCMC samples [B(x)(s)](d) = [(B(x))(d)]⊤ ψ(x)(s), d = 1, · · · ,D. Similarly, the estimated coefficient function B̂(w)(s) and its credible interval can be obtained. To facilitate easy reading and implementation of the proposed functional joint model, a Stan code has been posted in the Web Supplement.

3.3 Dynamic prediction framework

We next illustrate the dynamic prediction framework based on the proposed Bayesian FJM. Given a new subject N’s outcome histories yN{t}={yN(tNj);0≤tNj≤t} and covariates XN{t}={xN(tNj),gN(x)(s),wN,gN(w)(s);0≤tNj≤t} up to time t, and δN = 0 (no event), we want to predict the personalized longitudinal outcome yN(t′) at a future time point t′ &gt; t (e.g., t′ = t+ Δt), and the conditional probability of event-free or survival at time t′, denoted by πN(t′∣t)=P(TN∗≥t′∣TN∗&gt;t,yN{t},XN{t}). The key step for prediction is to obtain samples for subject N’s random effect vector uN from its posterior distribution p(uN∣TN∗&gt;t,yN{t},θ). Conditional on the dth posterior sample θ(d), d = 1, · · ·, D, we draw the dth sample of the random effect vector uN from its posterior distribution

p(uN∣TN∗&gt;t,yN{t},θ(d))=p(yN{t},TN∗&gt;t,uN∣θ(d))p(yN{t},TN∗&gt;t∣θ(d))∝p(yN{t},TN∗&gt;t,uN∣θ(d))=p(yN{t}∣θ(d),uN)p(TN∗&gt;t∣θ(d),uN)p(uN∣θ(d)),

where p(yN{t}∣θ(d),uN) is the conditional probability of longitudinal data from model (3), p(TN∗&gt;t∣θ(d),uN) is the survival probability from model (4), and p(uN|θ(d)) is the probability of random effect. For each of θ(d), d = 1, · · ·, D, we use adaptive rejection Metropolis sampling (ARMS)35 to draw one sample of random effect vector uN. This process is repeated for the D saved values of θ so that D samples of random effect vector uN are obtained. The predictions can be calculated by plugging in the samples of the parameter vector and random effec vector {θ(d), uN(d), d = 1, …, D} into the proposed models. For example, based on model (3), the expected values of the longitudinal outcome for subject N at time t′ is

E^{yN(t′)∣TN∗&gt;t,yN{t},XN{t}}=∫E{yN(t′)∣TN∗&gt;t,yN{t},XN{t},uN}p(uN∣TN∗&gt;t,yN{t},XN{t})duN≈1D∑d=1DE{yN(t′)∣TN∗&gt;t,yN{t},XN{t},uN(d)}=1D∑d=1DmN(d)(t′),

where the integration with respect to uN in the first equality is approximated using Monte Carlo method. The baseline functional predictor such as gN(x)(s) can be converted to gN(x)(s)≈μ^(x)(s)+∑l=1Kxξ^Nl(x)ϕ^l(x)(s), where ξ^Nl(x)=∫S{gN(x)(s)-μ^(x)(s)}ϕ^l(x)(s)ds. Similarly, based on model (4), the conditional probability of event-free at time t′ is

π^N(t′∣t)=∫P(TN∗≥t′∣TN∗&gt;t,yN{t},XN{t},uN)p(uN∣TN∗&gt;t,yN{t},XN{t})duN≈1D∑d=1DP(TN∗≥t′∣TN∗&gt;t,yN{t},XN{t},uN(d))=1D∑d=1DP(TN∗≥t′∣TN∗&gt;t,yN{t},XN{t},uN(d))P(TN∗≥t∣TN∗&gt;t,yN{t},XN{t},uN(d))=1D∑d=1Dexp[-∫tt′hN(d)(t∗∣uN(d))dt∗].

Suppose that subject N has not experienced the event of interest by time t′, then the outcome histories are updated to yN{t′}. We can dynamically update the posterior distribution to p(uN∣TN∗&gt;t′,yN{t′},θ), draw new samples, and obtain the updated predictions.

It is essential to assess the performance of the proposed predictive measures. Information criteria, such as deviance information criterion (DIC), can be useful to assess the overall predictive ability of the model. Here we mainly focus on the survival outcome, probability of event-free πN(t′|t), and on how well the model discriminates between patients who had the event from patients who did not. Such discrimination performance is measured by the time-dependent receiver operating characteristic (ROC) curve and the area under the ROC curve (AUC; higher value indicates better discrimination performance). Specifically, for any given cut point c ∈ (0, 1), the time-dependent sensitivity and specificity are defined as sensitivity: P(πi(t′∣t)&gt;c∣Ni(t,t′)=1,Ti∗&gt;t) and specificity: P(πi(t′∣t)≤c∣Ni(t,t′)=0,Ti∗&gt;t), respectively, where Ni(t,t′)=I(t&lt;Ti∗≤t′) indicating whether there is an observed event or not for subject i during the time interval (t, t′]. In the absence of censoring, sensitivity and specificity can be simply estimated from the empirical distribution of the predicted risk. To accommodate censoring time, Li et al.36 proposed a kernel weighting method to estimate the time-dependent ROC curve nonparametrically and a closed-form formula to calculate ROC. Consistent estimation of the time-dependent sensitivity and specificity can be achieved by weighting the patients by their conditional probabilities of disease onset prior to the time horizon, given the data. This method produces unbiased and efficient estimators and is less sensitive to the selection of kernel bandwidth as compared with Heagerty et al.37.

Moreover, we also assess our model’s performance in calibration, i.e., the agreement between the predicted and true risks. We use the dynamic expected Brier score (BS) for joint models which is an extension from the BS developed in the survival model38,39. The dynamic expected BS is defined as E[(D(t′|t)−π(t′|t))2], where the observed failure status D(t′|t) equals to 1 if the subject experiences the terminal event within the time interval (t, t′] and 0 if the subject is event free until t′. An estimator of BS is

BS^(t∣t′)=1Nt∑i=1NtG^i(t∣t′)(Di(t∣t′)-πi(t′∣t))2,

where Nt is the number of subjects at risk at time t, and the weight G^i(t∣t′)=I(ti&gt;t′)S^0(t′)/S^0(t)+I(t&lt;ti≤t′)δiS^0(ti)/S^0(t) is to account for censoring with Ŝ0 denoting the Kaplan-Meier estimate39. In general, BS = 0 indicates perfect prediction and BS = 0.25 means no better than a random guess.

3.4 Implementation using software

An advantage of the proposed Bayesian FJM is that its implementation and extension can be done via available softwares and the sample Stan code. The first step is to conduct FPCA for functional predictors and estimate the FPC eigenfunctions and scores, by using either fpca.sc function in the refund packages40 in R or fpca.mle and fpca.score functions in the FPCA package41 in R. In the second step, the cubic B-spline basis functions can be evaluated over the discretized domain S using the bs function in the package spline in R. In the third step, the FPC scores obtained from FPCA are used as scalar covariates in the joint model and the parameters can be estimated using the sample Stan code. For prediction, the samples of the random effect vector uN can be drawn from its posterior distribution using the arms function in the HI package in R. The future survival probability can then be calculated based on the samples. Finally, assessment of the predictive performance based on time-dependent ROC can be achieved using the tdROC package in R.

4 Application to the ADNI Study

We apply the proposed Bayesian FJM to the motivating ADNI-1 study. We include the following variables as scalar covariates: baseline age (bAge, mean: 74.4, SD: 7.3, range 55.1–89.3), gender (gender, 36.1% female), years of education (Edu, mean: 15.6, SD: 3.0, range 4–20), and presence of at least one apolipoprotein E allele (APOE–ε4, 56%), given their potential effects on AD progression25,26,42. To utilize the brain imaging information, we include baseline hippocampal volume (bHV ) as a scalar covariate and the baseline hippocampal surface based on hippocampal radial distance (HRD) as a functional predictor. We follow the procedure in Section 2 to convert the 3D HRD to a 1D domain denoted by S. In an exploratory analysis of the ADNI data, we plot the lowess curve of the longitudinal outcome ADAS-Cog 11 against each scalar covariate and there is no strong nonlinearity in these curves. Hence, we include linear terms of these covariates, and avoid using splines to have easy interpretation and less computational burden.

The first model we consider is the regular joint model (refer to as model JM), which incorporates variable bHV in both longitudinal and survival submodels. Additionally, we consider three FJMs, i.e., model FJM1 that includes HRD only in the longitudinal submodel, model FJM2 that includes HRD only in the survival submodel, and model FJM3 that includes HRD in both submodels as

ADAS-Cogi(tij)=mi(tij)+εijmi(tij)=β0+β1tij+β2bAgei+β3bHVi+∫SHRDi(s)B(x)(s)ds+ui1hi(t)=h0(t)exp{γ1genderi+γ2bAgei+γ3Edui+γ4APOE-ε4+γ5bHVi+∫SHRDi(s)B(w)(s)ds+αmi(t)}.

We perform functional principal component analysis (FPCA) on HRD and select the first 20 FPCs, along with their FPC scores. We expand the coefficient functions B(x)(s) and B(w)(s) using the same cubic B-spline basis functions ψ(s)(x) = ψ(s)(w) with KB = 20. Baseline hazard function h0(t) is approximated by a piecewise constant function. Specifically, the observed survival time is divided into M = 7 intervals by every 1/Mth quantiles. We have also explored other selections of M and obtained very similar results.

We compare the four candidate models by assessing their predictive performance, manifested by the time-dependent AUCs, at different time points over the follow-up period. To avoid overestimation of the prediction, we conduct a 10-fold cross validation. Specifically, the total sample of patients is randomly splitted into 10 subgroups of about equal size. The analysis is repeated 10 times with one subset being set aside as the validation dataset and the remaining 9 subsets being used as the training dataset. Parameters of the joint model are estimated from the training dataset and applied to the validation dataset. The conditional event-free probability corresponding to the time frame (t, t+Δt] are predicted for each patient in the validation datasets as describe in Section 3.3. Because the ADNI patients were reassessed approximately every half year, we select t at 1, 1.5, and 2 years, and Δt as 0.5 and 1 years for analysis. Then the time-dependent AUCs and Brier scores are calculated based on the predicted probabilities of all patients.

Table 1 displays the time-dependent AUCs and dynamic expected Brier scores from the four candidate models. Model FJM2 and FJM3 have notably larger AUCs and smaller BS than models JM and FJM1 for most of combinations of t and Δt. This suggests that including functional predictor HRD in the survival submodel, in addition to scalar predictor hippocampal volume, improves the capability of the joint model in predicting risk of AD diagnosis. We also notice that FJM3 has a smaller DIC than FJM2 (12063 compares to 12097), which indicates that HRD is an important functional predictor for the cognitive functions manifested by variable ADAS-Cog 11 among the MIC patients. These results suggest that including HRD in the longitudinal submodel may further improve the overall predictive ability of the FJM model. Hence, we select FJM3 as the final model because it has a competitive good discrimination capability and a smaller DIC value.

Parameter estimates from model FJM3 using whole dataset are presented in Table 2, while the estimated vector of coefficients B̂(x) and B̂(w) (for a vector of 20 FPC scores ξi(x) as in models (3) and (4)) are presented in Web Tables 1 and 2. In the longitudinal submodel, the ADAS-Cog 11 score increases (deteriorates) as time progresses, i.e., an average increase of 0.428 unit (95% CI: [0.338–0.521]) per year for MCI patients. Larger hippocampal volume at baseline (bHV ) is associated with lower (better) ADAS-Cog 11 scores. In the survival submodel, the presence of APOE-ε4 allele(s) increases the hazard of AD diagnosis by 70% (exp(0.533) – 1, 95% CI: [26%–107%]), which is consistent with the literature43. Older age at baseline is associated with lower risk of AD diagnosis. The hippocampal volume (bHV ) is no longer significant after including the functional predictor HRD in the survival submodel. Furthermore, larger ADAS-Cog 11 score increases the risk of AD diagnosis, i.e., one unit increase in ADAS-Cog 11 score increases the hazard of AD diagnosis by 14.3% (exp(0.134) – 1, 95% CI: [8%–19%]).

The coefficient function of B(x)(s) for HRD in the longitudinal submodel is estimated via B^(x)(s)=∑l=120B^l(x)ψl(x)(s), and B(w)(s) in the survival submodel can be estimated in the same way. For visualization purpose, we map B̂(x)(s) and B̂(w)(s) back to the corresponding vertex on the hippocampal surfaces (Figure 2). Due to the difficulty of displaying a 3D object on paper, Figure 2 only displays two views (from top and bottom) of left and right hippocampal surfaces. Panel (a) displays a schematic representation of the hippocampal subfields, defined by Apostolova et al.44, on the hippocampal surface template. Panel (b) displays the coefficient function B̂(x)(s) of the functional predictor HRD in the longitudinal submodel. Blue colors denote negative values of B̂(x)(s) in the regions. It suggests that the decrease of HRD (i.e., hippocampal atrophy) in the blue regions is associated with increasing ADAS-Cog 11 score and deteriorating cognitive functions. Panel (c) displays the coefficient function B̂(w)(s) of HRD in the survival submodel. The negative values of B̂(w)(s) in the blue region indicate that the thinner of the area, the higher of the risk of progressing from MCI to AD. Most blue regions in Panels (b) and (c) are located in the CA1 subfield and subiculum (Sub) subfield displayed in Panel (a), suggesting that regional radial atrophy in these subfields may be a good predictor of AD progression among MCI patients.

To illustrate the personalized dynamic predictions, we select two target patients as validation data, and predict their future health outcome and event-free probability based on FJM3 estimates using the remaining data as training set. Patient A has a baseline age of 73, no APOE-ε, as compared with a more severe Patient B, 69 years old at baseline, and with APOE-ε. Figure 3 demonstrates how the predicted ADAS-Cog 11 scores are updated over time for the two patients. From left to right on Figure 3, by using more follow-up data, predictions are closer to the true observed values and the 95% uncertainty band is narrower. It also suggests that Patient A (upper panels) has lower and more stable predicted ADAS-Cog 11 scores (better cognitive function) than patient B (lower panels). Figure 4 displays the predicted probability of being free of AD diagnosis. For Patient A, the event-free probability curve does not show large change because Patient A’s predicted ADAS-Cog 11 scores are relatively low. In comparison, Patient B has higher predicted ADAS-Cog 11 scores and worse cognitive function, and thus has considerably drop in the event-free probability. This suggests that Patient B has a higher risk of AD diagnosis and should be monitored frequently.

5 Simulation Study

In this section, we conduct a simulation study to evaluate the proposed Bayesian FJM models, and investigate the predictive and calibration performance of the survival probability using the FJM models. We generate 200 datasets with sample size I = 700 subjects and each subject has Ji=5 measurements at time 0, 3, 6, 9, and 12. The simulated data structure is similar to the motivating ADNI study, and we include one functional predictor in both longitudinal and survival submodels. The longitudinal submodel is

yi(tij)=mi(tij)+εij,mi(tij)=β0+β1tij+∫Sgi(x)(s)B(x)(s)ds+ui,s∈[0,1]=S,

where j = 1, . . ., Ji, εij~N(0,σε2=1), and ui~N(0,σu2=2). The time-invariant functional predictor is defined on a 1D domain S = [0, 1] as gi(x)(s)=di1+di2s+∑k=110{νis1·sin(2πks)+νis2·cos(2πks)}, where di1 ~ U(0, 5), di2 ~ N(1, 0.2), and νis1, νis2 ~ N(0, 1/k2). It is observed on a discrete grid at location s = c/100, where c = 0, . . ., 100. The observed functional predictor gi(x′)(s)=gi(x)(s)+εi(s), where the measurement errors εi(s) ~ N(0, 0.1) across s. The coefficient β0 = 1.35, β1 = 7.0, and coefficient function B(x)(s) = −1.5 − sin(2πs) − cos(2πs). The survival submodel is

hi(t)=h0(t)exp{γ1w1+∫Sgi(w)(s)B(w)(s)ds+αmi(t)},s∈[0,1]=S,

where the baseline hazard function h0(t) = exp(−10), w1 is simulated from Bernoulli distribution with probability being 0.5, and γ1 = −2.5. We have functional predictor gi(w)(s)=gi(x)(s) and the observed functional predictor gi(w′)(s) is generated in a similar fashion as gi(x′)(s). The coefficient function B(w)(s)=12.5Φ(s-0.60.22), where Φ(·) is the standard Normal density function. Censoring time is independently simulated from a uniform distribution to achieve a censoring rate about 30%. Due to censoring, each subject has an average of four repeated measurements. We perform FPCA to the simulated functional predictors gi(x′)(s) and gi(w′)(s), and choose the first 10 functional principal components. The coefficient functions B(x)(s) and B(w)(s) are expanded by cubic B-spline basis with KB = 10.

For each of the 200 simulated datasets (denoted by subscript r), we randomly select 500 subjects as the training dataset and set aside the remaining 200 subjects as the validation dataset for prediction. The ability to estimate the true coefficient is assessed by the average mean squared error (AMSE). For the coefficient functions β̂(·), AMSE(B^(.))=1200∑r=1200[B^r(s)-B(s)]2, and for the other parameters, AMSE(β^1)=1200∑r=1200(β^1r-β1)2. Table 3 presents the AMSE, in addition to bias (the average of the posterior means minus the true values), standard error (SE, the square root of the average of the variance), standard deviation (SD, the standard deviation of the posterior mean), and coverage probabilities (CP) of 95% credible intervals. Table 3 suggests that the proposed Bayesian FJM performs reasonable well with relatively small AMSE values for both coefficient functions and other parameters, SE being close to SD, and the credible interval coverage probabilities being reasonably close to 95%.

Figure 5 displays the true coefficient functions B(x)(s) and B(w)(s) (red solid lines) and their estimated curves (black solid lines), along with the 95% pointwise credible interval (dashed lines). Both panels suggest that the estimated coefficient functions are reasonably close to the true coefficient functions, with 95% pointwise credible interval always covering the true functions.

For each testing dataset, we predict subject-specific conditional survival probability π̂k(t′|t) for each subject at different time points t and t′ = t + Δt using the MCMC samples from the fitted model and available measurements up to time t. The predicted time-dependent AUCs are calculated based on the predicted probabilities of all subjects. The true conditional survival probability πN(t′|t) and AUCs are computed using the prespecified parameter values and the generated random effects. We use the dynamic expected Brier score BS^(t′∣t) to assess the bias between the predicted and true risks. Table 4 presents the time-dependent AUCs and BS by averaging the results from 200 simulated datasets. The predict AUCs are only slightly smaller than the true AUCs, suggesting good prediction performance of the FJM in terms of validation. The small values in BS indicate the excellent calibration performance of the FJM.

6 Discussion

The methodology introduced in this paper is motivated by many current studies where functional data are collected. The Alzheimer’s Disease Neuroimaging Initiative (ADNI) is just one example of such studies. However, both theoretical and computational complexity in modeling functional data restrict researchers to focused on scalar measures, e.g., volumes of a few brain regions. Without careful analysis of the functional data, pace to understand diseases and population’s health condition can be dramatically slowed down. Moreover, some high dimensional data, such as genetic variant profiles defined along chromosomes or genomic regions, are commonly treated as functional data. To this end, functional data analysis methods are becoming increasingly important.

In this article, we first propose a Bayesian functional joint model (FJM) to account for functional predictors in both longitudinal and survival submodels within the framework of joint modeling. We use the functional principal component analysis (FPCA) to approximate the functional predictor, and expand its corresponding coefficient function using penalized B-spline approach. We then develop the process of making personalized dynamic prediction of future outcome trajectories and risks of event using both scalar and functional predictors. Simulation indicate that the proposed Bayesian FJM yields accurate inference and prediction. Being applied to the motivating ADNI study, the FJM can efficiently estimate the association between the trajectory of cognitive functions measured by the ADAS-Cog 11 score and time to AD diagnosis, while accounting for the functional predictor (hippocampal radial distance, HRD) and other scalar covariates. We have identified the regional radial atrophy in the CA1 subfield and the subiculum subfield as a good predictor of AD progression among patients with mild cognitive impairment. More importantly, the proposed Bayesian FJM can utilize the functional predictors to make correct predictions for new subjects. The inclusion of functional predictor HRD into both the longitudinal and survival submodels improves overall model fitting and predictive performance. When new measurements are available, the predictions can be updated with improved accuracy and efficiency. Thus, earlier diagnosis can be made to subjects with high predicted risk of deterioration, and intervention can be planned in a timely manner to delaying the manifestation of AD in prodromal AD patients. In addition, although we only use HRD in ADNI data analysis, the proposed Bayesian FJM can readily include multiple brain regions, and even genotype profiles, as functional predictors to provide even precise prediction of Alzheimer’s disease progression.

There are some limitations we will address in the future. First, we exclude from analysis the subjects (45 out of 400) with missing data in baseline covariates of interest. Most of these subjects either do not have baseline image data measured or do not have image data in the archive due to the technical difficulty in image data collection and storage. Although the well-established imputation methods, e.g., multiple imputation, can be used for missing data in scalar predictors, it is challenging in both statistical theory and computation to handle missing functional data. We will extend our Bayesian FJM to account for missing data in both scalar and functional covariates in the future. Second, we use time-invariant functional data as predictor in this article. It would be of scientific interest to extend the proposed Bayesian FJM to accommodate longitudinal functional data. We can decompose the longitudinal functional predictor using longitudinal FPCA (LFPCA)45 to account for its longitudinal data structure. Alternatively, we can treat the longitudinal functional data as a functional response variable in the longitudinal submodel (function-on-scalar regression problem) and it can be incorporated in the survival submodel as a time-dependent functional predictor. This model can investigate how the longitudinal functional variable directly impacts the risk for an event.

Moreover, in model (2), we implicitly assume that the risk for an event at time t depends on the unobserved true value of the longitudinal outcome at the same time point. We can investigate different functional forms for the association structure between the longitudinal outcome and the risk for an event46,47. For example, both the unobserved true value of mi(tij) in model (1) and its time-dependent slope mi′(tij) or even its cumulative effect ∫0tmi(s)ds can be included in model (2). The proposed Bayesian FJM can readily accommodate various functional forms with minor modification to the sample codes. Furthermore, the Bayesian procedure we develop is shown to have good inferential properties in simulation studies. As sample size and the number of parameters associated with B-spline grow, computation time may increase dramatically. To this end, paralleling MCMC48 and variational approximations49 may address the computational concerns and result in good estimations of model components. We would like to investigate these issues in our future research.

Supplementary Material

Web Supplement

Sheng Luo’s research was supported by the National Institute of Neurological Disorders and Stroke under Award Number R01NS091307 and 5U01NS043127. The authors acknowledge the Texas Advanced Computing Center (TACC) for providing high-performing computing resources. Data used in preparation of this article were obtained from the Alzheimer’s Disease Neuroimaging Initiative (ADNI) database (adni.loni.ucla.edu). As such, the investigators within the ADNI contributed to the design and implementation of ADNI and/or provided data but did not participate in analysis or writing of this article. A complete listing of ADNI investigators can be found at: http://adni.loni.ucla.edu/wp-content/uploads/how_to_apply/ADNI_Acknowledgement_List.pdf.

Figure 1 Smoothing curves of variable ADAS-Cog 11 over time for MCI patients with follow-up time less than 3 years (203 patients, solid line), 3–6 years (82 patients, dotted line), and more than 6 years (70 patients, dashed line). The shaded regions are 95% pointwise confidence intervals.

Figure 2 Panel (a): Hippocampal subfields mapped onto the hippocampal surfaces; Panel (b) the estimated coefficient function B̂(x)(s) from the longitudinal submodel and Panel (c) the estimated coefficient function B̂(w)(s) from the survival submodel, mapped onto the hippocampal surfaces .

Figure 3 Predicted ADAS-Cog 11 for Patient A (upper panels) and Patient B (lower panels). Solid line is predicted longitudinal trajectories. Dashed lines construct a 95% pointwise uncertainty band. The dotted vertical line represents the time of prediction t.

Figure 4 Predicted event-free probability with 95% pointwise uncertainty band for Patient A (upper panels) and Patient B (lower panels). The dotted vertical line represents the time of prediction t.

Figure 5 The FJM’s estimates of coefficient functions in simulation study. The true coefficient functions (red solid line) B(x)(s) (left panel) and B(w)(s) (right panel) and their estimates (black solid line), along with 95% pointwise pointwise credible interval (dashed lines) and converge probability (red dotted line) with a reference line (horizontal line) at 0.95.

Table 1 Areas under the ROC curve (AUC) and Brier score (BS) by four candidate models in the ADNI study.

Δt	t	JM	FJM1	FJM2	FJM3	
	
AUC	BS	AUC	BS	AUC	BS	AUC	BS	
0.5	1	0.818	0.086	0.818	0.086	0.815	0.084	0.814	0.084	
1.5	0.728	0.118	0.729	0.118	0.755	0.112	0.778	0.109	
2	0.825	0.103	0.831	0.102	0.877	0.087	0.875	0.086	
	
1	1	0.784	0.150	0.785	0.150	0.793	0.145	0.808	0.142	
1.5	0.757	0.171	0.762	0.170	0.812	0.150	0.823	0.146	
2	0.741	0.142	0.746	0.139	0.789	0.129	0.792	0.128	

Table 2 ADNI data analysis results from model FJM3.

	Parameters	Mean	SE	2.5%	97.5%	
For longitudinal outcome						
ADAS-Cog 11	Time (Years)	0.428	0.045	0.338	0.521	
	bAge	−0.364	0.260	−0.885	0.156	
	bHV (mm3)	−1.617	0.295	−2.201	−1.051	
	
For survival process						
MCI to AD	Female	−0.088	0.173	−0.397	0.270	
	bAge	−0.283	0.042	−0.423	−0.109	
	Edu (years)	0.028	0.016	−0.002	0.062	
	APOE-ε	0.533	0.125	0.239	0.728	
	bHV (mm3)	0.056	0.114	−0.185	0.276	
	α	0.134	0.022	0.079	0.177	

Table 3 Parameter estimation in the simulation study.

	Bias	AMSE	SE	SD	CP	
For longitudinal data	
β1 = 7.00	&lt;0.001	&lt;0.001	0.006	0.007	0.920	
B(x)(s)		0.014				
σε2=1	0.006	0.002	0.038	0.040	0.925	
σu2=2	&lt;0.001	0.023	0.144	0.152	0.940	
For survival data	
γ1 = −2.5	−0.059	0.042	0.198	0.197	0.955	
α = 1.2	0.021	0.005	0.068	0.069	0.930	
B(w)(s)		0.003				

Table 4 Areas under the ROC curve (AUC) and calibration assessment (mean square error of the predicted conditional survival probability) for the simulation study.

Δt	t	True AUCtΔt	Predicted AUCtΔt	BS^(t′∣t)	
3	3	0.856	0.853	0.015	
	6	0.948	0.941	0.024	
	9	0.960	0.957	0.035	
6	3	0.935	0.929	0.033	
	6	0.959	0.957	0.044	
	9	0.970	0.959	0.047	


1 Faucett CL Thomas DC Simultaneously modelling censored survival data and repeatedly measured covariates: a Gibbs sampling approach Statistics in Medicine 1996 15 15 1663 1685 8858789
2 Wulfsohn MS Tsiatis AA A joint model for survival and longitudinal data measured with error Biometrics 1997 53 1 330 339 9147598
3 Rizopoulos D Dynamic predictions and prospective accuracy in joint models for longitudinal and time-to-event data Biometrics 2011 67 3 819 829 21306352
4 Taylor JM Park Y Ankerst DP Proust-Lima C Williams S Kestin L Real-time individual predictions of prostate cancer recurrence using joint models Biometrics 2013 69 1 206 213 23379600
5 Ramsay JO Dalzell CJ Some tools for functional data analysis Journal of the Royal Statistical Society Series B (Methodological) 1991 53 3 539 572
6 Wang JL Chiou JM Mller HG Functional data analysis Annual Review of Statistics and Its Application 2016 3 1 257 295
7 Morris JS Functional regression Annual Review of Statistics and Its Application 2015 2 1 321 359
8 Cardot H Ferraty F Sarda P Spline estimators for the functional linear model Statistica Sinica 2003 13 3 571 591
9 James GM Generalized linear models with functional predictors Journal of the Royal Statistical Society: Series B (Statistical Methodology) 2002 64 3 411 432
10 Müller HG Stadtmüller U Generalized functional linear models The Annals of Statistics 2005 33 2 774 805
11 Reiss PT Ogden RT Functional principal component regression and functional partial least squares Journal of the American Statistical Association 2007 102 479 984 996
12 James GM Wang J Zhu J Functional linear regression that’s interpretable The Annals of Statistics 2009 37 5A 2083 2108
13 Goldsmith J Bobb J Crainiceanu CM Caffo B Reich D Penalized functional regression Journal of Computational and Graphical Statistics 2012 20 4 830 851
14 Goldsmith J Crainiceanu CM Caffo B Reich D Longitudinal penalized functional regression for cognitive outcomes on neuronal tract measurements Journal of the Royal Statistical Society: Series C (Applied Statistics) 2012 61 3 453 469
15 Gertheiss J Goldsmith J Crainiceanu C Greven S Longitudinal scalar-on-functions regression with application to tractography data Biostatistics 2013 14 3 447 461 23292804
16 Gellar JE Colantuoni E Needham DM Crainiceanu CM Cox regression models with functional covariates for survival data Statistical Modelling 2015 15 3 256 278 26441487
17 Lee E Zhu H Kong D Wang Y Giovanello KS Ibrahim JG BFLCRM: A Bayesian functional linear Cox regression model for predicting time to conversion to Alzheimer’s disease The Annals of Applied Statistics 2015 9 4 2153 2178 26900412
18 Weiner MW Veitch DP Aisen PS Beckett LA Cairns NJ Cedarbaum J 2014 Update of the Alzheimer’s Disease Neuroimaging Initiative: A review of papers published since its inception Alzheimer’s &amp; Dementia 2015 11 6 e1 e120
19 Li K Chan W Doody RS Quinn J Luo S Prediction of Conversion to Alzheimers Disease with Longitudinal Measures and Time-To-Event Data Journal of Alzheimer’s Disease 2017 58 2 361 371
20 Cleveland WS Robust locally weighted regression and smoothing scatterplots Journal of the American Statistical Association 1979 74 368 829 836
21 Diggle P Kenward MG Informative drop-out in longitudinal data analysis Journal of the Royal Statistical Society Series C (Applied Statistics) 1994 43 1 49 93
22 Lo RY Hubbard AE Shaw LM Trojanowski JQ Petersen RC Aisen PS Longitudinal change of biomarkers in cognitive decline Archives of Neurology 2011 68 10 1257 1266 21670386
23 Zhang D Shen D Initiative ADN Predicting future clinical changes of MCI patients using longitudinal and multimodal biomarkers PLOS ONE 2012 7 3 e33182 22457741
24 Du AT Magnetic resonance imaging of the entorhinal cortex and hippocampus in mild cognitive impairment and Alzheimer’s disease Journal of Neurology, Neurosurgery &amp; Psychiatry 2001 71 4 441 447
25 Cui Y Liu B Luo S Zhen X Fan M Liu T Identification of conversion from mild cognitive impairment to Alzheimer’s disease using multivariate predictors PLOS ONE 2011 6 7 e21896 21814561
26 Li S Okonkwo O Albert M Wang MC Variation in variables that predict progression from MCI to AD dementia over duration of follow-up American Journal of Alzheimer’s Disease 2013 2 1 12 28
27 Apostolova LG Mosconi L Thompson PM Green AE Hwang KS Ramirez A Subregional hippocampal atrophy predicts Alzheimer’s dementia in the cognitively normal Neurobiology of Aging 2010 31 7 1077 1088 18814937
28 Qiu A Fennema-Notestine C Dale AM Miller MI Initiative ADN Regional shape abnormalities in mild cognitive impairment and Alzheimer’s disease NeuroImage 2009 45 3 656 661 19280688
29 Ruppert D Selecting the number of knots for penalized splines Journal of Computational and Graphical Statistics 2002 11 4 735 757
30 Staniswalis JG Lee JJ Nonparametric regression analysis of longitudinal data Journal of the American Statistical Association 1998 93 444 1403 1418
31 Yao F Müller HG Clifford AJ Dueker SR Follett J Lin Y Shrinkage estimation for functional principal component scores with application to the population kinetics of plasma folate Biometrics 2003 59 3 676 685 14601769
32 Stefan Lang AB Bayesian P-splines Journal of Computational and Graphical Statistics 2004 13 1 183 212
33 Hoffman MD Gelman A The No-U-turn sampler: adaptively setting path lengths in Hamiltonian Monte Carlo Journal of Machine Learning Research 2014 15 1 1593 1623
34 Gelman A Carlin JB Stern HS Rubin DB Bayesian Data Analysis CRC Press 2013
35 Gilks WR Best NG Tan KKC Adaptive rejection Metropolis sampling within Gibbs sampling Journal of the Royal Statistical Society Series C (Applied Statistics) 1995 44 4 455 472
36 Li L Greene T Hu B A simple method to estimate the time-dependent receiver operating characteristic curve and the area under the curve with right censored data Statistical Methods in Medical Research 2016 10.1177/0962280216680239
37 Heagerty PJ Lumley T Pepe MS Time-dependent ROC curves for censored survival data and a diagnostic marker Biometrics 2000 56 2 337 344 10877287
38 Blanche P Proust-Lima C Loubre L Berr C Dartigues JF Jacqmin-Gadda H Quantifying and comparing dynamic predictive accuracy of joint models for longitudinal marker and time-to-event in presence of censoring and competing risks Biometrics 2015 3 71 1 102 113 25311240
39 Sne M Taylor JMG Dignam JJ Jacqmin-Gadda H Proust-Lima C Individualized dynamic prediction of prostate cancer recurrence with and without the initiation of a second treatment: development and validation Statistical methods in medical research 2016 12 25 6 2972 2991 24847900
40 Crainiceanu CM Reiss PT Goldsmith J Huang L Huo L Scheipl F refund: Regression with functional data 2013
41 Peng J Paul D A Geometric approach to maximum likelihood estimation of the functional principal components from sparse longitudinal data Journal of Computational and Graphical Statistics 2009 18 4 995 1015
42 Risacher SL Saykin AJ Wes JD Shen L Firpi HA McDonald BC Baseline MRI predictors of conversion from MCI to probable AD in the ADNI cohort Current Alzheimer Research 2009 6 4 347 361 19689234
43 Corder E Saunders A Strittmatter W Schmechel D Gaskell P Small G Gene dose of apolipoprotein E type 4 allele and the risk of Alzheimer’s disease in late onset families Science 1993 261 5123 921 923 8346443
44 Apostolova LG Dutton RA Dinov ID Hayashi KM Toga AW Cummings JL Conversion of mild cognitive impairment to Alzheimer disease predicted by hippocampal atrophy maps Archives of Neurology 2006 63 5 693 699 16682538
45 Greven S Crainiceanu C Caffo B Reich D Longitudinal functional principal component analysis Electronic Journal of Statistics 2010 4 1022 1054 21743825
46 Rizopoulos D Hatfield LA Carlin BP Takkenberg JJ Combining dynamic predictions from joint models for longitudinal and time-to-event data using Bayesian model averaging Journal of the American Statistical Association 2014 109 508 1385 1397
47 Yang L Yu M Gao S Prediction of coronary artery disease risk based on multiple longitudinal biomarkers Statistics in Medicine 2016 35 8 1299 1314 26439685
48 Wang X Guo F Heller KA Dunson DB Parallelizing MCMC with random partition trees Cortes C Lawrence ND Lee DD Sugiyama M Garnett R Advances in Neural Information Processing Systems 28 Curran Associates, Inc 2015 451 459
49 Ormerod JT Wand MP Explaining variational approximations The American Statistician 2010 64 2 140 153
