LICENSE: This file is available for text mining. It may also be used consistent with the principles of fair use under the copyright law.


9713490
21159
Med Image Anal
Med Image Anal
Medical image analysis
1361-8415
1361-8423

27639215
5099092
10.1016/j.media.2016.09.001
NIHMS816875
Article
Conformal Invariants for Multiply Connected Surfaces: Application to Landmark Curve-Based Brain Morphometry Analysis
Shi Jie a
Zhang Wen a
Tang Miao a
Caselli Richard J. b
Wang Yalin a*
for the Alzheimer’s Disease Neuroimaging Initiative
a School of Computing, Informatics, and Decision Systems Engineering, Arizona State University, Tempe, AZ, USA
b Department of Neurology, Mayo Clinic Arizona, Scottsdale, AZ, USA
Please address correspondence to: Dr. Yalin Wang, School of Computing, Informatics, and Decision Systems Engineering, Arizona State University, P.O. Box 878809, Tempe, AZ 85287 USA, Phone: (480) 965-6871, Fax: (480) 965-2751, ylwang@asu.edu
Data used in preparation of this article were obtained from the Alzheimer’s Disease Neuroimaging Initiative (ADNI) database (adni.loni.usc.edu). As such, the investigators within the ADNI contributed to the design and implementation of ADNI and/or provided data but did not participate in analysis or writing of this report. A complete listing of ADNI investigators can be found at: http://adni.loni.usc.edu/wp-content/uploads/how_to_apply/ADNI_Acknowledgement_List.pdf

16 9 2016
6 9 2016
1 2017
01 1 2018
35 517529
This file is available for text mining. It may also be used consistent with the principles of fair use under the copyright law.
Landmark curves were widely adopted in neuroimaging research for surface correspondence computation and quantified morphometry analysis. However, most of the landmark based morphometry studies only focused on landmark curve shape difference. Here we propose to compute a set of conformal invariant-based shape indices, which are associated with the landmark curve induced boundary lengths in the hyperbolic parameter domain. Such shape indices may be used to identify which surfaces are conformally equivalent and further quantitatively measure surface deformation. With the surface Ricci flow method, we can conformally map a multiply connected surface to the Poincaré disk. Our algorithm provides a stable method to compute the shape index values in the 2D (Poincaré Disk) parameter domain. The proposed shape indices are succinct, intrinsic and informative. Experimental results with synthetic data and 3D MRI data demonstrate that our method is invariant under isometric transformations and able to detect brain surface abnormalities. We also applied the new shape indices to analyze brain morphometry abnormalities associated with Alzheimer’s disease (AD). We studied the baseline MRI scans of a set of healthy control and AD patients from the Alzheimer’s Disease Neuroimaging Initiative (ADNI: 30 healthy control subjects vs. 30 AD patients). Although the lengths of the landmarks in Euclidean space, cortical surface area, and volume features did not differ between the two groups, our conformal invariant based shape indices revealed significant differences by Hotelling’s T2 test. The novel conformal invariant shape indices may offer a new sensitive biomarker and enrich our brain imaging analysis toolset for studying diagnosis and prognosis of AD.

Graphical Abstract

Conformal invariant
Teichmüller shape space
brain landmark curves
Alzheimer’s disease

1. Introduction

Shape analysis is a key research topic in anatomical modeling and involves statistical comparisons of anatomy and medical image registration. In the computational analysis of brain anatomy, volumetric or surface feature measures of structures identified on 3D MRI have been used to study group differences in brain structure and also to predict diagnosis (Botino et al., 2002; Li et al., 2014). In research studies that analyze brain morphometry, many shape analysis methods have been proposed, such as spherical harmonic analysis (SPHARM) (Gerig et al., 2001; Chung et al., 2008), medial representations (M-reps) (Pizer et al., 1999), point distribution models (PDM) (Cootes et al., 1995; Shen et al., 2004), minimum description length approaches (Davies et al., 2003), spectral methods (Shi et al., 2010; Seo and Chung, 2011; Wachinger et al., 2015) and cortical thickness and gyrification indices (Batchelor et al., 2002; Luders et al., 2006), etc. These methods may be applied to analyze shape changes or abnormalities in brain cortical and subcortical structures. Even so, a stable method to compute transformation-invariant shape descriptors would be highly advantageous to this research field.

Landmark based statistical shape analysis is a technique that has been adopted by a variety of fields, including anthropology, genetics, and evolutionary biology (e.g. Boyer et al., 2011) and now has been widely used for brain imaging research (e.g. Thompson et al., 2004; Van Essen, 2005; Glaunès et al., 2004). Although many prior approaches have tried to build cortical correspondence by aligning curvature, sulcal depth or other geometric maps (e.g. Fischl et al., 1999c; Argall et al., 2006; Lyttelton et al., 2007; Tosun and Prince, 2008; Yeo et al., 2010), there is increasing evidence that good relationships can be created between primary sulci and the boundaries of cytoarchitectonic fields in primary cortices (Fischl et al., 2008) and it suggests that a landmark-based method may provide better results for cortical surface shape analysis. Since the manual labeling of landmark curves is time-consuming and error-prone, a variety of cortical landmark identification algorithms have been developed to delineate landmark curves rather than rely upon manual landmark placement (e.g. Le Goualher et al., 1999; Lohmann and von Cramon, 2000; Cachia et al., 2003; Van Essen, 2005; Shattuck et al., 2009; Im et al., 2010; Zhong et al., 2010).

In addition to serving as common geometric constraints to help shape analysis of cortical surfaces, brain landmark curves are often directly analyzed to illustrate brain morphometry changes (e.g. Joshi et al., 2012; Chollet et al., 2014). For example, Mangin et al. (2003) has studied sulcal patterns by enforcing rotational as well as scale invariance. Some prior work (e.g. Tao et al., 2001; Vaillant and Davatzikos, 1997) studied and compared landmark curves via unit speed parameterizations of active contours for constructing Procrustes shape average for sulci. With the current-based diffeomorphic approach, Durrleman et al. (2007) focused on detecting variability in the sulcal patterns without pursuing explicit point correspondences. Fillard et al. (2007) proposed a statistical representation for sulcal curves and measured variability by extrapolating a covariance tensor field to the whole brain. Joshi et al. (2012) further developed a reparametrization invariant shape space of sulcal curves and built statistical models intrinsically on the shape space. However, most of the prior landmark curve analysis frameworks mainly focused on the landmark curves themselves. Missing at this time is an algorithm that studies the global brain morphometry changes through the landmark curve analysis. Here we propose a novel and intrinsic method to compute conformal invariants (shape indices) on multiply connected surfaces and apply it to study brain morphometry by analyzing statistics based on landmark curves. Our conformal invariants are based on the surface conformal structure and can be accurately computed using the surface hyperbolic Ricci flow method.

All oriented metric surfaces have conformal structures. If there exists a conformal map between two surfaces, then they are conformally equivalent. All surfaces can be classified by the conformal equivalence relation. Any two conformally equivalent surfaces have the same coordinates in the Teichmüller shape space (Luo, 1998) and the coordinates are invariant to conformal maps. We call them conformal invariants. By computing and studying conformal invariants and their statistical behavior, we may develop a promising approach for measuring local and global changes or identifying abnormalities in anatomical morphometry due to neurodegenerative diseases. We hypothesize that the heterogeneous changes caused by some neurodegenerative diseases, such as Alzheimer’s disease (AD), may dramatically alter surface conformal structure so that measuring the conformal invariant changes may offer a set of stable and accurate shape indices for brain morphometry that may enrich our understanding of AD effects and enhance our image analysis schemes. Furthermore, our system may be complementary to other brain shape analysis techniques and advance further the use of imaging biomarkers for preclinical AD research (Sperling et al., 2011; Caselli and Reiman, 2013).

In this work, we develop a conformal invariant-based brain morphometry system based on hyperbolic Ricci flow (Hamilton, 1988) and Teichmüller space coordinate theorem (Luo, 1998). Here we automatically trace six landmark curves on each cortical surface with the FreeSurfer (Fischl et al., 1999a) and Caret software (Van Essen et al., 2001) to represent major anatomical and functional features. After slicing a cortical surface along these landmarks, we convert it to a multiply connected surface. We then compute its hyperbolic uniformization metric with the hyperbolic Ricci flow method (Zeng et al., 2010; Shi et al., 2015) and isometrically embed it onto the 2D Poincaré disk. The lengths of the landmarks in the hyperbolic parameter space form the proposed shape indices, which are the Teichmüller space coordinates of the multiply connected cortical surface. We validate the proposed method on some synthetic and longitudinal brain image data. We further apply our system to study brain cortical structural differences associated with baseline T1-weighted brain images from the ADNI dataset, including 30 healthy control subjects and 30 AD patients. Here we set out to test whether our new system can compute reliable shape indices and whether the new shape indices are able to capture brain morphometry abnormalities.

2. Methods and Materials

2.1. Theoretical Background

In this section, we briefly introduce the most relevant theoretical background in conformal geometry, hyperbolic geometry, surface Ricci flow (Hamilton, 1988) and Teichmüller space theory (Gardiner and Lakic, 2000).

Conformal Deformation

Let S be a surface in ℝ3 with a Riemannian metric g (defined in Appendix .1). Suppose u : S → ℝ is a scalar function defined on S. It can be verified that ḡ = e2ug is also a Riemannian metric on S and angles measured by ḡ are equal to angles measured by g, which means the deformation of metrics from g to ḡ is angle-preserving. Then ḡ is called the conformal deformation of g and u is the conformal factor. Furthermore, when surface metric changes, surface Gaussian curvature K (defined in Appendix .2) will change accordingly to K̄ = e−2u(−Δgu + K), where Δg is the Laplace-Beltrami operator under the metric g.

Uniformization Theorem

Given a surface {S, g}, there exist an infinite number of metrics that are conformal to g. The uniformization theorem states that, among all the conformal metrics, there exists a unique representative, which induces constant Gaussian curvature everywhere on S. Furthermore, the constant will be one of {1, 0, −1}. The corresponding metric is called the uniformization metric of S. Therefore, using the uniformization metric, one can embed the universal covering space of any closed surface onto one of three canonical spaces: the unit sphere 𝕊2 for genus-zero surfaces that have positive Euler characteristics; the plane 𝔼2 for genus-one surfaces that have Euler characteristic zero; the hyperbolic space ℍ2 for high-genus surfaces that have negative Euler characteristics.

Fundamental Group and Universal Covering Space

Let S be a closed surface and q ∈ S is a base point. Two loops through q are homotopic if one of them can deform to the other without leaving S. The concatenation of two loops is called their product. All homotopy classes of loops form the fundamental group of S, denoted as π1(S, q). By slicing S along the fundamental group of loops, we obtain a simply connected domain of S, i.e., a genus-zero surface with a single boundary, denoted as S̃. For multiply connected surfaces, their fundamental groups consist of paths that connect existing boundaries. An example of the fundamental group on a multiply connected cortical surface is illustrated in Fig. 2 (d), where the fundamental group of paths are labeled as τi. The detailed computation process is introduced in Sec. 2.2.1. The projection ϕ : S̃ → S is a local homeomorphism, which maps paths on S̃ to their endpoints. The pair (S̃, ϕ) is called the universal covering space of S.

Surface Ricci Flow

The hyperbolic uniformization metric of a multiply connected surface can be computed by the hyperbolic Ricci flow (Zeng et al., 2010; Shi et al., 2015). Given a Riemannian manifold {S, g}, the normalized surface Ricci flow is defined as dg(t)dt=2(2πχ(S)A(0)−K(t))g(t), where A(0) is the total area of S at time 0 and K(t) is the Gaussian curvature induced by metric g(t). If χ(S) &lt; 0, the solution to the normalized Ricci flow equation exists for all t &gt; 0 and converges to a metric with constant Gaussian curvature 2πχ(S)A(0) (Hamilton, 1988). With conformal mapping, which requires g(t) = e2u(t)g(0), we obtain a simplified Ricci flow equation (1) du(t)dt=−2K(t)

The derivation of Eq. (1) can be found in (Wang et al., 2012).

Hyperbolic Geometry

Suppose S is a surface, given its hyperbolic uniformization metric and S̃, we can isometrically embed its universal covering space onto the hyperbolic space ℍ2. The hyperbolic space cannot be realized in ℝ3, thus we use the Poincaré disk model to visualize it. Figure 1 (a) is an illustration of the Poincaré disk model. The Poincaré disk is the unit disk |z| &lt; 1, z = x + iy in the complex plane ℂ with the metric ds2=4dzdz¯(1−zz¯)2. The rigid motion in the Poincaré disk is the Möbius transformation (2) z→eiθz−z01−z0¯z

With a conformal mapping computed by the surface Ricci flow, all open boundaries on S are mapped to geodesics in the Poincaré disk model. Geodesics in the Poincaré disk are hyperbolic lines, which are circular arcs that are perpendicular to the unit circle, as shown in Fig. 1 (b).

Teichmüller Space

Given two surfaces {S1, g1} and {S2, g2}, a map ϕ : S1 → S2 is conformal, if the pull back metric induced by ϕ is a conformal deformation of g1, i.e., ϕ*g2 = e2ug1. Two surfaces are conformally equivalent if there is a conformal map between them. Fixing the topology, all conformal equivalence classes of surfaces form a finite-dimensional Riemannian manifold, which is called the Teichmüller space (Gardiner and Lakic, 2000). Each point in the Teichmüller space represents a class of conformally equivalent shapes and a curve segment represents a deformation from one class to another. The Riemannian metric in Teichmüller space is well defined and it measures the angle distortion between shapes. The Teichmüller space coordinates of surfaces are invariant to conformal maps and if two surfaces have the same Teichmüller coordinates, they are conformally equivalent. Therefore, the Teichmüller coordinates can be used to index shapes (Wang et al., 2009a,b; Zeng et al., 2010).

Teichmüller Space Coordinates on Multiply Connected Surfaces

Genus-zero surfaces with more than two open boundaries are called multiply connected surfaces. Multiply connected surfaces have negative Euler characteristics and can be conformally mapped to the hyperbolic space ℍ2 with their hyperbolic uniformization metric. The lengths of the open boundaries on the multiply connected surfaces under the hyperbolic uniformization metric are the Teichmüller coordinates of the surfaces (Luo, 1998; Wang et al., 2009b). The obtained Teichmüller space coordinates, i.e. conformal invariants, are invariants with conformal structures, computationally simple and stable. We use them as the shape indices to characterize multiply connected surfaces.

2.2. Computational Algorithms

This section introduces the computational algorithms of the proposed shape indices in details. Specifically, we build an integrated and automated framework to compute the shape indices for cortical surfaces. Major steps are summarized in Alg. 1 and Fig. 2.

2.2.1. Cortical Surface Reconstruction and Brain Landmark Curve Tracing

Given a structural MR image, the image segmentation and cortical surface reconstruction are automatically performed with the FreeSurfer software package (Fischl et al., 1999b). A reconstructed left hemispherical surface is illustrated in Fig. 2 (b). Then, a set of ‘Core 6’ landmark curves, including the Central Sulcus (CeS), Anterior Half of the Superior Temporal Gyrus (aSTG), Sylvian Fissure (SF), Calcarine Sulcus (CaS), Medial Wall Ventral Segment, and Medial Wall Dorsal Segment, are automatically traced on each cortical surface using the Caret package (Van Essen et al., 2001). In Caret software, the PALS-B12 atlas is used to delineate the “core 6” landmarks, which are well-defined and geographically consistent, Algorithm 1 Surface Conformal Invariants Computation Pipeline.

	Input: A structural MR image.	
	Output: Shape indices, which is a set of conformal invariants of the cortical surfaces.	
1	The structural MRI (Fig. 2 (a)) is segmented and the cortical surfaces (Fig. 2 (b))
are reconstructed automatically using the FreeSurfer software (Fischl et al., 1999b).	
2	Six landmark curves are automatically traced on each cortical hemisphere surface
using the Caret software (Van Essen et al., 2001).	
3	With topology optimization, each cortical surface is converted to a multiply connect
surface. Open boundaries γ1, γ2, γ3 are shown in Fig. 2 (c).	
4	The fundamental group of each cortical surface is computed and the simply connected
domain is obtained by slicing each surface along the fundamental group of paths (Fig. 2 (d)).	
5	Compute the hyperbolic uniformization metric of the multiply connect surface and
embed it onto the Poincaré disk with the simply connect domain (Fig. 2 (e)).	
6	Compute the conformal invariants, i.e. shape indices, with the hyperbolic
uniformization metric.	

when compared with other gyral and sulcal features on human cortex. The stability and consistency of the six landmarks was validated in (Van Essen, 2005).

An illustration of the landmark curves on a left cortical surface is shown in Fig. 3 with two views. We show the landmarks with both the original and inflated cortical surfaces for clarity.

2.2.2. Topology Optimization

After we identify six landmark curves on a cortical surface, we further slice open the mesh along them. Basically, each vertex on the landmark curve split into two vertices with the same geometry position except the two ending vertices. The new vertices form two new boundaries that are connected by the two ending vertices so we get a closed boundary. Geometrically the surface is still closed but we create a topological hole. We call this process topology optimization. The key idea is that, with the topology optimization, we convert some significant surface curves into open boundaries and each cortical surface is converted to a multiply connected surface. As a result, we may apply practical algorithms which are suitable to deal with genus zero surfaces with open boundaries to specifically process these curves. In our prior work (Wang et al., 2012, 2013), by converting brain landmark curves into open boundary, we enforced landmark curve matching by boundary matching conditions for cortical surface registration research. Similarly, after the topology optimization, here we analyze the intrinsic conformal invariants of the obtained multiply connected surfaces for brain morphometry study.

As shown in Fig. 2 (c), we label the open boundary CeS as γ1, aSTG as γ2, SF as γ3, CaS as γ4, Medial Wall Ventral Segment as γ5, and Medial Wall Dorsal Segment as γ6, respectively. Then we compute the fundamental group of the cortical surface by tracing paths to connect the Medial Wall Dorsal Segment (γ5) to every other landmark curve boundary. Specifically, we choose 5 points on the Medial Wall Dorsal Segment and connect each point to the nearest endpoint of every other boundary. The paths are traced with Dijkstra’s algorithm with avoidance of collisions (Li et al., 2009). An example of the fundamental group on a cortical surface is shown in Fig. 2 (d), where the path connecting γ5 with γi is labeled as τi. After slicing a cortical surface along with its fundamental group of paths, we obtain its simply connected domain. In the following section, we explain in details how we compute the hyperbolic uniformization metric with the multiply connected surface and embed it onto the Poincaré disk with the simply connected domain.

2.2.3. Discrete Hyperbolic Ricci Flow

In practice, smooth surfaces are often approximated by simplicial complexes (triangular meshes). We denote a triangular mesh as Σ, the vertex set as V, the edge set as E, and the face set as F. We use υi to represent a vertex, eij to represent the edge connecting vertices υi and υj, fijk to represent the face formed by vertices υi, υj, and υk, and θijk to represent the corner angle located at vertex υi in face fijk.

The discrete Riemannian metric defined on Σ is a function defined on each edge l : E → ℝ+, such that in each face fijk, the triangle inequality holds ljk + lki &gt; lij. Usually, it is the edge length. In hyperbolic geometry, we regard each triangle as a hyperbolic triangle, as shown in Fig. 4 (a). The corner angles in each face are computed with the hyperbolic cosine law (3) θi=cos−1coshlijcoshlki−coshljk2sinhlijsinhlki

The discrete Gaussian curvature Ki on vertex υi ∈ Σ can be computed using the angle deficit (4) Ki={2π−∑fijk∈Fθijk,υi∉∂Σπ−∑fijk∈Fθijk,υi∈∂Σ

where ∂Σ represents the boundary of the mesh.

The concept of the circle packing metric was introduced by Thurston in (Thurston, 1976) for approximating conformal metric deformation. Conformal metric deformations, in the smooth case, preserve infinitesimal circles and the intersection angles among them. The discrete conformal deformation of metrics uses circles with finite radii to approximate infinitesimal circles. Let r be a function defined on the vertices, r : V → ℝ+, which assigns a radius ri to the vertex υi. Similarly, let Φ be a function defined on the edges, Φ:E→[0,π2], which assigns an acute angle ϕij to each edge eij and is called a weight function on the edges. The set {r, Φ} is called the circle packing metric of the mesh Σ, which is illustrated in Fig. 4 (b) with a hyperbolic triangle. Two circle packing metrics (r1, Φ1) and (r2, Φ2) on the same mesh are conformally equivalent if Φ1 ≡ Φ2. A conformal deformation of a circle packing metric only modifies the vertex radii and preserves the intersection angles on the edges.

The edge length lij is given by the hyperbolic cosine law (5) lij=cosh−1(coshricoshrj+cosϕijsinhrisinhrj)

Suppose u : V → ℝ denotes the discrete conformal factor vector, u = {u1, u2, …, un}, where n is the number of vertices on Σ, and define (Zeng et al., 2010; Shi et al., 2015) (6) ui=log(tanhri2)

The discrete Ricci flow is defined as follows: (7) dui(t)dt=−2Ki(t),

The discrete Ricci flow is exactly the same form as the Ricci flow equation in the continuous setting (Eq. 1). Let the conformal factor vector be u0 = {0, 0, …, 0} at time 0, the discrete hyperbolic Ricci energy is defined as in (Zeng et al., 2010) (8) f(u)=∫u0u∑i=1nKidui,

It can be easily proved that ∂θi∂uj=∂θj∂ui using Eqs. 3, 5, and 6. Given the definition of Gaussian curvature Ki in Eq. 4, immediately we get ∂Ki∂uj=∂Kj∂ui. Thus, the differential 1-form ω=∑i=1nKidui is closed as dω = 0. This proves that the hyperbolic Ricci energy (Eq. 8) is convex and its unique global minimum corresponds to the hyperbolic metric with zero vertex Gaussian curvature. The discrete Ricci flow (Eq. 7) is the negative gradient flow of the hyperbolic Ricci energy. Thus, the hyperbolic Ricci energy can be minimized with the gradient descent method using Eq. 7.

Here, we use Newton’s optimization method, which is more efficient and stable than gradient descent (Zeng et al., 2010; Wang et al., 2012; Shi et al., 2015). The gradient of the hyperbolic Ricci energy (Eq. 8) is ∇f(u)=(∂f∂u1,∂f∂u2,…,∂f∂un)=(K1,K2,…,Kn). Then Algorithm 2 Hyperbolic Ricci Flow with Newton’s Optimization

	Input: A triangular mesh Σ(V, E, F).	
	Output: Hyperbolic metric of Σ.	
1	Compute the initial ri for each vertex υi and the weight ϕij for each edge eij.	
2	Set the target Gaussian curvature as zero.	
3	repeat Compute the edge lengths with Eq. 5, face corner angles with Eq. 3, and the Gaussian curvature with Eq. 4.

For each vertex υi, compute ∂Ki∂ui and ∂Ki∂uj with Eq. 9 and construct the Hessian matrix H.

Solve the linear system HΔu = −2K.

Update ui for vertex υi with ui ← ui + Δui.

Update ri for vertex υi with Eq. 6.

	
	until the resulting Gaussian curvature of all vertices is less than a user-defined
threshold.	

the elements in the Hessian matrix H are hii=∂Ki∂ui,hij=∂Ki∂uj, i, j = 1, 2, …, n. Specifically, define τij = sinh(ri)cosh(rj) + cosh(ri)sinh(rj)cos(ϕij), we have (9) ∂Ki∂ui=sinh(ri)×ΣfijkCB−DAAA2−B2,∂Ki∂uj=sinh(rj)×ΣfijkEB−FAAA2−B2

where A = sinh(lij)sinh(lki), B = cosh(lij)cosh(lki) − cosh(ljk), C=τijsinh(lki)cosh(lij)sinh(lij)+τjksinh(lij)cosh(lki)sinh(lki) , D = τijcosh(lki) + τkicosh(lij), E=τjisinh(lki)cosh(lij)sinh(lij), F = τjicosh(lki) − τjk.

Algorithm 2 summarizes the hyperbolic Ricci flow method with Newton’s optimization.

2.2.4. Embedding onto the Poincaré Disk and Conformal Invariants Computation

After computing the hyperbolic uniformization metric, we can embed the surface onto ℍ2, as described in Alg. 3. An illustration of the cortical surface embedding onto the Poincaré disk is in Fig. 2 (e).

In the Poincaré disk, open boundaries on the mesh Σ are mapped to hyperbolic geodesics, as shown with red curves in Fig. 2 (e). Assume the edges on boundary bk are counter-clockwisely ordered, as (ei, e2, …, em), and the two edges adjacent to vertex υi ∈ bk are ei and ei+1. Then the length of each boundary is computed as (10) lenbk=Σei∈bk|ei|

where |ei| is the length of edge ei under the hyperbolic metric. The lengths of the geodesics are invariant to conformal mappings and they form the proposed shape indices for each surface. Algorithm 3 Embed the surface onto the Poincaré disk.

	Input: A multiply connected surface Σ with its hyperbolic uniformization metric and
  its simply connected domain Σ̃.	
	Output: The embedding of Σ̃ onto the Poincaré disk.	
1	Copy the hyperbolic uniformization metric from Σ to Σ̃.	
2	Select a seed face f012 = [υ0, υ1, υ2] ∈ Σ̃, map each vertex to the Poincaré disk as:
p(υ0) = (0, 0), p(υ1)=el01−1el01+1(1,0), and p(υ2)=el02−1el02+1(cosθ012,sinθ012).	
3	Put all the neighboring faces of f012 to a queue.	
4	while the queue is not empty do	
5		Pop the first face fijk from the queue;	
6	if fijk has been embedded then	
7		Continue;	
8	else	
9		Suppose υi and υj have been embedded, compute the intersections of two
circles (center, radius): (p(υi), lik) and (p(υj), ljk).	
10	Then p(υk) is chosen as the intersection point that keeps the face upward.	
11	Put the neighboring faces of fijk in the queue.	
12	end	
13	end	

2.3. Subjects

Data used in the preparation of this article were obtained from the Alzheimer’s Disease Neuroimaging Initiative (ADNI) database (adni.loni.usc.edu). The ADNI was launched in 2003 by the National Institute on Aging (NIA), the National Institute of Biomedical Imaging and Bioengineering (NIBIB), the Food and Drug Administration (FDA), private pharmaceutical companies and non-profit organizations, as a $60 million, 5-year public private partnership. The primary goal of ADNI has been to test whether serial magnetic resonance imaging (MRI), positron emission tomography (PET), other biological markers, and clinical and neuropsychological assessment can be combined to measure the progression of mild cognitive impairment (MCI) and early Alzheimer’s disease (AD). Determination of sensitive and specific markers of very early AD progression is intended to aid researchers and clinicians to develop new treatments and monitor their effectiveness, as well as lessen the time and cost of clinical trials.

The Principal Investigator of this initiative is Michael W. Weiner, MD, VA Medical Center and University of California - San Francisco. ADNI is the result of efforts of many coinvestigators from a broad range of academic institutions and private corporations, and subjects have been recruited from over 50 sites across the U.S. and Canada. The initial goal of ADNI was to recruit 800 subjects but ADNI has been followed by ADNI-GO and ADNI-2. To date, these three protocols have recruited over 1500 adults, ages 55 to 90, to participate in the research, consisting of cognitively normal older individuals, people with early or late MCI, and people with early AD. The follow up duration of each group is specified in the protocols for ADNI-1, ADNI-2 and ADNI-GO. Subjects originally recruited for ADNI-1 and ADNI-GO had the option to be followed in ADNI-2. For up-to-date information, see www.adni-info.org.

In this study, the T1-weighted images from 64 subjects were used. The structural MRI images were from the ADNI baseline (62 images) and 24-months dataset (2 images) (Mueller et al., 2005; Jack et al., 2008). We used FreeSurfer’s automated processing pipeline (Dale et al., 1999; Fischl et al., 1999a) for skull stripping, tissue classification, surface extraction, and cortical and subcortical parcellations. It also calculated volumes of individual grey matter parcellations in mm3 and surface area in mm2, provided surface and volume statistics for about 34 different cortical structures, and computed geometric characteristics such as curvature, curvedness, local foldedness for each of the parcellations (Desikan et al., 2006). We further loaded the pial surface constructed by FreeSurfer to Caret (Computerized Anatomical Reconstruction and Editing Tooklit) software (Van Essen et al., 2001), which applies atlas based spherical registration and automatically trace the core 6 landmarks, including Central Sulcus (CeS), Anterior Half of the Superior Temporal Gyrus (aSTG), Sylvian Fissure (SF), Calcarine Sulcus (CaS), Medial Wall Ventral Segment, and Medial Wall Dorsal Segment. Details of Caret software on spherical deformation and landmark information are described in (Van Essen Lab, 2012).

Specifically, the subjects we studied included 30 AD (age: 76.67 ± 7.61), 30 healthy control subjects (age: 76.50 ± 7.51) and 2 MCI patients (for longitudinal illustration). The demographic information of 60 studied subjects in ADNI baseline dataset is in Table 1. Here MMSE is short for mini-mental state examination (Folstein et al., 1975). It is a brief cognitive assessment tool generally used for office-based clinical examinations. Full score is 30, lower means more impaired.

3. Experimental Results

3.1. A Synthetic Data Example

The proposed conformal invariant based shape indices are succinct, intrinsic, invariant under the rigid motions and scalings. To validate these properties, we conducted a synthetic experiment with two dinosaur surfaces, which differed by an isometric deformation. Fig. 5 (a) is a dinosaur surface with six open landmark curves, where the landmark curves are labeled as γi, i = 1, …, 6. They were chosen to represent the most salient shape information, including head, tail, and limbs, etc. We isometrically bent the surface into a different pose with an elongated tail, as shown in Fig. 5 (b). The two surfaces are isometrically equivalent so they are also conformally equivalent. After we sliced open them along six open landmark curves, both surfaces have the Euler characteristic −4. Following the uniformization theorem, they may be equipped by Riemannian metrics that induce constant negative Gaussian curvatures, i.e. their conformal parameterizations admit hyperbolic geometry. We applied our conformal invariant computation pipeline (Alg. 1) and computed the length of each boundary under the hyperbolic metric.

Fig. 5 (c) shows the embedding of two surfaces (a, left; b, right) onto the Poincaré disk. As indicated by the picture, we can see open boundaries, γ1, …, γ6 are mapped to the geodesic curves on the Poincaré disk. Among them, boundary γ5 is mapped to several segments because of the way we generate the fundamental group of the multiply connected surfaces. We also computed the the hyperbolic lengths of the boundaries, i.e. the conformal invariant shape indices. They were: [1.85083, 0.404286, 1.04093, 0.93902, 0.536393, 0.54362] for (a) and [1.85083, 0.404287, 1.04093, 0.93902, 0.536393, 0.54362] for (b), respectively. The resulting shape indices and embedding were almost identical for both surfaces. This simple synthetic example shows that the proposed shape index is invariant between the synthesized conformal transformation and also demonstrates that the proposed algorithm is able to generate stable computational results.

3.2. Longitudinal Cortical Morphometry in Alzheimer’s Disease

In this experiment, we tested the feasibility of the proposed shape index in studying longitudinal cortical morphometry associated with AD. We randomly selected two mild cognitive impairment (MCI) patients from the ADNI database. One MCI patient converted to AD 36 months after the baseline screening, which we called the MCI converter subject, the other who did not convert to AD 36 months after the baseline screening was called the MCI stable subject.

In our experiments, we studied their structural MR images at two time points, the baseline and 24 months. Our hypothesis is that we may observe some different atrophy patterns associated with the conversion vs. stable progression paths. In this experiment, only the left hemispherical cortical surfaces were used. With the preprocessing with FreeSurfer (Fischl et al., 1999a) and Caret (Van Essen et al., 2001) software packages, two baseline brain cortical surfaces with the landmark curves are shown in Fig. 6 (a). We computed the lengths of the landmark curves under the hyperbolic metric in the same way as the above section. For each MCI patient, we obtained a shape feature matrix (Bi, Ti), i = 1, …, 6, where B represents the baseline cortical surface and T represents the 24-month cortical surface. Then we calculated the L2 norm of the shape difference for a given subject over time as d=∑i=16(Bi−Ti)2. With the proposed method, the shape difference between the cortical surfaces of two time points is 0.3925 and 1.0438 for the MCI stable and converter subjects, respectively. We see some more differences on the MCI converter subject’s longitudinal image data than the MCI stable subject.

Further, to illustrate the difference on each conformal invariant, we plotted the radar chart (Chambers et al., 1983) in Fig. 6 (b). Basically, a radar chart is a graphical method of displaying multivariate data in the form of a two-dimensional chart where three or more quantitative variables are represented on axes starting from the same point. In our case, six landmarks are associated with six corners on a hexagon and six axes connect them to the common origin point. The position on each axis is proportional to the absolute difference between the computed conformal invariants on two time points. The more different, the farther away the point is to the origin. Meanwhile, we used two different color lines to connect the longitudinal differences from two different subjects, the blue color is for the MCI stable subject while the orange color is for the MCI converter subject. From the radar chart, we find that there is a clear difference between these two subjects’ radar charts. Interestingly, we also found on the MCI converter radar chart, there are sharp differences associated with two landmark curves on the medial wall ventral segment and medial wall dorsal segment, especially on medial wall ventral segment. Since medial wall ventral segment runs along the medial margin of the hippocampal sulcus and medal wall dorsal segment runs along the corpus collosum (Fig. 3). It may be particularly consistent with prior observations that, for AD conversion, grey matter atrophy is more related to medial temporal lobe region and the posterior cingulate (Frisoni et al., 2010; Thompson et al., 2003; Buckner et al., 2008; Leech and Sharp, 2014; Matsuda, 2007). Although multi-subject studies are clearly necessary, this experiment demonstrates that our conformal invariants may potentially be used as a set of shape indices to compare and classify cortical surfaces of AD patients at different stages of disease progression. Our work may also provide a simple way to directly visualize the cortical morphometry changes related to different brain regions.

3.3. Application of Conformal Invariants to Multivariate Statistics on Population-based Group Difference Study

This experiment further investigates the variation patterns of the six landmarks to study brain shape morphometry in AD at the group-level population-based study. We hypothesize that the length of those six landmarks under hyperbolic metric may serve as useful shape indices to verify and predict degeneration of AD. In this experiment, we applied a group-wise statistical analysis to our proposed shape indices in left hemisphere cortex between AD and control subjects. Our data set consisted of 60 subjects which were randomly chosen from ADNI database, including 30 AD subjects and 30 matching normal controls. The demographic information of these subjects is shown in Table 1. The cortical surface of each subject was computed, from which six landmarks were extracted using the same method as that in the previous experiments. Similarly, we use the lengths of six landmarks in hyperbolic space as the conformal invariants to represent morphometric characteristics of cortical surfaces. Here, conformal invariants for each cortical surface for a given hemisphere was a vector υ = (υ1,…, υ6)T, where υi is the length of a given landmark under hyperbolic metric.

Similar to our prior work (e.g. Wang et al., 2011), we performed the permutation based Hotelling’s T2 test to evaluate group difference. Suppose there are two sets of feature vectors from two different groups, C = (x1, x2, …, xm) and W = (y1, y2, …, yn), where m and n are the number of subjects in AD and the control group respectively. The difference between two groups is measured by the Mahalanobis distance, (11) d(υ)=(μC−μW)T(ΣW+ΣC)−1(μC−μW)

where μC, μW, ΣC and ΣW are the mean and covariance of two groups, respectively. We first compute the true group distance based on the true grouped samples. Then we randomly assigned the feature vectors into two groups each with the equal size number of 30 and recomputed group distance. The process was repeated 5000 times with the outcome of 5000 permutation values. Finally, a probability (p value) was computed as the ratio of the number of permutation values greater than the true group distance to the total permutation times. To evaluate if our proposed conformal invariant vector really helped to improve the detection power, we also computed group differences by using cortical surfaces area and cortex volume.

With this protocol, the prominent statistical result of conformal invariants was p = 0.0133 between AD and control groups. For comparison purpose, we also computed the natural lengths of the six landmark curves in the ambient space, as they are the counterpart of the proposed shape indices in the Euclidean domain. Similarly, we used Hotelling’s T2 test to perform group comparison. With the same permutation test as above, the Euclidean lengths of the landmarks did not reveal significant difference between the two groups (p = 0.7844). Furthermore, we also conducted permutation based t tests using left cortical surface area and left cortex volume, respectively. Similarly, we conducted 5000 times of permutation and estimated the probability of the ground truth data happened in this random permutation results. Neither of the two statistical results reached significant level (p = 0.5888 and p = 0.1152 for left cortical surface area and left cortex volume, respectively). Our empirical results demonstrated that it may be possible to use our proposed shape indices to detect AD related morphometric variation on group-based studies.

4. Discussion

Application of the shape space concept to investigate brain morphometry changes can be used to evaluate disease burden, progression and response to interventions. In this paper, we introduced a novel Teichmüller shape space based automatic brain imaging system that focuses on studying six major landmark curves on human brain cortical surfaces. There are two main findings in our paper. First, this paper demonstrates the feasibility of applying the concept of Teichmüller shape space to study image based brain morphometry variance. The Teichmüller shape space is an abstract mathematical concept which reflects intrinsic surface conformal structure. Our prior work (Zeng et al., 2012) has shown that the Teichmüller shape space could be applied to study certain brain functional area morphometry changes. However, that work strongly depended on the specific areas to be studied. In this work, we focus on six common landmark curves and compute the Teichmüller shape space coordinates when modeling them as open curves. The proposed method is general and has the potential to provide an integrated simple morphometry descriptor to brain shape analysis research. Second, we built an efficient and practical imaging analysis pipeline by integrating surface Ricci flow, hyperbolic geometry methods and other popular neuroimaging software tools such as FreeSurfer and Caret. The obtained image indexing system is robust and automatic and defined on 6 most common landmarks in human brains. The obtained imaging indices practically encode information about intrinsic surface conformal structure, providing a unique way to study subtle brain morphometry changes that may enrich current state-of-the-art brain morphometry analysis algorithms.

The proposed conformal invariant computation system is theoretically sound and numerically efficient (Jin et al., 2008; Wang et al., 2012; Zeng et al., 2010; Shi et al., 2015). To evaluate its numerical stability, we randomly selected a baseline brain image from a healthy control subject. With FreeSurfer and Caret, we identified 6 landmark curves on its left cortical surface. We further used Loop subdivision (Loop, 1987) to increase its face numbers and generated two additional surfaces. These three cortical meshes with some zoom-in snapshots are shown in Fig. 7. Then we applied the same computational pipeline on these three cortical surfaces to compute their conformal invariants. The computed conformal invariants for three meshes are [3.44536, 3.11303, 4.75132, 3.5008, 5.88926, 4.67419], [3.37195, 3.16175, 4.87988, 3.40043, 5.96301, 4.74933] and [3.46745, 3.10535, 4.7666, 3.48866, 5.83625, 4.75211] for three meshes with 145440, 200000, and 581760 faces, respectively. We can see the results are quite similar and difference are less than 2% of the the original values. The empirical results demonstrate that our computation is robust and independent of the mesh resolutions.

It is well known that noise in MR images has an important influence on brain imaging study and many denoising algorithms have been introduced (Wink and Roerdink, 2004; Nobi and Yousuf, 2011). Thus an MRI analysis tool that is robust to image noise will be highly advantageous. To study the sensitivity of our method to image noise, we randomly selected an MR image from the ANDI baseline control dataset. As studied in (Gudbjartsson and Patz, 1995), the image intensity in MR images with noise present is governed by a Rician distribution, we manually added the Racian noise to the original MR image with standard deviation of 35, using the method as in (Ridgway, 2007). The raw images without and with noise are shown in Fig. 8 (a) and (b), respectively. With FreeSurfer and Caret, the reconstructed cortical surfaces overlaid with landmark curves are shown in Fig. 8, where (c) and (e) are the front and back views of the left cortical surface from the image without noise, (d) and (f) are from the noisy image. We can see that the reconstructed cortical surfaces and the landmark curves are very similar to each other. Then we computed the conformal invariants with both multiply connected surfaces and the resulting shape indices are [3.44536, 3.11303, 4.75132, 3.5008, 5.88926, 4.67419] for Fig. 8 (c, e) and [3.46495, 3.1554, 4.81487, 3.53899, 5.84046, 4.67932] for Fig. 8 (d, f), respectively. We can see that the results are quite similar, even with a high image noise level. Although more carefully designed experiments are necessary, this simple experiment demonstrates that our method may be robust to noise in raw MR images.

The longitudinal MCI experiment presented in Sec. 3.2 serves as a quick illustration to justify the relevance of our proposed work with the AD research. It is not expected that such a simple comparison would bring any new insights to the AD research. To do so, more rigorous test-retest population based studies are certainly necessary. Even so, our work shows that the posterior cingulate area is one of the areas that has the drastic shape changes over the study period. In the literature, the posterior cingulate is among a few structures that are affected significantly by the early stages of AD (Buckner et al., 2008; Leech and Sharp, 2014; Matsuda, 2007). In our prior work (Shi et al., 2015), we also found that subregions on lateral ventricles that are adjacent to posterior cingulate demonstrated significant enlargement in MCI converters. Thus our observation is consistent with AD research results in the literature. It may indicate that our shape indices may be able to capture the brain shape morphometry that is associated with AD progress.

The current work is related to manifold shape space research, which was pioneered by Kendall (1977) and Bookstein (1978). In image analysis research, shape space was well studied for brain atlas estimation (Fletcher et al., 2009; Fletcher, 2013), shape analysis (Kurtek et al., 2011; Gutman et al., 2015; Su et al., 2015a), morphometry study (Younes et al., 2009; Boyer et al., 2011), and other applications. In a computational anatomy framework (Grenander and Miller, 1998), the space of diffeomorphisms was carefully studied (Miller et al., 2002; Miller and Younes, 2001; Trouvé, 1998; Younes, 2010). In Srivastava et al. (2005), Younes et al. (2008) and Srivastava and Jermyn (2009), shape space was defined as the space of orbits of the reparameterization group acting on the space of immersions. The reparameterization invariant (RI) metric constructed in Bauer et al. (2010) and Bauer et al. (2012) used the volume form and the mean curvature of the immersion f, and the metric in (Kurtek et al., 2012) used the area multiplication factor of f. Kurtek et al. (2013) extended the work in (Kurtek et al., 2012) by adding landmark constraints. Jermyn et al. (2012) simplified the RI metric computation and Gutman et al. (2015) recently built a Riemannian framework for an intrinsic comparison of the RI metric structure. Lipman and Daubechies (2011) introduced a metric for shape comparison based on conformal uniformization and optimal mass transport. The metric is invariant under Möbius transformation. Later, Lipman et al. (2013) provided a convergence analysis of the discrete approximation to the arising mass transport problems. Mémoli (2011) presented a modification and expansion of the original Gromov-Hausdorff notion of distance between metric spaces which considers probability measures defined on measurable subsets of metric spaces. Recently, Riemannian optimal mass transport (Ambrosio and Gigli, 2013; Su et al., 2015a) was introduced. It was used to compute Wasserstein distance on sphere (Su et al., 2015b) and hyperbolic domain (Shi et al., 2016)

There are two important caveats when applying Teichmüller shape space coordinates for brain morphometry research. First, it demands more investigations on how useful the conformal invariants are for brain morphometry study. Further, it may be beneficial to apply our method if the users have some prior knowledge on the brain deformations associated with a specific neurodegenerative disease. Otherwise, one may have to screen a set of candidate curves to find which are the most sensitive to certain disease states. It demands some computation time to make it clinically useful. Even so, it is a natural idea that one can expect certain neurodegenerative diseases would have distorted conformal structures so that one can use the conformal invariants to measure the severity and develop an imaging biomarker. Our work provides unique measurements to quantify cortical surface deformations and associate them with some brain cognitive measures. Second, Teichmüller shape space remains a fast growing research field, including some recent seminal work in the pure mathematics society (e.g. Mirzakhani, 2008). The current work presents our initial efforts to study the possibility for the Teichmüller shape space coordinates as a valid brain imaging biomarker. We hope our preliminary results could inspire new ideas on this topic and further advance brain morphometry research.

5. Conclusion and Future Work

In this paper, we propose a stable way to compute conformal invariants for multiply connected surfaces. With topology optimization, surface hyperbolic Ricci flow and hyperbolic embedding, we can conformally map a 3D surface with open boundaries onto the Poincaré disk. The lengths of the open boundaries on the multiply connected surfaces under the hyperbolic uniformization metric are the Teichmüller space coordinates, i.e. conformal invariants. The computed conformal invariants are robust to rigid-body transformations and conformal transformations of the surfaces from which they are derived. Local geometry is well preserved under conformal mapping so conformal invariants may be good candidate features for brain research on cortical and subcortical surface morphometries. The proposed method is part of our ongoing work on hyperbolic conformal geometry and its applications in brain imaging research. In (Shi et al., 2015), we studied ventricular enlargement in MCI converters using hyperbolic Ricci flow and surface tensor-based morphometry (TBM) (Chung et al., 2008). Based on this work, we developed a hyperbolic space sparse coding system (Zhang et al., 2016). In (Shi et al., 2016), we computed the hyperbolic Wasserstein distance and applied it to an AD-control cortical surface classification problem and achieved an accuracy rate of 76.7%. This demonstrates that we may use hyperbolic Wasserstein distance as a single shape index to characterize a unique brain surface. These promising results encourage us to further explore the power of hyperbolic geometry. In future, we will continue working on computing novel surface features from surface hyperbolic conformal structure and studying their applications in AD diagnosis. The proposed conformal invariant-based shape indices are an integral part of our future work. Specifically, first, we will further validate the method with more imaging data; second, by applying some popular statistical classifiers, such as the support vector machine (Cortes and Vapnik, 1995) and linear discriminant analysis (LDA) (Fisher, 1936), we plan to carefully study and validate these conformal invariants for MCI conversion prediction and AD prognosis. Furthermore, we will also study more shape space invariants, such as the period matrix of high-genus surfaces for conformal equivalence (Gu et al., 2004), heat kernel descriptors for isometry equivalence (Wang and Wang, 2015), etc. These invariants may provide new reliable and intrinsic shape features.

This work was partially supported by the National Institutes of Health (R21AG043760 to JS, WZ, RJC and YW, R21AG049216 to WZ and YW, RF1AG051710 and U54EB020403 to YW, R01AG031581 and P30AG19610 to RJC) and the National Science Foundation (DMS-1413417 to YW, IIS-1421165 to WZ and YW).

Data collection and sharing for this project was funded by the Alzheimer’s Disease Neuroimaging Initiative (ADNI) (National Institutes of Health Grant U01 AG024904) and DOD ADNI (Department of Defense award number W81XWH-12-2-0012). ADNI is funded by the National Institute on Aging, the National Institute of Biomedical Imaging and Bioengineering, and through generous contributions from the following: Alzheimer’s Association; Alzheimer’s Drug Discovery Foundation; BioClinica, Inc.; Biogen Idec Inc.; Bristol- Myers Squibb Company; Eisai Inc.; Elan Pharmaceuticals, Inc.; Eli Lilly and Company; F. Hoffmann-La Roche Ltd and its affiliated company Genentech, Inc.; GE Healthcare; Innogenetics, N.V.; IXICO Ltd.; Janssen Alzheimer Immunotherapy Research &amp; Development, LLC.; Johnson &amp; Johnson Pharmaceutical Research &amp; Development LLC.; Medpace, Inc.; Merck &amp; Co., Inc.; Meso Scale Diagnostics, LLC.; NeuroRx Research; Novartis Pharmaceuticals Corporation; Pfizer Inc.; Piramal Imaging; Servier; Synarc Inc.; and Takeda Pharmaceutical Company. The Canadian Institutes of Health Research is providing funds to Rev December 5, 2013 support ADNI clinical sites in Canada. Private sector contributions are facilitated by the Foundation for the National Institutes of Health (www.fnih.org). The grantee organization is the Northern California Institute for Research and Education, and the study is coordinated by the Alzheimer’s Disease Cooperative Study at the University of California, San Diego. ADNI data are disseminated by the Laboratory for Neuro Imaging at the University of Southern California.

Appendix. 1

Riemannian Metric

Suppose S is a surface embedded in ℝ3 and its parametric representation is r(x, y) with local coordinates (x, y). A tangent vector of S is dr = rxdx + rydy, where (dx, dy) are coordinates of dr on the tangent plane. The length of the tangent vector is ds2 =&lt; dr, dr &gt;= dx2 &lt; rx, rx &gt; +2dxdy &lt; rx, ry &gt; +dy2 &lt; ry, ry &gt;. Let E =&lt; rx, rx &gt;, F =&lt; rx, ry &gt;, and G =&lt; ry, ry &gt;, then ds2 can be written as (1) ds2=(dxdy)(EFFG)(dxdy).

The ds2 is called the first fundamental form or Riemannian metric, which defines an inner product in the tangent space of S. Usually, we denote the Riemannian metric as the positive definite tensor g=(EFFG)

Appendix .2

Gaussian Curvature

Given a surface S, the Gauss map G : S → 𝕊2 projects each point p ∈ S to its normal n(p) on the unit sphere. The Gaussian curvature K(p) is defined as the Jacobian of the Gauss map, i.e., the ratio between the infinitesimal area around the Gauss image of p on the sphere and the infinitesimal area around p on the surface. Gaussian curvature is intrinsic surface property and invariant under isometries. According to the Gauss-Bonnet theorem (Carmo, 1976), the total Gaussian curvature of a surface is determined by its topology: ∫S KdA = 2πχ(S), where dA is the surface area element and χ(S) is the Euler characteristic of S.

Figure 1 Illustration of the hyperbolic geometry. (a) The Poincaré disk model; (b) geodesics in the Poincaré disk model.

Figure 2 Algorithm pipeline. Given an MRI (a), the cortical surfaces (b) are reconstructed with the FreeSurfer (Fischl et al., 1999b). Six landmarks are then traced on each cortical surface using the Caret tool (Van Essen et al., 2001). With topology optimization, each cortical surface is converted to a multiply connected surface (c). We then compute the fundamental group (d) of the multiply connected surface. Finally, with the hyperbolic Ricci flow, we map each cortical surface onto the Poincaré disk (e).

Figure 3 A left cortical surface with six landmark curves, which are automatically labeled with Caret (Van Essen et al., 2001), showing in two different views on both the original and inflated surfaces. The inflated surface is obtained with FreeSurfer (Fischl et al., 1999b).

Figure 4 Illustration of a hyperbolic triangle (a) and the circle packing metric in the hyperbolic space (b).

Figure 5 Synthetic experiment to illustrate the stability of the proposed shape index under isometric deformations: (a) a dinosaur surface with six open boundaries after slicing along six open landmark curves; (b) an isometrically bent surface from (a); (c) the embedding of two surface parameterizations onto the hyperbolic Poincaré disk (a, left; b, right).

Figure 6 Radar chart showing the variance of each landmark curve on multiply connected cortical surfaces. (a) two baseline flattened cortical surfaces with identified six landmark curves. (b) Radar chart on individual landmark conformal invariants between two MCI subjects. The landmark conformal invariants are computed on their left cortical surfaces. Each landmark is associated with a corner on a hexagon and six axes are connected them to the common origin point. The position on the axis is proportional to the absolute difference between two landmark conformal invariants computed on different time points. By connecting the six points from the same subject, we get two new hexagons. The blue line stands for MCI Stable (MCI-Sta) and the orange for MCI converter (MCI-Con). The radar chart provides a simple way to display multivariate data in the form of a two-dimensional chart.

Figure 7 Cortical surface meshes in different resolutions. The cortical mesh (a) was originally from a healthy control subject and reconstructed by FreeSurfer software. With Loop subdivision, we generated two other meshes, (b) and (c), with different resolutions. The inner pictures show the zoom-in snapshots of the mesh structures. Our empirical results show that the computational results are stable with different mesh resolutions.

Figure 8 Sensitivity of the proposed shape indices to raw MR image noise. (a) an MR image without noise, (b) the same MR image as in (a) but with noise added, (c) front view of the cortical surface reconstructed from image (a), overlaid with landmark curves, (d) front view of the cortical surface reconstructed from image (b), overlaid with landmark curves, (e) back view of the cortical surface reconstructed from image (a), overlaid with landmark curves, (f) back view of the cortical surface reconstructed from image (b), overlaid with landmark curves.

Table 1 Demographic information of 60 studied subjects in ADNI baseline dataset.

	Gender(M/F)	Education	Age	MMSE at Baseline	
CTL	13/17	15.1 ± 2.1	79.73 ± 3.73	29.94 ± 0.81	
AD	14/16	15.4 ± 2.8	82.52 ± 6.12	24.82 ± 1.68	

Highlights

A Teichmüller shape space approach to landmark curve-based brain morphometry study

FreeSurfer/Caret used to reconstruct cortical surfaces and locate 6 landmark curves

With topology optimization, cortical surfaces are equipped with hyperbolic metric

Hyperbolic Ricci flow conformally maps multiply connected surfaces to Poincaré disk

Experiments on synthetic and ADNI data showed promising results

This is a PDF file of an unedited manuscript that has been accepted for publication. As a service to our customers we are providing this early version of the manuscript. The manuscript will undergo copyediting, typesetting, and review of the resulting proof before it is published in its final citable form. Please note that during the production process errors may be discovered which could affect the content, and all legal disclaimers that apply to the journal pertain.


References

Ambrosio L Gigli N Piccoli Benedetto Rascle Michel Modelling and Optimisation of Flows on Networks: Cetraro, Italy 2009 2013 Berlin, Heidelberg Springer Berlin Heidelberg 1 155 chapter A User’s Guide to Optimal Transport
Argall BD Saad ZS Beauchamp MS Simplified intersubject averaging on the cortical surface using SUMA Hum Brain Mapp 2006 27 14 27 16035046
Batchelor PG Castellano Smith AD Hill DL Hawkes DJ Cox TC Dean AF Measures of folding applied to the development of the human fetal brain IEEE Trans Med Imaging 2002 21 953 965 12472268
Bauer M Harms P Michor PW Sobolev metrics on shape space of surfaces in n-space 2010 arXiv:1009.3616
Bauer M Harms P Michor PW Almost local metrics on shape space of hyper-surfaces in n-space SIAM Journal on Imaging Sciences 2012 5 244 310
Bookstein FL The Measurement of Biological Shape and Shape Change volume 24 of Lecture Notes in Biomathematics 1978 Springer-Verlag
Botino CM Castro CC Gomes RL Buchpiguel CA Marchetti RL Neto MR Volumetric MRI measurements can differentiate Alzheimer’s disease, mild cognitive impairment and nomral aging International Psychogeriatrics 2002 14 59 72 12094908
Boyer DM Lipman Y St Clair E Puente J Patel BA Funkhouser T Jernvall J Daubechies I Algorithms to automatically quantify the geometric similarity of anatomical surfaces Proc. Natl. Acad. Sci. U.S.A 2011 108 18221 18226 22025685
Buckner RL Andrews-Hanna JR Schacter DL The brain’s default network: anatomy, function, and relevance to disease Ann. N. Y. Acad. Sci 2008 1124 1 38 18400922
Cachia A Mangin JF Riviere D Kherif F Boddaert N Andrade A Papadopoulos-Orfanos D Poline JB Bloch I Zilbovicius M Sonigo P Brunelle F Regis J A primal sketch of the cortex mean curvature: a morphogenesis based approach to study the variability of the folding patterns IEEE Trans Med Imaging 2003 22 754 765 12872951
Carmo MPD Differential Geometry of Curves and Surfaces Pearson 1976
Caselli RJ Reiman EM Characterizing the preclinical stages of Alzheimer’s disease and the prospect of presymptomatic intervention J. Alzheimers Dis 2013 33 Suppl 1 S405 S416 22695623
Chambers JM Cleveland WS B K Tukey PA Graphical Methods for Data Analysis 1983 Wadsworth
Chollet MB Aldridge K Pangborn N Weinberg SM Deleon VB Land-marking the brain for geometric morphometric analysis: an error study PLoS ONE 2014 9 e86005 24489689
Chung M Dalton K Davidson R Tensor-based cortical surface morphometry via weighted spherical harmonic representation IEEE Trans. Med. Imag 2008 27 1143 1151
Cootes TF Taylor CJ Cooper DH Graham J Active shape models&amp; mdash;their training and application Comput. Vis. Image Underst 1995 61 38 59
Cortes C Vapnik V Support-vector networks Mach. Learn 1995 20 273 297
Dale AM Fischl B Sereno MI Cortical surface-based analysis. I. Segmentation and surface reconstruction Neuroimage 1999 9 179 194 9931268
Davies RH Twining CJ Allen PD Cootes TF Taylor CJ Shape discrimination in the hippocampus using an MDL model Proc. Infor. Proc. Med. Imag. (IPMI) 2003
Desikan RS Segonne F Fischl B Quinn BT Dickerson BC Blacker D Buckner RL Dale AM Maguire RP Hyman BT Albert MS Killiany RJ An automated labeling system for subdividing the human cerebral cortex on MRI scans into gyral based regions of interest Neuroimage 2006 31 968 980 16530430
Durrleman S Pennec X Trouve A Ayache N Measuring brain variability via sulcal lines registration: a diffeomorphic approach Med Image Comput Comput Assist Interv 2007 10 675 682 18051117
Fillard P Arsigny V Pennec X Hayashi KM Thompson PM Ayache N Measuring brain variability by extrapolating sparse tensor fields measured on sulcal lines Neuroimage 2007 34 639 650 17113311
Fischl B Rajendran N Busa E Augustinack J Hinds O Yeo BT Mohlberg H Amunts K Zilles K Cortical folding patterns and predicting cytoarchitecture Cereb. Cortex 2008 18 1973 1980 18079129
Fischl B Sereno MI Dale AM Cortical surface-based analysis. II: Inflation, flattening, and a surface-based coordinate system Neuroimage 1999a 9 195 207 9931269
Fischl B Sereno MI Dale AM Cortical surface-based analysis II: Inflation, flattening, and a surface-based coordinate system NeuroImage 1999b 9 195 207 9931269
Fischl B Sereno MI Tootell RB Dale AM High-resolution intersubject averaging and a coordinate system for the cortical surface Hum Brain Mapp 1999c 8 272 284 10619420
Fisher RA The use of multiple measurements in taxonomic problems Annals of Eugenics 1936 7 179 188
Fletcher PT Geodesic regression and the theory of least squares on Riemannian manifolds International Journal of Computer Vision 2013 105 171 185
Fletcher PT Venkatasubramanian S Joshi S The geometric median on Riemannian manifolds with application to robust atlas estimation Neuroimage 2009 45 S143 S152 19056498
Folstein MF Folstein SE McHugh PR ”Mini-mental state”. A practical method for grading the cognitive state of patients for the clinician J Psychiatr Res 1975 12 189 198 1202204
Frisoni GB Fox NC Jack CR Scheltens P Thompson PM The clinical use of structural MRI in Alzheimer disease Nat Rev Neurol 2010 6 67 77 20139996
Gardiner FP Lakic N Quasiconformal Teichmüller Theory American Mathematical Society 2000
Gerig G Styner M Jones D Weinberger D Lieberman M Shape analysis of brain ventricles using SPHARM IEEE Workshop on Mathematical Methods in Biomedical Image Analysis (MMBIA’01) 2001
Glaunès J Vaillant M Miller MI Landmark matching via large deformation diffeomorphisms on the sphere Journal of Mathematical Imaging and Vision 2004 20 179 200
Grenander U Miller MI Computational anatomy: an emerging discipline Quart. Appl. Math 1998 56 617 694
Gu X Wang Y Yau ST Computing conformal invariants: Period matrices Communications in Information and Systems 2004 3 153 170
Gudbjartsson H Patz S The Rician distribution of noisy MRI data Magn Reson Med 1995 34 910 914 8598820
Gutman BA Fletcher PT Cardoso MJ Fleishman GM Lorenzi M Thompson PM Ourselin S Ourselin S Alexander DC Westin CF Cardoso MJ A riemannian framework for intrinsic comparison of closed genus-zero shapes Information Processing in Medical Imaging 2015 Springer International Publishing 205 218 volume 9123 of Lecture Notes in Computer Science
Hamilton RS The Ricci flow on surfaces Contemp. Math 1988 71 237 262
Im K Jo HJ Mangin JF Evans AC Kim SI Lee JM Spatial distribution of deep sulcal landmarks and hemispherical asymmetry on the cortical surface Cereb. Cortex 2010 20 602 611 19561060
Jack CR Bernstein MA Fox NC Thompson P Alexander G Harvey D Borowski B Britson PJ L Whitwell J Ward C Dale AM Felmlee JP Gunter JL Hill DL Killiany R Schuff N Fox-Bosetti S Lin C Studholme C DeCarli CS Krueger G Ward HA Metzger GJ Scott KT Mallozzi R Blezek D Levy J Debbins JP Fleisher AS Albert M Green R Bartzokis G Glover G Mugler J Weiner MW The Alzheimer’s Disease Neuroimaging Initiative (ADNI): MRI methods J Magn Reson Imaging 2008 27 685 691 18302232
Jermyn IH Kurtek S Klassen E Srivastava A Elastic shape matching of parameterized surfaces using square root normal fields Proceedings of the 12th European Conference on Computer Vision - Volume Part V (ECCV’12) 2012 7576 804 817
Jin M Kim J Luo F Gu X Discrete surface ricci flow Visualization and Computer Graphics, IEEE Transactions on 2008 14 1030 1043
Joshi SH Cabeen RP Joshi AA Sun B Dinov I Narr KL Toga AW Woods RP Diffeomorphic sulcal shape analysis on the cortex IEEE Trans Med Imaging 2012 31 1195 1212 22328177
Kendall DG The diffusion of shape Advances in Applied Probability 1977 9 428 430
Kurtek S Klassen E Ding Z Jacobson SW Jacobson JL Avison MJ Srivastava A Parameterization-invariant shape comparisons of anatomical surfaces IEEE Trans Med Imaging 2011 30 849 858 21156390
Kurtek S Klassen E Gore JC Ding Z Srivastava A Elastic geodesic paths in shape space of parameterized surfaces IEEE Trans Pattern Anal Mach Intell 2012 34 1717 1730 22144521
Kurtek S Srivastava A Klassen E Laga H Landmark-guided elastic shape analysis of spherically-parameterized surfaces Computer Graphics Forum 2013 32
Le Goualher G Procyk E Collins DL Venugopal R Barillot C Evans AC Automated extraction and variability analysis of sulcal neuroanatomy IEEE Trans Med Imaging 1999 18 206 217 10363699
Leech R Sharp DJ The role of the posterior cingulate cortex in cognition and disease Brain 2014 137 12 32 23869106
Li S Yuan X Pu F Li D Fan Y Wu L Chao W Chen N He Y Han Y Abnormal changes of multidimensional surface features using multivariate pattern classification in amnestic mild cognitive impairment patients J. Neurosci 2014 34 10541 10553 25100588
Li X Gu X Qin H Surface mapping using consistent pants decomposition IEEE Transactions on Visualization and Computer Graphics 2009 15 558 571 19423881
Lipman Y Daubechies I Conformal Wasserstein distances: Comparing surfaces in polynomial time Advances in Mathematics 2011 227 1047 1077
Lipman Y Puente J Daubechies I Conformal Wasserstein distance: II. computational aspects and extensions Math Comp 2013 82 331 381
Lohmann G von Cramon D Automatic labelling of the human cortical surface using sulcal basins Medical Image Analysis 2000 4 179 188 11145307
Loop C Smooth Subdivision Surfaces Based on Triangles. Master’s thesis Mathematics Department 1987 University of Utah
Luders E Thompson PM Narr KL Toga AW Jancke L Gaser C A curvature-based approach to estimate local gyrification on the cortical surface Neuroimage 2006 29 1224 1230 16223589
Luo F Geodesic length functions and teichmller spaces J. Differential Geom 1998 48 275 317
Lyttelton O Boucher M Robbins S Evans A An unbiased iterative group registration template for cortical surface analysis Neuroimage 2007 34 1535 1544 17188895
Mangin JF Poupon F Rivière D Cachia A Collins DL Evans AC Régis J Medical Image Computing and Computer-Assisted Intervention - MICCAI 2003 2003 6th International Conference November 15–18, 2003 Montréal, Canada Berlin, Heidelberg Springer Berlin Heidelberg Proceedings. chapter 3D Moment Invariant Based Morphometry. pp. 505–512
Matsuda H Role of neuroimaging in Alzheimer’s disease, with emphasis on brain perfusion SPECT J. Nucl. Med 2007 48 1289 1300 17631544
Mémoli F Gromovwasserstein distances and the metric approach to object matching Foundations of Computational Mathematics 2011 11 417 487
Miller MI Trouve A Younes L On the metrics and Euler-Lagrange equations of computational anatomy Annu Rev Biomed Eng 2002 4 375 405 12117763
Miller MI Younes L Group actions, homeomorphisms, and matching: A general framework International Journal of Computer Vision 2001 41 61 84
Mirzakhani M Ergodic theory of the earthquake flow International Mathematics Research Notices 2008
Mueller SG Weiner MW Thal LJ Petersen RC Jack C Jagust W Trojanowski JQ Toga AW Beckett L The Alzheimer’s disease neuroimaging initiative Neuroimaging Clin. N. Am 2005 15 869 877 16443497
Nobi MN Yousuf MA A new method to remove noise in magnetic resonance and ultrasound images Journal of Scientific Research 2011 3 81 89
Pizer S Fritsch D Yushkevich P Johnson V Chaney E Segmentation, registration, and measurement of shape variation via image object shape IEEE Trans. Med. Imag 1999 18 851 865
Ridgway G Rice/rician distribution 2007 https://www.mathworks.com/matlabcentral/fileexchange/14237-rice-rician-distribution/content/rician/html/ricedemo. html?requestedDomain=www.mathworks.com
Seo S Chung MK Laplacebeltrami eigenfunction expansion of cortical manifolds, in: Biomedical Imaging: From Nano to Macro, 2011 IEEE International Symposium on 2011 IEEE 372375
Shattuck DW Joshi AA Pantazis D Kan E Dutton RA Sowell ER Thompson PM Toga AW Leahy RM Semi-automated method for delineation of landmarks on models of the cerebral cortex J. Neurosci. Methods 2009 178 385 392 19162074
Shen L Ford J Makedon F Saykin A A surface-based approach for classification of 3D neuroanatomic structures Intelligent Data Analysis 2004 8 519 542
Shi J Stonnington CM Thompson PM Chen K Gutman B Reschke C Baxter LC Reiman EM Caselli RJ Wang Y Studying ventricular abnormalities in mild cognitive impairment with hyperbolic Ricci flow and tensor-based morphometry NeuroImage 2015 104 1 20 25285374
Shi J Zhang W Wang Y Shape analysis with hyperbolic wasserstein distance IEEE Conf. Comp. Vis. Patt. Recog. CVPR ’16 2016
Shi Y Lai R Morra JH Dinov I Thompson PM Toga AW Robust surface reconstruction via Laplace-Beltrami eigen-projection and boundary deformation IEEE Trans Med Imaging 2010 29 2009 2022 20624704
Sperling RA Aisen PS Beckett LA Bennett DA Craft S Fagan AM Iwatsubo T Jack CR Kaye J Montine TJ Park DC Reiman EM Rowe CC Siemers E Stern Y Yaffe K Carrillo MC Thies B Morrison-Bogorad M Wagster MV Phelps CH Toward defining the preclinical stages of Alzheimer’s disease: recommendations from the National Institute on Aging-Alzheimer’s Association workgroups on diagnostic guidelines for Alzheimer’s disease Alzheimers Dement 2011 7 280 292 21514248
Srivastava A Jermyn IH Looking for shapes in two-dimensional cluttered point clouds IEEE Trans Pattern Anal Mach Intell 2009 31 1616 1629 19574622
Srivastava A Joshi SH Mio W Liu X Statistical shape analysis: clustering, learning, and testing IEEE Trans Pattern Anal Mach Intell 2005 27 590 602 15794163
Su Z Wang Y Shi R Zeng W Sun J Luo F Gu X Optimal mass transport for shape matching and comparison IEEE Trans Pattern Anal Mach Intell 2015a In Press
Su Z Zeng W Wang Y Lu ZL Gu X Ourselin S Alexander DC Westin CF Cardoso MJ Shape classification using wasserstein distance for brain morphometry analysis Information Processing in Medical Imaging 2015b Springer International Publishing 411 423 volume 9123 of Lecture Notes in Computer Science
Tao X Han X Rettmann ME Prince JL Davatzikos C Information Processing in Medical Imaging 2001 17th International Conference, IPMI 2001 Davis June 18–22, 2001 CA, USA Berlin, Heidelberg Springer Berlin Heidelberg 475 487 Proceedings. chapter Statistical Study on Cortical Sulci of Human Brains
Thompson PM Hayashi KM Sowell ER Gogtay N Giedd JN Rapoport JL de Zubicaray GI Janke AL Rose SE Semple J Doddrell DM Wang Y van Erp TG Cannon TD Toga AW Mapping cortical change in Alzheimer’s disease, brain development, and schizophrenia NeuroImage 2004 23 S2 S18 15501091
Thompson PM Hayashi KM de Zubicaray G Janke AL Rose SE Semple J Herman D Hong MS Dittmer SS Doddrell DM Toga AW Dynamics of gray matter loss in Alzheimer’s disease J. Neurosci 2003 23 994 1005 12574429
Thurston WP Geometry and Topology of Three-Manifolds Princeton lecture notes 1976
Tosun D Prince JL A geometry-driven optical flow warping for spatial normalization of cortical surfaces IEEE Trans Med Imaging 2008 27 1739 1753 19033090
Trouvé A Diffeomorphisms groups and pattern matching in image analysis Int. J. Comput. Vision 1998 28 213 221
Vaillant M Davatzikos C Finding parametric representations of the cortical sulci using an active contour model Med Image Anal 1997 1 295 315 9873912
Van Essen DC A Population-Average, Landmark- and Surface-based (PALS) atlas of human cerebral cortex Neuroimage 2005 28 635 662 16172003
Van Essen DC Drury HA Dickson J Harwell J Hanlon D Anderson CH An integrated software suite for surface-based analyses of cerebral cortex J Am Med Inform Assoc 2001 8 443 459 11522765
Van Essen Lab Caret: Operations/surface based registration 2012 http://brainvis.wustl.edu/wiki/index.php/Caret:Operations/SurfaceBasedRegistration
Wachinger C Golland P Kremen W Fischl B Reuter M BrainPrint: A discriminative characterization of brain morphology Neuroimage 2015 109 232 248 25613439
Wang G Wang Y Multi-scale Heat Kernel based Volumetric Morphology Signature Med Image Comput Comput Assist Interv 2015 9351 751 759 26550613
Wang Y Dai W Chan TF Yau ST Toga AW Thompson PM Teichmüller shape space theory and its application to brain morphology Med. Image Comp. Comput.-Assist. Intervention, Proceedings 2009a
Wang Y Dai W Gu X Chan TF Toga AW Thompson PM Studying brain morphology using Teichmüller space theory Computer Vision, 2009. ICCV 2009. IEEE 12th International Conference on 2009b 2365 2372
Wang Y Shi J Yin X Gu X Chan TF Yau ST Toga AW Thompson PM Brain surface conformal parameterization with the Ricci flow IEEE Transactions on Medical Imaging 2012 31 251 264 21926017
Wang Y Song Y Rajagopalan P An T Liu K Chou YY Gutman B Toga AW Thompson PM Surface-based TBM boosts power to detect disease effects on the brain: an N=804 ADNI study Neuroimage 2011 56 1993 2010 21440071
Wang Y Yuan L Shi J Greve A Ye J Toga AW Reiss AL Thompson PM Applying tensor-based morphometry to parametric surfaces can improve MRI-based disease diagnosis Neuroimage 2013 74 209 230 23435208
Wink AM Roerdink JB Denoising functional MR images: a comparison of wavelet denoising and Gaussian smoothing IEEE Trans Med Imaging 2004 23 374 387 15027530
Yeo BT Sabuncu MR Vercauteren T Ayache N Fischl B Golland P Spherical demons: fast diffeomorphic landmark-free surface registration IEEE Trans Med Imaging 2010 29 650 668 19709963
Younes L Shapes and Diffeomorphisms 2010 Springer
Younes L Arrate F Miller MI Evolutions equations in computational anatomy Neuroimage 2009 45 40 50
Younes L Michor P Shah J Mumford D A metric on shape space with explicit geodesics Atti Accad. Naz. Lincei Cl. Sci. Fis. Mat. Natur 2008 19 25 57
Zeng W Samaras D Gu X Ricci flow for 3D shape analysis IEEE Transactions on Pattern Analysis and Machine Intelligence 2010 32 662 677 20224122
Zeng W Shi R Wang Y Yau ST Gu X Teichmüller shape descriptor and its application to alzheimer’s disease study International Journal of Computer Vision 2012 105 155 170
Zhang J Shi J Stonnington CM Li Q Gutman BA Chen K Reiman EM Caselli RJ Thompson PM Ye J Wang Y Hyperbolic space sparse coding with its application on prediction of alzheimer’s disease in mild cognitive impairment. International Conference on Medical Image Computing and Computer Assisted Intervention (MICCAI) 2016
Zhong J Phua DY Qiu A Quantitative evaluation of LDDMM, FreeSurfer, and CARET for cortical surface mapping Neuroimage 2010 52 131 141 20381626
