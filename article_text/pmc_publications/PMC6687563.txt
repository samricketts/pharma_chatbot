LICENSE: This file is available for text mining. It may also be used consistent with the principles of fair use under the copyright law.


9885960
29671
IEEE Trans Pattern Anal Mach Intell
IEEE Trans Pattern Anal Mach Intell
IEEE transactions on pattern analysis and machine intelligence
0162-8828
1939-3539

30763239
6687563
10.1109/TPAMI.2019.2898400
NIHMS1029305
Article
Hyperbolic Wasserstein Distance for Shape Indexing
Shi Jie
Wang Yalin
Alzheimer’s Disease Neuroimaging Initiative
School of Computing, Informatics, and Decision Systems Engineering, Arizona State University, Tempe, AZ 85281.
jshi28@asu.edu.
29 5 2019
08 2 2019
6 2020
01 6 2021
42 6 13621376
This file is available for text mining. It may also be used consistent with the principles of fair use under the copyright law.
Shape space is an active research topic in computer vision and medical imaging fields. The distance defined in a shape space may provide a simple and refined index to represent a unique shape. This work studies the Wasserstein space and proposes a novel framework to compute the Wasserstein distance between general topological surfaces by integrating hyperbolic Ricci flow, hyperbolic harmonic map, and hyperbolic power Voronoi diagram algorithms. The resulting hyperbolic Wasserstein distance can intrinsically measure the similarity between general topological surfaces. Our proposed algorithms are theoretically rigorous and practically efficient. It has the potential to be a powerful tool for 3D shape indexing research. We tested our algorithm with human face classification and Alzheimer’s disease (AD) progression tracking studies. Experimental results demonstrated that our work may provide a succinct and effective shape index.

Index Terms

Shape space
hyperbolic conformal geometry
Wasserstein distance
shape indexing

1 Introduction

With the rapid development of 3D imaging and scanning techniques, 3D surface-based representations of real-life objects are becoming more popular. Effective algorithms to store, classify, and retrieve 3D surface models are highly demanded. Shape indexing refers to the process to extract concise, refined, and meaningful shape descriptors from 3D models to represent the geometric or topological features that are able to accurately describe the similarities and dissimilarities between different shapes. The shape space [1] provides a suitable tool for shape indexing research. Commonly used shape space models include the Kendall’s space [2], the space of diffeomorphisms [3], the Gromov-Hausdorff space [4] and the Techmüller space [5], etc. Recently, the Wasserstein space, which consists of all probability measures that are defined on a Riemannian manifold, is attracting more attention. Wasserstein distance (also known as earth mover’s distance [6]) defines a Riemannian metric for the Wasserstein space and it intrinsically compares the similarities between different shapes. The advantages of the Wasserstein distance include:

Accuracy. The Wasserstein space is continuous [7]. Thus the geodesic distance in Wasserstein space is known for its high accuracy and robustness for nearest neighbor retrievals or distribution comparison. This property makes Wasserstein distance attractive for 3D image analysis study, where a high accuracy is usually required.

Efficiency. The Wasserstein distance is computed by the optimal mass transportation (OMT) map [8], which can be efficiently solved by the Monge-Brenier optimization [8]. Given the enormous amount of 3D geometric data being generated daily, the Wasserstein distance may provide an effective solution for 3D shape indexing research.

Robustness to Noise. The Wasserstein distance considers a transportation between two probability measures on a canonical image or surface, so it is robust to image noise. It has the potential to quantitatively measure 3D shapes reconstructed from images and provide a theoretically rigorous foundation for 3D shape analysis.

Wasserstein distance has been well studied and widely applied in image processing and shape analysis research. By measuring the similarities between normalized histograms, Ni et al. [9] proposed a nonparametric region-based active contour model for image segmentation. Schmitzer et al. [10] introduced a functional for variational object segmentation and shape matching. By interpreting the image intensities as the probability measure distribution, the Wasserstein distance is naturally applied for image comparison. A linearized Wasserstein distance was proposed in [11], to efficiently quantify and visualize variations in large sets of images. While these methods work well with 2D images, the Wasserstein distance cannot be directly applied to 3D-surface based shape analysis. In differential geometry, a surface is a two dimensional manifold that can be embedded in 3D real space ℝ3. Suppose M is a surface, {Uα}, α = 1, 2, …, is an open covering of M, thus M ⊂ ∪α{Uα}. If for each Uα, there is a homeomorphism ϕα:Uα→E2, where E2 is the Euclidean plane, then (Uα, ϕα) is a chart and M is a topological surface. This work is based on topological surfaces. So we use the terms surface and topological surface interchangeably in this paper. The Wasserstein distance computation was extended to Riemannian manifolds in [12] and the conformal Wasserstein distance was studied between disk-type surfaces [13], [14] and genus-0 closed surfaces [15]. Later, an entropic regularization was proposed in [16] to reduce Wasserstein distance computational cost and the algorithm was extended to geometric domains in [17]. To date, few studies have investigated the Wasserstein distance between general topological surfaces.

In practice, many 3D shapes have more complicated topology than disk-type and genus-0 closed surfaces. They are either high-genus surfaces or genus-0 surfaces with multiple (more than 2) open boundaries. We call them general topological surfaces. For example, in brain imaging research, landmark curves are often added on cortical surfaces to denote important common sulcus patterns across subjects [18]. One approach is to model these curves as surface boundaries by cutting open cortical surfaces along these landmarks. Thus they are modeled as open boundaries to be matched across subjects [19], [20] or be used as shape indices [5], [21]. Existing algorithms for Wasserstein space study are unable to compute Wasserstein distance on such surfaces. This paper proposes a novel framework to tackle this problem by integrating hyperbolic Ricci flow [22], [23], hyperbolic harmonic map [20], surface tensor-based morphometry (TBM) [24], [25], and the OMT map [8], [26]. We extend the OMT map and Wasserstein distance computation to the hyperbolic space, i.e., the Poincaré disk. The resulting Wasserstein distance is called hyperbolic Wasserstein distance [27] and may provide an important tool for general topological surface indexing research.

This paper applies the hyperbolic Wasserstein distance to index and compare genus-0 surfaces that have multiple (more than 2) open boundaries, which are called multiply connected surfaces. Figure 1 (a) is an example of the multiply connected surfaces, which is a human face surface with 4 open boundaries, denoted as γ0, γ1, γ2, γ3, respectively. We tested the proposed algorithm with shape classification study on human face surfaces from different people and Alzheimer’s disease (AD) progression tracking using 3D cortical surface models. Experimental results demonstrate that the hyperbolic Wasserstein distance is promising to be a novel, refined and effective tool for general shape indexing.

In summary, major contributions of this paper are:

we propose a novel algorithm to compute the Wasserstein distance between general topological surfaces based on hyperbolic Riemannian metric, which may provide a powerful single shape index to characterize surfaces with complicated topology;

we extend the OMT map to the hyperbolic Poincaré disk, which greatly enhances its applicability for general topological surface analysis;

we deploy a general framework that may be applicable for other shape space work. Most shape space studies in the literature only work with genus-0 surfaces (e.g. [28], [29], [30]), which cannot be easily extended to high-genus surfaces, due to the fact that most high-genus surfaces are not conformally equivalent so it is difficult to build a canonical space for them. Our framework adopts the hyperbolic Ricci flow [22], [23] and hyperbolic harmonic map [20] to build diffeomorphic matchings between general topological surfaces and may help generalize other shape space algorithms to general topological surfaces as well.

2 Previous Work

2.1 Shape Space

The manifold shape space research was pioneered by [2]. In the Kendall’s space, Brignell et al. [31] modeled brain surfaces as star-shaped objects and computed a radial function which measures the size and shape of the brain surfaces. This work has been applied to study brain shape asymmetry in schizophrenia [31]. In the computational anatomy framework, the space of diffeomorphisms was carefully studied [3], [32]. In [33], [34], shape space was defined as the space of orbits of the reparameterization group acting on the space of immersions and measures the similarities between two shapes by the deformation between them. Various reparameterization invariant (RI) metrics were defined with the immersion f, using its volume form and mean curvature [35], or its area multiplication factor [28]. A metric that is invariant to Möbius transformations was introduced in [13] for shape comparison based on conformal uniformization and OMT. Later, the convergence analysis of the arising mass transportation problems was provided in [36]. The Gromov-Wasserstein distance between metric spaces was introduced in [4] as isometry invariance for shape matching and comparison.

2.2 Optimal Mass Transportation

The optimal mass transportation (OMT) problem was raised by Monge [37] and its existence and uniqueness were proved in [26] with linear programming. The Monge-Kantorovich optimization has numerous applications in various fields, including physics, economics, computer science, etc. [38]. The OMT also provides a powerful tool for image processing [39], [40]. However, the high computational cost of the Monge-Kantorovich optimization greatly limits its applications in many fields. An alternative optimization method, the Monge-Brenier optimization [8], can significantly reduce the time complexity of the OMT. Based on this method, the OMT has been applied in blue noise generation [41], 2D shape reconstruction and simplification [42], area preserving mappings of 3D surfaces [14], and conformal Wasserstein distance computation [14].

2.3 Shape Indexing

In literature, Many shape indexing algorithms have been proposed and studied (as reviewed in [43]). The spherical harmonics [44], [45] are widely used to compare and match surfaces that are homotopic to spheres. The heat kernel signature (HKS) describes each surface point’s local and global geometric information using heat diffusion method [46]. The HKS is invariant to isometric transformations and has extensive applications in shape classification [47], matching [46], and retrieval [48]. The medial representations or m-reps [49] of surfaces encode rich information about local shape variants and are used in many shape analysis applications [50], [51]. Rooted in conformal geometry, the histogram of the conformal factors was used in [52] to characterize different shapes and it is invariant to both rigid motions and pose changes. If two surfaces can be conformally mapped to each other, they are conformally equivalent and share the same coordinate in the Teichmüller shape space. Teichmüller space coordinate based shape indices are invariant to conformal mappings and have been widely applied in computer vision [22] and brain imaging [5], [21] research. Additionally, spectral l2 distance provides a rigorous comparison of shape differences based on intrinsic geometry. It has been applied for major sulci identification on vervet cortices [53].

3 Theoretical Background

3.1 Conformal Mapping

Given a surface S∈ℝ3, its Riemannian metric g is a tensor that defines an inner product on the tangent space of S. Simply speaking, g is the unit for measuring curve length on S. Let ϕ : (S1, g1) → (S2, g2) be a diffeomorphic map between two Riemannian manifolds S1 and S2. If the pullback metric of ϕ, ϕ*g2, differs from g1 by a scalar, as defined by ϕ*g2 = e2λg1, then ϕ is a conformal map from S1 to S2, where λ:S1→ℝ is the conformal factor.

Definition 1 (Surface Ricci Flow) [54]: Given a surface (S, g), the normalized surface Ricci flow is defined as dg(t)dt=(4πχ(S)A(0)−2K(t))g(t), where A(0) is the total area of S at time 0, χ(S) is the Euler characteristic number of S and K(t) is the Gaussian curvature of S at time t.

Surface Ricci flow is based on the fact that there is a correspondence between the Riemannian metric g and the surface Gaussian curvature K. It conformally deforms the metric to induce constant or user-defined Gaussian curvature on S [22]. It has been proved that if χ(S) &lt; 0, the solution to the normalized Ricci flow equation exists for all t &gt; 0 and converges to a metric with constant Gaussian curvature 2πχ(S)A(0) [54]. With conformal mapping, which constrains g(t) = eλ(t)g(0), we obtain the following simplified Ricci flow equation: (1) dλ(t)dt=−2K(t)

Proof of the above equation can be found in [19].

Theorem 1 (Klein-Poincaré Uniformization Theory): All compact surfaces can be conformally mapped to one of three canonical spaces with constant Gaussian curvatures, i.e., the unit sphere with Gaussian curvature 1, the 2D Euclidean plane with Gaussian curvature 0, and the hyperbolic disk with Gaussian curvature −1, depending on the Euler number of the surface is positive, zero, or negative, respectively. In other words, surfaces with Euler numbers χ &gt; 0 can be conformally mapped to the unit sphere S2, surfaces with χ = 0 to the Euclidean plane E2, and surfaces with χ &lt; 0 to the hyperbolic space ℍ2. The surface metric corresponding to the constant Gaussian curvature is the uniformization metric, which is conformal to the original Euclidean metric.

Definition 2 (Fundamental Group and Fuchsian Group): Let (S, g) be a surface with Euler number χ(S) &lt; 0 and its hyperbolic uniformization metric is g¯. Let p ∈ S be a base point, if two loops through p can deform to each other without leaving S, then they are homotopic to each other. All the homotopic classes of loops form the fundamental group of S. By slicing S along the fundamental group of loops, we obtain the simply connected domain of S, i.e., a genus-0 surface with a single boundary, denoted as S¯. For multiply connected surfaces, their fundamental groups consist of paths that connect existing boundaries. Fig. 1 (a) shows a multiply connected surfaces with 4 boundaries (γ0, γ1, γ2, γ3). As illustrated in Fig. 1 (b), its fundamental group consists of 3 paths, which are denoted as τ1, τ2, τ3. Then (S¯,g¯) denotes the fundamental domain of S, which is an embedding of S in ℍ2, as shown in Fig. 1 (c). A Fuchsian transformation ϕ is a Möbius transformation (Eq. 3) that maps (S¯,π), where π:S¯→S is a local homeomorphism, to another period and preserves the projection π ○ ϕ = π. All Fuchsian transformations form the Fuchsian group of S. Figure 1 (d) illustrates one of the Fuchsian transformations that maps the surface in Fig. 1 (c) to a different location. With the Fuchsian group of transformations, we can tile the universal covering space of S. For a surface with a negative Euler number, its universal covering space is the entire Poincaré disk, as introduced below.

Definition 3 (Hyperbolic Geometry): We use the Poincaré disk model to visualize the hyperbolic space ℍ2. Poincaré disk is the unit disk in the complex plane {z∈ℂ,|z|&lt;1} with the Riemannian metric ds2=4dzdz¯(1−zz¯)2, as shown in Fig. 2 (a). Given two points z1, z2 in the Poincaré disk, the hyperbolic distance between them is defined as (2) dist(z1,z2)=tanh−1|z1−z21−z1z¯2|

The rigid motion in the Poincaré disk is the Möbius transformation (3) z→eiθz−z01−z¯0z

A geodesic (hyperbolic line) in the Poincaré disk is a circular arc that is perpendicular to the unit circle, as illustrated in Fig. 2 (b). A hyperbolic circle (c, r), where c is the center and r is the radius, is similar to a Euclidean circle (C, R), with C=2−2μ21−μ2|c|2 and R2=|C|2−|c|2−μ21−μ2|c|2, where μ=er−1er+1.

Another hyperbolic model that can be visualized is the Klein model, where hyperbolic lines coincide with Euclidean lines, as shown in Fig. 2 (c). The conversion of the Poincaré disk to the Klein model is defined as (4) z→2z1+z¯z

The Poincaré disk model is conformal to the Euclidean geometry, while the Klein model is not.

3.2 Harmonic Map

Given a surface (S, g), if its local coordinates (x, y) satisfy g=e2λ(x,y)(dx2+dy2)=e2λ(x,y)dzdz¯, where λ is the conformal factor and z is the complex parameter, with z = x+iy, dz = dx+idy, dz¯=dx−idy, (x, y) are called the isothermal coordinates of S. Given a map f : (S1, g1) → (S2, g2), where g1=σ(z)dzdz¯, g2=ρ(w)dwdw¯, z,w are the isothermal coordinates on S1 and S2, respectively. Locally, we denote the mapping as w = f(z) or w(z). We call S1 the source surface and S2 the target surface. Then the harmonic energy of map f is defined as (5) E(w)=∫S1ρ(w(z))(|wz|2+|wz¯|2)dxdy

where wz=12(∂w∂x−i∂w∂y), wz¯=12(∂w∂x+i∂w∂y).

The map f is a harmonic map if it is a critical point of the harmonic energy. The necessary condition for f to be a harmonic map is that it satisfies the Euler-Lagrange equation: (6) wzz¯+ρw(w)ρ(w)wzwz¯≡0

The harmonic energy (Eq. 5) depends on the Riemannian metric of the target surface and the conformal structure of the source surface. If the Riemannian metric on the source surface deforms conformally, the harmonic energy will not change [20]. The following theorem shows that the harmonic map with hyperbolic metrics is unique and diffeomorphic within a fixed homotopic class.

Theorem 2 (Yau) [55]: Suppose f : (S1, g1) → (S2, g2) is a degree-one harmonic map and g2 induces negative Gaussian curvature, then for each homotopic class, the harmonic map is unique and diffeomorphic.

3.3 Optimal Mass Transportation Map and Wasserstein Distance

Let (S, g) be a Riemannian manifold with metric g. We define two probability μ measures ν and on (S, g) and μ, ν have the same total mass, i.e., ∫Sμ = ∫Sν. Let ϕ : S → S be a diffeomorphic map that establishes the correspondence between μ and ν. The pullback measure induced by ϕ is ϕ*ν = det(J)ν ○ ϕ, where J is the Jacobian matrix of ϕ. If ϕ*ν = μ, then ϕ is a measure-preserving map. The transportation cost of ϕ is (7) cost(ϕ)=∫Sdg2(p,ϕ(p))μ(p)dp

where p ∈ S is a vertex and dg(p, ϕ(p)) is the geodesic distance between p and its image ϕ(p) under the metric g. The optimal mass transportation (OMT) problem finds the measure-preserving map between two probability measures that uses the minimal transportation cost (Eq. 7). The OMT induces the Wasserstein distance.

Definition 4 (Wasserstein Distance): Let Pj(S) be the space of all probability measures μ on S with finite jth moment, where j ≥ 1. For some point p0 ∈ S ∫Sdgj(p,p0)μ(p)dp&lt;∞. Given two probability measures μ, ν ∈ Pj(S), the Wasserstein distance between them is defined as the transportation cost of the OMT map ϕ : Sμ → Sν: (8) Wj(μ,ν)=infϕ*ν=μ(∫Sdgj(p,ϕ(p))μ(p)dp)1j

Theorem 3 [7]: The Wasserstein distance (Eq. 8) is a Riemannian metric of the space Pj(S).

Definition 5 (Wasserstein Space): The space Pj(S) equipped with the Wasserstein distance forms a metric space (Pj(S), Wj) and the metric space is called the Wasserstein space [7].

4 Algorithms

Our computational framework with multiply connected surfaces as an application example is summarized in Algorithm 1 and illustrated in Fig. 3, where we use a left cerebral hemisphere surface with 6 boundaries being cut open along 6 landmark curves.

4.1 Discrete Hyperbolic Ricci Flow

We use triangular meshes to approximate smooth surfaces in our algorithm implementation. Let M(V, E, F) be a triangular mesh, where V is the vertex set, E is the edge set, and F is the triangular face set. A vertex is denoted as vi, an edge connecting the vertices vi and vj is denoted as eij, a triangular face formed by the vertices vi, vj, vk is denoted as fijk, the corner angle attached to vertex vi in the face fijk is denoted as θijk. In hyperbolic geometry, every face is a hyperbolic triangle, as shown in Fig. 4 (a). The discrete Riemannian metric is a function defined on each edge l:E→ℝ+ and in each face fijk, it satisfies the triangle inequality, i.e., lij + ljk &gt; lki. Usually, it is the edge length.

The discrete Gaussian curvature on a vertex vi ∈ M can be computed by the angle deficit, (9) Ki={2π−∑fijk∈Fθijk,vi∉∂Mπ−∑fijk∈Fθijk,vi∈∂M

where ∂M represents the boundary of M.

In hyperbolic Ricci flow computation, corner angles in each hyperbolic triangle are computed with the hyperbolic cosine law: (10) θi=cos−1cosh(lij)cosh(lki)−cosh(ljk)2sinh(lij)sinh(lki)

where sinh(l)=el−e−l2 and cosh(l)=el+e−l2.

Theoretically, a conformal mapping maps infinitesimal circles on one surface to infinitesimal circles on another surface and preserves the intersection angles among the circles. In discrete setting, the circle packing metric [56] of a surface approximates the infinitesimal circles with finite circles. The circle packing metric consists of two functions, a vertex radius function r and an edge weight function Φ. The function r:V→ℝ+ assigns a real positive value ri on each vertex vi, which represents the radius of a circle that centers at vi. The function Φ: E → [0, π/2] assigns a real positive weight value ϕij on each edge eij, which represents the intersection angle between the circles that center at two vertices of the edge eij. The circle packing metric on a hyperbolic triangle is illustrated in Fig. 4 (b). Ricci flow can be implemented with the circle packing metric by changing the vertex radius function and keeping the edge weight function unchanged. The result is a surface with changed metric and preserved angles.

With circle packing metric, the length of the edge eij can be computed with the hyperbolic cosine law as: (11) lij=cosh−1(cosh(ri)cosh(rj)+cos(ϕij)sinh(ri)sinh(rj))

Let Λ=(λ1,λ2,…,λn):V→ℝ be the conformal factor vector, where n is the number of vertices on the mesh M. We define [22], [23] (12) λi=log(tanhri2)

The discrete Ricci flow is defined in exactly the same form as the continuous Ricci flow equation (Eq. 1) [19], [22] (13) dλi(t)dt=−2Ki(t)

Let Λ0 = (0, 0, …,0) be the conformal factor vector at time 0, the discrete hyperbolic Ricci energy is defined as [19], [22] (14) f(Λ)=∫Λ0Λ∑i=1nKidλi

The discrete Ricci flow (Eq. 13) is the negative gradient flow of the hyperbolic Ricci energy. Thus, the hyperbolic Ricci energy can be minimized with the gradient descent method using (Eq. 13) [23].

The discrete hyperbolic Ricci flow algorithm with gradient descent optimization is described in Algorithm 2. For more details of hyperbolic Ricci flow and the stabler Newton’s optimization, please refer to [21], [22].

4.2 Poincaré Disk Embedding

With the hyperbolic uniformization metric, we can embed the surface M onto the Poincaré disk. The simply connected domain of M should be obtained by computing its fundamental group for 2D embedding. This work computes the fundamental group of a multiply connected surface by choosing the longest boundary on it and tracing a path from that boundary to one of the endpoints of every other boundary. The paths are traced with Dijkstra’s algorithm with avoidance of collisions [57]. An example is illustrated in Fig. 5 (a-b) with the cortical surface in Fig. 3 (a), where the six landmark curves are modeled as open boundaries and denoted as {γ1, γ2, γ3, γ4, γ5, γ6}. The fundamental group of paths are computed by connecting boundary γ5 to every other boundary and the path to boundary γi is denoted as τi. By slicing M along the fundamental group of paths, we obtain its simply connected domain M¯. The Poincaré disk embedding process is detailed in Algorithm 3. Given the Riemannian metric of the Poincaré disk model, the conformal factor near boundaries of the embedding goes to infinity. This may introduce instability in the following computations, especially for complicated surfaces as those of human cortices. To address this problem, in the embedding algorithm, we pick the seed face f012 to be a triangle that is close to the center of the fundamental domain of each surface. As a result, the embedding is close to the center of the Poincaré disk. The fundamental domain of surface M is shown in Fig. 5 (c).

4.3 Geodesic Curve Lifting

As shown in Fig. 5 (c), in the fundamental domain of the surface M, existing boundaries {γ1, γ2, γ3, γ4, γ5, γ6} on M become geodesics on the Poincaré disk. However, the paths in the fundamental domain are not geodesics and as the paths tracing algorithm depends on the geometry of each 3D surface, they are not consistent across subjects either. Thus the fundamental domain of a multiply connected surface cannot serve as the canonical parameter space for surface registration [23]. We solve this problem by applying a geodesic curve lifting step to achieve consistent boundaries with the Fuchsian group of M [23]. In the fundamental domain, each path τi is split to two identical halves, τi+ and τi˙−. There exists a unique Möbius transformation from τi+ to τi˙− and another unique Möbius transformation from τi˙− to τi+. All these Möbius transformations form the Fuchsian group of the surface M. Any other Möbius transformation on M can be obtained by composing the Fuchsian group of transformations, so they are called the Fuchsian group generators.

We explain the details for computing the Möbius transformation from τi+ to τi˙− and others can be obtained with the same method. As illustrated in Fig. 6 (a), counterclockwisely, we denote the starting and ending points of each side as ∂τi+=(pi+,qi+) and ∂τi−=(qi−,pi−). In the Poincaré disk, the geodesic distance from pi+ to qi+ equals the geodesic distance from pi− to qi−. Firstly, we compute a Möbius transformation ti+ to map pi+ to the origin and qi+ to a real positive number, with (15) ti+=eiθi+z−pi+1−zpi+¯,θi+=arctan(pi+−qi+1−pi+¯qi+)

Similarly, we can compute the Möbius transformation to map pi− to the origin and qi− to a real positive number. The transformations are illustrated in Fig. 6 (a). Then with the requirement that ti+(qi+)=ti−(qi−), we obtain the final Möbius transformation ti=(ti−)−1°ti+, which satisfies ti(pi+)=pi− and ti(qi+)=qi−. As shown in Fig. 6, the fundamental domain above the u axis in (a) is transformed to the red region in (b) and it can be glued with the original fundamental domain. As a result, a finite portion of the universal covering space, i.e., the entire Poincaré disk, can be tiled by mapping a fundamental domain to other periods with the Fuchsian transformations and gluing the transformed fundamental domains with the original fundamental domain, as shown in Fig. 6 (c). In the universal covering space, we recompute the positions of τi+ and τi˙− as geodesics, which are the hyperbolic lines that are perpendicular to the unit circle and cross certain points in the Poincaré disk. In this paper, similar to our prior work [23], we enforce them to cross the endpoints of existing boundaries. These geodesics are unique and consistent across subjects [22], [23], as shown in Fig. 6 (d). By slicing the universal covering space along the new geodesics, we obtain the canonical fundamental domain of the multiply connected surface M, as shown in Fig. 3 (f). To ensure the stability of geodesic computation near the boundaries, we only tile a finite portion of the Poincaré disk by gluing each undetermined boundary τi+/− with a transformed fundamental domain. When lifted to 3D, the positions of τis are also consistent across subjects. Figure 7 shows two cortical surfaces from different people, although their geometry is different from each other, the recomputed fundamental group of paths are consistent.

4.4 Initial Map Construction

In the canonical fundamental domain of the surface M, all boundaries become geodesic curves. Thus the canonical fundamental domain is consistent across different subjects. We convert the canonical Poincaré disk to the Klein model with Eq. 4. The result is a hyperbolic polygon which coincides with a Euclidean polygon, as shown in Fig. 3 (g). We use the Klein disk as the canonical space to construct the initial map between the surface M and the template surface with the constrained harmonic map [19], [23].

Briefly, given two multiply connected surfaces M and N which are homotopic to each other, both of them are mapped to the Klein disk using above algorithms. A map f : M → N is harmonic if Δf ≡ 0. To solve the Laplace equation, corresponding boundaries on the two Klein polygons are used as boundary conditions and are enforced to be aligned with each other with linear interpolation by the arc length parameter. With the finite element definition of the Laplace operator, the initial map can be constructed efficiently by solving a linear sparse system [20]. As proved in [55], if the target domain is convex, the planar harmonic maps are diffeomorphic. Thus, the initial map is diffeomorphic.

In computation, the infinite conformal factor near Poincaré disk boundary may cause the initial map computation to fail. In our framework, we solve this problem by decomposing the canonical fundamental domain of each surface into smaller patches and matching corresponding patches in different surfaces. As illustrated in Fig. 8, suppose (a) and (e) are the canonical fundamental domains of surfaces M and N, respectively. We compute consistent geodesics to decompose the domain into 5 patches, as shown by the red lines in (a) and (e). For each patch, we move it to the center of the Poincaré disk by a Möbius transformation, as shown in (b) and (f). We then convert each small patch to the Klein model, as shown in (c) and (g). After matching corresponding Klein patches across subjects, we convert the Klein patches back to the Poincaré disk model and move them back to their original positions in the canonical fundamental domain using the inverse Möbius transformation. By gluing the matched small patches together, we obtain the initial map among surfaces. As shown in Fig. 8 (h), the canonical fundamental domain of surface N is registered to surface M (Fig. 8 (d)).

4.5 Hyperbolic Harmonic Map

We further improve the initial map to a hyperbolic harmonic map [20], as shown in Fig. 3 (h). The harmonic maps have many advantages, including 1) they measure the elastic energy of the deformations, so they are physically natural; 2) they can be computed by solving an elliptic partial differential equation, so they are numerically stable and efficient; 3) they are diffeomorphic for planar convex domains; 4) they continuously depend on the boundary condition, so they can be controlled by adjusted boundaries conditions. The hyperbolic harmonic map has been explored in [20] to compute a global diffeomorphic correspondence between multiply connected surfaces. The current work incorporates the hyperbolic harmonic map to build a canonical space for hyperbolic Wasserstein distance computation.

Suppose (M, gM) and (N, gN) are two manifolds, where gM, gN are their hyperbolic uniformization metrics, respectively. We denote their local isothermal coordinates as z and w and the initial map as f : M → N and f(z) = w(z). The hyperbolic harmonic map can be computed with the following gradient descent equation: (16) dw(z,t)dt=−[wzz¯+ρw(w)ρ(w)wzwz¯]

where ρ(w)=4(1−ww¯)2 is the hyperbolic metric in the Poincaré disk. Algorithm 4 gives the computation details.

Suppose pi ∈ M is a vertex and it has local coordinate zi. After the hyperbolic harmonic diffusion process, zi obtains a new local position w(zi) and w(zi) is inside of a triangle t(pi) = [wi, wj, wk] on the Poincaré disk embedding of surface N. We then denote the image of pi with the pair of (t(pi), η(pi)), where η(pi) is the complex cross ratio of the four vertices (w(zi), wi, wj, wk)η(pi)=[w(zi),wi;wj,wk]=(w(zi)−wj)(wi−wk)(w(zi)−wk)(wi−wj). All local coordinate transitions in the conformal parameter space of surfaces M and N are Möbius transformations and the cross ratio η is invariant to Möbius transformations. Thus the image representation pi → (t(pi), η(pi)) is independent of the choice of local coordinates [20]. Furthermore, as the geodesics computed in Sec. 4.3 should be continuous on 3D surfaces, it ensures the hyperbolic harmonic map cross these geodesics with the Fuchsian group of transformations [20]. Furthermore, as the geodesics computed in Sec. 4.3 should be continuous on 3D surfaces, it ensures the hyperbolic harmonic map cross these geodesics with the Fuchsian group of transformations [20].

4.6 Surface Tensor-based Morphometry

Surface tensor-based morphometry (TBM) [24], [25] measures the amount of local area atrophy or enlargement in an individual surface with respect to the template surface. We use surface TBM to define the probability measures on the Poincaré disk. Given two surfaces M and N, suppose f : M → N is the hyperbolic harmonic map between them. The derivative map of f is the linear map between the tangent spaces df : TM(p) → TM(f(p)), induced by f, where p is a vertex on M. The map df defines the Jacobian matrix of f and TBM is defined as the determinant of the Jacobian matrix. In discrete setting, the TBM, T, is the area ratio of triangles on M to corresponding triangles on N. It is used to build probability distributions on two surfaces.

4.7 Discrete Optimal Mass Transportation Map and Hyperbolic Wasserstein Distance

Following [14], [15], We compute the discrete OMT map between two probability measures that are defined on surfaces with power Voronoi diagram [58], [59]. The power Voronoi diagram is a generalized Voronoi diagram [59]. It defines a partition of a plane into polygonal cells using a set of circles. A cell spanned by a circle C includes all points whose power distances to the circle center are smaller than those to other circle centers.

Definition 6 (Power Voronoi Diagram) [58], [59]: Given a Riemannian manifold (S, g), let P = {p1, p2, …,pn} be a point set on S and its weight vector W={w1,w2,…,wn}∈ℝ the power Voronoi diagram induced by (P, W) is a cell decomposition of S, such that the cell spanned by point pi is given by (17) Cell(pi)={p∈S|dg2(p,pi)−wi≤dg2(p,pj)−wj},i,j=1,2,…,n and i≠j

Here, dg2(p,pi)−wi is the power distance between p and pi. In other words, P and W are the centers and radii of the circles that define the cell decomposition, respectively. The power Voronoi diagram reduces to a Voronoi diagram if all circles have equal radii, i.e., w1 = w2 = … = wn.

Our work extends the power Voronoi diagram to the hyperbolic space. Specifically, we define the geodesic distance dg in Eq. 17 between two points as the hyperbolic distance (Eq. 2) on the Poincaré disk. The resulting power Voronoi diagram is called hyperbolic power Voronoi diagram and all geodesics that partition the cells are hyperbolic lines. The proposed hyperbolic power Voronoi diagram is illustrated in Fig. 3 (i) and Fig. 9.

Theorem 4 (Riemannian Optimal Mass Transportation Map) [15]: Given a surface S with Riemannian metric g, suppose μ and ν are two probability measures defined on S and they have the same total mass. We define ν as a Dirac measure with the discrete point set support P = {p1, p2, …,pn} and denote ν(pi) = νi. There exists a weight vector W = {w1, w2, …,wn}, unique up to a constant, such that the power Voronoi diagram induced by (P, W) gives the OMT map between μ and ν: ψ: Cell(pi) → pi and ∫Cell(pi) dμ = νi, i ∈ [1, 2, …,n].

Furthermore, the optimal weight vector of the power Voronoi diagram which induces the OMT map can be computed by the following gradient descent equation: (18) dwidt=νi−∫Cell(pi)dμ

Theorem 4 provides a general framework to compute the Riemannian OMT. Here we explore the Riemannian OMT map on the Poincaré disk. Assume f : M → N is the hyperbolic harmonic map from surface M to target surface N, then dμ is defined as dμ = TγNdA, where T is the surface TBM of f, γN is the area ratio between area elements on N and their counterparts in the Poincaré disk embedding, and A is the hyperbolic area element. Similarly, we initialize νi = ∫Region(pi)γNdA, i ∈ [1, 2, …,n], where Region(pi) is the Voronoi diagram cell spanned by pi on the Poincaré disk to establish the Dirac measure. The details of the OMT map computation with hyperbolic metric are in Algorithm 5. In our prior work [14], we derived the Hessian matrix for the Euclidean variational OMT solution. Similarly, the Hessian matrix for hyperbolic OMT is under development.

The transportation cost of the OMT map that is computed by Algorithm 5 defines the Wasserstein distance between the probability measures μ and ν. With the hyperbolic metric in the Poincaré disk, the proposed hyperbolic Wasserstein distance is defined as (19) Wasserstein(μ,ν)=∑i=1n∫Cell(pi)(tanh−1|p−pi1−pp¯i|)2dμ(p)

The proposed hyperbolic Wasserstein distance quantitatively represents the similarities between probability measures μ and ν. The formulation is quite general and may analyze any probability distributions defined on general topological surfaces. Here we define the probability measures as the TBM statistic, which measures the deformation between two surfaces. As a result, the proposed hyperbolic Wasserstein distance eventually describes the morphometry similarities between two surfaces and may be used as a single shape index.

5 Experimental Results

5.1 Human Facial Expression Analysis

The first experiment applied the proposed hyperbolic Wasserstein distance to study 3D human facial expression. Human facial expression modeling is an interesting problem studied for a long time [60]. The goal is to discriminate and describe different human facial expressions. It is useful for face recognition and dynamical facial animation research.

We chose three face meshes from the BU-3DFE Database [61], including an angry face (Fig. 10, a), a happy face (Fig. 10, b), and a happier face (Fig. 10, c), which all belong to a randomly selected subject. On each face surface, we manually removed two eyes and the mouth along their boundaries, a common approach used in 3D face modeling [22]. The resulting facial surface became a genus-0 surface with four open boundaries. We used the happy face as the template surface to compute the hyperbolic harmonic map and the OMT map. First, we ran hyperbolic Ricci flow on the three surfaces and isometrically embedded them on the Poincaré disk, as shown in Fig. 10 (d-f). Then, the angry and happier faces were registered to the happy face with the hyperbolic harmonic map (Fig. 10, g). Finally, with the TBM measures, we constructed the OMT maps between both faces and the template face with the hyperbolic power Voronoi diagram (Fig. 10, h). Later, the hyperbolic Wasserstein distances between the angry face and the template face, and between the happier face and the template face, were computed as the costs of respective OMT maps. Intuitively, the happier face is more similar to the template, thus it should have smaller Wasserstein distance. The experimental results verified our intuition, where the hyperbolic Wasserstein distances for the angry face and happier faces are 25.94 and 11.75, respectively. Although multi-subject studies are clearly necessary, this experiment demonstrates that our hyperbolic Wasserstein distance may have the potential to quantify and measure human expression changes.

5.2 Human Face Classification

Face recognition is one of the most fundamental tasks in computer vision. Given the large amount of human face images and videos, a common practice for face recognition is to extract and store the most distinguishable features from the data. A testing subject is then recognized by matching its features to those in the database [62]. Recently, 3D facial recognition [63] is attracting more attention, as it is robust to lighting changes and can provide better results for face recognition. In [63], the isometric invariance was used as a shape descriptor for 3D face surfaces. A deformable model was proposed in [64] to parameterize 3D face shapes to 2D structures. Then the 2D structures were analyzed in the wavelet domain and the obtained spectral coefficients defined the features for comparing different subjects. In [22], conformal modules were used to index the amount of expression changes. In this experiment, we test the feasibility of our hyperbolic Wasserstein distance to serve as a shape index to represent a unique human face.

We randomly selected two people from the Texas 3D Face Recognition Database (Texas 3DFRD) [65], one with 39 scans and another with 46 scans. In Texas 3DFRD, each face image is marked with a set of consistent fiducial points, including the endpoints of eyes and mouth. We implemented the Dijkstra’s algorithm to trace paths between these endpoints to mark the positions of the eyes and the mouth. By slicing along these paths, each face surface was converted to a multiply connected surface. Fig. 11 shows some examples of the multiply connected surfaces from both subjects. We applied the proposed algorithm to these surfaces in the same way as in Sec. 5.1, with a template face surface which did not belong to either of the two people. Then, with the computed hyperbolic Wasserstein distances, we applied the complex tree in the Statistics and Machine Learning Toolbox of MATLAB1 as a classifier. With a 5-fold cross validation, our method achieved a classification rate of 88.2%.

We compared our method with the spectral l2 distance [53], which compares 3D shapes based on their intrinsic geometry. Briefly, the spectral l2 distance is computed by optimizing the Laplace-Beltrami space embeddings of 3D surfaces. This distance allows a rigorous comparison of surfaces. We also compared the hyperbolic Wasserstein distance with the surface area and mean curvature, which are important surface features and have been widely applied in face recognition [66], [67]. We applied the same classifier on these measurements with 5-fold cross validations. The comparison results are listed in Table 1. It can be noticed that our method significantly outperformed other methods. These comparisons demonstrated the effectiveness of our hyperbolic Wasserstein distance.

5.3 Cortical Shape Indexing

There is increasing interest in finding brain imaging biomarkers for AD tacking, detection, and diagnosis. In the clinical setting, a simple, universal, meaningful, and interpretable brain imaging index is highly desired by the physicians but remains challenging. In this experiment, we demonstrate the feasibility of our hyperbolic Wasserstein distance to index cortical shape morphometry for tracking AD progression. Cortical morphometry is a valid imaging biomarker for preclinical AD and has been widely analyzed in the literature [18], [69]. Here we test our method with the T1-weighted magnetic resonance images (MRIs), which were obtained from the Alzheimer’s Disease Neuroimaging Initiative (ADNI) database ([70], adni.loni.usc.edu)2.

MR images of 115 subjects from the ADNI-1 baseline dataset were studied here, including 30 AD patients, 45 Mild cognitive impairment (MCI) subjects and 40 healthy old people. MCI is the intermediate stage between normal aging and AD. The MRIs were preprocessed using FreeSurfer [68] to reconstruct the cortical surfaces. Only the left hemispheric cerebral cortices were used here. Six major brain landmark curves were automatically labeled on each cortical surface with the Caret software3, including the Central Sulcus, Anterior Half of the Superior Temporal Gyrus, Sylvian Fissure, Calcarine Sulcus, Medial Wall Ventral Segment, and Medial Wall Dorsal Segment. An illustration of the landmark curves is shown in Fig. 12 with a left cortical surface and two views. The landmarks are shown with different colors on both the original and inflated surfaces for clarity. After we cut the cortical surfaces along the delineated landmark curves, they became genus-0 surfaces with six open boundaries. Then we randomly selected the left cortical surface of a healthy control subject, who is not in the studied subject dataset, as the template surface, and performed the same processing as in Sec. 5.1. Fig. 13 illustrates the hyperbolic Wasserstein distance computation on a pair of left cortical surfaces. (a), (c) and (e) show the computation results of an AD patient and (b), (d) and (f) the results of a healthy control subject.

With the obtained hyperbolic Wasserstein distances, we applied the one-way analysis of variance (ANOVA) in the SPSS package4 to study differences between these three groups. One-way ANOVA is a statistical algorithm that is able to determine if significant differences exist between the means of two or more independent groups. In our results, the hyperbolic Wasserstein distance was significantly different among these three groups, with p = 1.9729E − 11. A Tukey post hoc test also revealed significant difference between AD and control groups (p = 5.1454E − 9), AD and MCI groups (p = 0.038), and MCI and control groups (p = 3.8161E − 7). We further studied the linear trend of cortical shape changes at different diagnostic stages using SPSS. The hyperbolic Wasserstein distances were significantly associated with the diagnostic disease severity (linear tread p = 1.5418E − 11).

As a comparison, we also computed the spectral l2 distance [53] and two other standard cortical surface shape features, the cortical surface area and cortical volume, where the latter two features have also been widely used in AD research [71], [72]. The spectral l2 distance, surface volume and area are not different in these three groups with p = 0.215768, p = 0.113427 and p = 0.143435, respectively. Pair-wise group comparisons with Tukey post hoc test did not reveal any differences for the compared measures. The linear trend analysis p-values of spectral l2 distance, surface volume and area were p = 0.081489, p = 0.053915 and p = 0.070558, respectively. These results demonstrated that, as a single shape index, our hyperbolic Wasserstein distance showed superiority over some other single brain imaging indices. Our work has a potential to provide a concise, quantitative and powerful brain imaging index to track AD development and diagnose AD in its prodromal stage.

5.4 Computational Efficiency

Our OMT map computation is based on the Monge-Brenier approach [8], which proves that the OMT map is the gradient map of a special convex function. Thus, suppose the target domain of the optimal mass transportation problem is discretized to k areas, the Monge-Brenier approach reduces the computation cost from O(k2) to O(k) [14]. To illustrate the efficiency of the OMT map computation, we conducted a running time comparison study with the hyperbolic Wasserstein distance and the spectral l2 distance [53]. We tested with a human face surface and a cortical surface with 60k and 145k triangular faces, respectively. The results are summarized in Table 2. Both algorithms were run on a 2.2GHz Intel i5–5200U laptop with Windows 10 64-bit operating system. The results show that the computational cost of hyperbolic Wasserstein distance is much lower than spectral l2 distance, even for complex cortical surfaces.

5.5 Robustness to Noise

As the hyperbolic Wasserstein distance computes the transportation between two probability measures on the canonical Poincaré disk, it is robust to imaging noise. To validate this property, we conducted a synthetic experiment to study the effects of imaging noise on the resulting hyperbolic Wasserstein distance. Similar to our prior work [21], we manually added a Racian noise with standard deviation 35 on an MR image that was randomly picked from the ADNI dataset of Sec. 5.3. The MR images without and with noise are present in Fig. 14 (a) and (b), respectively. The relative changes due to noise in different shape measures, including hyperbolic Wasserstein distance, spectral l2 distance, surface area and volume, are summarized in Table 3. As the results demonstrated, our hyperbolic Wasserstein distance is relatively more robust to imaging noise.

6 Conclusion and Future Work

This work introduces a novel algorithm to compute the Wasserstein distance between general topological surfaces with hyperbolic metric. Our work generalized the OMT and Wasserstein space work to general surfaces. In our recent work [73], the same algorithm was applied to fuse brain surface TBM and structural connectivity information that is obtained from diffusion MR images. In a small dataset, the hyperbolic Wasserstein distance showed better shape classification performance than some other diffusion MRI derived features. Its results demonstrate the feasibility and power of incorporating other probability definition in the hyperbolic Wasserstein distance for shape indexing. In future, we will explore the possibility to use this framework to generalize other shape space work to general topological surfaces. One caveat of applying the new method to multiply connected surfaces is how the number and locations of original boundaries/landmark curves may impact its effectiveness. Overall, our framework is flexible enough to handle any number (greater than 2) of landmark curves. Here we choose 6 landmarks from the PALS-B12 atlas because of their generality and wide availability. Eventually, it deserves further in-depth investigation on which landmark curve set should be adopted and how their selection will affect the system performance.

Acknowledgments

The authors would like to thank Wen Zhang and Yonghui Fan of Arizona State University for their helpful discussion. This work was partially supported by National Health Institutes (R21AG043760, R21AG049216, RF1AG051710, R01EB025032, U54EB020403), National Science Foundation (DMS-1413417, IIS-1421165) and Arizona Alzheimer’s Consortium.

Data collection and sharing for this project was funded by the Alzheimer’s Disease Neuroimaging Initiative (ADNI) (National Institutes of Health Grant U01 AG024904) and DOD ADNI (Department of Defense award # W81XWH-12-2-0012). ADNI is funded by the National Institute on Aging, the National Institute of Biomedical Imaging and Bioengineering, and through generous contributions from the following: Alzheimer’s Association; Alzheimer’s Drug Discovery Foundation; Araclon Biotech; BioClinica, Inc.; Biogen Idec Inc.; Bristol-Myers Squibb Company; Eisai Inc.; Elan Pharmaceuticals, Inc.; Eli Lilly and Company; EuroImmun; F. Hoffmann-La Roche Ltd and its affiliated company Genentech, Inc.; Fujirebio; GE Healthcare; IXICO Ltd.; Janssen Alzheimer Immunotherapy Research &amp; Development, LLC.; Johnson &amp; Johnson Pharmaceutical Research &amp; Development LLC.; Medpace, Inc.; Merck &amp; Co., Inc.; Meso Scale Diagnostics, LLC.; NeuroRx Research; Neurotrack Technologies; Novartis Pharmaceuticals Corporation; Pfizer Inc.; Piramal Imaging; Servier; Synarc Inc.; and Takeda Pharmaceutical Company. The Canadian Institutes of Rev December 5, 2013 Health Research is providing funds to support ADNI clinical sites in Canada. Private sector contributions are facilitated by the Foundation for the National Institutes of Health (www.fnih.org). The grantee organization is the Northern California Institute for Research and Education, and the study is coordinated by the Alzheimer’s Disease Cooperative Study at the University of California, San Diego. ADNI data are disseminated by the Laboratory for Neuro Imaging at the University of Southern California.

Fig. 1. (a) A multiply connected human face surface; (b) the fundamental group of surface (a); (c) the fundamental domain of surface (a); (d) another fundamental domain of surface (a), which is deformed from (c) with a Fuchsian transformation of surface (a).

Fig. 2. Illustrations of hyperbolic geometry: (a) Poincaré disk model; (b) geodesics in Poincaré disk; (c) Klein model.

Fig. 3. The overall computational pipeline of the proposed hyperbolic Wasserstein distance.

Fig. 4. (a) A hyperbolic triangle; (b) the circle packing metric on a hyperbolic triangle.

Fig. 5. Front (a) and back (b) views of a left cortical surface with six landmark curves and the fundamental group of paths; (c) embedding of the cortical surface onto the Poincaré disk.

Fig. 6. Geodesic curve lifting: (a) Fuchsian transformations that map Ti+ and Ti− to the u axis; (b) Fuchsian transformation that maps Ti+ to Ti−; (c) a finite portion of the universal covering space; (d) recomputation of the fundamental group of paths as geodesics in the Poincaré disk.

Fig. 7. When the recomputed fundamental group of paths are lifted to 3D surfaces, they are consistent across different surfaces (a) and (b).

Fig. 8. Canonical fundamental domain decomposition for the initial map construction between surfaces.

Fig. 9. Illustration of the power Voronoi diagram on the Poincaré disk, where each point (black dot) is associated with a Voronoi cell (green boundary) and the radius of each circle (blue) centered at each point.

Fig. 10. Experimental results of human facial expression analysis with hyperbolic Wasserstein distance.

Fig. 11. Multiply connected surfaces of the two persons (a) and (b) from Texas 3DFRD.

Fig. 12. Landmark curves on a left cortical surface, which are automatically labeled by Caret, showing in two different views (a) and (b), on both original and inflated surfaces. The inflated surface is obtained with FreeSurfer [68].

Fig. 13. Hyperbolic Wasserstein distance computation results of a pair of brain left cortical surfaces of an AD patient (a, c and e) and a healthy control subject (b, d, and f).

Fig. 14. Robustness of the hyperbolic Wasserstein distance to imaging noise: (a) is the original MR image and (b) is the image with manually added Racian noise.

TABLE 1 Classification results of our method and three other surface shape features, the surface area, mean curvature and spectral l2 distance.

Method	Classification Rate	
hyperbolic Wasserstein distance	88.2%	
Surface Area	52.9%	
Mean Curvature	55.3%	
Spectral l2 Distance	74.1%	

TABLE 2 Running time comparison of hyperbolic Wasserstein distance and spectral l2 distance.

Number of faces	Hyperbolic Wasserstein	Spectral l2	
60k	74.27s	112.99s	
145k	155.49s	1004.94s	

TABLE 3 Comparison of hyperbolic Wasserstein distance with other shape measures in robustness to noise.

Shape Measure	Amount of Changes	
Hyperbolic Wasserstein Distance	0.056%	
Spectral l2 Distance	0.46%	
Surface Area	0.17%	
Cortical Volume	0.70%	

Data used in preparation of this article were obtained from the Alzheimer’s Disease Neuroimaging Initiative (ADNI) database (adni.loni.usc.edu). As such, the investigators within the ADNI contributed to the design and implementation of ADNI and/or provided data but did not participate in analysis or writing of this report. A complete listing of ADNI investigators can be found at: https://adni.loni.usc.edu/wp-content/uploads/how_to_apply/ADNI_Acknowledgement_List.pdf

1. http://www.mathworks.com/products/statistics.html

2. Data used in the preparation of this article were obtained from the Alzheimers Disease Neuroimaging Initiative (ADNI) database (adni.loni.usc.edu). The ADNI was launched in 2003 as a public-private partnership, led by Principal Investigator Michael W. Weiner, MD. The primary goal of ADNI has been to test whether serial magnetic resonance imaging (MRI), positron emission tomography (PET), other biological markers, and clinical and neuropsychological assessment can be combined to measure the progression of mild cognitive impairment (MCI) and early Alzheimers disease (AD).

3. http://brainvis.wustl.edu/wiki/index.php/Caret:About

4. http://www.ibm.com/analytics/us/en/technology/spss


References

[1] Younes L , “Spaces and manifolds of shapes in computer vision: An overview,” Image and Vision Computing, vol. 30 , no. 6–7 , pp. 389–397, 2012.
[2] Kendall DG , “The diffusion of shape,” Advances in Applied Probability, vol. 9 , no. 3 , pp. 428–430, 1977.
[3] Miller MI , Trouve A , and Younes L , “On the metrics and Euler-Lagrange equations of computational anatomy,” Annu Rev Biomed Eng, vol. 4 , pp. 375–405, 2002.12117763
[4] Mémoli F and Sapiro G , “A theoretical and computational framework for isometry invariant recognition of point cloud data,” Foundations of Computational Mathematics, vol. 5 , no. 3 , pp. 313–347, 2005.
[5] Zeng W , Shi R , Wang Y , Yau S-T , and Gu X , “Teichmüller shape descriptor and its application to Alzheimer’s disease study,” Int. J. Comput. Vision, vol. 105 , no. 2 , pp. 155–170, 2013.
[6] Rubner Y , Tomasi C , and Guibas LJ , “The earth mover’s distance as a metric for image retrieval,” Int. J. Comput. Vision, vol. 40 , no. 2 , pp. 99–121, 11 2000.
[7] Villani C , Topics in Optimal Transportation. American Mathematical Society, 2003.
[8] Brenier Y , “Polar factorization and monotone rearrangement of vector-valued functions,” Com. Pure Appl. Math, vol. 64 , pp. 375–417, 1991.
[9] Ni K , Bresson X , Chan T , and Esedoglu S , “Local histogram based segmentation using the Wasserstein distance,” Int. J. Comput. Vision, vol. 84 , no. 1 , pp. 97–111, 2009.
[10] Schmitzer B and Schnörr C , “Object segmentation by shape matching with Wasserstein modes,” Energy Minimization Methods in Comp. Vis. and Patt. Recog, vol. 8081 , pp. 123–136, 2013.
[11] Wang W , Slepčev D , Basu S , Ozolek JA , and Rohde GK , “A linear optimal transportation framework for quantifying and visualizing variations in sets of images,” Int. J. Comput. Vision, vol. 101 , no. 2 , pp. 254–269, 2013.
[12] Ambrosio L and Gigli N , A User’s Guide to Optimal Transport. Berlin, Heidelberg: Springer Berlin Heidelberg, 2013, pp. 1–155.
[13] Lipman Y and Daubechies I , “Conformal Wasserstein distances: Comparing surfaces in polynomial time,” Advances in Mathematics, vol. 227 , no. 3 , pp. 1047 – 1077, 2011.
[14] Su Z , Wang Y , Shi R , Zeng W , Sun J , Luo F , and Gu X , “Optimal mass transport for shape matching and comparison,” IEEE Trans Pattern Anal Mach Intell, vol. 37 , no. 11 , pp. 2246–2259, 11 2015.26440265
[15] Su Z , Zeng W , Wang Y , Lu ZL , and Gu X , “Shape classification using Wasserstein distance for brain morphometry analysis,” Inf Process Med Imaging, vol. 24 , pp. 411–423, 2015.26221691
[16] Cuturi M , “Sinkhorn distances: Lightspeed computation of optimal transportation,” in Advances in Neural Information Processing Systems, 2013, pp. 2292–2300.
[17] Solomon J , de Goes F , Peyré G , Cuturi M , Butscher A , Nguyen A , Du T , and Guibas L , “Convolutional Wasserstein distances: Efficient optimal transportation on geometric domains,” ACM Trans. Graph, vol. 34 , no. 4 , pp. 66:1–66:11, 7 2015.
[18] Thompson PM , Mega MS , Woods RP , Zoumalan CI , Lindshield CJ , Blanton RE , Moussai J , Holmes CJ , Cummings JL , and Toga AW , “Cortical change in Alzheimer’s disease detected with a disease-specific population-based brain atlas,” Cereb. Cortex, vol. 11 , no. 1 , pp. 1–16, 1 2001.11113031
[19] Wang Y , Shi J , Yin X , Gu X , Chan TF , Yau S-T , Toga AW , and Thompson PM , “Brain surface conformal parameterizaiton with the Ricci flow,” IEEE Trans Med Imaging, vol. 31 , no. 2 , pp. 251–264, 2012.21926017
[20] Shi R , Zeng W , Su Z , Jiang J , Damasio H , Lu Z , Wang Y , Yau ST , and Gu X , “Hyperbolic harmonic mapping for surface registration,” IEEE Trans Pattern Anal Mach Intell, vol. 39 , no. 5 , pp. 965–980, 5 2017.27187948
[21] Shi J , Zhang W , Tang M , Caselli RJ , and Wang Y , “Conformal invariants for multiply connected surfaces: Application to landmark curve-based brain morphometry analysis,” Med Image Anal, vol. 35 , pp. 517–529, 1 2017.27639215
[22] Zeng W , Samaras D , and Gu X , “Ricci flow for 3D shape analysis,” IEEE Trans Pattern Anal Mach Intell, vol. 32 , no. 4 , pp. 662–677, 2010.20224122
[23] Shi J , Stonnington CM , Thompson PM , Chen K , Gutman BA , Reschke C , Baxter LC , Reiman EM , Caselli RJ , and Wang Y , “Studying ventricular abnormalities in mild cognitive impairment with hyperbolic Ricci flow and tensor-based morphometry,” NeuroImage, vol. 104 , no. 1 , pp. 1–20, 2015.25285374
[24] Davatzikos C , “Spatial normalization of 3D brain images using deformable models,” J. Comput. Assist. Tomogr, vol. 20 , pp. 656–665, 1996.8708076
[25] Chung MK , Dalton KM , and Davidson RJ , “Tensor-based cortical surface morphometry via weighted spherical harmonic representation,” IEEE Trans Med Imaging, vol. 27 , pp. 1143–1151, 2008.18672431
[26] Kantorovich LV , “On a problem of Monge,” Uspekhi Mat. Nauk, vol. 3 , pp. 225–226, 1948.
[27] Shi J , Zhang W , and Wang Y , “Shape analysis with hyperbolic Wasserstein distance,” in Comp. Vis. and Patt. Recog, 6 2016, pp. 5051–5061.
[28] Kurtek S , Klassen E , Gore JC , Ding Z , and Srivastava A , “Elastic geodesic paths in shape space of parameterized surfaces,” IEEE Trans Pattern Anal Mach Intell, vol. 34 , no. 9 , pp. 1717–1730, 9 2012.22144521
[29] Jermyn IH , Kurtek S , Klassen E , and Srivastava A , “Elastic shape matching of parameterized surfaces using square root normal fields,” Proceedings of the 12th European Conference on Computer Vision - Volume Part V (ECCV’12), vol. 7576 , pp. 804–817, 2012.
[30] Gutman BA , Fletcher PT , Cardoso MJ , Fleishman GM , Lorenzi M , Thompson PM , and Ourselin S , “A Riemannian framework for intrinsic comparison of closed genus-zero shapes,” Inf Process Med Imaging, vol. 24 , pp. 205–218, 2015.26221675
[31] Brignell CJ , Dryden IL , Gattone SA , Park B , Leask S , Browne WJ , and Flynn S , “Surface shape analysis with an application to brain surface asymmetry in schizophrenia,” Biostatistics, vol. 11 , no. 4 , pp. 609–630, 2010.20350956
[32] Younes L , Shapes and Diffeomorphisms. Springer, 2010.
[33] Srivastava A , Joshi SH , Mio W , and Liu X , “Statistical shape analysis: clustering, learning, and testing,” IEEE Trans Pattern Anal Mach Intell, vol. 27 , no. 4 , pp. 590–602, 4 2005.15794163
[34] Srivastava A and Jermyn IH , “Looking for shapes in two-dimensional cluttered point clouds,” IEEE Trans Pattern Anal Mach Intell, vol. 31 , no. 9 , pp. 1616–1629, 9 2009.19574622
[35] Bauer M , Harms P , and Michor PW , “Almost local metrics on shape space of hypersurfaces in n-space,” SIAM J. Imaging Sciences, vol. 5 , pp. 244–310, 2012.
[36] Lipman Y , Puente J , and Daubechies I , “Conformal Wasserstein distance: II. computational aspects and extensions,” Math Comp, vol. 82 , pp. 331–381, 2013.
[37] Bonnotte N , “From Knothe’s rearrangement to Brenier’s optimal transport map,” arXiv:1205.1099 [math.OC], pp. 1–29, 2012.
[38] Rachev S and Ruschendorf L , Mass Transportation Problems. Springer, New York, 1998, vol. I-II .
[39] Haker S , Zhu L , Tannenbaum A , and Angenent S , “Optimal mass transport for registration and warping,” Int. J. Comput. Vision, vol. 60 , no. 3 , pp. 225–240, 2004.
[40] Rehman T , Haber E , Pryor G , Melonakos J , and Tannenbauma A , “3D nonrigid registration via optimal mass transport on the GPU,” Med Image Anal, vol. 13 , no. 6 , pp. 931–940, 2009.19135403
[41] de Goes F , Breeden K , Ostromoukhov V , and Desbrun M , “Blue noise through optimal transport,” ACM Trans. Graph, vol. 31 , no. 6 , pp. 171:1–171:11, 11 2012.
[42] de Goes F , Cohen-Steiner D , Alliez P , and Desbrun M , “An optimal transport approach to robust reconstruction and simplification of 2D shapes,” Computer Graphics Forum, vol. 30 , no. 5 , pp. 1593–1602, 2011.
[43] Tangelder JWH and Veltkamp RC , “A survey of content based 3D shape retrieval methods,” Multimedia Tools and Applications, vol. 39 , no. 3 , pp. 441–471, 2008.
[44] Styner M , Lieberman JA , McClure RK , Weinberger DR , Jones DW , and Gerig G , “Morphometric analysis of lateral ventricles in schizophrenia and healthy controls regarding genetic and disease-specific factors,” Proc. Natl. Acad. Sci. U. S. A, vol. 102 , no. 13 , pp. 4872–4877, 2005.15772166
[45] Chung MK , Dalton KM , and Davidson RJ , “Tensor-based cortical surface morphometry via weighted spherical harmonic representation,” IEEE Trans Med Imaging, vol. 27 , no. 8 , pp. 1143–1151, 8 2008.18672431
[46] Sun J , Ovsjanikov M , and Guibas L , “A concise and provably informative multi-scale signature based on heat diffusion,” in Proc Symp Geom Process, 2009, pp. 1383–1392.
[47] Castellani U , Mirtuono P , Murino V , Bellani M , Rambaldelli G , Tansella M , and Brambilla P , “A new shape diffusion descriptor for brain classification,” Med Image Comput Comput Assist Interv, pp. 426–433, 2011.21995057
[48] Raviv D , Bronstein MM , Bronstein AM , and Kimmel R , “Volumetric heat kernel signatures,” in Proc. Intl. Workshop on 3D Object Retrieval (3DOR). ACM Multimedia, 2010, pp. 39–44.
[49] Pizer SM , Fritsch DS , Yushkevich PA , Johnson VE , and Chaney EL , “Segmentation, registration, and measurement of shape variation via image object shape,” IEEE Trans Med Imaging, vol. 18 , no. 10 , pp. 851–865, 10 1999.10628945
[50] Fletcher PT , Lu C , Pizer SM , and Joshi S , “Principal geodesic analysis for the study of nonlinear statistics of shape,” IEEE Trans Med Imaging, vol. 23 , no. 8 , pp. 995–1005, 8 2004.15338733
[51] Styner M and Gerig G , “Medial models incorporating object variability for 3D shape analysis,” Inf Process Med Imaging, pp. 502–516, 2001.
[52] Ben-Chen M and Gotsman C , “Characterizing shape using conformal factors,” in Proceedings of the 1st Eurographics Conference on 3D Object Retrieval, 2008, pp. 1–8.
[53] Lai R , Shi Y , Scheibel KE , Fears SC , Woods RP , Toga AW , and Chan TF , “Metric-induced optimal embedding for intrinsic 3D shape analysis,” in Comp. Vis. and Patt. Recog, 2010, pp. 2871–2878.
[54] Chow B , Lu P , and Ni L , Hamilton’s Ricci Flow. American Mathematical Society, 2006.
[55] Schoen R and Yau S-T , Lectures on Harmonic Maps. International Press, 1997.
[56] Thurston WP , Geometry and Topology of Three-Manifolds. Princeton Lectures Notes, 1976.
[57] Li X , Gu X , and Qin H , “Surface mapping using consistent pants decomposition,” IEEE Trans Vis Comput Graph, vol. 15 , no. 4 , pp. 558–571, 2009.19423881
[58] Aurenhammer F , “Power diagrams: properties, algorithms and applications,” SIAM J. Comput, vol. 16 , no. 1 , pp. 78–96, 1987.
[59] Edelsbrunner H , 13.6 Power diagrams, Algorithms in Combinatorial Geometry. Springer-Verlag New York, Inc, 1987.
[60] Essa IA and Pentlan AP , “Coding, analysis, interpretation, and recognition of facial expressions,” IEEE Trans Pattern Anal Mach Intell, vol. 19 , no. 7 , pp. 757–763, 1997.
[61] Yin L , Wei X , Sun Y , Wang J , and Rosato MJ , “A 3D facial expression database for facial behavior research,” in 7th Int Conf on Automatic Face and Gesture Recog, 2006, pp. 211–216.
[62] Zhao W , Chellappa R , Phillips PJ , and Rosenfeld A , “Face recognition: A literature survey,” ACM Comput. Surv, vol. 35 , no. 4 , pp. 399–458, 12 2003.
[63] Bronstein AM , Bronstein MM , and Kimmel R , “Three-dimensional face recognition,” Int. J. Comput. Vision, vol. 64 , no. 1 , pp. 5–30, 2005.
[64] Kakadiaris IA , Passalis G , Toderici G , Murtuza MN , Lu Y , Karampatziakis N , and Theoharis T , “Three-dimensional face recognition in the presence of facial expressions: An annotated deformable model approach,” IEEE Trans Pattern Anal Mach Intell, vol. 29 , no. 4 , pp. 640–649, 4 2007.17299221
[65] Gupta S , Castleman KR , Markey MK , and Bovik AC , “Texas 3D face recognition database,” http://live.ece.utexas.edu/research/texas3dfr/index.htm, 2010.
[66] Zhang L , Razdan A , Farin G , Femiani J , Bae M , and Lockwood C , “3D face authentication and recognition based on bilateral symmetry analysis,” The Visual Computer, vol. 22 , no. 1 , pp. 43–55, 2006.
[67] Corrigan MS , Pattern Recognition in Biology. Nova Science Pub Inc, 2007.
[68] Fischl B , Sereno MI , and Dale AM , “Cortical surface-based analysis. II: Inflation, flattening, and a surface-based coordinate system,” Neuroimage, vol. 9 , no. 2 , pp. 195–207, 2 1999.9931269
[69] Du AT , Schuff N , Kramer JH , Rosen HJ , Gorno-Tempini ML , Rankin K , Miller BL , and Weiner MW , “Different regional patterns of cortical thinning in Alzheimer’s disease and frontotemporal dementia,” Brain, vol. 130 , no. Pt 4 , pp. 1159–1166, 4 2007.17353226
[70] Mueller SG , Weiner MW , Thal LJ , Petersen RC , Jack C , Jagust W , Trojanowski JQ , Toga AW , and Beckett L , “The Alzheimer’s disease neuroimaging initiative,” Neuroimaging Clin. N. Am, vol. 15 , no. 4 , pp. 869–877, 11 2005.16443497
[71] Li S , Yuan X , Pu F , Li D , Fan Y , Wu L , Chao W , Chen N , He Y , and Han Y , “Abnormal changes of multidimensional surface features using multivariate pattern classification in amnestic mild cognitive impairment patients,” J. Neurosci, vol. 34 , no. 32 , pp. 10 541–10 553, 8 2014.24381264
[72] Andersen SK , Jakobsen CE , Pedersen CH , Rasmussen AM , Plocharski M , and Øtergaard LR , “Classification of Alzheimer’s disease from MRI using sulcal morphology,” Image Analysis, pp. 103–113, 2015.
[73] Zhang W , Shi J , Yu J , Z. L , Thompson PM , and Wang Y , “Enhancing diffusion MRI measures by integrating grey and white matter morphometry with hyperbolic Wasserstein distance,” in Proc IEEE Int Symp Biomed Imaging, 2017, pp. 520–524.28936280
