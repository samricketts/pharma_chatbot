LICENSE: This file is available for text mining. It may also be used consistent with the principles of fair use under the copyright law.


8215016
7188
Stat Med
Stat Med
Statistics in medicine
0277-6715
1097-0258

34649301
8671252
10.1002/sim.9214
NIHMS1743565
Article
Bayesian Inference and Dynamic Prediction of Multivariate Joint Model with Functional Data: An Application to Alzheimer’s Disease
Zou Haotian PhD candidate Gillings School of Global Public Health, Department of Biostatistics, University of North Carolina at Chapel Hill, NC 27599, USA

Li Kan Merck Research Lab, Merck &amp; Co, North Wales, Pennsylvania

Zeng Donglin Professor Department of Biostatistics, Gillings School of Global Public Health, CB#7420, University of North Carolina at Chapel Hill, NC 27599, USA

Luo Sheng Professor *Department of Biostatistics and Informatics, Duke University, 2424 Erwin Rd, Durham, NC 27705, USA

Alzheimer’s Disease Neuroimaging Initiative
Acknowledgement of the Alzheimer’s Disease Neuroimaging Initiative study is available in Section 6.

* Corresponding author: Sheng Luo, Department of Biostatistics and Informatics, Duke University, 2424 Erwin Rd, Durham, NC 27705, USA (sheng.luo@duke.edu).
28 9 2021
14 10 2021
30 12 2021
30 12 2022
40 30 68556872
This file is available for text mining. It may also be used consistent with the principles of fair use under the copyright law.
Alzheimer’s Disease (AD) is a severe neurodegenerative disorder impairing multiple domains, e.g., cognition and behavior. Assessing the risk of AD progression and initiating timely interventions at early stages are critical to improve the quality of life for AD patients. Due to the heterogeneous nature and complex mechanisms of AD, one single longitudinal outcome is insufficient to assess AD severity and disease progression. Therefore, AD studies collect multiple longitudinal outcomes, including cognitive and behavioral measurements, as well as structural brain images such as Magnetic Resonance Imaging (MRI). How to utilize the multivariate longitudinal outcomes and MRI data to make efficient statistical inference and prediction is an open question. In this article, we propose a Multivariate Joint Model with Functional Data (MJM-FD) framework that relates multiple correlated longitudinal outcomes to a survival outcome, and use the scalar-on-function regression method to include voxel-based whole-brain MRI data as functional predictors in both longitudinal and survival models. We adopt a Bayesian paradigm to make statistical inference and develop a dynamic prediction framework to predict an individual’s future longitudinal outcomes and risk of a survival event. We validate the MJM-FD framework through extensive simulation studies and apply it to the motivating Alzheimer’s Disease Neuroimaging Initiative (ADNI) study.

Multivariate joint model with functional data
functional regression
Bayesian inference
dynamic prediction
ADNI study

pmc1 Introduction

Alzheimer’s Disease (AD) is a common and severe progressive neurodegenerative disorder. In 2020, the predicted number of people in US with AD increases to about 5.8 million, as compared to around 4.7 million in 2010,1 which poses a challenging public health issue. To slow the progression of AD, a number of recent studies suggested to evaluate the severity of AD via cognitive and behavioral scores, and to take interventions promptly at early disease stages,2,3 where a meta-analysis shows that 33.6% mild cognitive impairment (MCI) patients transit to AD after five years follow-up.4 Due to the complex and heterogenous nature of AD, a single longitudinal outcome is insufficient to assess AD progression because of the complex pathological mechanisms of AD.3 Hence, AD studies collect multiple longitudinal neuropsychological and behavioral measurements to assess AD progression, and novel statistical methods are needed to leverage this information.

The Joint Model (JM) framework is traditionally used to model a longitudinal outcome and a survival outcome.5,6 In recent biomedical research, multiple longitudinal outcomes are collected for better understanding of complex diseases such as AD, and resulting in more accurate prediction of disease progression.3 To this end, recent studies extend the JM framework to multivariate settings, where the correlation of multiple longitudinal outcomes are commonly modeled using the shared random effects, and some functional forms of the longitudinal outcomes are included in the survival model.7–9 A good review of the joint model framework is available in recent literatures.10,11 One important application of joint model is dynamic prediction,12–15 where the predicted longitudinal trajectories and survival probabilities are updated in a dynamic fashion for a new individual at different visit times and prediction windows.11 To the best of our knowledge, no work has been done in incorporating functional data in the multivariate joint model (MJM). In this article, we extend the MJM framework to include high-dimensional functional data as predictors for both longitudinal and survival outcomes. We also propose a personalized dynamic prediction method to predict an individual’s future longitudinal outcomes and risk of an event under this framework.

Magnetic Resonance Imaging (MRI) technique has been widely adopted to detect the volume atrophy for AD patients.16 Specifically, the structural MRI (sMRI) tool detects the structure, shape, and size of the whole brain, in addition to regions of interest (ROI), which are 3D images consisting of thousands of volumetric voxels.17 There are two common methods to analyze the sMRI data, ROI-based method and voxel-based method.18 The ROI-based method combines the volume information in the voxels within a specific region of interest,19 which may result in losing volumetric information of each voxel. The voxel-based method overcomes the problem of information loss by normalizing and analyzing each voxel separately.18 For example, a recent voxel-based analysis shows that atrophy in medial and lateral temporal lobe is strongly associated with deterioration of memory scores.20 However, the voxel-based analysis has other issues such as multiple comparison and failure to account for voxel-wise correlation.21 Because the volumes of some voxels in the whole brain are crucial predictors for AD progression, we adopt the voxel-based whole-brain sMRI data as functional data and consider them as functional predictors for both longitudinal and survival outcomes.

A common approach to model the functional data and handle their high dimensionality is to decompose functions into infinite-dimensional linear combinations of basis functions using basis expansion.22,23 Then regularization, usually via truncation or penalization, is applied to convert the infinite-dimensional linear combinations to finite linear combinations.24,25 The scalar-on-function regression is a widely-used functional regression method which quantifies the association between a scalar outcome and a functional predictor via the coefficient function.26 Functional principal component analysis (FPCA) is a powerful dimension reduction approach to decompose the functional predictor,22,27–30 and splines decomposition has been widely adopted to estimate the coefficient function.22,23 In addition, the scalar-on-function regression approach has also been developed in the JM framework as functional joint model (FJM).31

In this article, we propose a multivariate joint model with functional data (MJM-FD) framework to assess AD progression among MCI patients using baseline characteristics, whole-brain MRI data, and three longitudinal neuropsychological measurements. Comparing to the existing literatures, there are three major novelties in our method. First, we extend FJM by jointly modeling multivariate longitudinal outcomes and a survival outcome, and incorporating functional predictors in the submodels for both types of outcomes. Second, we develop a dynamic prediction framework to predict the future longitudinal trajectories and probability of dementia diagnosis. Third, we use a voxel selection method to filter informative voxels from whole-brain MRI data.

The article is organized as follows. In Section 2, we introduce the motivating ADNI study, longitudinal outcomes, and MRI data. In Section 3, we propose the multivariate joint model with functional data (MJM-FD), Bayesian inference method, and dynamic prediction framework. In Section 4, we present the results of model fitting and predictive performance in the ADNI study. In Section 5, we conduct an extensive simulation study with eight settings to validate our methods. In Section 6, we summarize our findings and discuss limitations and future work.

2 A motivating clinical study

The multivariate joint model with functional data (MJM-FD) framework is motivated by the Alzheimer’s Disease Neuroimaging Initiative (ADNI) study, which is a comprehensive longitudinal study to measure the association between the progression of AD and biomarkers, neuropsychological scores, medical imaging data, and genetic variants and the study consists of four stages: ADNI-1; ADNI-GO; ADNI-2; ADNI-3 (ongoing stage). We downloaded all clinical and MRI data on November, 02, 2019. In summary, the total number of subjects is 2,253, with 815 cognitive normal (CN), 1,018 MCI, 390 dementia participants, and 30 participants with missing diagnosis at baseline. The mean follow-up time is 2.43 years (a mean of 6.46 visits). More information for the ADNI study can be found on the ADNI website: http://adni.loni.usc.edu/. We include all patients with MCI diagnosis and valid baseline MRI data, APOE-ϵ4, and age. The final analysis dataset consists of 742 patients, with a total of 3,826 longitudinal observations before dementia diagnosis or censoring, a mean follow-up length of 3.10 years, and standard deviation of 2.89 years.

We select three longitudinal outcomes: mini-mental state examination (MMSE; score ranges from 0 to 30 with higher score indicating better cognitive function), clinical dementia rating - sum of boxes (CDR-SB; score ranges from 0 to 18 with higher score indicating worse cognitive behavior), Wechsler memory scale - logical memory (WMS-LM; score ranges from 0 to 25 with higher score indicating better memory function) due to two reasons. First, MMSE and CDR-SB are reported to be significantly associated with AD progression.32 Second, all three measures are commonly collected in AD studies.33–35 Specifically, MMSE is a widely adopted scale to measure the cognitive function and is closely related to AD progression.36,37 CDR-SB evaluates the cognitive functioning in six domains (memory, orientation, judgment and problem solving, community affairs, home and hobbies, and personal care) and it is closely associated with AD progression.36 Moreover, WMS-LM is a measurement of cognitive function in the memory aspect, and the logical memory subset of WMS is a good measure in distinguishing between subjects who develop AD and who remain stable.37

The ADNI Study has different schedule for MMSE, CDR-SB, and WMS-LM. For MCI patients, MMSE and CDR-SB are measured at baseline, month 6 (ADNI-1, ADNI-GO, ADNI-2 phases only), month 12, month 18 (ADNI-1 phase only), month 24 and annual visits after, while WMS-LM are measured at baseline, month 12 and annual visits after. Thus, we obtain the analysis dataset with 3,593 visits (89 missing), 3,593 visits (82 missing), 2,771 visits (92 missing) for MMSE, CDR-SB and WMS-LM, respectively, before dementia diagnosis or censoring. Figure 1 displays the longitudinal trajectories in LOWESS curves of three outcomes using visits at or before dementia diagnosis, which suggests non-linear trajectory patterns. The missing longitudinal data are multiply imputed and averaged using bootstrap EM algorithm via Amelia package. The multiple imputation model includes baseline covariates (age, gender, education years, and APOE-ϵ4 alleles), other two longitudinal scores, and current diagnosis status (CN, MCI or dementia).

We use the baseline voxel-based whole-brain MRI data as functional predictors, where the MRI data go through correction steps before preprocessing. More details about correction steps and MRI preprocessing protocols are given in Section 3.5.

3 Methods

In brief, our Multivariate Joint Model with Functional Data (MJM-FD) consists of three major steps. First, we select informative voxels in structural MRI data using linear mixed models and Cox Proportional Hazards Model to reduce the amount of MRI data, and we transform the volumes of selected voxels into functional predictors. Second, functional principal component analysis and cubic B-spline approximation are adopted to reduce dimensions of functional predictors and coefficient functions, respectively. Third, the joint modeling of longitudinal and survival data are incorporated in the MJM-FD model and Bayesian methods are used for statistical inference.

3.1 Voxel Selection

After preprocessing steps detailed in Section 3.5, sMRI data have the same image structure and format as the Eve Template, with S = 1, 843, 303 non-zero-volume voxels. To reduce the computation time and to resolve the large memory issue associated with the high-dimensional functional data, we adopt the False Discovery Rate (FDR) adjustment to select informative voxels to be included in the real data analysis.

The voxel selection step we adopt is similar, in principle, to voxel-based morphometry (VBM), which is an automated procedure to detect differences in voxel volumes between groups using voxel-wise comparison method.38,39 The VBM method has been widely used to assess the association between voxel volumes and cognitive change, both cross-sectionally and longitudinally, while adjusting for other covariates, such as age, sex, education, etc.40–45 In these analyses, the association between cognitive scores and voxel volumes is commonly assessed using the regression methods, but the interaction term between voxel volume and time is typically not included as a regression covariate.46 Thus, in the voxel selection step, we do not include the interaction between the voxel volume and time.

We have i = 1, 2, …, n subjects, j = 1, 2, …, J longitudinal measurements, and k = 1, 2, …Kij visits for subject i and outcome j. We denote the longitudinal measurements {Yij(tijk)} and Y˜ijtijk at time tijk for observed and missing longitudinal outcomes, respectively. We assume missing at random (MAR) and denote the missing indicator as Iijk (1 if missing and 0 otherwise). We denote pj-dimensional covariate vector as xijk, the event time Ti=minTi*,Ci, with Ti* being the failure time and Ci being the censoring time. We observe the censoring indicator δi=ITi*≤Ci, and the pw-dimensional covariate vector wi. For subject i, the MRI data gi(S) is defined on a dense domain S with S voxels, and the volume of voxel s is denoted by Voli,s, s = 1, 2, …, S.

For each longitudinal outcome j, we independently fit S linear mixed effects models Yijtijk=β0j+xijk′βj+Voli,sβjs+uij0+tijkuij1+ϵijk, where β0j is the intercept, βj is the pj-dimensional regression coefficient, βjs is the regression coefficient for voxel s. We assume that the random intercepts uij0~N0,σuj02, and random slopes uij1~N0,σuj12, with correlation coefficient ρj, and the random errors ϵijk~N0,σj2. For the survival outcome, we independently fit S Cox proportional hazards models hi(t)=h0(t) expwi′γ+Voli,sγs, where h0(t) is the baseline hazard function, γ is the pw-dimensional regression coefficient vector, and γs is the regression coefficient for voxel s.

The missing longitudinal outcome data are imputed using bootstrap EM algorithm as in Section 2, generating five imputed datasets. For each imputed dataset, we use FDR to adjust the S p-values of the regression coefficients of voxel volumes for longitudinal outcomes, and we take union of the voxels with adjusted p-values of regression coefficients less than the FDR threshold. We use FDR-adjusted p-value threshold of 0.05 for MMSE and CDR-SB, and a more conservative threshold of 0.01 for WMS-LM and survival outcome. We select more stringent threshold for WMS-LM and the survival outcome, because we would get more than 10, 000 voxels with 0.05 being the threshold, which requires intensive computation time and memory. After voxel selection, we obtain functional predictor gi,j(s) defined on domain Sj for each longitudinal outcome j and functional predictor gi,w(s) defined on domain Sw for the survival outcome.

3.2 Multivariate Joint Model with Functional Data

We propose the MJM-FD consisting of two submodels: (1) Yijtijk=mijtijk+ϵijk,

(2) where mijtijk=β0j+xijk′βj+∫Sgi,j(s)Bj(s)ds+vj0ui0+vj1tijkui1,

(3) hi(t)=h0(t) expwi′γ+∫Sgi,w(s)Bw(s)ds+∑j=1Jαjmij(t).

The latent longitudinal means are denoted as mij(t) for subject i and longitudinal outcome j at visit time t. We denote the coefficient functions as Bj(s) for the longitudinal outcome j, and Bw(s) for the survival outcome. For simplicity and computational efficiency, we model the correlation among longitudinal outcomes via the shared random effects ui′=ui0,ui1′, with outcome-specific association parameters vj0 and vj1 for j = 1, 2, …, J, while other forms of multivariate random effects can be readily adopted.47 We assume that the random intercepts ui0~N0,σu02, and random slopes ui1~N0,σu12 with correlation coefficient ρ, and are shared across all J longitudinal outcomes. We let the association parameter αj denote the association between the survival outcome and longitudinal outcome j. We set v10 = v11 = 1 for model identifiability. To account for the skewness of longitudinal outcomes, we let the random errors ϵijk~Skew-Normal0,ωj2,δj, where ωj is the scale parameter and δj is the shape parameter (reduces to Normal distribution if δj = 0). We approximate the baseline hazard function h0(t) using piecewise constant functions.48–50 Specifically, we set h0(t) = h0z if τz ≤ t &lt; τz+1 for knot locations τ = (τ1, …, τZ), where τ1 = 0.

We adopt functional principal component analysis (FPCA) to decompose the functional predictors gi,j(s) and gi,w(s), and adopt B-spline to decompose the coefficient functions Bj(s) and Bw(s). For notational convenience, we denote the functional predictor as gi(s) and its corresponding coefficient function as B(s). The functional predictor is observed as a noisy form: gi′(s)=gi(s)+ϵi(s), where ϵi(s) is a stochastic Gaussian process with mean zero, and variance σ2. We define the mean function μ(s) = E(gi(s)), and the covariance function C(s, s′) = cov(gi(s), gi(s′)), where s and s′ denotes two points over domain S. By Mercer’s Theorem, Cs,s′=∑l=1∞alϕl(s)ϕls′, where a1 ≥ a2 ≥ … 0 are non-increasing eigenvalues, and ϕl(s) is the corresponding eigenfunction, satisfying ʃS ϕl(s)2ds = 1 and ʃS ϕl(s)ϕl′(s)ds = 0 when l ≠ l′. We decompose the functional predictor gi(s)=μ(s)+∑l=1∞ξilϕl(s) using Karhunen-Loeve’s expansion, where ξil is the corresponding FPC score, satisfying E(ξil) = 0, Var(ξil) = al, ξil ⫫ ξil′ for l ≠ l′, where ⫫ denotes independence. The truncated Karhunen-Loeve’s expansion is adopted, using proportion of variance explained (PVE) criteria: ∑l=1Lal/∑l=1∞al≥PVE.

We conduct FPCA using the following procedure for the observed gi′(s). First, the estimated mean function μ^(s) is obtained from the sample mean: μ^(s)=(1/n)∑i=1ngi′(s), and is smoothed using the cubic B-spline function. Second, we demean the data gi′(s)−μ^(s) from which we calculate the raw covariance matrix. Third, the raw covariance matrix is smoothed using either the tensor-product smoother (for low dimensional domains), or a bivariate scattered points from the multilevel B-splines (for high dimensional domains). Finally, we perform eigendecomposition for the smoothed covariance matrix to obtain the estimated eigenfunctions ϕ^l(s) and the number of eigenfunctions L, where L is set to be the minimum number that achieves the PVE criteria.

For the coefficient function B(s), we decompose it using cubic B-spline functions: B(s)=∑p=1Pbpfp(s), where fp(s) is the cubic B-spline function p evaluated at location s, and bp is the corresponding B-spline coefficient. For model identifiability, the number of B-spline functions P is smaller than or equal to the number of eigenfunctions L. Hence, we set P = min(L1, …, LJ, Lw).

We approximate the integration term ʃS gi(s)B(s)ds as ʃS gi(s)B(s)ds ≈ IμBb + ΞiIϕBb, where IμB is a 1 by P vector, with p-th element as ʃS μ(s)fp(s)ds, and b is a P by 1 coefficient vector, with p-th element as bp. We denote Ξi as a 1 by L vector, with l-th element as ξil, and IϕB as an L by P matrix, with (l, p)-th element being ʃS ϕl(s)fp(s)ds (refer to Web Supplement Section 1 for derivation). The integrals ʃS μ(s)fp(s)ds and ʃS ϕl(s)fp(s)ds are approximated using Riemann sum. The FPC scores satisfy ξil = ʃS(gi(s) − μ(s))ϕl(s)ds, which are approximated as ξ^il≈∫Sgi′(s)−μ^(s)ϕ^l(s)ds.

3.3 Estimation and Inference

We denote the parameter space as: θ = (β0, β, b, σu, ρ, v, ω, δ, h0, γ, α)′, where β0 = (β01, …, β0J), β = (β1, …, βJ), b = (b1, …, bJ, bw), bj = (bj1,…, bjp), bw = (bw1, …, bwp), σu = (σu0, σu1), v = (v20, v21, …, vJ0, vJ1), ω = (ω1, …, ωJ), δ = (δ1, …, δJ), h0 = (h01, …, h0Z), and α = (α1, …, αJ).

We express the full data log-likelihood as: l(θ∣Y,Y˜,T,δ)=∑i=1nlog∏j=1J∏k=1Kijfyijtijk∣ui,θ1−Iijkfy˜ijtijk∣ui,θIijk.

(4) hiTi∣ui,θδiSiTi∣ui,θPui∣θ,

where y˜ijtijk∣ui,θ~Skew-Normalmijtijk,ωj2,δj, and Si(Ti) is the survival function. The missing outcomes y˜ijtijk are imputed in the MCMC sampling procedure. Specifically, we treat y˜ijtijk as unknown parameters and impute from the Skew-Normal distribution with each parameter being the posterior samples.

To sample from the log-likelihood, we utilize the software Stan, which provides a platform to perform full Bayesian inference using No-U-Turn Sampler (NUTS).51 The NUTS algorithm performs more efficiently and faster than the Hamiltonian Monte Carlo (HMC) sampler. In our real data application, we use two Monte Carlo chains with overdispersed initial values and each chain has 3,000 iterations with 2,000 iterations as burn-in iterations. We use Gelman-Rubin diagnostic to ensure the scale reduction R^ of all parameters are smaller than 1.1 as well as a suite of convergence diagnosis criteria to ensure convergence.51 The results consist of 2,000 NUTS samples for each parameter, from which we derive the posterior mean, estimated standard error, and the 95% credible interval for each parameter. The Stan code is provided in the Web Supplement Section 8 for easy implementation.

To evaluate model performance, we adopt Leave-One-Out cross-validation Information Criteria (LOOIC) and Widely Applicable Information Criteria (WAIC), which are robust, stable, and computationally efficient in Bayesian settings.52 Smaller LOOIC and WAIC values indicate better model performance.

3.4 Dynamic Prediction

Suppose we have a new patient M who is event-free to time T0. We predict future longitudinal outcomes at time T1, T1 &gt; T0, and the conditional survival probability. We use NUTS to obtain the samples of the random effects uM from its posterior distribution (refer to the Web Supplement Section 2 and 3 for the derivation of posterior distributions of random effects and conditional survival probability). PuM∣TM&gt;T0,yM,θ^∝∏j=1J∏k=1KMjPyMjtMjk∣uM,TM&gt;T0,θ^PTM&gt;T0∣uM,θ^PuM∣θ^,

where we denote yM = (yM1(t11), …, yM1(T0), …, yMJ(tJ1), …, yMJ(T0)) as all longitudinal outcomes up to time T0 for subject M, where the subscript M denotes subject M, and KMj is the number of time points up to time T for subject M, outcome j.

After drawing D samples of random effects uM(d), d = 1, 2, …, D, the latent longitudinal mean for the longitudinal outcome j at time T1 and conditional survival probability are calculated as: EyMj(d)T1∣TM&gt;T0,yM,uM(d),θ^=β^0j+xMj′T1β^j+BMj′b^j+v^j0uM0(d)+v^j1T1uM1(d),

PTM&gt;T1∣TM&gt;T0,yM,uM(d),θ^=exp−∫t=T0T1hMt∣yM,uM(d),θ^dt,

where hMt∣yM,uM(d),θ^=h^0(t) expwM′γ^+BMw′b^w+∑j=1Jα^jEyMj(d)(t). We denote xMj′T1 as the observed longitudinal covariate vector at time T1 for longitudinal outcome j, wM′ as the observed survival covariate vector, BMj′ and BMw′ as the functional covariate vectors, where BMj′=Iμj,Bj+ΞMjIϕj,Bj, and BMw′ is calculated similarly. The FPC score vector ΞMj is approximated as in Section 3.2. The means and quantiles of longitudinal means and conditional survival probability are calculated based on the D samples.

We evaluate the predictive performance in discrimination (how well the models discriminate between subjects who had the event from those who did not) and calibration (how well the models predict the observed data). We assess discrimination using time-dependent Area Under the Receiver Operating Characteristic Curve (AUC). Specifically, we adopt an efficient and unbiased estimator for time-dependent sensitivity and specificity proposed by Li et al.53 The time-dependent sensitivity is estimated as P^Xi&gt;c∣Ti≤τ=∑i=1nWiIXi&gt;c/∑i=1nWi, and the time-dependent specificity is estimated as P^Xi≤c∣Ti≥τ=∑i=1n1−WiIXi≤c/∑i=1n1−Wi, where Wi is the probability of subject i not surviving to time t. The AUC can be approximated using trapezoidal integration from the time-dependent ROC curve, where the best AUC value is 1, indicating perfect prediction, and an AUC value of 0.5 indicates no better than a random guess. The calibration is assessed by Brier Score (BS), which measures the disparity of prediction at a particular time, using a weighted sum of squares of the difference between the true survival status and the estimated survival probability.54 The best BS value is 0, and a BS value 0.25 indicates no better than a random guess.

3.5 MRI Preprocess Protocols and Software Implementation

The downloaded sMRI data had been corrected using gradient warping, B1 non-uniformity correction, and N3 correction. We utilize the MRI preprocess pipelines from Advanced Normalization Tools (ANTs) and FMRIB Software Library (FSL) to process the corrected 3D sMRI data in the following steps: (1) The sMRI data are stored as Digital Imaging and Communications in Medicine (DICOM) format, which are transformed into Neuroimaging Informatics Technology Initiative (NIFTI) format, using oro.dicom package v0.5.3 and oro.nifti package v0.10.1. (2) The neck part in the image is removed using standard MNI152 T1 1mm brain template and extrantsr package v3.9.8.1, and the skull part is then stripped using fslr package v2.24.2. (3) The neck-skull-stripped image is registered to the JHU-MNI-ss (Eve) Template,55 using Symmetric Normalization (SyN) transformation, and Lanczos Windowed Sinc interpolator via extrantsr package and EveTemplate package v0.99.14. (4) The registered image is standardized to have mean 0 and standard deviation 1, and the image voxels are extracted and merged with the White Matter Parcellation Map (WMPM Type II) of the Eve Template,56 using neurobase package v1.27.11.2 and EveTemplate package. (5) We align the non-zero-volume voxels in the order of three-dimensional coordinates, which are then transformed to the one-dimensional domain.

We utilize the following software packages for other computational steps. We use packages mgcv v1.8–30 and MBA v0.0–9 for the tensor-product smoother, and bivariate scattered points from the multilevel B-splines, respectively. We use package Rspectra v0.16–0 for high-dimensional eigendecomposition and we obtain the values of the B-spline function using spline package v4.0.4. For Bayesian inference, we use rstan package v2.19.3. We use loo package v2.1.0 to compute LOOIC and WAIC. For the estimation of AUC and BS, we use package tdROC v1.0 and ipred v0.0–9, respectively.

In summary, our rstan code can handle the following scenarios: (1) shared random effects; (2) more than three longitudinal outcomes by specifying the likelihood for each longitudinal outcome; (3) monotone or non-monotone missing outcomes under missing at random (MAR) assumption; (4) our MJM-FD model reduces to multivariate joint models by removing the functional predictors and coefficient functions.

4 Application to the ADNI Study

4.1 Model Description and Performance

The baseline characteristics we include are: age (mean = 72.8, sd = 7.7), gender (41.4% Female), education years (mean = 16.0, sd = 2.8), Apolipoprotein E (APOE)-ϵ4 alleles (51.2%, 38.1%, 10.6% patients with 0, 1, 2 alleles, respectively). We propose the MJM-FD: Yijtijk=mijtijk+ϵijk,

where mijtijk=β0j+∑κ=14tijk−τκ+β1jκ+xi′βj+∫Sgi,j(s)Bj(s)ds+vj0ui0+vj1tijkui1,

hi(t)=h0(t) expwi′γ+∫Sgi,w(s)Bw(s)ds+∑j=1Jαjmij(t),

where (tijk − τκ)+ (equal to tijk − τκ if tijk &gt; τκ and 0 otherwise) are spline terms to account for the non-linearity of longitudinal trajectories in Figure 1, while τ = {τκ}κ=1, …, 4 = (0, 1.5, 5.0, 9.0) are knot locations. Let Yi1(tijk), Yi2(tijk), Yi3(tijk) be the observed longitudinal outcomes MMSE, CDR-SB, WMS-LM, respectively, for subject i at visit time tijk from baseline. The survival time is the time from baseline to dementia diagnosis or censoring. Note that death is not reported in the ADNI study and we have no information after each individual’s last visit. If dementia diagnosis is not made during the study, we set the dementia diagnosis status as censoring at the last visit. The baseline hazard function is modeled using a piecewise constant function, using same knot locations as the longitudinal time spline. We set baseline characteristics xi′=Agei,Genderi,Educationi′, and wi′=Agei,Genderi,Educationi, APOEi′, where APOEi is the number of APOE-ϵ4 alleles for subject i. We follow the preprocess protocols and voxel-selection methods to process the baseline MRI data. The domains S1, S2, S3, and Sw consist of 324, 69, 1,387, and 972 voxels, respectively.

We compare model performance of six models: MJM-FD (defined above), Hippocampal Model (HM; MJM-FD using only hippocampal voxels as functional predictors gi(s) for both longitudinal and survival outcomes, with gi(s) on domain S with 9,846 voxels), Functional Cox Model (FCM, α1 = α2 = α3 = 0 in MJM-FD), Baseline Functional Cox Model (BFCM, FCM with longitudinal outcome data at baseline), Multivariate Joint Model (MJM; MJM-FD without functional predictors), and MJM-FCM (MJM-FD without functional predictors in longitudinal models). For FCM and BFCM, the parameters for longitudinal models are also estimated and the log-likelihood calculation also includes the longitudinal model, in order to have a fair comparison of LOOIC and WAIC. The reason why we compare MJM-FD and HM is that atrophy of hippocampus volume is strongly associated with faster progression from MCI to AD,57 and we desire to compare the performance of models using voxels from whole-brain vs. hippocampus only.

For model MJM-FD, we perform FPCA on the observed functional predictors and retain certain numbers of eigenfunctions (8 for MMSE, 6 for CDR-SB, 7 for WMS-LM, and 7 for the survival outcome), with PVEs all above 99%. Given the small numbers of informative voxels in each outcome, we use tensor-product surface spline to smooth the raw covariance matrices. For model HM, we retain the first 10 eigenfunctions, with PVE above 95%, and we use bivariate scattered points from the multilevel B-splines to smooth the covariance matrices. Next, we perform eigendecomposition for the smoothed covariance matrices to obtain estimated eigenfunctions and eigenvalues, and construct the approximated covariate matrices.

Table 1 displays Leave-One-Out cross-validation Information Criteria (LOOIC) and Widely Applicable Information Criteria (WAIC) from six candidate models. Model MJM-FD has smaller LOOIC and WAIC compared to HM, indicating that the inclusion of whole-brain voxels improves model fit performances compared to hippocampus voxels only. Comparing to FCM and BFCM, MJM-FD shows large improvement of LOOIC and WAIC, suggesting the advantage of including longitudinal trajectories in the survival model. Moreover, MJM-FD outperforms MJM and MJM-FCM, suggesting that functional predictors are predictive to both longitudinal and survival modeling. The proposed model MJM-FD performed markedly better than all other candidate models with smallest LOOIC and WAIC. Hence, we select model MJM-FD as the final model.

4.2 Results for Model Fitting

The parameter estimates from model MJM-FD are presented in Table 2. For the outcome Mini-Mental State Examination (MMSE), the average decrease is 0.164 (95% CI: [−0.298, −0.035]) for females as compared with males, and the average increase is 0.070 (95% CI: [0.046, 0.095]) for one year increase in education, conditioning on other covariates and the random effects. For the outcome Wechsler Memory Scale - logical memory (WMS-LM), the average decrease is 0.037 (95% CI: [−0.076, −0.001]) for one year increase in baseline age, and the average increase is 0.374 (95% CI: [0.283, 0.463]) for one year increase in education, conditioning on other covariates and the random effects. The random intercepts and the random slopes of time are positively correlated, with a correlation coefficient of 0.473 (95% CI: [0.375, 0.563]), suggesting that MCI patients with worse cognition scores at baseline (negative random intercept ui0) tend to have faster rate of deterioration (negative random slope ui1). The estimated shape parameters are −5.329 (95% CI: [−6.416, −4.401]), 7.816 (95% CI: [6.288, 9.933]), and 0.049 (95% CI: [−0.937, 0.962]) for MMSE, CDR-SB, and WMS-LM, respectively, indicating left-skewed distribution for MMSE, right-skewed distribution for CDR-SB, and no significant skewness for WMS-LM. The estimated association parameters v20 and v21 are negative, while the estimated association parameters v30 and v31 are positive, suggesting that higher (better) MMSE scores are associated with lower (better) CDR-SB scores and higher (better) WMS-LM scores. Specifically, one unit increase of random intercepts is associated with 5.573 (95% CI: [6.288, 9.933]) unit increase of WMS-LM score, while keeping all other covariates as constants. Moreover, the subject-specific progression rates of MMSE and CDR-SB are negatively associated (v^21=−1.331, 95% CI: [−1.573, −1.154]), while the subject-specific progression rates of MMSE and WMS-LM are positively associated (v^31=2.696, 95% CI: [2.284, 3.185]).

For the survival outcome, APOE-ϵ4 is the only significant predictor for the survival outcome. One additional APOE-ϵ4 allele is associated with an increase of logarithm hazard rate by 28.5% (95% CI: [0.104, 0.469]), conditioning on other covariates. One unit increase of CDR-SB score and WMS-LM score is associated with increase of logarithm hazard rate of 30.0% (95% CI: [0.050, 0.540]) and the decrease of logarithm hazard rate of 16.2% (95% CI: [−0.248, −0.075]), respectively.

Using BrainNet Viewer,58 we plot in Figure 2 (in sagittal view of the Eve Template) the heat map of the estimated coefficient functions. For clearer visualization, we provide the 3D movies of the estimated functional predictors in the Web Supplement Section 7. We select some voxels for illustration purpose. For MMSE, the atrophy of voxels on right and left fornix columns and body (label 116 and label 51), right hippocampus (label 92) is associated with lower MMSE scores (worse cognitive functions). For CDR-SB, the atrophy of voxels on right and left fornix columns and body is associated with higher CDR-SB scores (worse behavioral functions). For WMS-LM, the atrophy of voxels on right and left fornix columns and body, and right hippocampus is associated with lower WMS-LM scores (worse memory functions). For the survival outcome, the atrophy of voxels on right hippocampus is associated with faster conversion from MCI to AD. Previous studies find out that the atrophy of the hippocampus region is associated with worse cognitive functions and faster transition to AD.31 Our results confirm this finding, and discover some voxels on other ROIs that are associated with cognitive functions and AD progression.

4.3 Results for Dynamic Prediction

We conduct four-fold cross-validation and repeat 100 times to calculate the mean of estimated AUC and BS to compare the prediction accuracy for six candidate models (MJM-FD, HM, FCM, BFCM, MJM, and MJM-FCM). We set the prediction time t = (1, 1.5, 2) and the prediction window Δt = (0.25, 1).

Table 3 displays the estimated AUC and BS for models MJM-FD, HM, FCM, BFCM, MJM, and MJM-FCM. Model MJM-FD outperforms model HM for all prediction time and prediction windows with larger AUC and smaller BS, indicating using informative voxels from the whole-brain improves the predictive performance as compared to the model using only hippocampus voxels. Comparing MJM-FD with FCM and BFCM, MJM-FD shows good improvement of AUC and BS in most prediction settings, suggesting the advantage of using longitudinal trajectories in the joint-model framework in AD prediction. In comparison with MJM and MJM-FCM, MJM-FD had better predictive performance at later prediction time when more longitudinal data are available, e.g., larger AUC at 2 years and smaller BS at 1.5 and 2 years. Thus, the inclusion of functional predictors in both longitudinal and survival model generally improves the predictive performance of dementia diagnosis.

5 Simulation Study

5.1 Simulation Setting

To evaluate the proposed MJM-FD model, we conduct a simulation study with the true parameters close to the parameter estimates in Table 2, using eight simulation settings: Setting 1 (N = 800, event rate ER = 37% with around 4.5 assessments per longitudinal outcome, missing at random (MAR) with missing rate at around 5%); Setting 2 (N = 800, ER = 37%, No Missing); Setting 3 (N = 800, ER = 63% with around 4.0 assessments per longitudinal outcome, MAR with missing rate at around 5%); Setting 4 (N = 800, ER = 63%, No Missing); Setting 5–8: N = 1200, otherwise same as Setting 1–4. We generate 100 simulated datasets with a sample size of N+N/3 and set N subjects as the training set and retain the remaining subjects as the testing set. Each subject has three longitudinal outcomes (J = 3). The longitudinal outcomes are simulated at time grid [0, …, 3] with a 0.5 year increment. The MJM-FD model is: Yijtijk=mijtijk+ϵijk,

where mijtijk=β0j+∑κ=12tijk−τκ+β1jκ+xiβj+∫Sgi,j(s)Bj(s)ds+vj0ui0+vj1tijkui1,

hi(t)=h0(t) expwiγ+∫Sgi,w(s)Bw(s)ds+∑j=1Jαjmij(t),

where i = 1, …, N + N/3, j = 1, 2, 3, k = 1, …, Kij.

For the longitudinal models, we set (β01, β111, β112, β1) = (28, −1, −0.8, −0.4), (β02, β121, β122, β2) = (2, 1, 0.8, 0.2), (β03, β131, β132, β3) = (8, −1, −0.8, −0.2). The spline knot locations τ = (0, 2) and covariate xi ~ N(0, 1). The association parameters v2 = (−0.5, −0.4), v3 = (1, 0.5). We simulate ui ~ N(0, Σ), where Σ=0.250.10.10.25. The error ϵijk~Skew-Normal0,ωj2,δj, where ω = (1.2, 1, 1) and δ = (−2, 2, 0). We observe the noisy forms of functional predictors at domain S = [0, …, 1] with 0.005 increment for both longitudinal and survival outcomes. The functional predictors are simulated as: gi,j(s)=μj(s)+∑l=110ϕjl(s)ξijl, where μ1(s) = 1 + s, μ2(s)=s+1, μ3(s) = 1 + exp(s). The eigenfunctions ϕ1l(s)=2 sin((2l−1)πs/2), ϕ2l(s)=2 cos((2l−1)πs/2), ϕ3l(s)=ϕ1l(s), for l = 1, 2, …, 10. The FPC scores ξijl ~ N(0, 0.9l−1) for j = 1, 2, 3. We observe a noisy form gi,j(s)′ = gi,j(s) + ϵij(s), where ϵij(s) ~ N(0, 0.01). The coefficient functions B1(s) = 1 + sin(2πs) + cos(2πs), B2(s) = 1+sin(2πs)−cos(2πs), B3(s) = 1−sin(2πs)+cos(2πs). The missing pattern of longitudinal responses is missing at random, where missing indicator Iijk is sampled from Bernoulli distribution with event probability pijk, where logit(pijk) = 2(xi − 2) + t0j(tijk − t0j), where t0j = (2, 2.5, 1.5) for j = 1, 2, 3, generating missing proportions at around 5% for all simulation settings.

For the survival model, the baseline hazard function h0(t) is a piecewise constant function, when 0 ≤ t &lt; 2, h01 = exp(5), and when t ≥ 2, h02 = exp(6) (when ER=37%) or exp(10) (when ER=63%). The covariate wi ~ Binomial(2, 0.4), which mimics the APOE-ϵ4 genotype frequency, and γ = 0.4. The association parameters α1 = −0.4, α2 = 0.8, and α3 = −0.3. We simulate the survival probability Si(t) from standard uniform distribution U(0, 1). The failure time Ti* is computed using equations derived in the Web Supplement Section 4. The censoring time is generated from Ci ~ U(0, 6). The functional predictors are simulated as gi,w(s)=μw(s)+∑l=110ϕwl(s)ξiwl, where μw(s) = 1+Φ(2s), and Φ(s) denotes the CDF of standard normal distribution. The eigenfunctions ϕwl(s) = ϕ2l(s). The FPC scores ξiwl are simulated from N(0, 0.9l−1). We also observe a noisy form gi,w(s)′ = gi,w(s) + ϵiw(s), where ϵiw(s) ~ N(0, 0.01). The coefficient function Bw(s) = 1 − sin(2πs) − cos(2πs).

We perform FPCA on the observed functional predictors with the PVE criteria being 99%. We smooth the mean function using cubic B-spline function with a degree of freedom being 8. We use the tensor-product surface spline to smooth the raw covariance matrix. We perform NUTS sampling in Stan using two chains, each of which has a total of 2, 000 iterations with 1, 000 iterations being burn-in. The ability to estimate the true coefficient functions is assessed by the average mean squared error (AMSE), where AMSE=1/(100⋅S)∑r=1100∑SB(s)−B^(r)(s)2, and S is the number of grid points over domain S, and B^(r)(s) is the estimated coefficient function at r-th simulation replication. We then perform dynamic prediction with prediction time t = (1, 1.5, 2) and prediction window Δt = (0.25, 0.5, 0.75, 1) and we calculate the true AUC, estimated AUC, true BS, and estimated BS.

5.2 Results for Simulation Study

Since simulation Setting 1 is closest to the real data, we present the results from it, while the results from Setting 2–8 are presented in the Supplementary Tables 2–5. Table 4 presents bias (the average of the posterior means minus the true values), standard deviation (SD, the standard deviation of the posterior mean), standard error (SE, the square root of the average of the variance), and coverage probabilities (CP) of 95% credible intervals, in addition to AMSE for Setting 1. Table 4 suggests that the MJM-FD model performs well with small bias, SE being close to SD, the coverage probabilities being reasonably close to the nominal level of 0.95, and AMSE being close to zero. For simulation Setting 2–8, Supplementary Tables 2 and 4 also suggest parameters are estimated with small bias, and the coverage probabilities being close to 0.95. The estimated coefficient functions are close to the true coefficient functions with very little bias. Thus, the simulation studies confirm the correctness of the MJM-FD estimation method and the method in handling the missing data.

Figure 4 displays the true coefficient functions, mean of estimated coefficient functions from 100 replications, and 95% point-wise credible interval bands over domain S. The results indicate that the mean of estimated coefficient functions are very close to the true coefficient functions, with 95% credible interval bands always covering the true functions.

Table 5 displays the true and estimated time-dependent AUC and BS for prediction time at (1.5, 2, 2.5) years and prediction window of (0.25, 0.5, 0.75, 1) years. The estimated AUC values are slightly smaller than the true AUC values, and the estimated BS are slightly larger than the true BS, indicating satisfying model performance in both discrimination and calibration. For simulation Setting 2–8, Supplementary Tables 3 and 5 suggest that the estimated AUC values are close to true AUC values, and the estimated BS are close to true BS, confirming the correctness of the dynamic prediction method under various simulation settings with different sample sizes, event rates, and with or without missing outcome data.

6 Discussion

In this paper, we propose a multivariate joint model with functional data (MJM-FD) framework to jointly model multivariate longitudinal outcomes and a survival outcome in Alzheimer’s Disease, with the baseline magnetic resonance imaging (MRI) data being included as functional predictors. We use shared random intercepts and random slopes of time to account for subject heterogeneity at baseline and rates of progression among longitudinal outcomes. Functional principal component analysis and cubic B-spline functions are used to decompose functional predictors and coefficient functions, respectively. We adopt Bayesian methods for statistical inference and dynamic prediction and apply the MJM-FD framework to the Alzheimer’s Disease Neuroimaging Initiative (ADNI) study, where missing longitudinal responses are imputed in the Markov-Chain Monte Carlo (MCMC) sampling procedure. For longitudinal outcomes, we conclude that older ages are significantly associated with worse memory functions (lower Wechsler Memory Scale-logical memory scores, WMS-LM), and lower education is significantly associated with worse cognition and memory functions (lower Mini-Mental State Examination and WMS-LM scores). Higher Clinical Dementia Rating-sum of boxes scores and lower WMS-LM scores are significantly associated with higher Alzheimer’s disease (AD) risk among participants with mild cognitive impairment (MCI). The atrophy of voxels inside hippocampus and fornix column and body region is associated with worse cognition scores and memory function. The atrophy of voxels inside hippocampus region and other ROIs may expedite the progression from MCI to AD. We also construct a dynamic prediction framework to predict future longitudinal outcomes and risk of AD onset for new subjects. The inclusion of selected voxels from the whole voxel-based baseline MRI data and the inclusion of longitudinal trajectories in the survival model improve the overall model fitting and predictive performance, comparing with other candidate models.

There are few limitations we may address as future directions. First, we only use the baseline MRI data as functional predictors in the MJM-FD, while the longitudinal MRI data are available for some individuals. The longitudinal MRI data can be treated as two-dimensional functional predictors with time and volumes of voxels being two-dimensional domains and the coefficient functions can be constructed in the two-dimensional domains. Second, although we utilize the whole-brain MRI data, we only select voxels with FDR-adjusted p-values less than 0.05 for MMSE and CDR-SB, and 0.01 for WMS-LM and survival outcomes, which is an ad-hoc method for voxel-selection. A recent article discusses a soft-thresholded Gaussian process for scalar-on-image regression and variable selection and it is an alternative way for voxel selection.59 In addition, the informative voxels in WMS-LM are 1,387, about 20 fold more than the informative voxels in CDR-SB (69 voxels), indicating that WMS-LM has larger voxel volume variation than CDR-SB. Finally, we only use one of the representative genetic variants of AD progression, APOE-ϵ4. The MJM-FD framework can be extended to account for multiple genetic variants by adopting the polygenic risk scores (PRS) approach.60,61 Furthermore, age is found to be insignificantly associated with AD progression. The possible reason is that age is a shared covariate in the longitudinal and survival model, and there exists a direct effect and an indirect effect for age. Thus, the age effect is possibly ameliorated in the survival model.

As pointed out by one reviewer, our MJM-FD assumes that the effects of baseline brain structure on the longitudinal trajectories and survival outcome are time-independent. To relax this assumption, we may incorporate coefficient functions with two dimensions in voxel space and time, e.g., replacing Bj(s) in Model (2) by Bj(s, tijk). This modification allows the baseline brain structure to be associated with the intensity of the cognitive change. On the other hand, this change greatly increases the model complexity and computational burden, and we would like to investigate it in our future research. Furthermore, in the longitudinal submodel of the MJM-FD, we model the correlation across multivariate longitudinal outcomes using the shared random effects ui0 and ui1. A more general form is to include outcome-specific random effects which follow a multivariate normal distribution. The large number of required random effects may impose challenging numerical difficulty and computational burden.62 A practical solution to reduce computational burden is to adopt a two-stage approach and use a correction factor based on the importance sampling theory. The correction factor allows us to re-weight each realization of the MCMC sample such that the estimates more closely approximate those obtained via the full multivariate joint model.63

In this article, we use the scalar-on-function regression method to include functional predictors in the multivariate joint model framework. It would be more general if the longitudinal outcome data are treated as functional outcomes on a sparse time domain. To this end, we may treat longitudinal observations as functional outcomes and MRI data as functional predictors, and adopt the function-on-function regression methods. Specifically, the functional mixed effects models can be readily applied to model the longitudinal outcomes and the latent mean function can be incorporated in the survival model as described in several articles.64–66 The dynamic prediction framework can be also developed.

Supplementary Material

supinfo

Acknowledgements

The research of Sheng Luo was supported in part by National Institute of Aging (grant number: R01AG064803). The authors acknowledge the Longleaf Cluster in University of North Carolina for high-performance computation resources. The authors also appreciate Dr. John Muschelli, assistant scientist at Johns Hopkins Bloomberg School of Public Health, for the tutorials and softwares of MRI preprocess pipelines. Data used in preparation of this article were obtained from the Alzheimer’s Disease Neuroimaging Initiative (ADNI) database (adni.loni.usc.edu). As such, the investigators within the ADNI contributed to the design and implementation of ADNI and/or provided data but did not participate in analysis or writing of this report. A complete listing of ADNI investigators can be found at: http://adni.loni.usc.edu/wp-content/uploads/how_to_apply/ADNI_Acknowledgement_List.pdf.

Figure 1: The longitudinal trajectories of MMSE, CDR-SB and WMS-LM for visits at or before dementia diagnosis. The solid curves are the LOWESS curves with 95% CI (shaded regions). The dashed vertical lines are visit times at 1.5, 5.0 and 9.0 years. The slopes are markedly different at those time points.

Figure 2: The brain (in sagittal view) heat map of estimated coefficient functions. For clarity, we only display voxels in the right hippocampus (label 92), right fornix column and body (label 116), left fornix column and body (label 51). The top left, top right, bottom left, bottom right panels are estimated coefficient functions for MMSE, CDR-SB, WMS-LM, and survival outcome, respectively. The colors indicate values of the estimated mean of coefficient functions. The node sizes are proportional to the number of significant voxels in the ROIs for each outcome. The numbers are ROI labels (refer to Supplementary Tables 6 and 7).

Figure 3: The predicted longitudinal outcome trajectories and survival probabilities for a new patient over visit time. The top, middle and bottom panels are the prediction time at 1.5, 2, 2.5 years, respectively. The circled dots are observed longitudinal outcomes. The black dotted vertical lines are the prediction time. The blue solid line are predicted means of longitudinal outcomes and survival probabilities. The dashed curves are the corresponding 95% credible intervals. The person’s censoring time is 4.10 years, which is plotted as the red dashed vertical lines.

Figure 4: The true coefficient functions (solid curves), mean of estimated coefficient functions (dashed curves), and 95% point-wise credible interval bands over domain S. The top left, top right, bottom left, bottom right panels are the coefficient functions B1(s), B2(s), B3(s), Bw(s), respectively.

Table 1: Leave-One-Out cross-validation Information Criteria (LOOIC) and Widely Applicable Information Criteria (WAIC) from MJM-FD, Hippocampal Model (HM), Functional Cox Model (FCM), Baseline Functional Cox Model (BFCM), Multivariate Joint Model (MJM), and MJM-FCM.

	MJM-FD	HM	FCM	BFCM	MJM	MJM-FCM	
LOOIC	37875.4	38007.3	38252.2	38166.7	37943.3	37948.8	
WAIC	37395.3	37528.4	37791.7	37706.6	37445.0	37470.0	

Table 2: Estimated mean, standard error, and 95% credible intervals from Model MJM-FD. The estimated coefficients for coefficient functions are available in Web Supplement Section 5.

	Parameters	Mean	SE	2.5%	97.5%	
— Longitudinal outcomes						
MMSE	Intercept	29.055	0.433	28.226	29.873	
	Age (years)	−0.006	0.005	−0.016	0.004	
	Female Sex	−0.164	0.068	−0.298	−0.035	
	Education (years)	0.070	0.012	0.046	0.095	
CDR-SB	Intercept	0.768	0.174	0.427	1.119	
	Age (years)	−0.003	0.002	−0.007	0.001	
	Female Sex	0.009	0.027	−0.042	0.061	
	Education (years)	−0.007	0.005	−0.016	0.002	
WMS-LM	Intercept	4.794	2.225	0.436	9.158	
	Age (years)	−0.037	0.018	−0.076	−0.001	
	Female Sex	−0.145	0.261	−0.667	0.388	
	Education (years)	0.374	0.046	0.283	0.463	
	σ u1	0.557	0.067	0.440	0.695	
	σ u2	0.452	0.042	0.370	0.531	
	ρ	0.473	0.046	0.375	0.563	
	v 20	−0.009	0.036	−0.078	0.064	
	v 21	−1.331	0.109	−1.573	−1.154	
	v 30	5.573	0.656	4.398	6.936	
	v 31	2.696	0.231	2.284	3.185	
	δ 1	−5.329	0.511	−6.416	−4.401	
	δ 2	7.816	0.931	6.288	9.933	
	δ 3	0.049	0.565	−0.937	0.962	
Survival outcome						
	Age (years)	−0.016	0.010	−0.034	0.003	
	Female Sex	−0.083	0.144	−0.376	0.214	
	Education (years)	0.006	0.025	−0.044	0.055	
	APOE-ϵ4 Alleles	0.285	0.096	0.104	0.469	
	α (MMSE)	−0.073	0.173	−0.431	0.253	
	α (CDR-SB)	0.300	0.124	0.050	0.540	
	α (WMS-LM)	0.162	0.044	0.248	0.075	

Table 3: Mean of estimated AUC and BS for MJM-FD, HM, FCM, BFCM, MJM, and MJM-FCM

		MJM-FD	HM	FCM	BFCM	MJM	MJM-FCM	
Prediction Time	Δt	AUC	BS	AUC	BS	AUC	BS	AUC	BS	AUC	BS	AUC	BS	
1.0	0.25	0.797	0.055	0.763	0.054	0.745	0.054	0.808	0.052	0.801	0.053	0.795	0.050	
	1.00	0.849	0.099	0.817	0.107	0.751	0.113	0.845	0.102	0.851	0.104	0.851	0.098	
1.5	0.25	0.854	0.034	0.824	0.038	0.709	0.040	0.840	0.041	0.861	0.038	0.848	0.035	
	1.00	0.877	0.092	0.873	0.097	0.755	0.112	0.852	0.095	0.875	0.099	0.876	0.095	
2.0	0.25	0.883	0.063	0.882	0.065	0.764	0.063	0.844	0.061	0.876	0.065	0.881	0.064	
	1.00	0.884	0.076	0.841	0.082	0.770	0.084	0.837	0.082	0.870	0.079	0.881	0.080	

Table 4: Parameter estimation from 100 simulation replications for simulation Setting 1

	Parameters	Bias	SD	SE	CP	
Longitudinal outcomes				
Y 1	β01=28	−0.013	0.056	0.059	0.950	
	β111=−1	−0.003	0.029	0.030	0.960	
	β112=−0.8	0.003	0.080	0.086	0.950	
	β1=−0.4	−0.001	0.024	0.026	0.980	
Y 2	β02=2	−0.001	0.037	0.038	0.980	
	β121=1	0.002	0.018	0.019	0.940	
	β122=0.8	−0.001	0.061	0.065	0.970	
	β2=0.2	−0.001	0.015	0.016	0.940	
Y 3	β03=8	−0.060	0.217	0.318	0.980	
	β131=−1	0.001	0.032	0.029	0.910	
	β132=0.8	−0.011	0.113	0.099	0.910	
	β3=−0.2	0.000	0.021	0.026	0.980	
	σu0=0.5	−0.000	0.028	0.028	0.960	
	σu1=0.5	−0.002	0.025	0.024	0.950	
	ρ=0.4	−0.000	0.075	0.072	0.940	
	v20=−0.5	−0.008	0.040	0.039	0.930	
	v21=−0.4	0.003	0.023	0.025	0.960	
	v30=1	0.009	0.067	0.067	0.950	
	v31=0.5	−0.003	0.039	0.039	0.970	
	δ1=−2	0.026	0.167	0.177	0.960	
	δ2=2	0.024	0.144	0.149	0.930	
	δ3=0	0.035	0.289	0.419	0.980	
Survival outcomes				
	γ=0.4	−0.002	0.096	0.095	0.960	
	α1=−0.4	−0.014	0.046	0.044	0.940	
	α2=0.8	0.023	0.063	0.058	0.910	
	α3=−0.3	−0.000	0.051	0.046	0.910	
	AMSE.B1	0.019				
	AMSE.B2	0.008				
	AMSE.B3	0.016				
	AMSE.BW	0.184				

Table 5: True area under the ROC curve (AUC), estimated AUC, true Brier Score (BS), and estimated BS from 100 simulation replications.

t	Δt	True AUC	Estimated AUC	True BS	Estimated BS	
1.0	0.25	0.895	0.885	0.022	0.022	
	0.50	0.893	0.880	0.041	0.044	
	0.75	0.893	0.879	0.059	0.063	
	1.00	0.894	0.879	0.074	0.080	
1.5	0.25	0.872	0.864	0.032	0.033	
	0.50	0.877	0.868	0.056	0.059	
	0.75	0.890	0.877	0.087	0.093	
	1.00	0.900	0.884	0.106	0.117	
2.0	0.25	0.878	0.867	0.064	0.067	
	0.50	0.886	0.875	0.100	0.107	
	0.75	0.902	0.887	0.114	0.124	
	1.00	0.919	0.901	0.064	0.071	


References

1. Hebert LE , Weuve J , Scherr PA , Alzheimer disease in the United States (2010–2050) estimated using the 2010 census. Neurology. 2013;80 (19 ):1778–1783.23390181
2. Jack CR , Albert MS , Knopman DS , Introduction to the recommendations from the National Institute on Aging-Alzheimer’s Association workgroups on diagnostic guidelines for Alzheimer’s disease. Alzheimers Dement. 2011;7 (3 ):257–262.21514247
3. Gross AL , Mungas DM , Leoutsakos JS , Alzheimer’s disease severity, objectively determined and measured. Alzheimers Dement. 2016;4 :159–168.
4. Mitchell AJ , Shiri-Feshki M . Rate of progression of mild cognitive impairment to dementia: Meta-analysis of 41 robust inception cohort studies. Acta Psychiatr Scand. 2009;119 (4 ):252–265.19236314
5. Wulfsohn MS , Tsiatis AA . A Joint Model for Survival and Longitudinal Data Measured with Error. Biometrics. 1997;53 (1 ):330–339.9147598
6. Henderson R , Diggle P , Dobson A . Joint modelling of longitudinal measurements and event time data. Biostatistics. 2000;1 (4 ):465–480.12933568
7. Mauff K , Steyerberg E , Kardys I , Joint models with multiple longitudinal outcomes and a time-to-event outcome: a corrected two-stage approach. Stat Comput. 2020;30 (4 ):999–1014.
8. Long JD , Mills JA . Joint modeling of multivariate longitudinal data and survival data in several observational studies of Huntington’s disease. BMC Med Res Methodol. 2018;18 (1 ):138.30445915
9. Proust-Lima C , Dartigues JF , Jacqmin-Gadda H . Joint modeling of repeated multivariate cognitive measures and competing risks of dementia and death: a latent process and latent class approach. Stat Med. 2016;35 (3 ):382–398.26376900
10. Hickey GL , Philipson P , Jorgensen A , Joint modelling of time-to-event and multivariate longitudinal outcomes: recent developments and issues. BMC Med Res Methodol. 2016;16 (1 ):1–15.26728979
11. Papageorgiou G , Mauff K , Tomer A , An overview of joint modeling of time-to-event and longitudinal outcomes. Annu Rev Stat Appl. 2019;6 :223–240.
12. Rizopoulos D Dynamic predictions and prospective accuracy in joint models for longitudinal and time-to-event data. Biometrics. 2011;67 (3 ):819–829.21306352
13. Li L , Luo S , Hu B , Dynamic prediction of renal failure using longitudinal biomarkers in a cohort study of chronic kidney disease. Stat Biosci. 2017;9 (2 ):357–378.29250207
14. Schumacher M , Hieke S , Ihorst G , Dynamic prediction: A challenge for biostatisticians, but greatly needed by patients, physicians and the public. Biomed J. 2020;62 (3 ):822–835.
15. Leroux A , Xiao L , Crainiceanu CM , Dynamic prediction in functional concurrent regression with an application to child growth. Stat Med. 2018;37 (8 ):1376–1388.29230836
16. Vemuri P , Jack CR . Role of structural MRI in Alzheimer’s disease. Alzheimers Res Ther. 2010;2 (4 ):23.20807454
17. Lerch JP , Kouwe AJ , Raznahan A , Studying neuroanatomy using MRI. Nat Neurosci. 2017;20 (3 ):314–326.28230838
18. Nicole RG , Vince DC , Godfrey DP , Voxel-based morphometry versus region of interest: A comparison of two methods for analyzing gray matter differences in schizophrenia. Schizophr Res. 2005;74 (2 ):135–147.15721994
19. Buchanan RW , Francis A , Arango C , Morphometric assessment of the heteromodal association cortex in schizophrenia. Am J Psychiatry. 2004;161 (2 ):322–331.14754782
20. Nho K , Risacher SL , Crane PK , Voxel and surface-based topography of memory and executive deficits in mild cognitive impairment and Alzheimer’s disease. Brain Imaging Behav. 2012;6 (4 ):551–567.23070747
21. Jennifer LW . Voxel-based morphometry: An automated technique for assessing structural changes in the brain. J Neurosci. 2009;29 (31 ):9661–9664.19657018
22. Wang J , Chiou J , Müller H . Functional data analysis. Annu Rev Stat Appl. 2016;3 (1 ):257–295.
23. Morris JS . Functional regression. Annu Rev Stat Appl. 2015;2 (1 ):321–359.
24. Goldsmith J , Bobb J , Crainiceanu CM , Penalized functional regression. J Comput Graph Stat. 2010;20 (4 ):830–851.
25. Goldsmith J , Crainiceanu CM , Caffo B , Longitudinal penalized functional regression for cognitive outcomes on neuronal tract measurements. J R Stat Soc Ser C Appl Stat. 2012;61 (3 ):453–469.
26. Reiss PT , Goldsmith J , Shang HL , Methods for scalar-on-function regression. Int Stat Rev. 2017;85 (2 ):228–249.28919663
27. Yao F , Müller H , Wang J . Functional data analysis for sparse longitudinal data. J Am Stat Assoc. 2005;100 (470 ):577–590.
28. Happ C , Greven S . Multivariate functional principal component analysis for data observed on different (dimensional) domains. J Am Stat Assoc. 2018;113 (522 ):649–659.
29. Di CZ , Crainiceanu CM , Caffo BS , Multilevel functional principal component analysis. Ann Appl Stat. 2009;3 (1 ):458–488.20221415
30. Xiao L , Zipunnikov V , Ruppert D , Fast covariance estimation for high-dimensional functional data. Stat Comput. 2016;26 :409–421.26903705
31. Li K , Luo S . Dynamic predictions in Bayesian functional joint models for longitudinal and time-to-event data: An application to Alzheimer’s disease. Stat Methods Med Res. 2019;28 (2 ):327–342.28750578
32. Li K , Chan W , Doody RS , Prediction of conversion to Alzheimer’s disease with longitudinal measures and time-to-event data. J Alzheimers Dis. 2017;58 (2 ):360–370.
33. Besser L , Kukull W , Knopman DS , Version 3 of the National Alzheimer’s Coordinating Center’s Uniform Data Set. Alzheimer Dis Assoc Disord. 2018;32 (4 ):351–358.30376508
34. Bennett DA , Buchman AS , Boyle PA , Religious orders study and rush memory and aging project. J Alzheimers Dis. 2018;64 (s1 ):S161–S189.29865057
35. Ellis KA , Bush AI , Darby D , The Australian Imaging, Biomarkers and Lifestyle (AIBL) study of aging: Methodology and baseline characteristics of 1112 individuals recruited for a longitudinal study of Alzheimer’s disease. Int Psychogeriatr. 2009;21 (4 ):672–687.19470201
36. Leoutsakos JM , Forrester SN , Corcoran CD , Latent classes of course in Alzheimer’s disease and predictors: The Cache County Dementia Progression Study. Int J Geriatr Psychiatry. 2015;30 (8 ):824–832.25363393
37. Chapman KR , Bing-Canar H , Alosco ML , Mini Mental State Examination and Logical Memory scores for entry into Alzheimer’s disease trials. Alzheimers Res Ther. 2016;8 (9 ).
38. Ashburner J , Friston KJ . Voxel-based morphometry—the methods. Neuroimage. 2000;11 (6 ):805–821.10860804
39. Pergher V , Demaerel P , Soenen O , Identifying brain changes related to cognitive aging using VBM and visual rating scales. Neuroimage Clin. 2019;22 :101697.30739844
40. Nho K , Risacher SL , Crane PK , Voxel and surface-based topography of memory and executive deficits in mild cognitive impairment and Alzheimer’s disease. Brain Imaging Behav. 2012;6 (4 ):551–567.23070747
41. Oschwald J , Guye S , Liem F , Brain structure and cognitive ability in healthy aging: a review on longitudinal correlated change. Rev Neurosci. 2020;31 (1 ):1–57.
42. Anatürk M , Suri S , Zsoldos E , Associations between longitudinal trajectories of cognitive and social activities and brain health in old age. JAMA Netw Open. 2020;3 (8 ):e2013793–e2013793.32816032
43. Chou YY , Leporé N , Saharan P , Ventricular maps in 804 ADNI subjects: correlations with CSF biomarkers and clinical decline. Neurobiol Aging. 2010;31 (8 ):1386–1400.20620663
44. Evans MC , Barnes J , Nielsen C , Volume changes in Alzheimer’s disease and mild cognitive impairment: cognitive associations. Eur Radiol. 2010;20 (3 ):674–682.19760240
45. Kovacevic S , Rafii MS , Brewer JB . High-throughput, fully-automated volumetry for prediction of MMSE and CDR decline in mild cognitive impairment. Alzheimer Dis Assoc Disord. 2009;23 (2 ):139.19474571
46. Armstrong NM , An Y , Shin JJ , Associations between cognitive and brain volume changes in cognitively normal older adults. Neuroimage. 2020;223 :117289.32835822
47. Geert V , Steffen F , Geert M , The analysis of multivariate longitudinal data: A review. Stat Methods Med Res. 2014;23 (1 ):42–59.22523185
48. Lawless JF , Zhan M . Analysis of interval-grouped recurrent-event data using piecewise constant rate functions. Can J Stat. 1998;26 (4 ):549–565.
49. Feng S , Wolfe RA , Port FK . Frailty survival model analysis of the national deceased donor kidney transplant dataset using Poisson variance structures. J Am Stat Assoc. 2005;100 (471 ):728–735.
50. Liu L , Huang X . Joint analysis of correlated repeated measures and recurrent events processes in the presence of death, with application to a study on acquired immune deficiency syndrome. J R Stat Soc Ser C Appl Stat. 2009;58 (1 ):65–81.
51. Homan MD , Gelman A . The No-U-Turn sampler: Adaptively setting path lengths in Hamiltonian Monte Carlo. J Mach Learn Res. 2014;15 (1 ):1593–1623.
52. Vehtari A , Gelman A , Gabry J . Practical Bayesian model evaluation using leave-one-out cross-validation and WAIC. Stat Comput. 2017;27 :1413–1432.
53. Li L , Greene T , Hu B . A simple method to estimate the time-dependent receiver operating characteristic curve and the area under the curve with right censored data. Stat Methods Med Res. 2018;27 (8 ):2264–2278.27895266
54. Graf E , Schmoor C , Sauerbrei W , Assessment and comparison of prognostic classification schemes for survival data. Stat Med. 1999;18 (17–18 ):2529–2545.10474158
55. Oishi K , Faria A , Mori S . JHU-MNI-ss Atlas. Johns Hopkins University School of Medicine, Department of Radiology, Center for Brain Imaging Science 2010.
56. Oishi K , Faria A , Jiang H , Atlas-based whole brain white matter analysis using large deformation diffeomorphic metric mapping: Application to normal elderly and Alzheimer’s disease participants. Neuroimage. 2009;46 (2 ):486–499.19385016
57. Jack CR , Petersen RC , Xu YC , Prediction of AD with MRI-based hippocampal volume in mild cognitive impairment. Neurology. 1999;52 (7 ):1397–1397.10227624
58. Xia M , Wang J , He Y . BrainNet Viewer: A network visualization tool for human brain connectomics. PLoS One. 2013;8 (7 ).
59. Kang J , Reich BJ , Staicu A . Scalar-on-image regression via the soft-thresholded Gaussian process. Biometrika. 2018;105 (1 ):165–184.30686828
60. Escott-Price V , Sims R , Bannister C , Common polygenic variation enhances risk prediction for Alzheimer’s disease. Brain. 2015;138 (12 ):3673–3684.26490334
61. Chaudhury S , Brookes KJ , Patel T , Alzheimer’s disease polygenic risk score as a predictor of conversion from mild-cognitive impairment. Transl Psychiatry. 2019;9 (1 ):154.31127079
62. Vasdekis GS , Rizopoulos D , Moustaki I . Weighted pairwise likelihood estimation for a general class of random effects models. Biostatistics. 2014;15 (4 ):677–689.24812421
63. Mauff K , Steyerberg E , Kardys I , Joint models with multiple longitudinal outcomes and a time-to-event outcome: a corrected two-stage approach. Stat Comput. 2020;30 (4 ):999–1014.
64. Guo W . Functional mixed effects models. Biometrics. 2002;58 (1 ):121–128.11890306
65. Guo W . Functional mixed effects models. Stat Methods Med Res. 2004;13 (1 ):49–62.14746440
66. Yao F . Functional principal component analysis for longitudinal and survival data. Stat Sin. 2007;17 (3 ):965–983.
