LICENSE: This file is available for text mining. It may also be used consistent with the principles of fair use under the copyright law.


8215016
7188
Stat Med
Stat Med
Statistics in medicine
0277-6715
1097-0258

36805635
10133011
10.1002/sim.9683
NIHMS1871594
Article
Multivariate functional mixed model with MRI data: an application to Alzheimer’s Disease
Zou Haotian 1
Xiao Luo 2
Zeng Donglin 1
Luo Sheng *3
Alzheimer’s Disease Neuroimaging Initiative
1 Department of Biostatistics, University of North Carolina, Chapel Hill, North Carolina, United States
2 Department of Statistics, North Carolina State University, North Carolina, United States
3 Department of Biostatistics and Bioinformatics, Duke University, North Carolina, United States
* Correspondence: Sheng Luo, Department of Biostatistics and Bioinformatics, Duke University, North Carolina, United States. sheng.luo@duke.edu
8 2 2023
10 5 2023
20 2 2023
10 5 2024
42 10 14921511
This file is available for text mining. It may also be used consistent with the principles of fair use under the copyright law.
Summary

Alzheimer’s Disease (AD) is the leading cause of dementia and impairment in various domains. Recent AD studies, (i.e., Alzheimer’s Disease Neuroimaging Initiative (ADNI) study), collect multimodal data, including longitudinal neurological assessments and magnetic resonance imaging (MRI) data, to better study the disease progression. Adopting early interventions is essential to slow AD progression for subjects with mild cognitive impairment (MCI). It is of particular interest to develop an AD predictive model that leverages multimodal data and provides accurate personalized predictions. In this article, we propose a multivariate functional mixed model with MRI data (MFMM-MRI) that simultaneously models longitudinal neurological assessments, baseline MRI data, and the survival outcome (i.e., dementia onset) for subjects with MCI at baseline. Two functional forms (the random-effects model and instantaneous model) linking the longitudinal and survival process are investigated. We use Markov Chain Monte Carlo (MCMC) method based on No-U-Turn Sampling (NUTS) algorithm to obtain posterior samples. We develop a dynamic prediction framework that provides accurate personalized predictions of longitudinal trajectories and survival probability. We apply MFMM-MRI to the ADNI study and identify significant associations among longitudinal outcomes, MRI data, and the risk of dementia onset. The instantaneous model with voxels from the whole brain has the best prediction performance among all candidate models. The simulation study supports the validity of the estimation and dynamic prediction method.

Alzheimer’s Disease
Magnetic resonance imaging
Functional regression
Bayesian method
Dynamic prediction

pmc1 | INTRODUCTION

Alzheimer’s Disease (AD) is the leading cause of dementia and impairment in various domains (e.g., cognition, memory, and daily activities).1 In US, the predicted number of subjects with AD reach 6.5 million in 2022, imposing a significant health burden.2 Recent AD studies, i.e., Alzheimer’s Disease Neuroimaging Initiative (ADNI) and National Alzheimer’s Coordinating Center (NACC), collect multimodal data, including longitudinal neurological assessments, biomarkers, medical imaging, and genomics data to better understand disease severity and progression pattern.3,4 Mild cognitive impairment (MCI) is an important clinical progression stage of AD.5 Cognition decline and impairment of one or more cognitive domains are presented in subjects with MCI due to AD. Adopting early personalized interventions in the MCI stage is essential to delay the time until dementia onset.6 Hence, it is important to develop an AD predictive model that leverages multimodal data and provides accurate personalized predictions of dementia onset.

The joint model (JM) is a broadly applicable approach to jointly analyze longitudinal repeated measurements and survival outcome.7,8 Recently, extensive research works applied the JM framework to investigate AD progression pattern and predict the risk of dementia onset.9–11 In the JM framework, the longitudinal and survival outcomes are commonly modelled using generalized mixed models and Cox proportional hazards models, respectively.8 Multiple functional forms have been investigated to link the association between the latent longitudinal mean and hazard function.12,13 Recently, the extension of JM to modelling multivariate longitudinal processes is investigated in multiple literature, while complex functional forms are incorporated to model the association between these two processes.14–16 Additionally, Bayesian shrinkage priors are adopted to determine the most appropriate functional form.17 Dynamic prediction is an important application of JM, which provides personalized predictions of longitudinal trajectories and the probability of event occurrence (e.g., dementia onset) based on subject’s latest data,8,18,19 and facilitates clinical decision making, treatment selection, and counseling the disease progress with patients.

Magnetic resonance imaging (MRI) is an widely used imaging technique that provides detailed anatomical structures of the whole brain.20,21 A common MRI tool that detects volume change in regions of interest (ROI) for patients with AD is the structural MRI (sMRI). Voxel-based morphometry (VBM) is a standard analytical method that performs voxel-wise comparison of the ROI volumes among multiple groups of subjects.22,23 For example, recent literature reported significant volume atrophy in hippocampus, cortical, and brainstem regions for subjects with early AD as compared with healthy controls using VBM analysis.24,25 Alternatively, the volumetric sMRI data can be treated as a functional outcome with millions of voxels observed on a dense voxel grid, and the functional regression approach can be adopted to handle the high-dimensional sMRI data as in previous literature.9,11

Functional regression is commonly used to model functional outcomes observed on a discrete grid.26,27 To model the univariate longitudinal variable as a sparse functional outcome, Guo28 proposed a semi-parametric functional mixed-effects model (FMEM) that decomposed the latent longitudinal mean into covariate-specific fixed functions and random effects functions. Yao29 extended the FMEM to the shared latent functional principal components (FPC) model to jointly analyze univariate functional longitudinal outcome and the survival process. To model the multivariate longitudinal outcomes, Li et al.10 proposed the non-parametric multivariate functional mixed model (MFMM) that captured nonlinear longitudinal trajectories and simultaneously modelled the survival outcome, linked by the FPC scores that are shared among multiple longitudinal outcomes and the outcome-specific FPC scores. On the other hand, it is essential to model voxel-wise sMRI data at baseline as a functional covariate because brain atrophy in some voxels negatively impact cognitive functions.9,11 To this end, Zou et al.11 used parametric mixed models for multivariate longitudinal outcomes while modelling the baseline sMRI data as functional covariates. However, the model did not capture complex nonlinear longitudinal trajectories and was sensitive to model misspecification.

In this article, we propose to extend the flexible non-parametric MFMM proposed by Li et al.,10 to a multivariate functional mixed model with MRI data (MFMM-MRI) that jointly models multivariate longitudinal outcomes (i.e., neurological scores), baseline MRI data, and the survival outcome (i.e., dementia onset). We decompose the functional volumetric sMRI data in a similar fashion to the joint and individual variation explained (JIVE) approach.30 Specifically, the MRI data are decomposed into the joint variation (the function determines shared variation between longitudinal outcomes and MRI data) and the individual variation (the function determines MRI-specific varying pattern). We also develop dynamic prediction methods that provide personalized predictions of dementia onset for subjects with MCI at baseline. Comparing with existing literature, our method is novel in three aspects. First, we use a non-parametric functional mixed model to model multivariate longitudinal outcomes and investigate two functional forms of the association between the longitudinal and survival process, which increase the flexibility in modelling and interpretation. Second, we include the baseline MRI data as a functional outcome and use a general and non-parametric decomposition similar in nature with JIVE. Third, we provide personalized predictions of longitudinal outcomes and the probability of remaining stable MCI, which facilitates clinical prognosis and early personalized interventions. The multivariate functional mixed model with MRI data (MFMM-MRI) provides personalized predictions of neurological scores and the risk of dementia onset using longitudinal outcomes, baseline MRI data, and the survival outcome. Additionally, we are able to determine the associations among those three types of outcomes.

This article is structured as follows. In Section 2, we give a brief introduction to the motivating ADNI study. In Section 3, we illustrate the MFMM-MRI model, its estimation, and the dynamic prediction method. In Section 4, the MFMM-MRI is applied to the motivating ADNI study. In Section 5, a simulation study is conducted to support the validity of the estimation and prediction method. In Section 6, we summarize our findings and discuss the limitations and future directions.

2 | MOTIVATION

The development of MFMM-MRI is motivated from the Alzheimer’s Disease Neuroimaging Initiative (ADNI) study with completed ADNI-1/GO/2 stages and the ongoing ADNI-3 stage. The primary objective of the ADNI study is to determine and predict cognition decline using biomarkers, neurological assessments, medical imaging data, and genetic data for subjects with different stages of AD.3 Based on a previous finding,31 we select five longitudinal neurological measurements that are predictive of dementia onset: Alzheimer’s Disease assessment scale - cognitive subscale, 13 items (ADAS-Cog 13), Rey auditory verbal learning test, immediate recall (RAVLT-immediate), RAVLT learning curve (RAVLT-learning), Mini-mental state examination (MMSE), and clinical dementia rating scale - sum of boxes (CDR-SB).32–35 Higher values in ADAS-Cog 13 and CDR-SB and lower values in other outcomes indicate worse cognitive and memory functions and are associated with faster AD progression. Figure 1 displays a spaghetti plot of these five selected longitudinal outcomes for randomly selected 15 subjects with MCI at baseline, suggesting the sparsity of longitudinal outcomes. Additionally, both subjects A and B show an increasing (clinically deteriorating) pattern for ADAS-Cog 13 and CDR-SB scores and a decreasing (clinically declining) trend for RAVLT and MMSE scores, suggesting that multivariate longitudinal outcomes are correlated within the same subject. Thus, we adopt the multivariate functional mixed model to model the five selected longitudinal outcomes observed on a sparse time grid.10

Based on the data downloaded on Jan. 15, 2020, we include 1,018 subjects with MCI at baseline from the ADNI-1/GO/2/3 stages. We exclude 86 subjects with missing ApoE-ϵ4 alleles because the ApoE-ϵ4 allele is associated with an increased risk of dementia occurrence.36 Moreover, we exclude one subject with missing education years and 189 subjects with invalid or no MRI data at baseline. The survival time is the time from baseline to the first dementia diagnosis. Subjects without dementia diagnosis during the follow-up period are treated as right-censored and the event time is set as the last visit time. The final analysis dataset consists of 742 subjects and 3323 visits, with 268 dementia occurrences. The outcomes ADAS-Cog 13, RAVLT-immediate, RAVLT-learning, MMSE, CDR-SB have 29, 15, 15, 8, 35 missing values, respectively. Subjects have a mean follow-up period of 2.70 years, with SD being 2.47 years. The minimum and maximum number of visits are 1 visit and 13 visits, with median being 4 visits.

3 | METHODS

Suppose there are N subjects (denoted as i = 1, 2, …, N) and J longitudinal outcomes (denoted as j = 1, 2, …, J), measured at time (ti1, ti2, …, tiKi), where Ki is the number of visits for subject i. Let Yi(tik) be the observed j-th longitudinal outcome for subject i and visit k, for k = 1, …, Ki, with a random noise ϵijk. Let Y˜ij(tik) denote the missing longitudinal outcome and Iijk be the missing status indicator (1 if outcome Yij(tik) is missing and 0 otherwise) and we assume missing at random (MAR). For subject i, We denote the baseline MRI data as mi(υ) at voxel location υ observed on a one-dimensional grid V, which is the vector of voxels of interest with length V, where V = 9, 846 if hippocampal voxels are of clinical interest and V = 642 after voxel-selection from the whole brain. The event time and censoring status for subject i are denoted as Ti=min(Ti*,Ci) and δi=I(Ti*≤Ci), respectively, where Ti* and Ci are the failure time and censoring time, respectively, and I() is an indicator function.

3.1 | MRI preprocess pipelines and voxel selection steps

The MRI data are T1-weighted structural MRI data, which undergone gradient warping, B1 non-uniformity correction, and N3 correction. The MRI preprocess pipelines and voxel selection steps are detailed in Zou et al.11 In brief, we register the neckskull-stripped MRI data to the JHU-MNI-ss (Eve) Template and the registered MRI data are standardized and merged with the white matter parcellation map (WMPM Type II) of the Eve Template, with S = 1, 843, 303 voxels.

For the voxel selection steps, we independently fit Cox proportional hazards models for S voxels from the whole brain: hi(t)=h0(t)exp(Zi′α+γsVoli,s), where Zi′ is the covariate vector and Voli,s is the voxel volume for voxel s and subject i. We adjust the p-value of the regression coefficient γs using false discovery rate (FDR) and the p-value threshold is set as 0.01.11 Similar ideas of voxel selection were adopted in recent literature. For example, Huang et al.37 used the logistic regression classifier to identify significant voxels, where they utilized the survival information (whether patients converted to AD). Additionally, Petrone et al.38 used the Jacobian determinant maps for feature selection and they also classified patients into three groups and used F-test to identify significant voxels.

3.2 | Model

The longitudinal outcome Yij(tik) is assumed to be a noisy measurement of the latent process Xij(tik) that Yij(tik) = Xij(tik)+ϵijk. The MRI data mi(υ) is also assumed to have a random noise ϵmi(υ). We denote subject i’s baseline covariate vector as Zi′. We model the longitudinal outcome Yij(tik), baseline MRI data mi(υ), and the survival process in the multivariate functional mixed model with MRI (MFMM-MRI): (1) Yij(tik)=Xij(tik)+ϵijk=μj(tik)+βj(Ui(tik)+Wij(tik))+ϵijk,

(2) mi(v)=μm(v)+βmumi(v)+fmi(v)+ϵmi(v),

(3) hi(t)=h0(t)exp(Zi′α+F(Xi,t)+gmi′γm).

In Model (1), we decompose the latent longitudinal process Xij(tik) into three components: the outcome-specific mean function μj(tik), the shared random profile Ui(tik), and the subject-outcome specific random profile Wij(tik), with an association parameter βj. The mean function μj(t) is time dependent and an additive model can be adopted to incorporate the time-varying effects of some baseline covariates. The shared random profile Ui(t) quantifies the subject-specific random deviation from the mean function and is shared across all longitudinal outcomes. The subject-outcome specific random profile Wi(t) quantifies subject-outcome specific disease progression pattern and we assume random profiles Ui(t), Wij(t), and random error ϵijk are independent. Higher values of random profiles Ui(t) and Wij(t) imply worse cognitive functions because we set β1 = 1 for the outcome ADAS-Cog 13 to achieve model identifiability. The association parameter βj is the expected increase of the outcome j in one unit increase of random profiles Ui(t) and Wij(t). The random error is assumed to follow ϵijk~N(0,σj2).

In Model (2), the subscript m is to denote the MRI data. We decompose the MRI data into three components, similar in nature with the JIVE approach,30 (1) mean function μm(υ); (2) joint variation (MRI component umi(υ) shared with the multivariate longitudinal outcomes via the latent functional principal component scores ξil detailed in Section 3.3, and being multiplied by a scale parameter βm); and (3) the individual variation (the MRI-specific varying pattern fmi(υ)), while the random noise ϵmi(v)~N(0,σm2). The scale parameter βm measures the strength of correlation between MRI data and longitudinal outcomes (e.g., βm = 0 indicates independence). We assume that MRI components umi(υ), fmi(υ), and random error ϵmi(υ) are independent.

In the survival model (3), h0(t) is the baseline hazard function and α is the regression coefficient vector. The functional form F(Xi, t) quantifies the contribution of the multivariate longitudinal outcomes towards the hazard function, whose expressions are detailed in Section 3.3. The parameter vector γm is the contribution of the MRI-specific pattern g′mi to the survival outcome, where g′mi is the projection of the individual variation fmi(υ) to its eigenfunctions (see details in Section 3.4). Figure 2 displays a directed acyclic graph showing the latent structural equations based on Models (1) to (3).

3.3 | Functional components, functional forms and Bayesian inference

In the longitudinal Model (1), we approximate the mean function μj(t) using cubic B-spline functions with p degrees of freedom, so that μj(t)≈∑j=1Pbp(t)Ajp, where bp(t) is the p-th cubic B-spline function at time t and Ajp is the regression coefficient. We set p as 9 because the sensitivity analysis displayed in Supplementary Table S1 suggests that the model assessment statistics are very close for different numbers of B-spline functions: p = (7, 8, 9, 10, 11). The random profiles Ui(t) and Wij(t) are assumed to be two zero-mean stochastic processes with covariance functions C0(t, t′) and C1(t, t′), respectively, where t and t′ are two different time points. By Mercer’s Theorem, we decompose covariance functions C0(t,t′)=∑l=1∞d0lϕl(t)ϕl(t′) and C1(t,t′)=∑l=1∞d1lψl(t)ψl(t′), where d0l and d1l are non-increasing eigenvalues, and ϕl(t) and Ψl(t) are orthonormal eigenfunctions of Ui(t) and Wij(t), respectively, i.e., ∫ ϕl(t)2dt = 1, and ∫ ϕl(t)ϕl′(t)dt = 0 for l ≠ l′. By Karhunen-Loeve’s expansion, we express random profiles Ui(t)=∑l=1∞ξilϕl(t) and Wij(t)=∑l=1∞ζijlψl(t), where ξil and ζijl are independent functional principal component (FPC) scores, which are assumed to follow ξil ~ N(0, d0l) and ζijl ~ N(0, d1l).

In the MRI Model (2), we approximate the mean function μm(υ) using the sample mean μ^m(v) because the dense sMRI data provide good estimates of the mean function, and we smooth the mean function using cubic B-spline functions. We decompose the shared MRI component as umi(v)=∑l=1∞ξilϕml(v), and we approximate it as umi(v)≈∑l=1L0ξilϕml(v), where ϕml(υ) is umi(υ)’s orthonormal eigenfunctions and L0 is the number of FPC scores for random profile Ui(t) and its specification is detailed in Section 3.4. The FPC scores ξil are from the shared random profile Ui(t) in Model (1) and they model the correlation between the MRI data and multivariate longitudinal outcomes. The MRI-specific varying pattern fmi(υ) is assumed to be a zero-mean stochastic process with the covariance function Cmm(υ, υ′), where υ and υ′ are two different voxels. Similar as above, we decompose fmi(v)=∑l=1∞ξmilψml(v), where ξmil is the MRI-specific FPC score, and Ψml(υ) is fmi(υ)’s orthonormal eigenfunctions, and we assume FPC scores ξmil ~ N(0, dml), where dml is the non-increasing eigenvalue of the MRI-specific FPC score ξmil. We approximate the MRI-specific varying pattern as fmi(v)≈∑l=1Lmξmilψml(v), where the number of eigenfunctions Lm is determined by the proportion of variance explained (PVE) criteria and is detailed in Supplementary Section 2.39

We project the MRI data m(υ) onto Lm dimensional orthonormal eigenfunctions Ψmj(υ), for j = 1, …, Lm. We obtain mij≈μmj+βm∑l=1L0ξilflj+ξmil+ϵmij, where mij = ∫v mi(υ)Ψmj(υ)dυ, μmj = ∫v μm(υ)Ψmj(υ)dυ, flj = ∫v ϕml(υ)Ψmj(υ)dυ, and ϵmij = ∫υ ϵmi(υ)Ψmj(υ)dυ. We denote the MRI-specific pattern as gmi′=(ξmi1,…,ξmiLm), which are used to model the hazard function in Model (3). We do not include FPC scores ξil in the MRI-specific pattern gmi′ because the function form (Xi, t) contains information of the FPC scores ξil and is detailed in the following context. By projection, we transform the high-dimensional MRI data (V voxels) to low-dimensional latent variables (Lm FPC scores), which facilitates computational efficiency while retaining most MRI-specific variation.

To investigate the association between multivariate longitudinal outcomes and survival process, we propose two functional forms of F(Xi, t): the random-effects model and instantaneous model.

Model 1 (random-effects model), F(Xi,t)=∑l=1∞γ0lξil+∑j=1J∑l=1∞γ1jlζijl. The association is quantified via the shared latent features (FPC scores) ξil and subject-outcome specific latent features ζijl. We estimate the number of FPC scores in Section 3.4 and we approximate F(Xi,t)≈∑l=1L0γ0lξil+∑j=1J∑l=1L1γ1jlζijl, where L0 is the number of FPC scores for shared random profile Ui(t) and L1 the number of FPC scores for subject-specific random profile Wij(t). We set γ0=(γ01,…,γ0L0) and γ1j=(γ1j1,…,γ1jL1).

Model 2 (instantaneous model), F(Xi,t)=γ0Ui(t)+∑j=1Jγ1jWij(t), which quantifies the association via the current values of the shared random profile Ui(t) and subject-outcome specific random profile Wij(t) at time t. We set γ0 = γ0 and γ1j = γ1j.

These two functional forms are widely used to investigate the association between longitudinal and survival process for various types of diseases (e.g., cardiovascular diseases,13 primary biliary cirrhosis,17 and Alzheimer’s Disease10). For Model 1 (random-effects model), because the eigenfunctions ϕl(t) and Ψl(t) are forced to be positive for easy interpretation, higher values of the shared FPC scores ξil and ζijl suggest worse cognitive behavior and faster dementia conversion. For Model 2 (instantaneous model), higher values of the shared random profile Ui(t) and outcome-specific progression patterns Wij(t) are associated with worse cognitive behavior and faster dementia conversion.

We denote the parameter space as Θ = (A, β, d0, d1, σ, α, γ0, γ1, γm), where A = (A1, …, Aj, …, AJ), Aj = (Aj1, …, Ajp), β = (β2, …, βJ), d0=(d01,…,d0L0), d1=(d11,…,d1L1), and σ = (σ1, …, σJ). The log-likelihood is expressed as: (4) l(Y∣Θ)=∑i=1Nlog(LilongLisurvp(ξi,ζi∣d0,d1)p(ξmi∣dm)),

where Lilong=∏j=1J∏k=1Kip(Yij(tik)∣ξil,ζijl)1−Iijkp(Y˜ij(tik)∣ξil,ζijl)Iijk,

(5) and Lisurv=hi(Ti∣ξi,ζi,gmi)δiSi(Ti∣ξi,ζi,gmi).

Equation (4) does not include the likelihood of the MRI data because the MRI data mi(υ) is projected onto eigenfunctions Ψml(υ) and the MRI-specific FPC scores ξmil are estimated using their expectations detailed in Section 3.4. We denote the FPC score vector ξi=(ξi1,…,ξiL0), ζi = (ζi1, …, ζij, …, ζiJ), ζij=(ζij1,…,ζijL1), and ξmi=(ξmi1,…,ξmiLm). We denote Si(t) as the survival probability at time t for subject i. We use a piecewise constant function to model the baseline hazard function h0(t).40,41 We use Gaussian quadrature to approximate the survival function Si(t), whose formulation is detailed in Supplementary Section 3. The choice of priors and derivation of posterior distribution are detailed as follows: A,β,α,γ0,γ1,γm~N(0,102),

d0,d1,σ~Inv_Gamma(0.1,0.1),

p(Θ∣Y)∝∏i=1NLilongLisurvp(ξi,ζi∣d0,d1)p(ξmi∣dm)p(Θ),

where Inv_Gamma is the inverse gamma distribution and p(Θ) is the prior distribution of the parameter space Θ.

We adopt Morkov Chain Monte Carlo (MCMC) method to obtain posterior samples from the likelihood based on No-U-Turn Sampling (NUTS) algorithm implemented in Stan.42 The missing outcomes Y˜ij(tik) are treated as unknown parameters and are imputed in the MCMC procedure. The scale reduction statistic R^ is used to assess the convergence of the model, where R^&lt;1.1 indicates satisfied convergence.42 For the real data analysis and simulation study, we use two chains with 2,000 warmup iterations and 1,000 post burn-in iterations for each MCMC chain. From a total of 2,000 posterior samples, we obtain the estimated mean, standard deviation, and 95% credible intervals. To facilitate easy implementation, the Stan code is given in Supplementary Section 9. Refer to https://github.com/zouhaotian/MFMM_MRI for detailed R codes in real data analysis and simulation study.

3.4 | Estimation of functional components and model assessment criteria

Let Cjj′(t, t′) be the covariance function between the latent processes Xij(t) and Xij′(t′). We use multivariate fast covariance estimation (mFACE) method to estimate the covariance function Cjj′(t, t′) on a refined grid S, where S is an equally spaced time grid.43 In Supplementary Section 1, we provide the detailed estimation procedure to obtain the estimated covariance functions C^0(t,t′) and C^1(t,t′). We use eigendecomposition to obtain the estimated eigenfunctions ϕ^l(t) and ψ^l(t) and eigenvalues d^0l and d^1l. Using the PVE criteria, we identify the number of FPC scores as L0 for the shared random profile Ui(t), and L1 for the subject-outcome specific random profile Wij(t). And we approximate the random profiles Ui(t)≈∑l=1L0ξilϕl(t) and Wij(t)≈∑l=1L1ζijlψl(t).

We denote the covariance function between the longitudinal outcome Yij(t) and MRI data mi(υ) as Cjm(t, υ) = cov(Yij(t), mi(υ)). We denote the covariance function between the MRI data mi(υ) and mi(υ′) as Cmm(υ, υ′) = cov(mi(υ), mi(υ′)). We express the covariance functions using the following equations (refer to Supplementary Section 2 for detailed derivation): (6) Cjm(t,v)=βjβm∑i=1∞d0lϕl(t)ϕml(v),

(7) Cmm(v,v′)=βm2∑l=1∞d0lϕml(v)ϕml(v′)+∑l=1∞dmlψml(v)ψml(v′)+I(v=v′)σm2.

We denote the demeaned MRI data as: mi*(v)=mi(v)−μ^m(v). From the multivariate longitudinal model (1), we obtain the number of FPC scores L0, estimated FPC scores ξ^il, and the variances of FPCs d^0l, for l = 1, …, L0. More explicitly, we denote the FPC score vector ξ^i=(ξ^i1,…,ξ^iL0), and D^0 is a diagonal matrix with its diagonal elements being the eigenvalue d^0l. To estimate eigenfunctions ϕml(υ), Ψml(υ), the scale parameter βm, and the standard deviation σm, we adopt an iterative search procedure detailed in Supplementary Section 2. To facilitate easy implementation, we display an algorithm graph 1.

After we obtain the estimated eigenfunctions ϕ^ml(v) and ψ^ml(v), we use Riemann’s sum to approximate mij, so m^ij≈∫Vmi(v)ψ^mj(v)dv, μ^mj≈∫Vμ^m(v)ψ^mj(v)dv, f^lj≈∫Vϕ^ml(v)ψ^mj(v)dv. Thus, we estimate FPC score ξmij using its expectation: E(ξ^mij)=m^ij−(μ^mj+β^m∑l=1L0ξilf^lj) because E(ϵ^mij)=E(∫vϵmi(v)ψ^mj(v)dv)=0, and the MRI-specific pattern gmi′=(ξmi1,…,ξmiLm). The eigenvalue dml is estimated based on the variance of the FPC scores ξmil.

We assess the model fitting performance using empirical Akaike information criterion (EAIC), empirical Bayesian information criterion (EBIC), leave-one-out information criterion (LOOIC), and widely applicable information criterion (WAIC).44,45 Lower values of the above statistics suggest a better model fitting performance. Specifically, we first compute the posterior mean deviation D¯(Θ)=−2E(∑i=1Nli(Θ)) using Monte Carlo approximation: D¯(Θ)≈−2/Q∑q=1Q∑i=1Nli(Θ(q)), where li(Θ) is the log-likelihood for subject i, Q is the number of posterior samples, and the superscript (q) denotes the q-th posterior sample. The EAIC and EBIC statistics are computed as: EAIC=D¯(Θ)+2p, and EBIC=D¯(Θ)+plogN, where p is the number of parameters in the parameter space Θ. The LOOIC and WAIC statistics are computed based on the log pointwise predictive density implemented in loo package.45

3.5 | Dynamic prediction

Suppose there is a new subject B with multivariate longitudinal outcomes observed at KB visits and the baseline MRI data. For a future time T′ (T′ &gt; T), we predict subject B’s longitudinal outcomes and the event-free probability at time T′. Let YB(T)=(YBj(tBk))j=1,…,J,k=1,…,KB be all longitudinal outcomes until time T, where YBj(tBk) is j-th longitudinal outcome for subject B at visit k. We denote the FPC score vector for longitudinal outcomes as ξB and ζB for subject B. We denote the covariate vector as zB′ and the FPC score vector for the MRI specific-varying pattern as ξmB. Let gmB′=(ξmB1,…,ξmBLm) denote the MRI-specific pattern as in Section 3.4. We adopt the MCMC method to obtain samples from the posterior distribution of score vectors ξB, ζB, and ξmB as in Equation (8). We use two MCMC chains, each of which consists of 2,000 warmup iterations and 1,000 post burn-in iterations, with a total of Q = 2000 posterior samples. (8) P(ξB,ζB,ξmB∣YB(T),T,δB=0,Θ^)∝∏j=1J∏k=1KBp(YBj(tBk)∣ξB,ζB,Θ^)SB(T∣ZB′,ξB,ζB,gmB,Θ^)p(ξB,ζB,ξmB∣Θ^),

where Θ^ is the estimated mean of Θ. Equation (8) does not include the likelihood of the MRI data because the MRI-specific FPC scores are estimated via projection detailed in Section 3.4.

We compute the predicted longitudinal outcomes and survival probability at time T′ from Q posterior samples as in Equations (9) and (10), respectively. (9) E(YBj(T′)∣ξB(q),ζB(q),Θ^)≈μ^j(T′)+β^j(∑l=1L0ξBl(q)ϕ^l(T′)+∑l=1L1ζBjl(q)ψ^l(T′)),

(10) SB(T′∣T,ZB′,ξB(q),ζB(q),gmB(q),Θ^)≈SB(T′∣ZB′,ξB(q),ζB(q),gmB(q),Θ^)/SB(T∣ZB′,ξB(q),ζB(q),gmB(q),Θ^),

where the superscript (q) denotes the q-th posterior sample. We compute the mean of predicted longitudinal outcomes and event-free survival probability based on Q predicted values.

To assess model predictive performance, we use discrimination (how well the model discriminates subjects with or without event) and calibration measurements (how well the model agrees with the observed survival status). Specifically, the area under the time-dependent receiver operating characteristic curve (AUC) is adopted to measure the discrimination, based on the trapezoidal integration of the time-dependent sensitivity and specificity.46 For the calibration measurement, we use the Brier score (BS) based on the average of the weighted squared differences between the predicted and observed survival status.47 Higher values of AUC and lower values of BS suggest a better predictive performance. For the illustration purpose, we integrate the estimated AUC and BS values over a dense prediction window δt given a landmark time T and we obtain the integrated AUC (iAUC) and integrated BS (iBS) using Simpson’s Rule.

4 | REAL DATA APPLICATION

For subject i at visit k, let Yi1(tik), …, Yi5(tik) denote the observed ADAS-Cog 13, RAVLT-immediate, RAVLT-learning, MMSE, and CDR-SB scores after Box-Cox transformation (for normality). We determine the number of FPC scores of the shared random profile Ui(t) and subject-outcome random profile Wij(t) using 95% PVE threshold and we obtain L0 = 2 and L1 = 1. We use a piecewise constant function to model the baseline hazard function with knots at 4, 6, and 8 years. The knots are so selected because the estimated cumulative hazard function displayed in Supplementary Figure S1 suggests that its slope is slightly different among 0 to 4 years, 4 to 6 years, 6 to 8 years, and 8 years later. We explored other knot selections and obtained very similar results (not shown). The covariate vector Zi′=(Agei,Sexi,Educationi,ApoEi), where we set Male as the reference sex, education as the number of education years, and ApoE as the number of ApoE-ϵ4 alleles.

We compare model fitting performance for three sets of models: (1) MFMM-whole: the MRI data is from whole-brain voxels after voxel selection, with V = 642 voxels and Lm = 10 using 95% PVE; (2) MFMM-hippo: the MRI data is from hippocampal voxels only, with V = 9846 voxels and Lm = 13 using 95% PVE; (3) MFMM: the model is without MRI data. The reason of comparing MFMM-hippo vs. MFMM is that hippocampal volume shrinkage is an important risk factor of dementia onset.24 Similarly, we compare two functional forms of F(Xi, t) as in Section 3.3, i.e., Model 1 (random effects model) and Model 2 (instantaneous model), rendering a total of six models for comparison. We also compare the MFMM-MRI model with other four candidate models: Model3 – 2S (two-stage sequential estimation approach based on Model2); Model3 - MJM-MRI (multivariate joint model with MRI data,11 with details available in Supplementary Section 5); Model 3 - bCox (the Cox model with baseline longitudinal outcomes); Model 3 - NM (non-mixed functional model that the longitudinal model is Yij(tik) = μj(tik) + ϵijk and the Cox model includes baseline covariates). We compare MFMM-MRI with four candidate models to show the advantages of the joint modelling vs. the two-stage approach, modeling nonlinear longitudinal outcomes and MRI data using functional mixed models, modelling longitudinal trajectories in the survival model, and modelling the random component functions in the longitudinal model.

Table 1 compares model fitting performance of candidate models. Comparing three sets of models in Model 1, Model 1 with whole-brain voxels (M1-whole) has the smallest LOOIC and WAIC statistics, suggesting a better model performance. Model 1 with hippocampal voxels (M1-hippo) and without MRI data (M1) show similar model assessment statistics. Table 1 suggests that Model 2 with whole-brain voxels (M2-whole) has a better performance (smaller EAIC and WAIC and similar LOOIC) as compared with Model 2 with hippocampal voxels (M2-hippo) and without MRI data (M2). Since EBIC statistics give large penalty to the number of parameters, Model 2 with whole-brain voxels (M2-whole) show slightly larger EBIC statistics as compared to Model 2. Model 2 with whole-brain voxels (M2-whole) has smaller assessment statistics as compared with M1-whole, suggesting that M2-whole has the best performance among all candidate models. Additionally, Model 2 with whole-brain voxels (M2-whole) show substantially better performance as compared to Model 3 – 2S, Model 3 - MJM-MRI, Model 3 - bCox, and Model 3 - NM, indicating the advantages of joint modelling vs. the two-stage approach, non-parametric mixed functional models vs. parametric linear models, modelling longitudinal trajectories in the survival model, and modelling random component functions in the longitudinal model. Thus, we select Model 2 with whole-brain voxels (M2-whole) as the final model. Specifically in the survival model (3), the covariate vector Zi′=(Agei,Sexi,Educationi,ApoEi), the functional form F(Xi,t)=γ0Ui(t)+∑j=1J=5γ1jWij(t), and the MRI-specific pattern g′mi = (ξmi1, …, ξmi10), where Ui(t) is the shared random profile, Wij(t) is the subject-outcome specific random profile, and ξmil is the MRI-specific FPC score, for l = 1, …, Lm = 10.

Table 2 summarizes the mean, SE, and 95% credible intervals from Model 2 with whole-brain voxels. For the multivariate longitudinal outcomes, the estimated association parameters β^2 to β^5 are all significant, suggesting that one unit increase of the shared random profile Ui(t) and subject-outcome specific random profile Wij(t) are associated with 0.540 unit decrease in RAVLT-immediate (95% CI: [−0.567, −0.514]), 0.600 unit decrease in RAVLT-learning (95% CI: [−0.636, −0.563]), 0.033 unit decrease in MMSE (95% CI: [−0.035, −0.031]), and 0.159 unit increase in CDR-SB (95% CI: [0.150, 0.169]), after their Box-Cox transformation (refer to Supplementary Table S2 for power parameters used in Box-Cox transformation). Results suggest that higher values of ADAS-Cog 13 (worse cognitive functions) are associated with lower values of RAVLT-immediate, RAVLT-learning, MMSE, and higher CDR-SB scores (worse functional activities and memory functions). The estimated variances of FPC scores, mean functions, and eigenfunctions are displayed in Supplementary Table S2 and Figure S2. For the MRI components, the estimated scale parameter β^m is −0.053 (95% bootstrap CI: [−0.072, −0.035] based on 120 bootstrap replications), suggesting that one unit increase in umi(υ) (the MRI component shared with longitudinal outcomes) is associated with 0.053 unit decrease in the volume for voxel υ. Results suggest that higher values of FPC scores ξil (worse cognitive functions) are associated with a greater decrease of the voxel volumes in MRI data. Figure 3 displays the decomposition of the MRI data for a randomly selected subject in the brain heat map (in sagittal view) using BrainNet Viewer.48

For the survival outcome as dementia onset, results suggest that one additional ApoE-ϵ4 allele is associated with 27.9% (95% CI: [0.078, 0.472]) increase in log hazard. The estimated association parameter γ^0 is significant, suggesting that one unit increase of the shared random profile Ui(t) (worse cognitive behaviors) is associated with 60.7% (95% CI: [0.522, 0.702]) increase in log hazard (higher risk of dementia onset). The estimated association parameters γ^11, γ^12, and γ^15 are marginally significant, suggesting higher values of ADAS-Cog 13, lower values of RAVLT-immediate, and higher values of CDR-SB are associated with a higher risk of dementia onset. Most of the estimated association parameters γ^ml, for l = 1, …, 10, are negative and statistically significant, suggesting that voxel volume shrinkage in MRI data is associated with higher risk of dementia onset. We use the likelihood ratio test (LRT) to test the hypothesis that H0 : γm1 = ⋯ = γm10 = 0 vs. H1 : otherwise.49 The test statistic T=39.89→dχ102, and p-value is less than 0.001, providing sufficient evidence of the significant association between the MRI-specific varying pattern and dementia onset.

We randomly split the dataset into training and testing set with sample sizes being 556 and 186, respectively (3:1 ratio). We repeat dynamic prediction for 100 times and compute the mean of iAUC and iBS. Table 3 compares predictive performance for all candidate models using iAUC and iBS measurements at landmark times 2, 2.5, 3, 3.5, and 4 years. The prediction window δt = (0.5, 0.51, …, 1.5). Comparing three sets of models in Model 1, results suggest that Model 1 with whole-brain voxels (M1-whole) shows highest iAUC and similar iBS values as compared with Model 1 with hippocampal voxels (M1-hippo) and without MRI data (M1), for all landmark times. Results also suggest that Model 2 with whole-brain voxels (M2-whole) has the best predictive performance as compared with Model 2 with hippocampal voxels (M2-hippo) and without MRI data (M2), and Model 1 with whole-brain voxels (M1-whole). Comparing Model 2 with whole-brain voxels (M2-whole) with other four candidate models (Model 3 – 2S, Model 3 - MJM-MRI, Model 3 - bCox, and Model 3 - NM), the results suggest that Model 2 has higher iAUC values for most landmark times. Thus, the proposed model show improved predictive performance as compared to the models using two-stage approach, parametric linear mixed models, without longitudinal trajectories in the survival model, and without random component functions in the longitudinal model. In summary, Model 2 with whole-brain voxels (M2-whole) has the best fitting and predictive performance among all candidate models.

Figure 4 displays the prediction of neurological scores and probability of remaining stable MCI for a randomly selected subject A at the landmark times of 2 and 3 years, based on Model 2 with whole-brain voxels (M2-whole). Figure 4 suggests that subject A has a relatively mild disease status (low ADAS-Cog 13 scores before 2 years) and good functional activities (low CDR-SB scores before 2 years). The predicted survival probabilities decrease slowly, with a high chance of remaining MCI at the censoring time (7.98 years).

5 | SIMULATION STUDY

5.1 | Simulation settings

A simulation study is conducted to validate the proposed estimation and prediction method. The true values of parameters are close to the estimates from the real data analysis based on Model 2 (the instantaneous model) with whole-brain voxels. To check the robustness of the method, we explore three simulation scenarios detailed in Supplementary Section 7. For simulation Scenario 1 (we simulate data from Model 2), we consider four simulation settings with different sample sizes and event rates (ER) detailed in Supplementary Section 7. In the following context, we only display the results from simulation Scenario 1 and Setting 1 (N = 800 for training set, N = 300 for testing set, h0(t) = exp(−1.5)). The results for Settings 2 to 4 are displayed in Supplementary Tables S3, S4, and S5. The results for Scenarios 2 and 3 are displayed in Supplementary Tables S8 and S9. We also compare the model with four candidate models as in Section 4 and detailed in Supplementary Section 7 to show the strengths of the joint modelling vs. the two-stage approach, modeling longitudinal outcomes and MRI data using functional mixed models, modelling longitudinal trajectories in the survival model, and modelling the random component functions in the longitudinal model. For the four candidate models, we simulate data from Scenario 1 and Setting 1 and estimate the parameters using the candidate models. The results are summarized in Supplementary Tables S6 and S7.

For subject i (i = 1, …, N), we simulate J = 3 longitudinal outcomes from Model (1) on a sparse time grid Si = [0, ti, ti + 0.1, …, ti +0.9] so the time grid has 11 points for each outcome, where ti is sampled from a multinomial distribution with equal probabilities on [0.01, 0.02, …, 0.1]. The true mean functions μj(t) are equal to the estimated mean functions from real data analysis. The FPC scores are simulated from ξil ~ N(0, d0l) and ζijl ~ N(0, d1l), where d0 = (2, 1) and d11 = 1, with L0 = 2 and L1 = 1. The eigenfunctions ϕ1(t)=2sin(πt), ϕ2(t)=2cos(πt), ψ1(t)=2cos(2πt). We set the association parameter β = (β2, β3) = (−0.55, −0.60) and the standard deviation for random errors σ = (1.10, 0.60, 1.36). We simulate missing outcomes with missing mechanism being missing at random (MAR), and the missing probability logit(pijk) = 0.5(tik − 5), and Iijk ~ Ber(pijk), thus achieving around 2.5% missing rate for all three longitudinal outcomes because we assume tik is the only predictor for the longitudinal outcomes, where Ber is the Bernoulli distribution.

We simulate the baseline MRI data mi(υ) from Model (2) observed on a dense voxel grid V = (1∕V, 2∕V, …, 1), where V = 642 voxels, and the scale parameter βm = −0.05. The FPC scores for MRI-specific varying pattern ξmil are simulated from ξmil ~ N(0, dml), for l = 1, …, Lm = 5, and the variance dm = (0.10, 0.07, 0.05, 0.03, 0.01). The eigenfunctions ϕml(v)=2sin((2l−1)πv/2), for l = 1, …, L0 = 2, and ψml(v)=2cos(π(2l−1)v/2), for l = 1, …, Lm = 5. We simulate random error from ϵmi(v)~N(0,σm2), where the standard deviation σm = 0.4.

To simulate the survival outcome from Model (3), we set the baseline hazard function h0(t) = exp(−1.5), Zi ~ Binom(2, 0.4), the regression coefficient α = 0.3, the association parameters γ0 = 0.6, γ1 = (0.35, 0.3, 0.1), and γm = (−0.6, −1.1, −0.5, 0.7, −1.8), where Binom is the Binomial distribution. The survival probability Si is simulated from (0, 1) and we approximate the event time Ti* using bisection method by solving the equation log(Si)=−Hi(Ti*). The censoring time is generated from Ci ~ U(0, 1.6). After censoring, we have around 6.5 observations per subject.

We repeat the simulation study for R = 100 replications. From each replication r, we obtain posterior mean, standard errors, and 95% credible intervals. From a total of R replications, we compute the bias (difference between the averaged posterior mean and true values of parameters), standard deviation (SD of R posterior means), standard error (SE, square root of averaged variances), and coverage probability (CP, frequency of 95% CI covering true values of parameters). The standard error and coverage probability for parameters dm and βm are not presented because those parameters are not in the parameter space as in Section 3.3. To evaluate the estimation performance for mean functions and eigenfunctions, we compute the mean-squared error (MSE), defined as MSE=1/G∑G(f^(g)−f(g))2, where G is the number of grid points for the refined time grid S ∈ [0, 0.01, …, 1] or the dense voxel grid V, f(g) is the true function, and the mean of estimated functions f^(g)=1/R∑r=1Rf^r(g). We apply the dynamic prediction method to the testing dataset for R replications. From each replication r, we obtain the true and estimated iAUC and iBS for landmark times at 0.4, 0.5, 0.55, and 0.6. The prediction window is set as δt = (0.1, 0.11, …, 0.25). From R replications, we average and compare the true and estimated iAUC and iBS values.

5.2 | Simulation results

Table 4 summarizes the bias, SD, SE, and CP for parameters from 100 replications. Results suggest that for most parameters, biases are close to zero, with SD being close to SE, and CP being close to the nominal level 0.95 (except for the parameter d11). The results for simulation Setting 2 (the sample size is 1200) displayed in Table S3 suggest that we have much smaller bias, SD, and SE in the parameters γm3, γm4, and γm5 as compared with simulation Setting 1 (the sample size is 800). Table 4 suggests that the SD and SE for γm are close, which indicates the accuracy of the estimation algorithm. Table 4 also suggests that the mean functions and eigenfunctions are estimated close to the true functions with mean-squared error being close to zero. Table 5 summarizes the mean of true and estimated iAUC and iBS from 100 replications. Results suggest that the estimated iAUC and iBS values are close to the true iAUC and iBS values, respectively, for all landmark times. Tables 4 and 5 support the validity of the estimation and dynamic prediction method.

The results for simulation Settings 1 to 4 presented in Supplementary Tables S3 to S5 suggest that in all settings, the parameters are estimated with small bias and the coverage probabilities are close to the nominal value of 0.95, and the estimated iAUC and iBS are close to their true values. For Model 3 – 2S (two-stage approach based on Model 2, the instantaneous model), the results presented in Supplementary Table S6 suggests that the estimated parameters have large bias and low coverage probabilities (i.e., parameters β2, β3, σ1, σ2, σ3, and γm). The prediction results for other four candidate models are presented in Supplementary Table S7. The results suggest that the estimated iAUC and iBS values are close to their true values for Model 3 – 2S (two-stage approach) and Model 3 - MJM-MRI (multivariate joint model with MRI data), while Model 3 - bCox (Cox model using baseline longitudinal outcomes) and Model 3 - NM (non-mixed functional model) have poor prediction performance. Comparing with Model 3 - MJM-MRI, our methods use non-parametric functional mixed models and are more robust to model sparse and nonlinear longitudinal outcomes.

The results for simulation Scenarios 2 and 3 are presented in Supplementary Tables S8 and S9. The results suggest that for Scenario 2 (no correlation between longitudinal and MRI data), the estimated parameters, functions, and iAUC and iBS values are close to their true values, with the coverage probabilities close to the nominal level 0.95. For Scenario 3 (misspecification of the functional form F(Xi, t)), we observe large bias in parameters γml, and the iAUC and iBS values are not close to their true values. The results suggest that the method is not sensitive to the correlation between the MRI and longitudinal outcomes, and is sensitive to the misspecification of the functional form F(Xi, t).

6 | DISCUSSION

In this article, we propose the multivariate functional mixed model with MRI data (MFMM-MRI) that simultaneously models multivariate longitudinal outcomes (i.e., neurological scores), baseline magnetic resonance imaging (MRI) data, and the survival process (i.e., dementia onset) for subjects with mild cognitive impairment (MCI) at baseline. We use the non-parametric functional mixed model to decompose the longitudinal and MRI data into the joint and individual variation. We adopt an iterative search procedure to estimate the eigenfunctions and scale parameter for the MRI data. The Markov Chain Monte Carlo (MCMC) approach based on No-U-Turn Sampling (NUTS) algorithm is adopted to obtain posterior samples from the likelihood. We also develop a dynamic prediction method that provides accurate personalized predictions of longitudinal trajectories and risk of dementia onset, which facilitates clinical decision making and treatment selection. We apply the proposed MFMM-MRI to the motivating Alzheimer’s Disease Neuroimaging Initiative (ADNI) study. We found that higher ADAS-Cog 13 scores (worse cognitive functions) are associated with lower RAVLT-immediate, RAVLT-learning, MMSE scores, and higher CDR-SB scores (worse memory functions and functional activities). We discover that higher functional principal component (FPC) scores (worse cognitive functions) are associated with a greater decrease in voxel volumes in MRI data. For the survival outcome, we conclude that additional ApoE-ϵ4 alleles, higher ADAS-Cog 13 and CDR-SB scores, and lower RAVLT-immediate scores are associated with higher dementia risk. Moreover, the MRI-specific varying pattern is significantly associated with the risk of dementia onset based on the likelihood ratio test. The dynamic prediction results show that the proposed instantaneous model with whole-brain voxels has the best prediction performance in terms of calibration and discrimination measurements among all candidate models. The simulation study supports the validity and accuracy of the estimation and dynamic prediction method.

The multivariate functional mixed model with MRI data (MFMM-MRI) leverages multimodal data, which are predictive of dementia occurrence and AD progression. Comparing with existing methods (i.e., parametric linear models11 and the model without MRI data10), our approach provides more accurate prediction of AD dementia and facilitates treatment selection for health care professionals and patients at early disease stages (i.e., mild cognitive impairment). Additionally, the MFMM-MRI model provides the association of the neurological scores, MRI data, and the survival outcome so that clinicians may determine how each diagnostic test may change this individual’s prognosis.

There are several limitations to address as future directions. First, the proposed MFMM-MRI models continuous longitudinal outcomes with normality assumption. The longitudinal submodel of MFMM-MRI may be extended to a generalized functional mixed model to model outcomes with distributions in the exponential family, e.g., ordinal, binary, or count.50 Second, as stated in Zou et al.,11 our voxel selection approach is an ad hoc procedure to reduce the memory burden in functional principal component analysis (FPCA). The high-dimensional FPCA using singular value decomposition (SVD) for the partitioned MRI data may be adopted to reduce the computational and memory burden.51 Alternatively, the MRI data can be treated as a spatial region embedded in three-dimensional space and multivariate FPCA may be applied.52 Third, the MRI submodel of MFMM-MRI handles baseline MRI data only, while longitudinal sMRI data are available for some subjects. Thus, the functional mixed model may be extended to model two-dimensional MRI data observed on the sparse time and dense voxel grid. Additionally, for the survival submodel of MFMM-MRI, the accelerated failure time (AFT) model is another alternative and Bayesian assessment criterion may be adopted to select the model with the best fit.53 Fourth, in the longitudinal and MRI models (1) and (2), we incorporate the correlation between the MRI data and longitudinal outcomes via shared FPC scores, but the baseline MRI data may also change longitudinal trajectories. Thus, the functional form F(Xi, t) in the survival model (3) may be extended to account for the interaction between the longitudinal outcomes and MRI data. Specifically, the interaction between the FPC scores of the longitudinal outcomes and MRI data may be included in both the random-effects model and instantaneous model.

As stated in Section 1, recent AD studies collect multi-omics data, e.g., the ADNI study collects genome, transcriptome, and proteome data, etc., which provide unique insights to determine disease mechanism together with neurological assessments and imaging data.54 One recent research article investigated the convolutional neural network (CNN) that integrated multi-omics data into kernel matrices and identified significant associations between single nucleotide variants (SNVs) and quantitative AD traits, including biospecimen samples and MRI data.55 Mo et al. proposed a Bayesian latent variable model that clustered multi-omics data and used Bayesian variable selection approach to reduce the high-dimensionality and determine significant latent variables.56 As a future direction, the extension of the above methods to modelling multimodal data, including multi-omics data, longitudinal neurological data, and MRI data, and efficient estimation algorithms are worth of further investigation.

Supplementary Material

supinfo

ACKNOWLEDGMENTS

Data used in preparation of this article were obtained from the Alzheimer’s Disease Neuroimaging Initiative (ADNI) database (adni.loni.usc.edu). As such, the investigators within the ADNI contributed to the design and implementation of ADNI and/or provided data but did not participate in analysis or writing of this report. A complete listing of ADNI investigators can be found at: http://adni.loni.usc.edu/wp-content/uploads/how_to_apply/ADNI_Acknowledgement_List.pdf.

Funding

The research of Sheng Luo was supported by National Institute on Aging (grant number: R01AG064803, P30AG072958, and P30AG028716).

FIGURE 1 Spaghetti plot of ADAS-Cog 13, RAVLT-immediate, RAVLT-learning, MMSE, and CDR-SB scores for randomly selected 15 subjects with MCI at baseline.

FIGURE 2 Directed acyclic graph showing the latent structural equations based on Models (1) to (3).

FIGURE 3 The brain heat map (in sagittal view) that expresses the decomposition of the MRI data for a randomly selected subject i as: mi(v)≈μ^m(v)+β^mu^mi(v)+f^mi(v). The four plots (from top left in clockwise order) represent the observed voxel volumes mi(υ), the estimated mean function μ^m(v), the MRI-specific varying pattern f^mi(v), and the MRI component shared with longitudinal outcomes u^mi(v). The colored dots are the voxels, with colors being volumes of voxels. The labels for regions of interest (ROI) are displayed as numbers (refer to Supplementary Tables S10 and S11). The voxel sizes are proportional to the number of voxels in each ROI.

FIGURE 4 Prediction of ADAS-Cog 13, RAVLT-immediate, RAVLT-learning, MMSE, CDR-SB scores, and the probability of remaining stable MCI for a new subject A given the landmark times at 2 years (rows 1 and 3) and 3 years (rows 2 and 4). The dotted circles are observed neurological scores. The blue and red vertical lines represent the landmark time (2 or 3 years) and the censoring time (7.98 years), respectively. The solid lines represent the predicted longitudinal trajectories or survival probabilities, with dashed lines being 95% credible intervals.

TABLE 1 Model comparison statistics for candidate models: Model 1-whole (random-effects model with whole-brain voxels); Model 1-hippo (random-effects model with hippocampal voxels); Model 1 (random-effects model without MRI data); Model 2 (instantaneous model); Model 3 – 2S (two-stage approach); Model 3 - MJM-MRI (multivariate joint model with MRI data); Model 3 - bCox (the Cox model with baseline longitudinal outcomes); Model 3 - NM (non-mixed functional model.

Model	EAIC	EBIC	LOOIC	WAIC	Time (hrs)	
Model 1-whole	19917	20295	23284	22570	3.3	
Model 1-hippo	19950	20342	23334	22618	2.6	
Model 1	19915	20247	23314	22583	2.5	
Model 2-whole	19887	20260	23283	22560	5.9	
Model 2-hippo	19922	20309	23277	22596	8.0	
Model 2	19892	20219	23303	22584	6.7	
Model 3 - 2S	20998	21325	24311	23662	5.0	
Model 3 - MJM-MRI	26645	27019	28104	28005	11.4	
Model 3 - bCox	20011	20333	23340	22661	5.8	
Model 3 - NM	40317	40585	40460	40476	1.0	
Notations and abbreviations: EAIC: empirical Akaike information criterion; EBIC: empirical Bayesian information criterion; LOOIC: leave-one-out information criterion; WAIC: widely application information criterion. The computation is run a four-core 2.50 GHz Intel processor.

TABLE 2 Mean, standard error, and 95% credible intervals for parameters from Model 2 (instantaneous model) with whole-brain voxels (M2-whole).

	Mean	SE	2.5%	97.5%	
Longitudinal outcomes and MRI data					
β2: RAVLT-immediate	−0.540	0.014	−0.567	−0.514	
β3: RAVLT-learning	−0.600	0.019	−0.636	−0.563	
β4: MMSE	−0.033	0.001	−0.035	−0.031	
β5: CDR-SB	0.159	0.005	0.150	0.169	
σ1: ADAS-Cog 13	1.065	0.016	1.035	1.096	
σ2: RAVLT-immediate	0.612	0.008	0.596	0.629	
σ3: RAVLT-learning	1.334	0.018	1.298	1.370	
σ4: MMSE	0.059	0.001	0.057	0.060	
σ5: CDR-SB	0.263	0.004	0.256	0.271	
β m	−0.053	0.009	−0.072	−0.035	
σ m	0.404	0.007	0.392	0.417	
Survival outcome					
Age	−0.022	0.009	−0.040	−0.004	
Female sex	0.134	0.145	−0.148	0.423	
Education years	−0.006	0.024	−0.055	0.041	
ApoE-ϵ4 alleles	0.279	0.100	0.078	0.472	
γ 0	0.607	0.045	0.522	0.702	
γ11: ADAS-Cog 13	0.169	0.099	−0.012	0.364	
γ12: RAVLT-immediate	0.164	0.092	−0.010	0.336	
γ13: RAVLT-learning	0.006	0.094	−0.174	0.200	
γ14: MMSE	−0.132	0.081	−0.288	0.029	
γ15: CDR-SB	0.279	0.083	0.120	0.446	
γ m1	−0.752	0.230	−1.199	−0.304	
γ m2	−1.194	0.306	−1.792	−0.594	
γ m3	−0.358	0.419	−1.155	0.486	
γ m4	0.922	0.593	−0.229	2.046	
γ m5	−1.765	0.601	−2.952	−0.573	
γ m6	−1.387	0.913	−3.228	0.495	
γ m7	1.739	0.954	−0.108	3.572	
γ m8	−3.129	1.060	−5.237	−1.086	
γ m9	−0.167	1.416	−2.985	2.567	
γ m10	0.707	1.452	−2.174	3.540	
Notations and abbreviations: ADAS-Cog: the Alzheimer’s Disease assessment scale - cognitive subscale; RAVLT: Rey auditory verbal learning test; MMSE: mini-mental state examination; CDR-SB: clinical dementia rating scale - sum of boxes. The SE and 95% CI for the scale parameter βm and standard deviation σm is derived using bootstrap method as in Section 3.4. The parameters γ0 and γ1j are the association parameters for the shared random profile Ui(t) and subject-outcome specific random profile Wij(t) with the risk of dementia onset, respectively, for j = 1, …, J = 5. The parameter γml is the association parameter between the MRI-specific varying pattern ξmil and the risk of dementia onset, for l = 1, …, Lm = 10.

TABLE 3 Predictive performance for candidate models at landmark times 2, 2.5, 3, 3.5, and 4 years.

	M1-whole	M1-hippo	M1	M2-whole	M2-hippo	M2	
Landmark T	iAUC	iBS	iAUC	iBS	iAUC	iBS	iAUC	iBS	iAUC	iBS	iAUC	iBS	
T = 2	0.879	0.091	0.876	0.090	0.877	0.088	0.884	0.087	0.875	0.090	0.873	0.088	
T = 2.5	0.886	0.087	0.866	0.083	0.872	0.083	0.899	0.081	0.867	0.081	0.871	0.079	
T = 3	0.854	0.102	0.835	0.096	0.840	0.101	0.866	0.095	0.834	0.098	0.834	0.096	
T = 3.5	0.783	0.095	0.765	0.089	0.751	0.096	0.802	0.089	0.769	0.090	0.767	0.094	
T = 4	0.801	0.084	0.780	0.079	0.774	0.084	0.834	0.077	0.811	0.079	0.804	0.079	
	M3 - 2S	M3 - MJM-MRI	M3 - bCox	M3 - NM					
Landmark T	iAUC	iBS	iAUC	iBS	iAUC	iBS	iAUC	iBS					
T = 2	0.850	0.097	0.808	0.116	0.864	0.087	0.696	0.103					
T = 2.5	0.843	0.080	0.838	0.100	0.810	0.086	0.675	0.092					
T = 3	0.816	0.093	0.829	0.120	0.798	0.096	0.681	0.107					
T = 3.5	0.777	0.088	0.817	0.110	0.757	0.087	0.564	0.102					
T = 4	0.798	0.083	0.821	0.100	0.760	0.083	0.577	0.097					
Notations and abbreviations: M1: Model 1, random-effects model; M2: Model 2, instantaneous model; M3 – 2S (two-stage sequential estimation approach); M3 - MJM-MRI (multivariate joint model with MRI data; M3 - bCox (the Cox model with baseline longitudinal outcomes); M3 - NM (non-mixed functional model); iAUC: integrated area under receiver operating characteristic curve; iBS: integrated Brier score.

TABLE 4 True values of parameters, bias, standard deviation (SD), standard error (SE), coverage probability (CP), and mean-squared error (MSE) from 100 simulation replications for simulation Scenario 1, Setting 1 (based on Model 2).

Parameters	Bias	SD	SE	CP	MSE		
Longitudinal outcomes							
d01=2	−0.055	0.103	0.132	0.980	μ1(t)	0.000	
d02=1	−0.029	0.065	0.065	0.940	μ2(t)	0.000	
d11=1	−0.026	0.065	0.045	0.810	μ3(t)	0.000	
β2=−0.55	−0.001	0.008	0.008	0.960	ϕ1(t)	0.002	
β3=−0.6	−0.001	0.014	0.013	0.930	ϕ2(t)	0.001	
σ1=1.1	0.001	0.010	0.013	0.990	Ψ1(t)	0.001	
σ2=0.6	0.002	0.006	0.007	1.000			
σ3=1.36	0.002	0.012	0.015	0.970			
MRI outcomes							
dm1=0.1	0.001	0.003			μm(t)	0.000	
dm2=0.07	0.002	0.002			ϕm1(t)	0.064	
dm3=0.05	0.001	0.002			ϕm2(t)	0.090	
dm4=0.03	0.000	0.001			Ψm1(t)	0.003	
dm5=0.01	0.000	0.000			Ψm2(t)	0.003	
βm=−0.05	0.002	0.009			Ψm3(t)	0.002	
σm=0.4	0.000	0.000			Ψm4(t)	0.000	
Survival outcome							
α=0.3	0.009	0.105	0.102	0.950	Ψm5(t)	0.000	
γ0=0.6	−0.007	0.052	0.055	0.960			
γ11=0.35	0.005	0.083	0.090	0.980			
γ12=0.3	−0.013	0.088	0.091	0.970			
γ13=0.1	0.000	0.095	0.109	0.980			
γm1=−0.6	0.076	0.232	0.225	0.940			
γm2=−1.1	0.019	0.291	0.270	0.960			
γm3=−0.5	−0.108	0.395	0.316	0.870			
γm4=0.7	0.109	0.463	0.407	0.900			
γm5=−1.8	0.087	0.670	0.701	0.960			
Notations and abbreviations: the standard error and coverage probability for parameters dm and βm are not presented because those parameters are not in the parameter space as in Section 3.3.

TABLE 5 True and estimated iAUC and iBS from 100 simulation replications for simulation Scenario 1, Setting 1 (based on Model 2).

Landmark time	True iAUC	Estimated iAUC	True iBS	Estimated iBS	
T = 0.4	0.818	0.799	0.063	0.065	
T = 0.5	0.805	0.786	0.060	0.063	
T = 0.55	0.797	0.774	0.058	0.059	
T = 0.6	0.785	0.755	0.056	0.058	
Notations and abbreviations: iAUC: integrated area under receiver operating characteristic curve; iBS: integrated Brier score.

Financial disclosure

None reported.

Conflict of interest

The authors declare no potential conflict of interest.

SUPPORTING INFORMATION

The Web Supplement for multivariate functional mixed model with MRI data: an application to Alzheimer’s Disease consists of five sections: (1) estimation of covariance matrices C0 and C1 for multivariate longitudinal outcomes; (2) estimation of eigenfunctions and scale parameter for the MRI components; (3) expression of Gaussian quadrature approximation; (4) sensitivity analysis of the number of B-spline functions and knot location; (5) details of four candidate Models; (6) estimated variances of functional principal components, mean functions, and eigenfunctions; (7) simulation results for Settings 1 to 4, other four candidate models, and Scenarios 2 and 3; (8) dictionary of ROI labels; (9) Stan code for the instantaneous model with whole-brain voxels.


References

1. Knopman DS , Amieva H , Petersen RC , Alzheimer disease. Nat Rev Dis Primers 2021; 7 (1 ): 1–21.33414454
2. Rajan KB , Weuve J , Barnes LL , McAninch EA , Wilson RS , Evans DA . Population estimate of people with clinical Alzheimer’s disease and mild cognitive impairment in the United States (2020–2060). Alzheimers Dement 2021.
3. Weiner MW , Veitch DP , Aisen PS , 2014 Update of the Alzheimer’s Disease Neuroimaging Initiative: a review of papers published since its inception. Alzheimers Dement 2015; 11 (6 ): e1–e120.26073027
4. Besser L , Kukull W , Knopman DS , Version 3 of the National Alzheimer’s Coordinating Center’s Uniform Data Set. Alzheimer Dis Assoc Disord 2018.
5. Petersen RC . Mild cognitive impairment. Continuum (Minneap Minn) 2016; 22 (2 Dementia ): 404.27042901
6. Albert MS , DeKosky ST , Dickson D , The diagnosis of mild cognitive impairment due to Alzheimer’s disease: recommendations from the National Institute on Aging-Alzheimer’s Association workgroups on diagnostic guidelines for Alzheimer’s disease. Alzheimers Dement 2011; 7 (3 ): 270–279.21514249
7. Hickey GL , Philipson P , Jorgensen A , Kolamunnage-Dona R . Joint models of longitudinal and time-to-event data with more than one event time outcome: a review. Int J Biostat 2018; 14 (1 ).
8. Papageorgiou G , Mauff K , Tomer A , Rizopoulos D . An overview of joint modeling of time-to-event and longitudinal outcomes. Annu Rev Stat Appl 2019; 6 : 223–240.
9. Li K , Luo S . Dynamic predictions in Bayesian functional joint models for longitudinal and time-to-event data: Anapplication to Alzheimer’s disease. Statistical methods in medical research 2019; 28 (2 ): 327–342.28750578
10. Li C , Xiao L , Luo S . Joint model for survival and multivariate sparse functional data with application to a study of Alzheimer’s Disease. Biometrics 2021.
11. Zou H , Li K , Zeng D , Luo S , Initiative ADN. Bayesian inference and dynamic prediction of multivariate joint model with functional data: An application to Alzheimer’s disease. Stat Med 2021; 40 (30 ): 6855–6872.34649301
12. Brown ER . Assessing the association between trends in a biomarker and risk of event with an application in pediatric HIV/AIDS. Ann Appl Stat 2009; 3 (3 ): 1163.20802852
13. Rizopoulos D , Hatfield LA , Carlin BP , Takkenberg JJ . Combining dynamic predictions from joint models for longitudinal and time-to-event data using Bayesian model averaging. J Am Stat Assoc 2014; 109 (508 ): 1385–1397.
14. Rizopoulos D , Ghosh P . A Bayesian semiparametric multivariate joint model for multiple longitudinal outcomes and a time-to-event. Stat Med 2011; 30 (12 ): 1366–1380.21337596
15. Long JD , Mills JA . Joint modeling of multivariate longitudinal data and survival data in several observational studies of Huntington’s disease. BMC Med Res Methodol 2018; 18 (1 ): 1–15.29301497
16. Mauff K , Steyerberg E , Kardys I , Boersma E , Rizopoulos D . Joint models with multiple longitudinal outcomes and a time-to-event outcome: a corrected two-stage approach. Stat Comput 2020; 30 (4 ): 999–1014.
17. Andrinopoulou ER , Rizopoulos D . Bayesian shrinkage approach for a joint model of longitudinal and survival outcomes assuming different association structures. Stat Med 2016; 35 (26 ): 4813–4823.27383428
18. Rizopoulos D Dynamic predictions and prospective accuracy in joint models for longitudinal and time-to-event data. Biometrics 2011; 67 (3 ): 819–829.21306352
19. Sène M , Taylor JM , Dignam JJ , Jacqmin-Gadda H , Proust-Lima C . Individualized dynamic prediction of prostate cancer recurrence with and without the initiation of a second treatment: Development and validation. Stat Methods Med Res 2016; 25 (6 ): 2972–2991.24847900
20. Vlaardingerbroek MT , Boer JA . Magnetic resonance imaging: theory and practice. Springer Science &amp; Business Media. 2013.
21. Polzehl J , Tabelow K . Magnetic Resonance Brain Imaging. Springer. 2019.
22. Ashburner J , Friston KJ . Voxel-based morphometry—the methods. Neuroimage 2000; 11 (6 ): 805–821.10860804
23. Whitwell JL . Voxel-based morphometry: an automated technique for assessing structural changes in the brain. J Neurosci 2009; 29 (31 ): 9661–9664.19657018
24. Gupta Y , Lee KH , Choi KY , Early diagnosis of Alzheimer’s disease using combined features from voxel-based morphometry and cortical, subcortical, and hippocampus regions of MRI T1 brain images. PLoS One 2019; 14 (10 ): e0222446.31584953
25. Ji X , Wang H , Zhu M , Brainstem atrophy in the early stage of Alzheimer’s disease: a voxel-based morphometry study. Brain Imaging and Behavior 2021; 15 (1 ): 49–59.31898091
26. Wang JL , Chiou JM , Müller HG . Functional data analysis. Annu Rev Stat Appl 2016; 3 : 257–295.
27. Morris JS . Functional regression. Annu Rev Stat Appl 2015; 2 : 321–359.
28. Guo W Functional mixed effects models. Biometrics 2002; 58 (1 ): 121–128.11890306
29. Yao F Functional principal component analysis for longitudinal and survival data. Stat Sin 2007: 965–983.
30. Lock EF , Hoadley KA , Marron JS , Nobel AB . Joint and individual variation explained (JIVE) for integrated analysis of multiple data types. Ann Appl Stat 2013; 7 (1 ): 523.23745156
31. Li K , Chan W , Doody RS , Quinn J , Luo S . Prediction of conversion to Alzheimer’s disease with longitudinal measures and time-to-event data. J Alzheimers Dis 2017; 58 (2 ): 361–371.28436391
32. Rosen WG , Mohs RC , Davis KL . A new rating scale for Alzheimer’s disease. Am J Psychiatry 1984.
33. Rey A L’examen clinique en psychologie. 1958.
34. Tombaugh TN , McIntyre NJ . The mini-mental state examination: a comprehensive review. J Am Geriatr Soc 1992; 40 (9 ): 922–935.1512391
35. Hughes CP , Berg L , Danziger W , Coben LA , Martin RL . A new clinical scale for the staging of dementia. Br J Psychiatry 1982; 140 (6 ): 566–572.7104545
36. Liu CC , Kanekiyo T , Xu H , Bu G . Apolipoprotein E and Alzheimer disease: risk, mechanisms and therapy. Nat Rev Neurol 2013; 9 (2 ): 106–118.23296339
37. Huang M , Yang W , Feng Q , Chen W . Longitudinal measurement and hierarchical classification framework for the prediction of Alzheimer’s disease. Scientific reports 2017; 7 (1 ): 1–13.28127051
38. Petrone PM , Casamitjana A , Falcon C , Prediction of amyloid pathology in cognitively unimpaired individuals using voxel-wise analysis of longitudinal structural brain MRI. Alzheimer’s research &amp; therapy 2019; 11 (1 ): 1–13.
39. Di CZ , Crainiceanu CM , Caffo BS , Punjabi NM . Multilevel functional principal component analysis. Ann Appl Stat 2009; 3 (1 ): 458.20221415
40. Lawless J , Zhan M . Analysis of interval-grouped recurrent-event data using piecewise constant rate functions. Can J Stat 1998; 26 (4 ): 549–565.
41. Feng S , Wolfe RA , Port FK . Frailty survival model analysis of the national deceased donor kidney transplant dataset using Poisson variance structures. J Am Stat Assoc 2005; 100 (471 ): 728–735.
42. Hoffman MD , Gelman A , others. The No-U-Turn sampler: adaptively setting path lengths in Hamiltonian Monte Carlo. J Mach Learn Res 2014; 15 (1 ): 1593–1623.
43. Li C , Xiao L , Luo S . Fast covariance estimation for multivariate sparse functional data. Stat 2020; 9 (1 ): e245.34262756
44. Wang J , Luo S . Bayesian multivariate augmented Beta rectangular regression models for patient-reported outcomes and survival data. Stat Methods Med Res 2017; 26 (4 ): 1684–1699.26037528
45. Vehtari A , Gelman A , Gabry J . Practical Bayesian model evaluation using leave-one-out cross-validation and WAIC. Stat Comput 2017; 27 (5 ): 1413–1432.
46. Li L , Greene T , Hu B . A simple method to estimate the time-dependent receiver operating characteristic curve and the area under the curve with right censored data. Stat Methods Med Res 2018; 27 (8 ): 2264–2278.27895266
47. Graf E , Schmoor C , Sauerbrei W , Schumacher M . Assessment and comparison of prognostic classification schemes for survival data. Stat Med 1999; 18 (17–18 ): 2529–2545.10474158
48. Xia M , Wang J , He Y . BrainNet Viewer: a network visualization tool for human brain connectomics. PloS one 2013; 8 (7 ): e68910.23861951
49. Kong D , Staicu AM , Maity A . Classical testing in functional linear models. J Nonparametr Stat 2016; 28 (4 ): 813–838.28955155
50. Scheipl F , Gertheiss J , Greven S . Generalized functional additive mixed models. Electron J Stat 2016; 10 (1 ): 1455–1492.
51. Zipunnikov V , Caffo B , Yousem DM , Davatzikos C , Schwartz BS , Crainiceanu C . Functional principal component model for high-dimensional brain imaging. Neuroimage 2011; 58 (3 ): 772–784.21798354
52. Katina S , Vittert L , W. Bowman A . Functional data analysis and visualisation of three-dimensional surface shape. J R Stat Soc Ser C Appl Stat 2021.
53. Tseng YK , Hsieh F , Wang JL . Joint modelling of accelerated failure time and longitudinal data. Biometrika 2005; 92 (3 ): 587–603.
54. Saykin AJ , Shen L , Yao X , Genetic studies of quantitative MCI and AD phenotypes in ADNI: Progress, opportunities, and plans. Alzheimers Dement 2015; 11 (7 ): 792–814.26194313
55. Konigorski S , Khorasani S , Lippert C . Integrating omics and MRI data with kernel-based tests and CNNs to identify rare genetic markers for Alzheimer’s disease. arXiv preprint arXiv:1812.00448 2018.
56. Mo Q , Shen R , Guo C , Vannucci M , Chan KS , Hilsenbeck SG . A fully Bayesian latent variable model for integrative clustering analysis of multi-type omics data. Biostatistics 2018; 19 (1 ): 71–86.28541380
