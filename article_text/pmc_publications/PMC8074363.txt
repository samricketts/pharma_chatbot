LICENSE: This file is available for text mining. It may also be used consistent with the principles of fair use under the copyright law.


8411723
3864
Genet Epidemiol
Genet Epidemiol
Genetic epidemiology
0741-0395
1098-2272

32896012
8074363
10.1002/gepi.22353
NIHMS1692349
Article
Set-based genetic association and interaction tests for survival outcomes based on weighted V statistics
Li Chenxi http://orcid.org/0000-0003-0701-0757
1
Wu Di 1
Lu Qing http://orcid.org/0000-0002-7943-966X
2
1 Department of Epidemiology and Biostatistics, Michigan State University, East Lansing, Michigan, USA
2 Department of Biostatistics, University of Florida, Gainesville, Florida, USA
Correspondence: Qing Lu, Department of Biostatistics, University of Florida, 2004 Mowry Rd, Gainesville, FL 32611-7450, USA. lucienq@ufl.edu and qlu@epi.msu.edu
12 4 2021
07 9 2020
2 2021
26 4 2021
45 1 4663
This file is available for text mining. It may also be used consistent with the principles of fair use under the copyright law.
With advancements in high-throughout technologies, studies have been conducted to investigate the role of massive genetic variants in human diseases. While set-based tests have been developed for binary and continuous disease outcomes, there are few computationally efficient set-based tests available for time-to-event outcomes. To facilitate the genetic association and interaction analyses of time-to-event outcomes, We develop a suite of multivariant tests based on weighted V statistics with or without considering potential genetic heterogeneity. In addition to the computation efficiency and nice asymptotic properties, all the new tests can deal with left truncation and competing risks in the survival data, and adjust for covariates. Simulation studies show that the new tests run faster, are more accurate in small samples, and account for confounding effect better than the existing multivariant survival tests. When the genetic effect is heterogeneous across individuals/subpopulations, the association test considering genetic heterogeneity is more powerful than the existing tests that do not account for genetic heterogeneity. Using the new methods, we perform a genome-wide association analysis of the genotype and age-to-Alzheimer’s data from the Rush Memory and Aging Project and the Religious Orders Study. The analysis identifies two genes, APOE and APOC1, associated with age to Alzheimer’s disease onset.

genetic heterogeneity
kernel function
left truncation
multivariant test
time-to-event outcomes
weighted V statistics

1 | INTRODUCTION

Advances in high-throughput technologies enable researchers to comprehensively investigate the role of a wide-ranging catalog of variants (e.g., single nucleotide polymorphisms (SNPs), gene expression, and copy number variations) in complex human diseases. Although most genetic association studies adopt a case–control design to identify genetic variants that are associated with disease susceptibility, there is an increased interest in identifying genetic variants that affect time-to-event outcomes such as age at disease onset and survival time after diagnosis of cancer (Azzato et al., 2010; K.-L. Huang et al., 2017; Y.-T. Huang et al., 2009). This is because, first, survival outcomes provide additional information beyond binary outcomes, that is, event occurrence, thereby could potentially improve the power of genetic association analyses (Hughey et al., 2019; Staley et al., 2017; van der Net et al., 2008), and second, numerous studies have revealed the enormous potential of genomic biomarkers for predicting survival outcomes (Beer et al., 2002; H.-Y. Chen et al., 2007; Yu et al., 2008).

Genetic data generated by high-throughput technologies are characterized by high-dimensionality. The massive number of genetic variants poses computational burden and multiple testing issue in association and interaction analyses. Single-variant tests may suffer from low power due to a large number of tests and small effect sizes of individual variants. Set-based tests aggregate the association signals from all variants in a knowledge-based variant set (e.g., genes and genetic pathways), and therefore could be more powerful. The results from a set-based test are also more interpretable and reproducible (Goeman, Oosting, Cleton-Jansen, Anninga, &amp; van Houwelingen, 2005; Subramanian et al., 2005). The state-of-the-art set-based tests with survival outcomes are based on kernel machine survival regression (Cai, Tonini, &amp; Lin, 2011; H. Chen et al., 2014; Goeman et al., 2005; Sinnott &amp; Cai, 2013). The advantages of the kernel machine tests are that (1) they effectively account for the correlation between variants, thereby improving the power, and (2) they can efficiently detect complex joint effects of multiple variants (e.g., nonlinear and nonadditive) without specification of any particular functional form of the genetic covariates in the outcome regression model. However, there are several disadvantages of the existing kernel machine tests for survival traits. First, the asymptotic Global Test (gt; Goeman et al., 2005), the AFT kernel machine test (aftKM; Sinnott &amp; Cai, 2013), and the Cox SKAT score test (coxSKATs; H. Chen et al., 2014) are not accurate for samples of very moderate size (n = 100–500). The p values’ distribution of these tests under the null hypothesis are not close to the uniform distribution over the interval [0, 1], as shown in the later simulation. Second, the permutation version of gt (Goeman et al., 2005), the Cox kernel machine test (coxKM; Cai et al., 2011), and aftKM use either permutation or resampling procedures to obtain p values, making genome-wide analyses very time-consuming. Third, genetic variants could have different effects on individuals or on subgroups of a population (Galvan, Ioannidis, &amp; Dragani, 2010; McClellan &amp; King, 2010), which we call genetic heterogeneity; none of the existing kernel machine survival tests can account for genetic heterogeneity and are subject to power loss when variants have heterogeneous genetic effects. Fourth, when adjusting for additional covariates, coxKM is far from being accurate if the adjustment covariates are correlated with the genetic variants under testing, as shown in the later simulation. So it cannot adjust for confounding effect.

In this paper, we develop a suite of set-based tests for genetic association and interaction on survival outcomes, based on weighted V statistics. The new tests address the aforementioned drawbacks of the existing set-based tests with survival outcomes while inheriting their advantages. Specifically, the new tests are more computationally efficient than the existing ones, are accurate in samples of very moderate size, can account for genetic heterogeneity, and can remove most confounding effects. They are also able to deal with left truncation and competing risks in survival data. The new tests can be considered an extension of the (heterogeneity) weighted-U-statistic-based association tests (Wei, Elston, &amp; Lu, 2016; Wei &amp; Lu, 2017) to censored survival traits. The (heterogeneity) weighted-U-statistic-based association tests are similarity-based tests, defined as the summation of phenotype similarities weighted by (heterogeneity weighted) genetic similarities over all pairs of individuals (Wei &amp; Lu, 2017; Wei et al., 2016). The phenotype similarity in weighted-U-statistic-based tests can be defined on different types of data (e.g., continuous and categorical data), making the tests applicable to various types of traits. Nonetheless, the existing weighted-U-statistic-based tests cannot be used for analyzing survival traits with censored data, which motivates us to develop a set of tests for genetic data analysis of survival traits. The innovations of the new tests over the existing weighted U tests are not just the change of types of outcomes. When considering possible effect heterogeneity in testing genetic associations, the proposed heterogeneity weighted V (HWV) test uses a different kernel as the heterogeneity weight function than the heterogeneity weighted U test (Wei et al., 2016), which makes the HWV test still powerful when the effect heterogeneity is small or nonexistent. Moreover, the weighted V test can test gene–gene/gene–environment (G–G/G–E) interactions, while the (heterogeneity) weighted U tests are designed for testing genetic associations only. In our simulation studies, we compare the weighted V tests with coxKM, gt, and coxSKATs. The results demonstrate the aforementioned advantages of weighted V tests over the existing ones. Finally, we present an application of the new tests to a genome-wide association study of age to Alzheimer’s disease onset, with the data from the Rush Memory and Aging Project and the Religious Orders Study (Bennett et al., 2018).

2 | METHODS

2.1 | Data and assumptions

We use a generic notation, G = (G1, …, Gp)T, to denote two types of genetic covariate sets, that is, Gi denotes either the genotype of a SNP (coded as 0, 1, or 2) or the expression measurement of a gene. SNP sets can be formed based on genes, pathways, LD blocks, recombination hot-spots, or a sliding window approach. Gene sets can be constructed based on information from the pathway databases (e.g., KEGG). The survival time of interest is denoted by T. The censoring time is denoted by C. The observed survival data of an individual are represented by (L, U, Δ), where L denotes the observed left truncation time (if any) and is zero in the absence of left truncation, U = min(T, C), and Δ = I(T ≤ C). The corresponding counting process and at-risk process are denoted by {N(t), Y(t): t ≥ 0}, where N (t) = I(U ≤ t, Δ = 1) and Y (t) = I(U ≥ t). The entire data set with n subjects comprise {Ni(⋅),Yi(⋅),Gi}i=1n. When adjusting for other covariates in the proposed tests, we denote the adjustment covariates by Z = (Z1, …, Zq)T. We assume that the survival time is conditionally independent of the left truncation time and the gap time between left truncation and right censoring given the genetic covariates (and the adjustment covariates, if any). We further assume that the left truncation time and the gap time between left truncation and right censoring are independent of the genetic covariates, but may be dependent on the adjustment covariates, if any. All the tests developed below are readily applicable to competing risks data by redefining N (t) and Y (t) as the counting and at-risk processes for the competing cause of interest.

2.2 | Weighted V tests for genetic association

2.2.1 | Weighted V tests for genetic association without adjusting for covariates

We propose a test for evaluating the association between G and T based on the following weighted V statistic, (1) V*=n−2∑i=1n∑j=1nf˜(Gi,Gj)MiMj,

where Mi=Ni(∞)−∫0∞Yi(s)dΛ(s), Λ(t) is the marginal cumulative hazard function of T, MiMj is considered as the V-statistic kernel, and f˜(Gi,Gj) is considered as the weight function and is a centered genetic similarity measure defined by f˜(Gi,Gj)=f(Gi,Gj)−E[f(Gi,Gj)|Gi]−E[f(Gi,Gj)|Gj]+E[f(Gi,Gj)],

where f(Gi, Gj) is a kernel function (see Definition 3.4 in Cristianini &amp; Shawe-Taylor, 2000), of which the choice will be discussed below. When G has effects on the survival outcome, MiMj, which can be viewed as a phenotype similarity, is concordant with the centered genetic similarity f˜(Gi,Gj). In other words, the larger phenotype similarity is weighted heavier and the smaller phenotype similarity is weighted lighter, leading to a large value of V*.

The choice of the kernel function f(Gi, Gj) depends on the type of G and the expected form of G’s effect. If the effect of G is expected to be linear, we use cross-product kernel, that is, f(Gi,Gj)=GiTGj. For SNPs, we use IBS kernel, that is, f(Gi,Gj)=∑k=1p(2−|Gik−Gjk|)/(2p), if the effect of G is not expected to be linear. For gene expression covariates, we use polynomial kernels, f(Gi,Gj)=(ρ+GiTGj)d, or Gaussian kernel, f(Gi, Gj) = exp(−ρ‖Gi − Gj ‖2), if nonlinear or interactive effects of G are expected. Here ρ is a specified positive constant and d is a specified positive integer. As suggested by Wei and Lu (2017), we can also choose a unified Laplacian kernel, f(Gi,Gj)=exp(−∑k=1pwk|Gik−Gjk|/Υ), where Gik can be discrete or continuous variables, Υ=∑k=1p, and wk is a function of the variance σk2 of Gk, defined by wk = 1/σk. This kernel is particularly useful for association analyses with sequencing data, where a large portion of genetic variants are rare. Table 1 summarizes the kernel functions we proposed for measuring genetic similarity in various scenarios.

To derive the asymptotic null distribution of V*, we can decompose the centered genetic similarity measure by f˜(gi,gj)=∑t=1∞ηtψt(gi)ψt(gj), where {ηt } and {ψt (·)} are eigenvalues and eigenfunctions of f˜(⋅,⋅). The eigenfunctions are orthonormal, that is, E(ψs (G)ψt (G)) = I(s = t). We can then write V* as (2) V*=1n∑t=1∞(1n∑i=1nψt*(Gi)Mi)2,

where ψt*(Gi)=ηt0.5ψt(Gi). Using this form, we can show that the asymptotic null distribution of V* is a weighted sum of independent χ2 random variables with degree 1. This is formally stated in Theorem 1 below, of which the proof is relegated to the appendix.

Theorem 1. Suppose that λ ≡ E(M2), where M=N(∞)−∫0∞Y(s)dΛ(s), is a finite-positive number and E[f˜(Gi,Gj)]&lt;∞. Under the null hypothesis that T is independent of G, nV*⇝λ∑t=1∞ηtχ1t2, where χ1t2′s are independent χ2 random variables with degree 1.

In real applications, we estimate Λ(s) by using the Nelson-Aalen estimator Λ^(s) and compute f˜(Gi,Gj) by using f(Gi,Gj)−n−1∑l=1nf(Gl,Gl)−n−1∑k=1nf(Gk,Gj)+n−2∑k=1n∑l=1nf(Gk,Gl).

The resulting weighted V statistic can be shown to be V=M^T(I−J)TF(I−J)M^,

where M^=(M^1,…,M^n)T with M^i=Ni(∞)−∫0∞Yi(s)dΛ^(s), I is an n × n identity matrix, J is an n × n matrix with all elements being 1/n, and F = {f(Gi, Gj)}n×n. We approximate λ by λ^=M^TM^/n and use a matrix eigen-decomposition of (I − J)TF(I − J) to obtain a finite-dimensional approximation for ηt’s. Denote the eigenvalues and eigenvectors of (I − J)TF(I − J) by η˜t(t=1,…,n) and ψ˜t(t=1,…,n), respectively. Because ψ˜t satisfies ∑i=1nψ˜ti2=1, instead of n−1∑i=1nψ˜ti2=1, a finite-dimensional approximation for ηt is η^t=η˜t/n. Using λ^ and η^t, the large-sample null distribution of V can be approximated by (3) nV~λ^∑t=1nη^tχ1t2.

Based on this distribution, we use Davies’ method (Davies, 1980) to compute the p value P(nV ≥ nVobs), where Vobs is the observed value of V. Davies’ method (Davies, 1980) is an algorithm that can compute the distribution function of a linear combination of independent χ2 random variables. It is based on the method of Davies (1973) involving numerical inversion of the characteristic function. The function “davies” in the R package “CompQuadForm” implements Davies’ method (Davies, 1980). Note that the test in (3) is a nonparametric test, that is, it has no model assumption.

2.2.2 | Weighted V tests for genetic association adjusting for covariates

We can adjust the above test for covariates to reduce confounding or increase power. To do so, we assume a Cox’s proportional hazards model between the survival outcome T and the adjustment covariates Z under the null hypothesis that T is independent of G given Z, that is, dΛ(t|Z) ≡ E{dN(t)|Z, Y(t −) = 1, Y(s), s &lt; }t = exp(ZTγ)dΛ0(t). We then develop a covariate-adjusted weighted V statistic by replacing Mi and f˜(Gi,Gj) in (1), respectively by MZ,i=Ni(∞)−∫0∞Yi(s)exp(ZiTγ)dΛ0(s) and a covariate-centered generic similarity defined by f˜Z(Gi,Gj)=f(Gi,Gj)−E[f(Gi,Gk)u(Zk,Zf)|Gi,Zj]−E[u(Zi,Zk)f(Gk,Gj)|Zi,Gj]+E[u(Zi,Zm)f(Gm,Gk)u(Zk,Zj)|Zi,Zj],

where u(Zi,Zj)=(1,ZiT)[E{(1,ZT)T(1,ZT)}]−1(1,ZjT)T. It is easy to show that E[f˜Z(Gi,Gj)(1,ZjT)|Gi,Zi]=0. The resulting covariate-adjusted weighted V statistic is (4) VZ*=n−2∑i=1n∑j=1nf˜Z(Gi,Gj)MZ,iMZ,j.

When G has effects on T, MZ,iMZ,j, which can be viewed as a covariate-adjusted phenotype similarity, is concordant with the covariate-centered genetic similarity f˜Z(Gi,Gj). In other words, the larger phenotype similarity is weighted heavier and the smaller phenotype similarity is weighted lighter, leading to a large value of VZ*. The asymptotic null distribution of VZ* is given in Theorem 2, which is proved in the appendix.

Theorem 2. Suppose that ξ≡E(MZ,i2) is a finite positive number and E[f˜Z(Gi,Gj)]&lt;∞. When T is independent of G given Z and G is independent of Z, nVZ*⇝ξ∑t=1∞vtχ1t2, where χ1t2's are independent χ2 random variables with degree 1 and νt’s are the eigenvalues of f˜Z(gi,gj), that is, f˜Z(gi,gj)=∑t=1∞vtϕt(gi,zi)ϕt(gj,zj) with E(ϕs(G,Z)ϕt(G,Z))=I(s=t).

The same asymptotic null distribution also holds when f(Gi, Gk) is the cross-product kernel and G satisfies a linear model with Z as the covariates, that is, G = a + BTZ + e, where a and B are respectively a constant vector and a constant matrix, and e is a zero-mean random error vector that is independent of Z.

When G is independent of Z, the test based on V* (the unadjusted test) and the test based on VZ* (the adjusted test) are both asymptotically valid, but the latter is more powerful than the former in finite samples if Z affects the survival outcome. When Z affects both G and the survival outcome, it is a confounder. Theorem 2 implies that the covariate-adjusted weighted V test with cross-product-kernel-based genetic similarity is asymptotically correct in the presence of linear confounding. This property is not enjoyed by Cai et al.’s (2011) kernel machine test, as shown in the later simulation.

In real applications, we estimate γ by the maximum partial-likelihood estimator γ^ and Λ0(s) by the Breslow estimator Λ^0(s) under the null hypothesis, and replace the expectations in f˜Z(gi,gj) by the corresponding sample averages. The resulting weighted V statistic can be shown to be VZ=M^ZT(I−H)TF(I−H)M^Z,

where M^Z=(M^Z,1,…,M^Z,n)T with M^Z,i=Ni(∞)−∫0∞Yi(s)exp(ZiTγ^)dΛ^0(s) and H=Z˜(Z˜TZ˜)−1Z˜T with Z˜ being a n × (q + 1) matrix whose ith row is (1,ZiT)(i=1,…,n). We approximate ξ by ξ^=M^ZTM^Z/n and use a matrix eigen-decomposition of (I − H)TF(I − H) to obtain a finite-dimensional approximation for νt’s. Denote the eigen-values and eigen-vectors of (I − H)TF(I − H) by ν˜t(t=1,…,n) and ϕ˜t(t=1,…,n), respectively. Because ϕ˜t satisfies ∑i=1nϕ˜t,i2=1, instead of n−1∑i=1nϕ˜t,i2=1, a finite-dimensional approximation for νt is v^t=ν˜t/n. Using ξ^ and v^t, the large-sample null distribution of VZ can be approximated by (5) nVZ~ξ^∑t=1nv^tχ1t2.

Based on this distribution, we use Davies’ method (Davies, 1980) to compute the p-value P(nVZ ≥ nVZ,obs), where VZ,obs is the observed value of VZ. When q is a relatively large number to n, we multiply the null distribution by a factor n/(n − q − 1) to take into account the projection operator I − H for finite samples, as Wei and Lu (2017) does.

2.3 | Weighted V tests for genetic association considering genetic heterogeneity

The effects of SNP sets or gene sets (e.g., genes in a biological pathway) on survival outcome could vary across subpopulations (e.g., different sexes, races, or genome profiles). To test the effects of SNP sets or gene sets considering heterogeneous effects across subpopulations, we extend the weighted V statistics, V and VZ, by replacing f(Gi, Gj) with the following heterogeneity weighted kernel function to consider the (latent) population structure, wij = (1 + κij)f(Gi, Gj), where κij is a measure of subpopulation similarity between two individuals. The resulting weighted V statistics, called heterogeneity weighted V in the sequel, are VH=M^T(I−J)TW^(I−J)M^

and VZH=M^ZT(I−H)TW^(I−H)M^Z,

where W^=(1+K)⋅F, 1 = {1}n×n, K = {κij}n×n and · is the element-wise matrix product operator.

The heterogeneity weighted V statistics can accommodate the population structure that is completely determined by a vector of observable variables X = (X1, …, XD)T (e.g., subpopulations determined by sex, race, education level, or their combinations) or the latent population structure (e.g., subpopulations with different ancestry backgrounds) that cannot be completely determined but can be inferred by a vector of observable variables X (e.g., a large number of genotyped SNPs across the genome). In either case, we can use a unified subpopulation similarity measure, (6) κij=exp(−D−1∑d=1D(Xlds−Xjds)2),

where Xids is the standardized Xid, that is, n−1∑i=1nXids=0 and n−1∑i=1n(Xids)2=1. We can also choose a particular κij appropriate for a particular type of X. For example, if X is a set of SNPs, we can use the IBS kernel for κij, that is, ∑d=1D(2−|Xid−Xjd|)/(2D). If X is a set of dummy variables representing a few subpopulations, we can choose κij = I (Xi = Xj). Table 2 summarizes the kernel functions we proposed for measuring the subpopulation similarity in various scenarios.

Under the null hypothesis that G has no effect on T in any subpopulation (while adjusting for Z), the large-sample distributions of nVH and nVZH can be approximated by (3) and (5), respectively, except replacing F by W^ to compute η^t′s and v^t′s . Based on these distributions, we use Davies’ method (Davies, 1980) to compute the p values P(nVH≥nVobsH) and P(nVZH≥nVZ,obsH), where VobsH and VZ,obs H are the observed values of VH and VZH, respectively. When the number of adjustment covariates is relatively large to n, we multiply the null distribution by a factor n/(n – q − 1) to take into account the projection operator I − H for finite samples, as Wei and Lu (2017) does.

2.4 | Weighted V tests for G–G/G–E interactions

We denote the gene of interest by G ≡ (G1, …, Gp)T, where Gk codes the genotype (0,1 or 2) of the kth SNP in the gene. In the G–E interaction analysis, the environmental variable is represented by another vector X = (X1, …, XD)T, whose dimension is greater than one if the variable is categorical with more than two levels. In the G–G interaction analysis, we denote the second gene by H = (H1, …, Hq)T.

For testing G–G interaction, we first construct martingale residual processes based on a Cox model with G and H as two covariates, assuming additive genetic effects of G and H under the null hypothesis of no interaction. That is, M^i(t)=Ni(t)−∫0tYi(s)exp(∑k=1pGikα^k+∑l=1qHilβ^l)dΛ^0(s), where α^k′s and β^q are the maximum partial-likelihood estimators of regression parameters and Λ^0(s) is the Breslow estimator of cumulative baseline hazard. Define M^i=M^i(∞), M^=(M^1,…,M^n)T, G˜T=(G1,…,Gn), and H˜T=(H1,…,Hn). Let f(Gi, Gj) and k (Hi, Hj) respectively represent the similarity in gene G and gene H between subjects i and j. The choice of kernel functions f(·, ·) and k(·, ·) depends on the mode of inheritance. For example, we can use the cross-product kernel f(Gi,Gj)=GiTGj if the genetic effect of G is additive. We propose a G-G interaction test based on the following weighted V statistic, VI=M^T(I−O)T(F⋅K)(I−O)M^,

where I is an n × n identity matrix, O=(1 G˜ H˜){(1 G˜ H˜)T(1 G˜ H˜)}−1(1 G˜ H˜)T,1 denotes an n-dimensional vector of ones, F = {f(Gi, Gj)}n×n, K = {k(Hi, Hj)}n×n, and F·K represents the element-wise product of F and K. The null limiting distribution of nVI can be approximated by a mixture of χ2 distributions computed in the same way as for nVZ. Based on the null distribution, we use Davies’ method (Davies, 1980) to compute the p value, P(nVI ≥ nVI,obs), where VI,obs is the observed value of VI. Because both of the genes may have multiple SNPs, p + q could be a relatively large number to n. In that case, we multiply the null distribution by a factor n/(n – p – q − 1) to take into account the projection operator I − O for finite samples, as Wei and Lu (2017) does.

If the mode of inheritance is unspecified for G and H, we propose a similar G–G interaction test with the following modifications: M^i(t)=Ni(t)−∫0tYi(s)exp(∑k=1p{I(Gik=1)α^1k+I(Gik=2)α^2k}+∑l=1q{I(Hil=1)β^1l+I(Hil=2)β^2l})dΛ^0(s),f(Gi,Gj)=∑k=1pI(Gik=Gjk),k(Hi,Hj)=∑l=1qI(Hil=Hjl),G˜,

becomes a n × 2p matrix with the ith row being (I(Gi1 = 1), I(Gi1 = 2), …, I(Gip = 1), I(Gip = 2))(i = 1, …, n), and H˜ is similarly defined.

The G–E interaction test is the same as the G-G interaction test except that the genetic variable H is replaced by the environment variable X. Both the G-G and G-E interaction tests can adjust for covariates by incorporating the covariates into the projection operator I − O and as additive covariates into the null model. The weighted-V-statistic based interaction tests are more powerful than the traditional tests (e.g., likelihood ratio, Wald, and score tests) for detecting interactions in a Cox model when G or H contains multiple correlated SNPs, because our test statistic has an effective degree of freedom (DF) that is lower than the DF of the traditional tests. Here the effect degree of freedom is defined to be the DF d0 of a rescaled χ2 distribution, c0χd02, that matches the first two moments of nVI.

3 | SIMULATIONS

We conducted Monte Carlo simulations to evaluate the finite-sample performance of the weighted V tests in both the absence and the presence of left truncation. In all the simulations, survival times were generated from Cox’s proportional hazards (PH) models, and censoring times were sampled from exponential distributions with varied rate parameters such that the right censoring proportion was controlled between 20% and 40%. Unless otherwise specified, we considered SNPs as the genetic covariates in the simulations and each SNP’s genotype was simulated from a Binomial (2, 0.2) distribution. In all the simulations, unless otherwise specified, three different sample sizes, n = 500, 1000, 1500, and three different SNP-set sizes, p = 5, 10, 15, were considered. When considering covariate adjustment, a binary covariate Z1~Bernoulli (0.5) and a continuous covariate Z2~Uniform (0, 2) were generated for each subject, unless otherwise specified. Several existing genetic association and interaction tests were also investigated in some of the simulations for comparison with our methods. In each simulation scenario, 2000 Monte Carlo samples were generated to investigate the test’s empirical size and 1000 samples for power assessment. The empirical size and power of every test were calculated based on the proportion of p values smaller than or equal to 0.05, unless otherwise specified. The simulation results in the absence of left truncation were given below, and the results under left truncation were given in the Supporting Information Materials.

3.1 | Testing genetic association in the absence of genetic heterogeneity

In this series of simulations, we investigated the performance of the weighted V test (WV), coxKM (implemented by using the R package “coxKM”), gt (the asymptotic version, implemented by using the R package “globaltest”), and coxSKATs (implemented by using our own R code) in testing association of a SNP set with a survival time in the absence of genetic heterogeneity, adjusting for covariates. In the Supporting Information Materials, we also presented a simulation study to investigate the empirical size and computation time of aftKM. The survival time for subject i(i = 1, …, n) was generated from an exponential distribution with the following rate parameter, (7) λ0exp(∑j=1pβ1jGij+∑k=120.5Zik),

where λ0 and (β11, …, β1p)T vary depending on the simulation scenario.

3.1.1 | Computation time comparison between WV, coxKM, gt, and coxSKATs

We compared the running times of WV, coxKM, gt, and coxSKATs under the null hypothesis of no genetic association on a PC with a 3.40 GHz CPU and 8 GB RAM. Cross-product kernel was used for WV and coxKM so that they were comparable to gt and coxSKATs in terms of assumed genetic effect form. λ0 in (7) was set to be 1. The run times of the four tests under p = 5 and n = 150, 500, and 1000 are given in the Supporting Information Materials. They show that WV and gt run faster than coxKM and coxSKATs. WV is a little bit slower than gt when n = 150 and 500, but faster when n = 1000. coxKM is the slowest due to using resampling to compute the p-value.

3.1.2 | Comparison of the empirical sizes of WV, coxKM, gt, and coxSKATs in samples of very moderate size

We investigated the empirical sizes of WV, coxKM, gt, and coxSKATs under n = 150 and p = 5. Cross-product kernel was used for WV and coxKM so that they were comparable to gt and coxSKATs in terms of assumed genetic effect form. λ0 in (7) was set to be 1. The empirical sizes of WV, coxKM, and gt are 0.054, 0.049, and 0.042, respectively, all close to the nominal level (0.05), but the empirical size of coxSKATs is remarkably smaller, only 0.0145. The Q-Q plots of p values in Figure 1 show that the null distributions of p value for WV and coxKM concur with the asymptotic theory of the two tests, that is, being close to Uniform (0, 1), in samples of very moderate size, whereas those for gt and coxSKATs do not. Therefore, we only compared WV and coxKM in the remaining simulations.

3.1.3 | Empirical sizes and powers of WV and coxKM under various n and p

In this simulation, we used the IBS kernel to measure genetic similarity in WV and coxKM. λ0 in (7) was set to be 0.5. β1j = 0.1(j = 1, …, p) in the power simulations. Table 3 shows that the empirical sizes of WV and coxKM are around the nominal level and the two tests have comparable powers under various n and p. In the Supporting Information Materials, we also present some simulations which compared the empirical sizes and powers of WV and coxKM for testing genetic association when there is linkage-disequilibrium in the considered SNP set.

3.1.4 | Emprical sizes of WV and coxKM under linear confounding

In this simulation, we considered gene expression values as the genetic covariates and let Gi = 1Zi1 + 1Zi2 + ei, where Gi = (Gi1, …, Gip)T. 1 is a p-dimensional vector of ones, and ei~MVN (0, Σ) with Σ = {0. 5|i−j|}p×p. We set p = 5, n = 500, and λ0 in (7) to be 0.5. Cross-product kernel was used for WV and coxKM. From the simulation, the empirical size of WV is 0.0475 and that of coxKM is 0.0185. This, together with the Q-Q plots of p values in Figure 2, shows that WV can account for linear confounding but coxKM can not.

3.2 | Testing genetic association in the presence of genetic heterogeneity

In this series of simulations, we investigated the performance of the heterogeneity weighted V test (HWV) and coxKM in testing association of a SNP set with a survival time in the presence of various types of genetic heterogeneity, adjusting for covariates.

3.2.1 | Empirical sizes and powers of HWV and coxKM in the presence of genetic heterogeneity across observable sub-populations

In this simulation, we considered heterogeneous genetic effects across four observable sub-populations. Specifically, when evaluating power, the survival time was simulated from an exponential distribution with the following hazard rate, exp{∑k=1p(0.5Zi1+0.005Zi2+0.001Zi3+0.0005)Gik+0.6Zi1+0.6Zi2+0.2Zi3},

where Zi1, Zi2, and Zi3 are three dummy variables that code four sub-populations, each constituting 1/4 of the whole population. When evaluating empirical size, the survival time was simulated from an exponential distribution with the hazard rate being exp{0.6Zi1 + 0.6Zi2 + 0.2Zi3}. IBS kernel was used in HWV and coxKM to measure genetic similarity. κij = I(Zi = Zj), where Zi = (Zi1, Zi2, Zi3)T was used to measure subpopulation similarity in HWV. Table 4 shows that the empirical sizes of both HWV and coxKM are close to the nominal level and that HWV is more powerful than coxKM in the presence of genetic heterogeneity across observable sub-populations.

3.2.2 | Empirical sizes and powers of HWV and coxKM in the presence of genetic heterogeneity across two latent subpopulations

In this simulation, we investigated the performance of HWV and coxKM in the presence of genetic heterogeneity across two latent subpopulations, adjusting for covariates. The two latent subpopulations each constitute 1/2 of the whole population. The survival time of subject j in subpopulation i was generated from an exponential distribution with the following hazard rate: (8) 0.5exp{∑k=1pGtjkβik+0.5Ztj1+0.5Ztj2},

where βik (i = 1, 2; k = 1, …, p) is the genetic effect of Gk in subpopulation i and varies depending on the simulation scenario. The subjects of a Monte Carlo sample came from the two latent subpopulations in a 1:1 ratio. Two covariates, X1 and X2, were generated to infer the latent subpopulation. Specifically, X1 = 1 + e1 and X2 = 2 + e2 if the subject is from subpopulation 1, and X1 = 3 + e1 and X2 = 5 + e2 if the subject is from subpopulation 2, where e1 and e2 are independent random variables from N(0, 0. 5)2. We used the IBS kernel to measure genetic similarity in HWV and coxKM and the function (6) to measure subpopulation similarity in HWV.

Table 5 shows that the empirical size of HWV is close to the nominal level under various p’s and n’s. The empirical size of coxKM is also close to the nominal level except that coxKM is a little bit conservative when p is relatively large to n. Table 6 shows the power comparison between HWV and coxKM in both the absence and the presence of genetic heterogeneity. As the heterogeneity size (|β1k − β2k|) increases, HWV consistently gains power. The power of HWV is consistently larger than that of coxKM in the presence of heterogeneity. In the absence of heterogeneity (i.e., β1k = β2k ≠ 0), HWV is less powerful than coxKM due to adjusting for non-existent genetic heterogeneity.

In Section 1, we stated that our HWV test uses a different kernel as the heterogeneity weight function than the heterogeneity weighted U test (Wei et al., 2016), which makes HWV still powerful when the effect heterogeneity is small or nonexistent. As supporting evidence, we present some simulations in the Supporting Information Materials which compared the empirical sizes and powers of HWV and the heterogeneity weighted V test with the heterogeneity weight function of Wei et al. (2016; i.e., 1 + κij vs. κij as the heterogeneity weight function) under little and no genetic heterogeneity across two latent subpopulations. In the Supporting Information Materials, we also present some simulations that compared the empirical sizes and powers of HWV and coxKM for testing genetic association in the presence of genetic heterogeneity across two latent sub-populations and LD in the considered SNP set.

3.2.3 | Empirical sizes and powers of HWV and coxKM in the presence of genetic heterogeneity across 20 latent subpopulations

In this simulation, we used the same survivaltime-generating model as the one used in the previous simulation except increasing the number of latent subpopulations to 20 and sampling βik (i = 1, …, 20; k = 1, …, p) from a uniform distribution with mean μβ and variance σβ2. We simulated 20 covariates, Xijd = aid + δij, δij~N (0, 0.5)(d = 1, …, 20), to infer the latent population structure, where aid’s (d = 1, …, 20) were randomly sampled from {1, …, 20} without replacement. We used IBS kernel to measure genetic similarity in HWV and coxKM and the function (6) to measure subpopulation similarity in HWV.

Table 7 shows that the empirical size of HWV is close to the nominal level. The powers of HWV and coxKM in the presence of genetic heterogeneity across 20 latent subpopulations are given in the Supporting Information Materials. The power results show that when the genetic heterogeneity is present and the SNP-set size or sample size is large, HWV is much more powerful than coxKM. When the average genetic effect (μβ) increases, both tests gain power. Furthermore, when the genetic heterogeneity (reflected by σβ) increases, the power of HWV gets substantially higher, while that of coxKM stays almost the same. The power change with μβ and σβ was demonstrated in Figure 3 for p = 15 and n = 1000.

3.2.4 | Empirical sizes and powers of HWV and coxKM in the presence of genetic heterogeneity across individual genome profiles

In reality, subpopulation structure may not be “categorical” as it is in the previous two simulations. In this simulation, we considered a situation where the subpopulation structure is “continuous,” that is, the genetic variants have varied effects across individuals depending on the subjects’ genome profiles. To mimic the “continuous” genetic heterogeneity, we generated the survival time from the following mixed-effects Cox model: (9) λ(t|Gi,Zi)=0.5exp(∑k=1pGikβik+0.5Zi1+0.5Zi2),

where βi1 = βi2 =⋯= βip (i = 1, …, n) was sampled from a uniform distribution with mean μβ and variance σβ2, which vary depending on the simulation scenarios. We further simulated a set of SNPs, {Xd = (X1d, X2d, …, Xnd)T: d = 1, …, 1000}, to reflect the latent genome background that leads to the genetic heterogeneity. Specifically, we first generated a X˜d from a multivariate normal distribution, MVN (0, Σ), where Σ = {σij}n×n was calculated based on the effect difference, σij = exp(−∣βi1 − βj1|/σβ) (σij = I(i = j) under the null hypothesis of no genetic association), and then categorized X˜d into three classes with values 0, 1, and 2 to obtain Xd by using rank-based cut-off values (the first rank cutoff, C1, was sampled from Uniform(0.6n, 0.7n), and the second was sampled from Uniform(C1, 0.9n)). We used the IBS kernel to measure genetic similarity in HWV and coxKM and the same kernel to measure subpopulation similarity in HWV.

Table 8 shows that the empirical size of HWV is close to the nominal level. The powers of HWV and coxKM in the presence of genetic heterogeneity across individual genome profiles are given in the Supporting Information Materials. The power results show that when the genetic heterogeneity is present and the SNP-set size or sample size is large, HWV is more powerful than coxKM. When the average genetic effect (μβ) increases, both tests gain power. Furthermore, when the genetic heterogeneity (reflected by σβ) increases, the power of HWV gets substantially higher, while that of coxKM stays almost the same. The power change with μβ and σβ was demonstrated in Figure 4 for p = 10 and n = 1000.

3.3 | Testing G–G interaction

In this simulation, we investigated the performance of the weighted V test for G–G/G–E interaction (WVI) and the standard likelihood ratio test (LRT) in testing the interaction between two SNP sets. To mimic linkage disequilibrium (LD) between SNPs within a SNP set, we generated the two SNP sets, G and H, in two steps. In the first step, we generated G˜ and H˜ from MVN (0, ΣG) and MVN(0, ΣH) respectively, where ΣG = {0. 3i−j}p×p and ΣH = {0. 3i−j}q×q. In the second step, we categorized each component in G˜ and in H˜ into three categories labeled by 0, 1 and 2 representing the count of minor allele; this was done in a way that the resulting minor allele frequency (MAF) was 0.2 and the resulting SNPs satisfied Hardy-Weinberg Equilibrium (HWE). We simulated the survival time from an exponential distribution with the following hazard rate: 0.5exp{∑k=1p0.05Gk+∑l=1q0.05Hl+∑m=1pq(GH)m βm},

where Gk, Hl and (GH)m represented, respectively, the kth SNP in SNP set G, the lth SNP in SNP set H and the mth G–G interaction term. βm = 0(m = 1, …, pq) under the null hypothesis of no interaction while βm = 0.1 under the alternative hypothesis that the interaction between G and H exists. We did the finite-sample adjustment of WVI’s null distribution as described in the section introducing WVI.

Table 9 shows that the empirical size of WVI is close to the nominal level, but LRT has an inflated empirical size when pq is relatively large to n. As expected, WVI is more powerful than LRT when the SNP sets contain correlated SNPs.

In the Supporting Information Materials, we also present some simulations that compared the powers of WVI and LRT for testing G–G interaction under some other effect sizes.

3.4 | Testing G–E interaction

In this simulation, we investigated the performance of WVI and LRT in testing the interaction between a set of 10 SNPs and a set of two environmental variables. The 10 genetic covariates were generated under linkage disequilibrium. Specifically, we first generated a vector of 10 random variables from MVN (0, Σ), where Σ = {0. 5i−j}10×10, and then categorized each random variable into three categories, 0, 1, and 2, to represent the count of minor alleles. The categorization was done in a way that the resulting MAF followed Beta(1, 3). The two environmental covariates, E1 and E2, followed E1~Bernoulli(0.5) and E2~Uniform(0, 2). The survival time for subject i (i = 1, …, n) was generated from the Cox’s proportional hazards model, 0.5exp{∑k=1100.1Gik+∑l=120.1Eil+∑k=110∑l=120.1GikEil}.

We set n = 1000. We did the finite-sample adjustment of WVI’s null distribution as described in the section introducing WVI.

The simulation results of WVI and LRT for G–E interaction are given in the Supporting Information Materials. The results show that the empirical size of WVI is close to the nominal level, while that of LRT is a bit inflated. They also show that WVI is more powerful than LRT when the SNP set contains correlated SNPs, which is expected.

3.5 | Empirical sizes of the (heterogeneity) weighted V tests under stringent p value thresholds

In many GWAS and next-generation sequencing studies, the associations of a huge number of genetic variants with the phenotype of interest need to be tested, which requires a more stringent p value threshold than 0.05 (e.g., p value thresholds based on Bonferroni correction or FDR adjustment) to handle the multiple comparison issue. We simulated 350 K Monte Carlo samples to calculate the empirical size of HWV that considers heterogeneity across individual genome profiles, under several stringent p value thresholds. The simulation settings are the same as those in the simulation of testing genetic association in the presence of genetic heterogeneity across individual genome profiles. The empirical sizes of HWV under the stringent p value thresholds are given in the Supporting Information Materials. They are close to the nominal level, suggesting that HWV is suitable for large-scale genetic association studies (e.g., GWAS). We also calculated the empirical sizes of other weighted V tests under stringent p value thresholds, and they were all well controlled (results not shown due to space limit).

4 | A REAL APPLICATION

We applied our methods to the GWAS and the dementia exam data from two large longitudinal studies of aging and dementia, the Religious Orders Study (ROS) and the Rush Memory and Aging Project (MAP; Bennett et al., 2018). The analysis goal was to discover genes that are associated with age to Alzheimer’s disease (AD) onset.

The GWAS data set includes 1679 subjects and 750,173 SNPs. After performing SNP-level quality control—removing SNPs with MAF &lt; 0.01, Hardy-Weinberg equilibrium test’s p value &lt; 10−6, or missing rate &gt; 0.02, 619,192 SNPs remained for the analysis. We then performed subject-level quality control to remove subjects with missing genotype rate&gt;0.02. After that, 1618 subjects remained for the analysis. We performed a principal component analysis of GWAS data to obtain the first 20 principal components for adjusting for population stratification. The missing genotypes in the remaining genetic data were then imputed by sampling from binomial distributions, Bin(2, MAF), where MAF was estimated from the data. After that, all available SNPs were grouped into gene-based SNP sets based on the human genome reference hg38 (i.e., located in or within 5K base pairs upstream/downstream of a gene). A total of 21,329 genes were formed along with the APOE gene, where APOE was coded as the count of APOE-ϵ4 allele. The dementia exam data set we used from the ROS and MAP studies was frozen in 2010 with a sample size of 2376. It contains annual clinical diagnosis of AD since baseline. We treated the age at diagnosis of AD as the survival outcome and excluded the subjects who had AD at baseline from the analysis, leading to left truncation. We then merged the processed dementia exam data with the processed GWAS data to generate the final analysis-ready data, which contain 1433 subjects who have both the genetic data and the survival data. Among them, 461 subjects developed AD during the follow-up. In the analysis, to improve power and/or reduce confounding, we adjusted for the first 20 principal components from the genome-wide data as well as sex, years of education, and cohort (ROS or MAP). We did not adjust for race because all but one of the 1433 subjects are white.

Without considering genetic heterogeneity, we used WV to perform a genome-wide gene-based analysis by testing the associations of the 21,330 genes with age to AD onset. Controlling the FDR under 10% by Benjamini-Hochberg procedure (Benjamini &amp; Hochberg, 1995), APOE appeared to be the most significant gene (p = 1.21e−10), followed by APOC1 (typed SNPs: rs4420638; p = 1.04e−07). We further conducted genome-wide gene-based analyses by using HWV to consider five different types of genetic heterogeneity (Table 10), including genetic heterogeneity due to different genetic backgrounds, education levels, and sexes. When considering heterogeneity across different genetic backgrounds, 200,000 SNPs were randomly selected from the whole genome to measure the genetic background. Although APOE and APOC1 remained to be the significant genes under all five heterogeneity scenarios after adjusting for multiple comparison (Table 10), their p values varied across different scenarios, being notably smaller when considering heterogeneity across education levels. This suggests that the effects of APOE and APOC1 depend on the education attainment.

APOC1’s typed SNP rs4420638 lies only about 14 Kbp away from APOE. To investigate whether the significant association of APOC1 is just due to linkage disequilibrium with APOE, we reran WV and HWV to test APOC1’s association with age to AD onset, adjusting for APOE and the previously considered covariates. Table 11 shows that considering heterogeneity across the three education attainment categories, APOC1 was found significantly associated with age to AD onset at 0.05 level, even adjusting for APOE.

5 | DISCUSSION

We developed a suite of multivariant association and interaction tests for survival phenotypes based on weighted V statistics. They have three main advantages over the state-of-the-art methods. First, the new tests are faster. Second, they can account for possible heterogeneity in genetic effects to enhance power. Third, they can handle linear confounding.

Although the covariate adjustment in the (heterogeneity) weighted V tests is based on a Cox model, the tests are robust against model mis-specification. This is because, under a null model that is not the Cox model, M^Z,i=Ni(∞)−∫0∞Yi(s)exp(ZiTγ^)dΛ^0(s)=Ni(∞)−∫0∞{Yi(s)exp(ZiTγ*)+op(1)}[E{dNi(s)}E{Yi(s)exp(ZiTγ*)}+op(1)]=Ni(∞)−∫0∞Yi(s)exp(ZiTγ*)E{dNi(s)}E{Yi(s)exp(ZiTγ*)}+op(1)≡MZ,i*+op(1),

where γ* is defined as in Lin and Wei (1989), E(MZ,i*)=0, and thus Theorem 2 with MZ,i replaced by MZ,i* still holds. Two simulations in the Supporting Information Materials support this theoretical reasoning empirically.

The covariate adjustment proposed for the (heterogeneity) weighted V tests cannot control Type I error rates around the nominal level in the presence of nonlinear confounding, that is, the genetic covariates follow a nonlinear model in relation to the adjustment covariates. However, our simulation results suggested that the empirical sizes of the proposed tests are smaller, not larger, than the nominal level in this situation (results not shown here due to space limit). A conservative test does not violate the fundamental principle of small-probability events in hypothesis testing.

The proposed G–G/G–E interaction test assumes linearity on the main effects of the two genes (or the gene and the environmental determinant). When the true main effects are nonlinear, the test may have incorrect size. A more robust test could estimate the null model using the kernel machine Cox regression (Cai et al., 2011), which, however, significantly increases the computational cost.

One may improve the power of the heterogeneity weighted V tests by changing wij to (ρ + κij)f(Gi, Gj), where ρ is a positive unknown parameter, and then using the test statistic S=supρ∈InVH(ρ)

or SZ=supρ∈InVZH(ρ),

where I is a range of ρ under consideration. The asymptotic null distribution of S or SZ is hard to derive. A workaround is to calculate S or SZ for many permutations of the n subjects’ martingale residuals to obtain a permutation-based p value. But this permutation test requires an assumption that there is no relationship between the genetic variables and the adjustment covariates when the latter are present.

We can also develop a set of weighted U tests in parallel to the weighted V tests developed herein. For example, a covariate-adjusted weighted U test for genetic association is based on the following weighted U statistic, UZ=1n(n−1)∑i≠jf˜^Z(gi,gj)M^Z,iM^Z,j,

where f˜^Z(gi,gj) is the ijth element of (I − H)TF(I − H). Following the derivation of the large-sample distribution of nVZ, it is easy to show that when n is large, the null distribution of nUZ can be approximated by nUZ~ξ^∑t=1nv^t(χ1t2−1).

The weighted U and V tests can be used interchangeably, as they have the same asymptotic efficiency.

Supplementary Material

Appendix

Supporting Information

ACKNOWLEDGMENTS

This study was supported by the National Institute on Drug Abuse (Award No. R01DA043501) and the National Library of Medicine (Award No. R01LM012848). The data for the application presented in this study were from the Religious Orders Study and the Rush Memory and Aging Project supported by the National Institute of Aging (U01AG61356, P30AG10161, R01AG15819, R01AG17917, R01AG019085, and R01AG30146). We are grateful to the Principal Investigator, David A. Bennett, MD, for the authorization to use the data. The GWAS data set (NG00029-ROSMAP GWAS) for the application were prepared, archived, and distributed by the National Institute on Aging Genetics of Alzheimer’s Disease Data Storage Site (NIAGADS) at the University of Pennsylvania (U24AG041689), funded by the National Institute on Aging.

FIGURE 1 Uniform(0, 1) Q-Q plots of p values for WV, coxKM, gt, and coxSKATs under n = 150, p = 5 and the null hypothesis of no genetic association

FIGURE 2 Uniform(0, 1) Q-Q plots of p-values for WV and coxKM under linear confounding and the null hypothesis of no genetic association

FIGURE 3 Power comparison between HWV and coxKM in the presence of genetic heterogeneity across 20 latent subpopulations when p = 15 and n = 1000

FIGURE 4 Power comparison between HWV and coxKM in the presence of genetic heterogeneity across individual genome profiles when p = 10 and n = 1000

TABLE 1 Some kernel functions and the scenarios where they are suitable for measuring genetic similarity

Kernel name	f (Gi, Gj)	Scenario	
Cross-product kernel	GiTGj	G’s effect is expected to be linear.	
IBS kernel	∑k=1p(2−|Gik−Gjk|)/(2p)	G is a set of SNPs.	
Polynomial kernel	(ρ+GiTGj)d	G is a set of gene expression values.	
Gaussian kernel	exp( − ρ‖Gi − Gj‖2)	G is a set of gene expression values.	
Laplacian kernel	exp(−∑k=1pwk|Gik−Gjk|/Υ)	Universal	

TABLE 2 Some kernel functions and the scenarios where they are suitable for measuring subpopulation similarity

Kernel name	κ ij	Scenario	
A unified kernel	exp(−D−1∑d=1D(XidS−Xjds)2)	Universal	
IBS kernel	∑d=1D(2−|Xid−Xjd|)/(2D)	X is a set of SNPs.	
Subpopulation identity kernel	I (Xi = Xj)	X codes several subpopulations.	

TABLE 3 Empirical size and power comparison between WV and coxKM in testing association of a SNP set with right-censored survival time in the absence of genetic heterogeneity, adjusting for covariates

	Empirical size (power)	
	p = 5, n = 500	p = 5, n = 1000	p = 5, n = 1500	
WV	0.054 (0.208)	0.049 (0.445)	0.055 (0.601)	
coxKM	0.052 (0.244)	0.054 (0.430)	0.045 (0.627)	
	p = 10, n = 500	p = 10, n = 1000	p = 10, n = 1500	
WV	0.038 (0.335)	0.052 (0.631)	0.055 (0.819)	
coxKM	0.041 (0.337)	0.051 (0.630)	0.040 (0.846)	
	p = 15, n = 500	p = 15, n = 1000	p = 15, n = 1500	
WV	0.046 (0.507)	0.049 (0.853)	0.046 (0.974)	
coxKM	0.038 (0.473)	0.034 (0.886)	0.045 (0.976)	

TABLE 4 Empirical size and power comparison between HWV and coxKM in the presence of genetic heterogeneity across four observable sub-populations, adjusting for covariates

	Empirical size (power)	
	p = 5, n = 500	p = 5, n = 750	
HWV	0.054 (0.801)	0.049 (0.963)	
coxKM	0.047 (0.618)	0.047 (0.811)	
	p = 10, n = 500	p = 10, n = 750	
HWV	0.052 (0.942)	0.046 (0.997)	
coxKM	0.045 (0.799)	0.055 (0.975)	
	p = 15, n = 500	p = 15, n = 750	
HWV	0.043 (0.931)	0.050 (0.998)	
coxKM	0.044 (0.857)	0.049 (0.984)	

TABLE 5 Empirical size comparison between HWV and coxKM in testing genetic association in the presence of genetic heterogeneity across two latent subpopulations, adjusting for covariates

	Empirical Size	
	p = 5, n = 500	p = 5, n = 1000	p = 5, n = 1500	
HWV	0.050	0.051	0.056	
coxKM	0.048	0.061	0.051	
	p = 10, n = 500	p = 10, n = 1000	p = 10, n = 1500	
HWV	0.050	0.054	0.046	
coxKM	0.034	0.049	0.046	
	p = 15, n = 500	p = 15, n = 1000	p = 15, n = 1500	
HWV	0.051	0.047	0.046	
coxKM	0.038	0.039	0.042	

TABLE 6 Power comparison between HWV and coxKM in the presence of genetic heterogeneity across two latent sub-populations, adjusting for baseline covariates

		Heterogeneity scenario*										
		T1	T2	T3	T4	
	β 1k	+0.05	+0.09	+0.13	+0.01	+0.02	+0.04	0	0	0	−0.01	+0.01	−0.01	
	β 2k	+0.05	+0.09	+0.13	−0.01	−0.02	−0.04	+0.01	+0.02	+0.04	+0.02	+0.05	+0.03	
p = 5, n = 500	HWV	0.08	0.11	0.25	0.06	0.10	0.27	0.05	0.06	0.11	0.09	0.09	0.10	
	coxKM	0.12	0.28	0.60	0.04	0.04	0.06	0.05	0.06	0.07	0.05	0.08	0.04	
p = 5, n = 1000	HWV	0.09	0.24	0.59	0.08	0.18	0.48	0.07	0.08	0.17	0.11	0.18	0.15	
	coxKM	0.20	0.57	0.91	0.04	0.04	0.04	0.04	0.05	0.07	0.05	0.09	0.04	
p = 5, n = 1500	HWV	0.11	0.42	0.86	0.09	0.20	0.64	0.07	0.09	0.21	0.14	0.22	0.21	
	coxKM	0.27	0.84	0.99	0.05	0.05	0.04	0.05	0.06	0.08	0.05	0.11	0.05	
p = 10, n = 500	HWV	0.05	0.10	0.25	0.10	0.27	0.77	0.06	0.10	0.30	0.20	0.29	0.27	
	coxKM	0.11	0.46	0.84	0.04	0.04	0.04	0.05	0.04	0.06	0.05	0.07	0.05	
p = 10, n = 1000	HWV	0.08	0.25	0.69	0.17	0.48	0.98	0.07	0.16	0.51	0.31	0.55	0.51	
	coxKM	0.25	0.83	1.00	0.05	0.05	0.04	0.05	0.05	0.07	0.05	0.10	0.04	
p = 10, n = 1500	HWV	0.10	0.44	0.94	0.22	0.69	1.00	0.10	0.21	0.67	0.47	0.71	0.70	
	coxKM	0.46	0.96	1.00	0.06	0.05	0.05	0.06	0.07	0.08	0.06	0.10	0.04	
p = 15, n = 500	HWV	0.04	0.09	0.22	0.16	0.54	0.98	0.08	0.19	0.58	0.34	0.58	0.56	
	coxKM	0.16	0.56	0.93	0.05	0.05	0.04	0.04	0.04	0.05	0.04	0.06	0.05	
p = 15, n = 1000	HWV	0.07	0.22	0.72	0.32	0.86	1.00	0.13	0.34	0.87	0.58	0.87	0.86	
	coxKM	0.33	0.93	1.00	0.05	0.03	0.05	0.04	0.05	0.08	0.05	0.12	0.05	
p = 15, n = 1500	HWV	0.11	0.43	0.98	0.42	0.94	1.00	0.17	0.46	0.95	0.78	0.96	0.95	
	coxKM	0.56	0.99	1.00	0.06	0.05	0.06	0.05	0.05	0.09	0.04	0.16	0.06	
* Note: Various heterogeneity scenarios were investigated in this simulation, determined by values of β1k and β2k, including same effect size with same direction (T1), same effect size with opposite directions (T2), no effect in one subpopulation while positive effect in the other (T3), and different effect sizes with same or opposite directions (T4).

TABLE 7 Empirical size comparison between HWV and coxKM in the presence of genetic heterogeneity across 20 latent subpopulations, adjusting for covariates

	Empirical size	
	p = 5, n = 500	p = 5, n = 1000	p = 5, n = 1500	
HWV	0.052	0.055	0.051	
coxKM	0.042	0.053	0.045	
	p = 10, n = 500	p = 10, n = 1000	p = 10, n = 1500	
HWV	0.048	0.056	0.047	
coxKM	0.046	0.043	0.050	
	p = 15, n = 500	p = 15, n = 1000	p = 15, n = 1500	
HWV	0.047	0.040	0.044	
coxKM	0.038	0.044	0.051	

TABLE 8 Empirical size comparison of HWV and coxKM considering genetic heterogeneity due to genomic profile, adjusting for covariates

	Empirical size	
	p = 5, n = 500	p = 5, n = 1000	p = 5, n = 1500	
HWV	0.041	0.057	0.049	
coxKM	0.042	0.046	0.057	
	p = 10, n = 500	p = 10, n = 1000	p = 10, n = 1500	
HWV	0.044	0.054	0.057	
coxKM	0.045	0.044	0.057	
	p = 15, n = 500	p = 15, n = 1000	p = 15, n = 1500	
HWV	0.042	0.047	0.050	
coxKM	0.039	0.040	0.045	

TABLE 9 Empirical sizes and powers of WVI and LRT in testing G-G interaction

	Empirical size (power)	
	p = 2, q = 2, n = 500	p = 2, q = 2, n = 1000	p = 2, q = 2, n = 1500	
WVI	0.050 (0.255)	0.056 (0.435)	0.051 (0.629)	
LRT	0.055 (0.205)	0.054 (0.328)	0.052 (0.494)	
	p = 3, q = 3, n = 500	p = 3, q = 3, n = 1000	p = 3, q = 3, n = 1500	
WVI	0.057 (0.488)	0.059 (0.837)	0.057 (0.952)	
LRT	0.072 (0.341)	0.064 (0.664)	0.052 (0.864)	

TABLE 10 Top ten significant genes discovered by WV/HWV from a genome-wide association analysis of ROSMAP data

Heterogeneity*	Gene names and p values	
S1	APOE	APOC1	CAMS API	XPR1	GRIP1	TBCC	KU. MEL.3	LETMD1	CSRNP2	PPM1A	
	1.21e−10	1.04e−07	2.34e−05	1.48e−04	3.04e−04	4.23e−04	4.28e−04	6.33e−04	6.58e−04	7.95e−04	
S2	APOE	APOC1	CAMS API	XPR1	KU. MEL.3	TBCC	USP19	MIR6890. QARS1	AAGAB	AHRR. PDCD6	
	4.03e−10	2.31e−07	7.56e−06	6.92e−05	1.97e−04	2.11e−04	2.41e−04	4.15e−04	4.78e−04	5.35e−04	
S3	APOE	APOC1	CAMS API	XPR1	PPM1A	KU. MEL.3	ING1	AAGAB	ZFP41	GOLGA6L2	
	6.72e−11	4.54e−08	7.94e−05	1.33e−04	3.93e−04	4.83e−04	6.05e−04	6.38e−04	6.79e−04	6.94e−04	
S4	APOE	APOC1	CAMSAP1	XPR1	LINC00911	GOLGA6L2	GDF9	ING1	AP1M1	CSRNP2	
	3.68e−11	1.68e−08	3.07e−05	4.30e−05	7.88e−05	7.91e−05	7.95e−05	1.09e−04	l.lOe−04	1.22e−04	
S5	APOE	APOC1	CAMSAP1	LETMD1	CSRNP2	GRIP1	TBCC	XPR1	HIGD1C	CELF2. AS2	
	4.30e−11	3.64e−08	1.15e−05	3.57e−05	6.17e−05	6.98e−05	8.20e−05	9.21e−05	9.25e−05	9.40e−05	
S6	APOE	APOC1	CAMS API	XPR1	PPM1A	GRIP1	ING1	KU. MEL.3	AAGAB	TBCC	
	2.87e−10	2.29e−07	2.05e−05	9.72e−05	1.19e−04	3.00e−04	3.47e−04	5.71e−04	5.74e−04	5.91e−04	
Threshold**	4.45e−07	8.89e−07	1.33e−06	1.78e−06	2.22e−06	2.67e−06	3.11e−06	3.56e−06	4.00e−06	4.45e−06	
* Note: Various types of heterogeneity have been considered including no genetic heterogeneity (S1), heterogeneity across individual genome profiles (S2), heterogeneity due to years of education (S3), heterogeneity across three education attainment categories (0: yrs of education ≤12; 1: yrs of education ∈((12, 16(]; 2: yrs of education &gt; 16) with education similarity between subjects i and j measured by κij = I(Xi = Xj) (S4), heterogeneity across the three education attainment categories with education similarity measured by IBS kernel (S5), and heterogeneity due to sex (S6).

** FDR-based p value thresholds were calculated according to Benjamini and Hochberg (1995) under arbitrary dependence assumption, that is, Threshold i=αim∑k=1m(1/k)(i=1,…,m), where m is the number of tests and α is the target FDR.

TABLE 11 Test results for association of APOC1 with age to AD, adjusting for APOE, the top 20 principal components, sex, years of education, and cohort

Heterogeneity scenario*	p value	
S1	5.67e−01	
S2	9.70e−02	
S3	1.31e−01	
S4	5.00e−03	
S5	4.40e−02	
S6	4.66e−01	
* Note: Various types of heterogeneity have been considered including no genetic heterogeneity (S1), heterogeneity across individual genome profiles (S2), heterogeneity due to years of education (S3), heterogeneity across three education attainment categories (0: yrs of education ≤ 12; 1: yrs of education ∈((12, 16(]; 2: yrs of education &gt; 16) with education similarity between subjects i and j measured by κij = I(Xi = Xj) (S4), heterogeneity across the three education attainment categories with education similarity measured by IBS kernel (S5), and heterogeneity due to sex (S6).

DATA AVAILABILITY STATEMENT

The GWAS data that support the findings of this study are available from the National Institute on Aging Genetics of Alzheimer’s Disease Data Storage Site (NIAGADS). Restrictions apply to the availability of these data, which were used under license for this study. Data are available from https://www.niagads.org/datasets/ng00029 with the permission of NIAGADS. The dementia exam data that support the findings of this study are available from Rush Alzheimer’s Disease Center. Restrictions apply to the availability of these data, which were used under license for this study. Data can be requested at http://www.radc.rush.edu.

SUPPORTING INFORMATION

Additional supporting information may be found online in the Supporting Information section.


REFERENCES

Azzato EM , Pharoah PD , Harrington P , Easton DF , Greenberg D , Caporaso NE , … Kraft P (2010). A genome-wide association study of prognosis in breast cancer. Cancer Epidemiology and Prevention Biomarkers, 19 (4 ), 1140–1143. 10.1158/1055-9965.EPI-10-0085
Beer D , Kardia S , Huang C-C , Giordano T , Levin A , Misek D , … Hanash S (2002). Gene-expression profiles predict survival of patients with lung adenocarcinoma. Nature Medicine, 8 , 816–824. 10.1038/nm733
Benjamini Y , &amp; Hochberg Y (1995). Controlling the false discovery rate: A practical and powerful approach to multiple testing. Journal of the Royal Statistical Society. Series B (Methodological), 57 (1 ), 289–300.
Bennett DA , Buchman AS , Boyle PA , Barnes LL , Wilson RS , &amp; Schneider JA (2018). Religious orders study and rush memory and aging project. Journal of Alzheimer’s Disease, 64 (S1 ), S161–S189. 10.1158/1055-9965.EPI-10-0085
Cai T , Tonini G , &amp; Lin X (2011). Kernel machine approach to testing the significance of multiple genetic markers for risk prediction. Biometrics, 67 (3 ), 975–986. 10.1111/j.1541-0420.2010.01544.x 21281275
Chen H , Lumley T , Brody J , Heard-Costa NL , Fox CS , Cupples LA , &amp; Dupuis J (2014). Sequence kernel association test for survival traits. Genetic Epidemiology, 38 (3 ), 191–197. 10.1002/gepi.21791 24464521
Chen H-Y , Yu S-L , Chen C-H , Chang G-C , Chen C-Y , Yuan A , … Yang P-C (2007). A five-gene signature and clinical outcome in non-small-cell lung cancer. New England Journal of Medicine, 356 (1 ), 11–20. 10.1056/NEJMoa060096
Cristianini N , &amp; Shawe-Taylor J (2000). An introduction to support vector machines and other kernel-based learning methods. Cambridge: Cambridge University Press. 10.1017/CBO9780511801389
Davies RB (1973). Numerical inversion of a characteristic function. Biometrika, 60 (2 ), 415–417. 10.1093/biomet/60.2.415
Davies RB (1980). Algorithm as 155: The distribution of a linear combination of χ2 random variables. Journal of the Royal Statistical Society. Series C (Applied Statistics), 29 (3 ), 323–333.
Galvan A , Ioannidis JP , &amp; Dragani TA (2010). Beyond genome-wide association studies: Genetic heterogeneity and individual predisposition to cancer. Trends in Genetics, 26 (3 ), 132–141. 10.1016/j.tig.2009.12.008 20106545
Goeman JJ , Oosting J , Cleton-Jansen A-M , Anninga JK , &amp; van Houwelingen HC (2005). Testing association of a pathway with survival using gene expression data. Bioinformatics, 21 (9 ), 1950–1957. 10.1093/bioinformatics/bti267 15657105
Huang K-L , Marcora E , Pimenova A , Narzo A , Kapoor M , Jin SC , … Goate A (2017). A common haplotype lowers pu.1 expression in myeloid cells and delays onset of alzheimer’s disease. Nature Neuroscience, 20 . 10.1038/nn.4587
Huang Y-T , Heist RS , Chirieac LR , Lin X , Skaug V , Zienolddiny S , … Christiani DC (2009). Genome-wide analysis of survival in early-stage non-small-cell lung cancer. Journal of Clinical Oncology, 27 (16 ), 2660–2667. 10.1200/JCO.2008.18.7906 19414679
Hughey JJ , Rhoades SD , Fu DY , Bastarache L , Denny JC , &amp; Chen Q (2019). Cox regression increases power to detect genotype-phenotype associations in genomic studies using the electronic health record. BMC Genomics, 20 (1 ), 805. 10.1186/s12864-019-6192-1 31684865
Lin DY , &amp; Wei LJ (1989). The robust inference for the cox proportional hazards model. Journal of the American Statistical Association, 84 (408 ), 1074–1078.
McClellan J , &amp; King M-C (2010). Genetic heterogeneity in human disease. Cell, 141 (2 ), 210–217. 10.1016/j.cell.2010.03.032 20403315
van der Net JB , Janssens ACJW , Eijkemans MJC , Kastelein JJP , Sijbrands EJG , &amp; Steyerberg EW (2008). Cox proportional hazards models have more statistical power than logistic regression models in cross-sectional genetic association studies. European Journal of Human Genetics, 16 (9 ), 1111–1116. 10.1038/ejhg.2008.59 18382476
Sinnott JA , &amp; Cai T (2013). Omnibus risk assessment via accelerated failure time kernel machine modeling. Biometrics, 69 (4 ), 861–873. 10.1111/biom.12098 24328713
Staley JR , Jones E , Kaptoge S , Butterworth AS , Sweeting MJ , Wood AM , &amp; Howson JMM (2017). A comparison of cox and logistic regression for use in genome-wide association studies of cohort and case-cohort design. European Journal of Human Genetics, 25 (7 ), 854–862. 10.1038/ejhg.2017.78 28594416
Subramanian A , Tamayo P , Mootha VK , Mukherjee S , Ebert BL , Gillette MA , … Mesirov JP (2005). Gene set enrichment analysis: A knowledge-based approach for interpreting genome-wide expression profiles. Proceedings of the National Academy of Sciences of United States of America, 102 (43 ), 15545–15550. 10.1073/pnas.0506580102
Wei C , Elston RC , &amp; Lu Q (2016). A weighted u statistic for association analyses considering genetic heterogeneity. Statistics in Medicine, 35 (16 ), 2802–2814. 10.1002/sim.6877 26833871
Wei C , &amp; Lu Q (2017). A generalized association test based on U statistics. Bioinformatics, 33 (13 ), 1963–1971. 10.1093/bioinformatics/btx103 28334117
Yu S-L , Chen H-Y , Chang G-C , Chen C-Y , Chen H-W , Singh S , … Yang P-C (2008). Microrna signature predicts survival and relapse in lung cancer. Cancer Cell, 13 (1 ), 48–57. 10.1016/j.ccr.2007.12.008 18167339
