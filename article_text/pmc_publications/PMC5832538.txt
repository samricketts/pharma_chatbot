LICENSE: This file is available for text mining. It may also be used consistent with the principles of fair use under the copyright law.


0370625
1170
Biometrics
Biometrics
Biometrics
0006-341X
1541-0420

28863246
5832538
10.1111/biom.12748
NIHMS899510
Article
FLCRM: Functional Linear Cox Regression Model
Kong Dehan
Ibrahim Joseph G.
Lee Eunjee
Zhu Hongtu
Department of Statistical Sciences, University of Toronto
Department of Biostatistics, University of North Carolina at Chapel Hill
Department of Biostatistics, University of Michigan
Department of Biostatistics, The University of Texas MD Anderson Cancer Center
14 8 2017
01 9 2017
3 2018
15 3 2018
74 1 109117
This file is available for text mining. It may also be used consistent with the principles of fair use under the copyright law.
Summary

We consider a functional linear Cox regression model for characterizing the association between time-to-event data and a set of functional and scalar predictors. The functional linear Cox regression model incorporates a functional principal component analysis for modeling the functional predictors and a high-dimensional Cox regression model to characterize the joint effects of both functional and scalar predictors on the time-to-event data. We develop an algorithm to calculate the maximum approximate partial likelihood estimates of unknown finite and infinite dimensional parameters. We also systematically investigate the rate of convergence of the maximum approximate partial likelihood estimates and a score test statistic for testing the nullity of the slope function associated with the functional predictors. We demonstrate our estimation and testing procedures by using simulations and the analysis of the Alzheimer‚Äôs Disease Neuroimaging Initiative (ADNI) data. Our real data analyses show that high-dimensional hippocampus surface data may be an important marker for predicting time to conversion to Alzheimer‚Äôs disease. Data used in the preparation of this article were obtained from the ADNI database (adni.loni.usc.edu).

Cox Regression
Functional Predictor
Functional Principal Component Analysis
Score Test

1. Introduction

Roughly more than 5 million Americans are suffering from memory loss and dementia caused by Alzheimer‚Äôs Disease (AD) and it costs the nation approximately 203 billion dollars in medical expenses solely in 2013. An earlier and more accurate diagnosis of AD is considered to be an important goal for researchers because therapeutic intervention is more likely to be more beneficial during the early development of the disease. This led to the development of Mild Cognitive Impairment (MCI), which is a transitional stage between normal aging and the development of AD (Petersen, 2004). MCI is characterized by insidious onset and gradual progression, and commonly arises as a result of underlying neurodegenerative pathology. There is a substantial interest in delineating a set of biomarkers that provide evidence of such neurodegenerative pathology in living individuals, with the goal of specifying the likelihood that the pathophysiological process is due to Alzheimer‚Äôs disease (MCI-AD) and will lead to dementia within a few years. Accordingly, increasing attention has been devoted to investigate the utility of various imaging, genetic, clinical, behavioral, and fluid data to predict the conversion from MCI to AD (Risacher et al., 2009).

The development of functional linear Cox regression model (FLCRM) is motivated by addressing a critical question: ‚Äúhow do we accurately predict the time to conversion in individuals who harbor AD pathology, as well as assess the predictive role of surface morphology?‚Äù There is a long-term interest in answering this question. Li et al. (2013) employed data from 139 MCI subjects in ADNI to evaluate the predictive power of brain volume, ventricular volume, hippocampus volume, APOE status, cerebrospinal fluid (CSF) biomarkers, and behavioral scores. Da et al. (2014) used 381 MCI subjects from ADNI to evaluate several biomarkers for predicting MCI to AD conversion including spatial patterns of brain atrophy, ADAS-Cog score, APOE genotype, and cerebrospinal fluid (CSF) biomarkers. To the best of our knowledge, no prior study has examined the role of neuroimaging data in predicting time to conversion from MCI to AD, while adjusting for low-dimensional behavioral and clinical measures.

The aim of this paper is to consider a FLCRM to examine the relationship of the survival distribution to a set of functional and scalar predictors in large-scale biomedical studies. Let the random variables T, C, and TÃÉ = min{T, C} be, respectively, the failure time, censoring time, and observed time, and f(t) and S(t), respectively, denote the probability density function and the survival function of T. The Cox regression model (Cox, 1972) has been widely used to model survival time T as a function of p predictors, denoted by Z = (z1, ‚ãØ, zp)T. The hazard function for the Cox regression model has the form (1.1) h(t)=f(t)/S(t)=h0(t)¬†exp(ZTŒ≥),

where h0(t) is a completely unspecified baseline hazard function and Œ≥ = (Œ≥1, ‚ãØ, Œ≥p)T. Although the Cox regression model and its various extensions have been widely investigated for a small number of predictors (Kalbfleisch and Prentice, 2002; Ibrahim et al., 2001; Cox, 1975), there is a great interest in developing accurate risk prediction models with high-dimensional genomic and clinical data to predict censored survival outcomes (Cai et al., 2011; Li and Ma, 2013).

Existing survival models for high-dimensional genomic data, however, suffer from a major limitation of incorporating infinite-dimensional imaging data to predict survival outcomes. Compared with genetic and clinical data, a key unique feature of imaging data is that they are high dimensional and intrinsically continuous functions measured at a large number of grid points. The effect of imaging data on survival outcomes is often non-sparse, which makes inference notoriously difficult based on existing regularization methods (Huang et al., 2013; Xu, 2012). Therefore, it is imperative to use some dimension reduction methods to extract and select ‚Äúlow-dimensional‚Äù important features, while eliminating redundant features (Johnstone and Lu, 2009).

Functional linear regression has become a standard method in functional data analysis for incorporating functional predictors. Most functional linear regression models focus on modeling the relationship between a functional or continuous response, Y, and a one-dimensional functional predictor X(s), in which s varies in a compact set ùíÆ. Functional linear regression usually assumes (1.2) Y=‚à´ùíÆX(s)Œ≤(s)ds+Œµ,

where Œµ is a noise term independent of X(s) and Œ≤(s) is an unknown function of interest. Two popular estimation methods for Œ≤(s) include the functional principal component analysis (FPCA) and methods of penalization. A few examples include Hall and Horowitz (2007); Reiss and Ogden (2007, 2010); Morris (2015) and the references therein. However, very little has been done on modeling survival outcomes and scalar and functional predictors.

We consider a FLCRM that incorporates (1.1) and (1.2) for modeling the relationship between survival outcomes and a set of finite and infinite dimensional predictors. Specifically, the hazard function for the FLCRM has the form (1.3) log{h(t)}=log{h0(t)}+‚à´ùíÆX(s)Œ≤(s)ds+ZTŒ≥.

At the time of submission, we are aware of three recent papers on the development of various estimation methods for model (1.3). Gellar et al. (2015) and Qu et al. (2016) proposed to maximize penalized partial likelihood functions for model (1.3), whereas Lee et al. (2015) developed a Bayesian framework for the same model. In particular, Gellar et al. (2015) combined penalized signal regression with methods developed for mixed effects proportional hazards models under penalized B-spline framework, and Qu et al. (2016) estimated the model under the reproducing kernel Hilbert space framework.

Compared to the existing literature, we make several new contributions. To deal with the nonparametric function Œ≤(s), we employ a FPCA method and then approximate Œ≤(s) by the eigenfunctions of the covariance operator of the functional predictor X(s). Such a FPCA method has been widely used in various functional linear regression models (Yao et al., 2005; Hall and Hosseini-Nasab, 2006). In particular, we use the first several functional principal components (FPCs) to represent the infinite dimensional process X(s), and the number of FPCs is treated as a tuning parameter diverging with the sample size, which distinguishes our work from the ones that fix the number of FPCs (Li, Wang, and Carroll, 2010). Subsequently, our FLCRM reduces to a Cox regression model with a growing number of predictors. We also examine both estimation and testing for FLCRM, and none of the recent papers on the development of various estimation methods for model (1.3) (Gellar et al., 2015; Qu et al., 2016; Lee et al., 2015) consider the testing problem. We further establish their associated asymptotic properties, and study the asymptotic theories when the number of scalar parameters diverges at a polynomial rate of sample size. In addition, we shed lights on how to choose the number of FPCs for both estimation and testing procedures. It turns out that we need to use different criteria for estimation and testing procedures.

2. Functional Linear Cox Regression Models

2.1 Model setup

Let ùíÆ be a compact set of ‚Ñù and Xi(¬∑) be the true trajectory of the ith individual. We observe the curve on grid points {sim ‚àà ùíÆ, 1 ‚â§ m ‚â§ Mi} with some measurement errors such that Wim = Xi(sim) + Œµim, where the Œµim‚Äôs are independent and identically distributed random variables with zero mean and variance œÉe2. We consider a random sample of n subjects and observe ({W1m, 1 ‚â§ m ‚â§ M1}, Z1, Œ¥1, TÃÉ1), ‚Ä¶, ({Wnm, 1 ‚â§ m ‚â§ Mn}, Zn, Œ¥n, TÃÉn), where Œ¥i = 1(Ti ‚â§ Ci), which equals 1 if the observed event is a failure and 0 otherwise. In neuroimaging studies, Wim and Zi, respectively, denote the imaging measure at sim and scalar predictors such as age, gender, or candidate genetic marker.

For model (1.3), we obtain the hazard function of the i-th subject under Cox regression as (2.1) hi(t)=h0(t)¬†exp{‚àëk=1pzikŒ≥k+‚à´ùíÆXi(s)Œ≤(s)ds},

where Zi = (zi1, ‚ãØ, zip)T, and t ‚àà [0, œÑ] for some finite œÑ &gt; 0. The FLCRM is determined by the unknown coefficient function Œ≤(¬∑), the unknown parameter vector Œ≥ = (Œ≥1, ‚ãØ, Œ≥p)T, and the baseline hazard function h0(¬∑).

The second component of FLCRM is the FPCA model of both X(s) and Œ≤(s). Let Œº(s) and K(s, s‚Ä≤) be, respectively, the mean and covariance functions of the stochastic process {X(s) : s ‚àà S} determined by the functional predictors. Let the spectral decomposition of the covariance function K(s,s‚Ä≤)=‚àëj=1‚àûŒªjœïj(s)œïj(s‚Ä≤), where {Œªj, j ‚â• 1} are the eigenvalues in decreasing order with ‚àëj=1‚àûŒªj&lt;‚àû and the œïj‚Äôs are the corresponding eigenfunctions. Thus, the i-th trajectory Xi(¬∑) can be represented by using the Karhunen-Lo√®ve expansion as Xi(s)=Œº(s)+‚àëj=1‚àûŒæijœïj(s).

The i-th observed trajectory is defined as Wi(s) = Xi(s) + Œµi(s), where Œµi(s) is measurement error with mean zero and variance œÉ2(s) at s and is independent of Œµi(s‚Ä≤) for s ‚â† s‚Ä≤. Moreover, Œæij = ‚à´{Xi(s)‚àíŒº(s)}œïj(s)ds is the FPC score and has mean zero with cov(Œæij, Œæik) = Œªj1(j = k). We also consider the FPCA model of Œ≤(s). Based on the basis {œïj(s) : 1 ‚â§ j &lt; ‚àû}, it is assumed that the projection of Œ≤(¬∑) onto the span of K is identifiable, we can expand Œ≤(s) as Œ≤(s)=‚àëj=1‚àûœïj(s)Œ≤j. Thus, we can calculate ‚à´ùíÆŒº(s)Œ≤(s)ds+‚àëj=1‚àûŒæijŒ≤j, where Œ≤j = ‚à´ùíÆŒ≤(s)œïj(s)ds.

Based on the FPCA model, the hazard function of FLCRM can be rewritten as (2.2) hi(t)=h0‚àó(t)¬†exp(‚àëk=1pzikŒ≥k+‚àëj=1‚àûŒæijŒ≤j),

where h0‚àó(t)=h0(t)¬†exp{‚à´ùíÆŒº(s)Œ≤(s)ds}. Since the number of predictors in (2.2) is infinite, we propose to approximate hi(t) by truncating the number of FPC scores, denoted as rn, which increases asymptotically as n ‚Üí ‚àû. Thus, FLCRM reduces to a Cox regression model with high-dimensional predictors as (2.3) hi(t)‚âàh0‚àó(t)¬†exp(‚àëk=1pzikŒ≥k+‚àëj=1rnŒæijŒ≤j).

The approximation (2.3) depends on whether the slope function Œ≤(¬∑) is efficiently represented in terms of the leading eigenfunctions or equivalently ‚àërn+1‚àû|ŒæijŒ≤j|‚âà0. We will discuss how to choose rn in Section 2.4.

2.2 Estimation procedure

We develop a three-step estimation procedure as follows. Step (I):We use the local linear regression technique to smooth all individual functions {Xi(sm) : m = 1, ‚ãØ, M}. It leads to a smoothed estimate of Xi(s), denoted by XÃÇi(s).

Step (II): Estimate K(s, s‚Ä≤) and its eigenvalues and eigenfunctions and then calculate the estimated FPC scores of all subjects.

Step (III): Calculate the maximum approximate partial likelihood estimate of Œ∑=(Œ≤nT,Œ≥T)T, where Œ≤n = (Œ≤1, ‚ãØ, Œ≤rn)T. Finally, we use the Nelson‚ÄìAalen method to estimate the baseline hazard function.

Step (I) is to estimate XÃÇi(s) for all s ‚àà ùíÆ and i = 1, ‚Ä¶, n by using the well-known local linear regression technique (Fan and Gijbels, 1996). Let ‚àÇsXi(s) be ‚àÇXi(s)/‚àÇs and Kloc(¬∑) be a kernel function. For each i, we calculate XÃÇi(s) = (1, 0) ƒài(s) by minimizing the weighted least squares function as C^i(s)=argminCi(s)‚àëm=1Mi{Wim‚àíCi(s)TZh(sm‚àís)}2Kh(sm‚àís),

where Ci(s) = (Xi(s), h{‚àÇsXi(s)}T)T, Zh(sm ‚àí s) = (1, (sm ‚àí s)/h)T are two dimensional vectors with each component a nonparametric function, and Kh(sm ‚àí s) = Kloc{(sm ‚àí s)/h} is the rescaled kernel function with a bandwidth h. We pool the data from all n subjects and select the optimal bandwidth hÃÉ by minimizing the generalized cross-validation score (Zhang and Chen, 2007).

In Step (II), we calculate Œº^(s)=n‚àí1‚àëi=1nX^i(s) and the sample covariance function of {XÃÇ(s) : s ‚àà ùíÆ} given by K^(s,s‚Ä≤)=n‚àí1‚àëi=1n{X^i(s)‚àíŒº^(s)}{X^i(s‚Ä≤)‚àíŒº^(s‚Ä≤)}=‚àëj=1‚àûŒª^jœï^j(s)œï^j(s‚Ä≤),

where {ŒªÃÇj, j ‚â• 1} are the estimated eigenvalues in decreasing order with ‚àëj=1‚àûŒª^j&lt;‚àû and {œïÃÇj(¬∑), j ‚â• 1} are the corresponding estimated eigenfunctions. Finally, the estimated eigenscores can be calculated by ŒæÃÇij = ‚à´ùíÆ{Xi(s) ‚àí ŒºÃÇ(s)}œïÃÇj(s)ds for all j ‚â§ rn, where choice of the truncation number rn would be discussed in Section 2.4.

In Step (III), we plug the first rn estimated FPCs scores into (2.3) to obtain a Cox regression model with rn + p predictors. Let Ni(t) = 1(TÃÉi ‚â§ t, Œ¥i = 1), N¬Ø(t)=‚àëi=1nNi(t), and R(t) = {j : TÃÉj ‚â• t} be the set of subjects who are at risk and uncensored prior to time t. For i = 1, ‚Ä¶, n, we define Yi(t) = 1(TÃÉi ‚â• t) = 1(i ‚àà R(t)). In this paper, we assume that the observed failure times are distinct. If there are ties, one may use Efron‚Äôs approximation (Efron, 1977) for example. Thus, the log-approximate partial likelihood function of Œ∑, denoted as Q(Œ∑), is given by (2.4) Q(Œ∑)=‚àëi=1n‚à´0œÑw^iTŒ∑dNi(t)‚àí‚à´0œÑ¬†log{‚àëi=1nYi(t)¬†exp(w^iTŒ∑)}dN¬Ø(t),

where ≈µi = (ŒæÃÇi1, ‚Ä¶, ŒæÃÇirn, zi1, ‚Ä¶, zip)T. We use the Newton-Raphson algorithm as implemented in the R function ‚Äú coxph()‚Äù under the survival package to calculate the maximum approximate partial likelihood estimate, denoted as Œ∑^=(Œ≤^nT,Œ≥^T)T, which maximizes Q(Œ∑), and their standard errors. Subsequently, we use the Nelson‚ÄìAalen method to estimate the cumulative baseline hazard function, H0(t)=‚à´0Th0(u)du, by H^0(t)=‚àëi:T‚àºi‚â§t[Œ¥i/{‚àëj‚ààR(T‚àºi)¬†exp(w^iTŒ∑^)}]. After we get { Œ≤ÃÇj, 1 ‚â§ j ‚â§ rn}, we can calculate the estimated coefficient function by Œ≤^(s)=‚àëj=1rnŒ≤^jœï^j(s). A limitation of our method is that it is difficult to obtain the confidence bands of Œ≤ÃÇ(¬∑), which is an interesting topic for future research.

2.3 Testing procedure

In real applications, evidence for the association between a functional predictor and the survival outcome is as valuable as, if not more than, estimation of the actual effect size. For example, in the ADNI dataset, it would be of great interest to test whether the hippocampus shape information is an important biomarker for predicting time to conversion to Alzheimer disease in patients with MCI. We propose a score test to statistically test the null effect of a functional predictor on the time-to-event data with the presence of other scalar predictors. Specifically, we are interested in testing (2.5) H0:Œ≤(s)=0v.s.Ha:Œ≤(s)‚â†0.

The testing problem under the functional linear regression context has been studied in the literature (Cardot et al., 2003; Kong et al., 2016).

Since Œ≤(s) is an infinite dimensional parameter, we instead truncate the number of basis functions for Œ≤(s) and then test Our test (2.6) H0‚àó:Œ≤1=Œ≤2=‚Ä¶=Œ≤rn=0v.s.Ha‚àó:Œ≤j‚â†0¬†for at least one¬†j,1‚â§j‚â§rn.

Our test is based on the score test statistic for FLCRM (2.3). We first derive the score function and the information matrix of Œ∑ for the approximate partial likelihood function (2.4) as: S(Œ∑)=‚àÇQ(Œ∑)‚àÇŒ∑=‚àëi=1n‚à´0œÑw^idNi(t)‚àí‚à´0œÑ‚àëi=1nw^iYi(t)¬†exp{w^iTŒ∑}‚àëi=1nYi(t)¬†exp{w^iTŒ∑}dN¬Ø(t),

I(Œ∑)=‚àí‚àÇS(Œ∑)‚àÇŒ∑=‚à´0œÑ[‚àëi=1nw^i‚äó2Yi(t)¬†exp(w^iTŒ∑)‚àëi=1nYi(t)¬†exp(w^iTŒ∑)‚àí{‚àëi=1nw^iTYi(t)¬†exp(w^iTŒ∑)‚àëi=1nYi(t)¬†exp(w^iTŒ∑)}‚äó2]dN¬Ø(t),

where a‚äó2 = aaT. Denote Œ∑^0=(0T,Œ≥^0T)T as the maximum approximate partial likelihood estimate of Œ∑ under H0‚àó. We have I(Œ∑^0)=‚à´0œÑ[‚àëi=1nw^i‚äó2Yi(t)¬†exp(ziTŒ≥^0)‚àëi=1nYi(t)¬†exp(ziTŒ≥^0)‚àí{‚àëi=1nw^iTYi(t)¬†exp(ziTŒ≥^0)‚àëi=1nYi(t)¬†exp(ziTŒ≥^0)}‚äó2]dN¬Ø(t).

Assume the (rn + p) √ó (rn + p) dimensional information matrix I(Œ∑ÃÇ0) is invertible, the score test for testing H0‚àó, denoted by TS, is given by TS=S(Œ∑^0)T{I(Œ∑^0)}‚àí1S(Œ∑^0).

Similar to the traditional score statistic in the Cox regression model, we will show that œárn2 provides a good approximation to the null distribution of the score statistic TS.

2.4 Choice of rn

We introduce two different methods of choosing rn for our testing and estimation procedures. The first one used in testing is to threshold the percentage of variance explained by the first rn FPCs, denoted by PV(rn)=‚àë=1rnŒªj/‚àëj=1‚àûŒªj. For instance, one may set the threshold values of PV(rn) as 70%, 85%, or 95%. We have found in our simulation studies that the testing procedure is relatively robust under different threshold values, and thus we use PV(rn) = 85% throughout the paper. The second one used in estimation is to choose an appropriate rn for accurately estimating Œ≤(t). We have found that changing rn can have a relatively large effect on the accuracy of estimating Œ≤(t). Generally, a smaller rn would lead to a larger bias, whereas a larger rn could lead to a larger variance. To achieve a balance between bias and variance, we use AIC to choose rn (Yao et al., 2005). Let Œ∑ÃÇ(rn) be the estimate of Œ∑ when the truncation integer is set as rn, AIC is defined as AIC(rn) = 2rn ‚àí 2 log{Q(Œ∑ÃÇ(rn))}. Numerically, we can use the grid search method to select an optimal rn that minimizes AIC. We will show in our simulations that AIC does not work well in testing, whereas thresholding the percentage of variance does not work well in estimation.

2.5 Computational Efficiency and Asymptotic Theory

Our method is easy to implement even for two- or higher dimensional images. Specifically, we only need to fit a typical cox regression model after we obtain the functional principal component (FPC) scores. Both steps are computationally fast. It takes 33 seconds to run the real data analysis by using our method. Among them, majority of time is spent on the construction of FPCA since we have 30, 000 grid points on each image. We also systematically investigate the asymptotic properties of the maximum approximate partial likelihood estimator Œ∑ÃÇ as well as the asymptotic null distribution of the score statistic TS. We have included them in Section 4 of the supplementary material.

3. Simulations

3.1 Estimation

We simulated datasets from the FLCRM with the hazard function (2.1), in which four scalar predictors (p = 4) and one functional predictor were considered. Specifically, the failure time T was independently generated from an exponential distribution with parameter h(t|Xi(s),Zi)=h0(t)¬†exp¬†{‚à´01Xi(s)Œ≤0(s)ds+ZiTŒ≥0},

in which we set h0(t) = 1, Œ≥0 = (0.2, 0.2, 0.2, 0.2)T, and Œ≤0(s) = 0.3[sin(œÄs) ‚àí cos(œÄs) + sin(3œÄs/10)‚àícos(3œÄs)+sin(5œÄs)/9‚àícos(5œÄs)/9+sin(7œÄs)/16‚àícos(7œÄs)/16+sin(9œÄs)/25‚àícos(9œÄs)/25 + (2œÄ)‚àí1/2 exp{‚àí2‚àí1(s ‚àí 0.5)2}] for 0 ‚â§ s ‚â§ 1. The censoring time was then independently simulated from a uniform distribution U(0, c0), where c0 was chosen to achieve a desired censoring rate of 10%, 30% or 50%. We independently simulated Xi(s)=ui1+ui2s+‚àëj=110[œÖij1¬†sin{2(2j‚àí1)œÄs}+œÖij2¬†cos{2(2j‚àí1)œÄs}], where ui1 ~ N(0, 1), ui2 ~ N(0, 1), and œÖij1, œÖij2 ~ N(0, 1/j2). The scalar covariates Zi were simulated from a multivariate normal distribution with zero mean and covariance matrix Œ£ = (œÅ|j‚àík|)1‚â§j,k‚â§4 with œÅ = 0.5. We allow some correlation between Zi andXi(s). In particular, we set Cov(zik, œÖi11) = 0.1 for all 1 ‚â§ k ‚â§ 4. We took 101 dense observations on grid points sim = 0.01m ‚àí 0.01 with 1 ‚â§ m ‚â§ 101 for each curve Xi(s). The noisy observations were obtained by Wim = Xi(sim)+Œµim for 1 ‚â§ i ‚â§ n, where Œµim were independently generated from N(0, 0.5).

We considered sample sizes of n = 200, 500, and 1, 000 for each censoring rate and generated 100 datasets for each case. We fitted the FLCRM to each simulated dataset. To select the number of principal components, we use AIC method. We calculated the relative mean square errors of estimated coefficient function and parameter estimates according to RMSEŒ≤=‚à´{Œ≤^(s)‚àíŒ≤0(s)}2ds/‚à´Œ≤02(s)ds and RMSEŒ≥ = ‚ÄñŒ≥ÃÇ ‚àí Œ≥0‚Äñ2/‚ÄñŒ≥0‚Äñ2. These relative mean square error values characterize the accuracy of Œ≤ÃÇ(¬∑) and Œ≥ÃÇ. We also report the prediction performance by using the concordance index (Harrell et al., 1996; Heagerty and Zheng, 2005), which can be implemented using the R function ‚Äú concordance.index()‚Äù in the R package ‚Äú survcomp‚Äù. To examine the effects of rn on the estimation of parameters, we varied rn from 1 to 10. We have also compared our method with the methods proposed in Gellar et al. (2015) and Qu et al. (2016). We include the estimation results for n = 200 and censoring rate 0.1 in Table 2. For all other eight settings, we include them in the supplementary document, Tables S1‚ÄìS8.

The results reveal that the estimation of Œ≤(s) is quite sensitive to rn. Specifically, changing rn can have a large effect on the estimation of Œ≤(s). This indicates that selecting rn by thresholding the percentage of variance explained would not work well in estimation since we do not know which PV(rn) we should use. However, it turns out that the AIC tuning method performs reasonably well in selecting rn, leading to good estimates of Œ≤(s). In contrast, the estimation of Œ≥ and the predictive accuracy are quite robust to the selection of rn. For the method of Gellar et al. (2015), it performs similarly as our method for all the scenarios. However, for the method of Qu et al. (2016), it fails to estimate Œ≤(s) and Œ≥ accurately. We guess that it may be caused by not using the traditional Newton-Raphson algorithm to obtain the estimator from penalized cox regression model. Specifically, they use the simplex search method of Lagarias et al. (1998), which is not guaranteed to converge to a local minimum, and therefore their method is not stable especially when the number of parameters is large.

3.2 Testing

We assess the Type I and II error rates of our score statistic by testing the hypotheses H0 : Œ≤0(¬∑) = 0 versus H1 : Œ≤0(¬∑) ‚â† 0. We used the same simulation method as that in Section 3.1 except that we set Œ≤0(s) = Œ≤C1,C2(s) = 0.3[C1{sin(œÄs) ‚àí cos(œÄs) + sin(3œÄs/10) ‚àí cos(3œÄs) + sin(5œÄs)/9 ‚àí cos(5œÄs)/9+sin(7œÄs)/16‚àícos(7œÄs)/16+sin(9œÄs)/25‚àícos(9œÄs)/25}+C2(2œÄœÉ2)‚àí1/2 exp{‚àí(2œÉ2)‚àí1(s‚àí0.5)2}], where C1,C2 ‚â• 0 are scalars that control the degree of departure from H0. We consider the censoring rates 10%, 30%, and 50% under sample sizes of n = 200, 500, and 1, 000. We selected the number of principal components using percentage of variance explained and AIC method. In particular, we compare the type-I error performance by thresholding six different percentages of variance explained, i.e. PV(rn) = 0.70, 0.75, 0.80, 0.85, 0.90, 0.95 and AIC method. For each simulated dataset, we calculated the score statistic and its associated p‚Äìvalue. The level of significance was set as 0.05. We used 5, 000 simulated datasets to estimate the Type I error rate when C1 = C2 = 0, that is Œ≤C1,C2(¬∑) = 0.

Table 3 summarizes type-I error rates of TS at the nominal level of 5%. Inspecting Table 3 reveals that the Type I error rates are relatively accurate for all censoring rates and sample sizes when we use the percentages of variance explained. In contrast, when we use AIC selection method, the Type I error rates are significantly inflated. This indicates that we cannot use AIC method for testing.

Consequently, we only study the power analysis for thresholding percentages of variance explained method. In particular, we used 500 simulated datasets to estimate the power for two different alternative settings. The first alternative setting is to set C2 = 0 and C1 = 0.1 √ó j for j = 1, ‚Ä¶, 10. The second alternative setting is to set C1 = 0 and C2 = 0.1 √ó j for j = 1, ‚Ä¶, 10. We include simulation results when we use different thresholds PV(rn) = 0.70, 0.75, 0.80, 0.85, 0.90, and 0.95 to select the number of FPCs. See Tables S9 and S10 of the supplementary document. From the results, we can see that the power of the test is quite robust to the choice of PV(rn). Thus, we use PV(rn) = 0.85 throughout the paper. Figure 1(a)‚Äì(c) give the statistical power of rejecting H0 under the first set of alternative hypotheses and Figure 1(d)‚Äì(f) give the power of rejecting H0 under the second setting. As expected, both increasing n and reducing the censoring rate improve the statistical power of rejecting the null hypothesis.

4. Alzheimer‚Äôs Disease Neuroimaging Initiative

Data used in the preparation of this article were obtained from the ADNI database (adni.loni.usc.edu). The detailed data description including hippocampus image data preprocessing and demographic information summary can be found in Section 2 in the supplementary document. The hippocampus is one of the key brain areas affected by AD. We consider the clinical and imaging measures of 373 MCI individuals in ADNI1 and use them to predict the time of conversion from MCI to AD, as well as to assess the predictive role of hippocampus surface morphology at baseline. Among the 373 MCI individuals, 161 MCI individuals progressed to AD before study completion and the remaining 212 MCI individuals did not convert to AD prior to study end. Thus, the time of conversion from MCI to AD can be treated as time-to-event data.

We fitted the FLCRM model to the ADNI dataset. The scalar covariate includes Gender (1=Male; 2=Female), Handedness (1=Right;2=Left), Marital Status (1=Married; 2=Widowed; 3=Divorced; 4=Never married), Education length, Retirement (1=Yes; 0=No), Age, the APOE genetic covariates with two SNPs, and the ADAS-Cog score. The two SNPs in APOE together define a 3-allele haplotype, namely, the Œµ2, Œµ3 and Œµ4 variants. For the categorical variables, we introduce dummy variables to represent them, resulting in a design matrix Z with dimension (n, p) = (373, 12). For the functional predictors, we used hippocampal radial distances of 30,000 surface points on the left and right hippocampus surfaces. The radial distance is defined as the distance between the medial core of the hippocampus and the corresponding vertex, and it is a summary statistic of the hippocampal shape and size. We applied FPCA to such surfaces to estimate the principal component scores. We selected the top 34 FPCs that explain 85% of the total variance. We used our score test statistic TS to test the null hypothesis of H0 : Œ≤(¬∑) = 0, and its associated p-value is 5 √ó 10‚àí6. This result may indicate a significant non-zero effect of the hippocampus radial distance surface data on the conversion time. We have performed the back-testing procedure to validate our testing result. In particular, we considered top 34 FPCs and applied our method to test whether each PC is significant compared with the null model with only clinical covariates. Then we adjust for multiple comparisons by using Bonferroni correction and compare all of the p-values with 0.05/34. The first principal component is still significant with its p-value 8 √ó 10‚àí7. Therefore, the signal is very strong, validating our testing results. We also performed the sensitivity analysis of our testing procedure by using different percentages of variance explained to select rn. In particular, we consider 70%, 75%, 80%, 90% and 95%, and the corresponding p-values are 2 √ó 10‚àí5, 2 √ó 10‚àí6, 2 √ó 10‚àí6, 3 √ó 10‚àí8, and 7 √ó 10‚àí7, respectively. Therefore, all the p‚Äìvalues support a significant non-zero effect even after the use of Bonferroni adjustment for multiple comparisons.

We then used the estimation procedure of FLCRM to estimate Œ≥ and Œ≤0(¬∑). The number of FPCs is chosen to be rÃÇn = 20 by AIC. We fitted the FLCRM and applied the method in Grambsch and Therneau (1994) to test the proportional hazards assumption for a Cox regression model fit. This can be implemented by the ‚Äú cox.zph()‚Äù function in the R package survival. The p-value is 0.177, which suggests that the proportional hazards assumption is not violated. Figure 2(b) includes the estimated coefficient functions. We have plotted the hippocampal subfields in Figure 2(c). Inspecting Figure 2 reveals that the subfield of CA1 on both hippocampi has negative effects on the hazard function, indicating that the thicker these areas on the hippocampus are, the shorter the time is to covert to AD. Table 1 presents the estimated Œ≥ and their standard errors and p-values. We observe that ADAS-Cog score is significant, whereas the APOE genes are not after Bonferroni correction. This coincides with the results in Da et al. (2014), which show that a combination of spatial patterns of brain atrophy and ADAS-Cog offers good predictive power of conversion from MCI to AD, whereas APOE genotype does not significantly improve prediction. Our findings support prior MRI studies of volumetric hippocampal changes in prodromal AD (Dickerson and Wolk, 2013), and extend them by finding that the possible prognostic value of adding hippocampus surface data may be superior to that provided by routine clinical cognitive testing data.

We plotted the survival function with the 95% point-wise confidence interval in Figure 2(d), where the values of all the covariates are taken as the mean value of the covariates. In addition, we performed some sensitivity analysis of rn. In particular, we consider rn = 17, 18, 19, 21, 22, and 23 and then we estimate Œ≥ and Œ≤0(¬∑). The estimated coefficient functions are presented in Figure S1 in the supplementary document. Compared with Figure 2(b), our estimated coefficient functions are quite robust to the choice of rn.

We investigate the predictive performance of the FLCRM method. We also compared our model with a reduced model without the hippocampus surface data, and we fitted a Cox regression with only the scalar covariates. We randomly selected 200 subjects as the training data. We calculated the concordance index using the remaining 173 data points as the test data. We repeated this step for 100 times in order to obtain the mean of the concordance indices and its standard error for the two fitted models. The results show that the mean of the concordance indices is 0.68 (0.003) for our FLCRM, whereas the mean is 0.65 (0.003) for the reduced model, indicating the better prediction of our model. We also want to note that the concordance index with 0.68 is not very high, and there is still a lot of unmeasured variability driving progression to AD. We also compared with a new model by replacing the surface data by the hippocampal size, and the mean of the concordance indices is 0.69 (0.003). Although the summary statistics provide similar prediction power, the use of the whole hippocampal surface allows us to localize the effects of hippocampal subregions on conversion from MCI to AD.

Supplementary Material

Supp info

The research of Dr. Zhu was supported by U.S. NIH grants MH086633 and MH092335, NSF grants SES-1357666 and DMS-1407655, and a grant from the Cancer Prevention Research Institute of Texas. Dr. Kong‚Äôs research was funded by Natural Sciences and Engineering Research Council of Canada. Dr. Ibrahim‚Äôs research was partially supported by NIH grants #GM 70335 and P01CA142538. The content is solely the responsibility of the authors and does not necessarily represent the official views of the NIH. Data used in preparation of this article were obtained from the Alzheimers Disease Neuroimaging Initiative (ADNI) database (adni.loni.usc.edu). As such, the investigators within the ADNI contributed to the design and implementation of ADNI and/or provided data but did not participate in analysis or writing of this report. A complete listing of ADNI investigators can be found at: http://adni.loni.usc.edu/wpcontent/uploads/how to apply/ADNI Acknowledgement List.pdf.

Figure 1 Simulation results for evaluating the rejection rate of TS when PV(rn) = 0.85: panels (a), (b), and (c), respectively, correspond to the changes in power for sample sizes of n = 200, 500, and 1, 000 under the first setting of alternative hypothesis; panels (d), (e), and (f), respectively, correspond to the changes in power for sample sizes of n = 200, 500, and 1, 000 under the second setting of alternative hypothesis. The solid, dashed and dotted lines correspond to censoring rate of 0.1, 0.3 and 0.5, respectively.

Figure 2 ADNI data analysis results: panel (a) is the color bar illustration, panel (b) contains the estimated coefficient functions Œ≤(s), panel (c) is the hippocampal subfields, and panel (d) is the survival function for the time of MCI to AD progression. This figure appears in color in the electronic version of this article.

Table 1 ADNI data analysis: the estimates of Œ≥ and their standard errors.

	Œ≥ 1	Œ≥ 2	Œ≥ 3	Œ≥ 4	Œ≥ 5	Œ≥ 6	Œ≥ 7	Œ≥ 8	Œ≥ 9	Œ≥ 10	Œ≥ 11	Œ≥ 12	
Estimate	0.390	0.225	0.112	‚àí0.676	0.132	‚àí0.030	0.419	‚àí0.035	0.407	0.204	‚àí0.438	0.132	
Standard Error	0.197	0.324	0.298	0.409	0.786	0.030	0.226	0.015	0.407	0.458	0.202	0.020	
p-values	0.048	0.488	0.707	0.099	0.866	0.320	0.064	0.017	0.317	0.656	0.030	1 √ó 10‚àí10	

Table 2 Simulation results for the estimation and predictive accuracy of our estimation method when n = 200 and censoring rate is 0.1. We vary rn from 1 to 10, and use AIC to select rn, and we also compare with Gellar et al. (2015)‚Äôs method. The means of the estimates of RMSEŒ≤, RMSEŒ≥, rÃÇn and the concordance index with their standard errors in the parentheses were reported.

rn	RMSEŒ≤	RMSEŒ≥	Concordance Index	rÃÇn	
1	0.22(0.007)	0.24(0.018)	0.731(0.0004)	1	
2	0.15(0.008)	0.25(0.019)	0.735(0.0005)	2	
3	0.12(0.008)	0.26(0.02)	0.737(0.0005)	3	
4	0.09(0.005)	0.26(0.019)	0.738(0.0003)	4	
5	0.13(0.008)	0.26(0.019)	0.738(0.0003)	5	
6	0.23(0.019)	0.27(0.02)	0.737(0.0004)	6	
7	0.46(0.043)	0.28(0.02)	0.736(0.0005)	7	
8	0.66(0.051)	0.29(0.02)	0.735(0.0005)	8	
9	1.02(0.066)	0.29(0.02)	0.734(0.0005)	9	
10	1.42(0.092)	0.29(0.02)	0.733(0.0005)	10	
AIC	0.28(0.052)	0.26(0.019)	0.737(0.0005)	3.68(0.16)	
Gellar	0.26(0.047)	0.26(0.019)	0.737(0.0004)	NA	
Qu	3.70 (0.04)	4.27(0.07)	NA	NA	

Table 3 Simulation results for TS: the Type I error rates were reported at three censoring rates and three sample sizes. The number 0.70, 0.75, 0.80, 0.85, 0.90, 0.95 in the first row denotes different PV(rn) values, and AIC denotes the AIC selection method. For each case, 5,000 simulated datasets were used.

n	censoring	0.7	0.75	0.80	0.85	0.90	0.95	AIC	
200	0.1	0.06	0.059	0.0586	0.059	0.06	0.066	0.173	
	0.3	0.0636	0.062	0.0626	0.0622	0.0664	0.0698	0.1782	
	0.5	0.064	0.064	0.0644	0.0642	0.0672	0.07	0.1808	
500	0.1	0.057	0.0514	0.0514	0.0514	0.0554	0.0574	0.162	
	0.3	0.057	0.0566	0.0566	0.057	0.0542	0.0568	0.1578	
	0.5	0.0574	0.0562	0.0562	0.0566	0.056	0.0598	0.1568	
1000	0.1	0.055	0.0556	0.0556	0.0556	0.0554	0.058	0.1514	
	0.3	0.0502	0.0556	0.0556	0.0556	0.056	0.0566	0.1504	
	0.5	0.0536	0.0546	0.0546	0.0544	0.0574	0.0572	0.1548	

Supplementary Material

Web Appendices, Tables, and Figures referenced in Sections 2, 3, 4 and the computer code are available with this paper at the Biometrics website on Wiley Online Library.


Cai T Tonini G Lin X 2011 Kernel machine approach to testing the significance of multiple genetic markers for risk prediction Biometrics 67 975 986 21281275
Cardot H Ferraty F Mas A Sarda P 2003 Testing hypotheses in the functional linear model Scandinavian Journal of Statistics 30 241 255
Cox DR 1972 Regression models and life-tables Journal of the Royal Statistical Society, Series B 34 187 220
Cox DR 1975 Partial likelihood Biometrika 62 269 276
Da X Toledo J 2014 Integration and relative value of biomarkers for prediction of mci to ad progression: spatial patterns of brain atrophy, cognitive scores, apoe genotype, and csf markers Neuroimage: Clinical 4 164 173 24371799
Dickerson BC Wolk D 2013 Biomarker-based prediction of progression in mci: comparison of ad-signature and hippocampal volume with spinal fluid amyloid-Œ≤ and tau Frontiers in aging neuroscience 5 55 24130528
Efron B 1977 The efficiency of Cox‚Äôs likelihood function for censored data Journal of the American Statistical Association 72 557 565
Fan J Gijbels I 1996 Local Polynomial Modelling and Its Applications Chapman and Hall London
Gellar JE Colantuoni E Needham DM Crainiceanu CM 2015 Cox regression models with functional covariates for survival data Statistical Modelling 15 256 278 26441487
Grambsch PM Therneau TM 1994 Proportional hazards tests and diagnostics based on weighted residuals Biometrika 81 515 526
Hall P Horowitz JL 2007 Methodology and convergence rates for functional linear regression The Annals of Statistics 35 70 91
Hall P Hosseini-Nasab M 2006 On properties of functional principal components analysis Journal of the Royal Statistical Society, Series B 68 109 126
Harrell FE Lee KL Mark DB 1996 Tutorial in biostatistics multivariable prognostic models: issues in developing models, evaluating assumptions and adequacy, and measuring and reducing errors Statistics in Medicine 15 361 387 8668867
Heagerty PJ Zheng Y 2005 Survival model predictive accuracy and ROC curves Biometrics 61 92 105 15737082
Huang J Sun T Ying Z Yu Y Zhang C 2013 Oracle inequalities for the lasso in the cox model The Annals of Statistics 41 1142 1165 24086091
Ibrahim JG Chen M-H Sinha D 2001 Bayesian Survival Analysis New York Springer-Verlag Inc.
Johnstone IM Lu AY 2009 On consistency and sparsity for principal components analysis in high dimensions Journal of the American Statistical Association 104 682 693 20617121
Kalbfleisch JD Prentice RL 2002 The Statistical Analysis of Failure Time Data John Wiley &amp; Sons
Kong D Staicu A-M Maity A 2016 Classical testing in functional linear models J. Nonparametr. Stat 28 813 838 28955155
Lagarias JC Reeds JA Wright MH Wright PE 1998 Convergence properties of the nelder‚Äìmead simplex method in low dimensions SIAM Journal on optimization 9 112 147
Lee E Zhu H Kong D Wang Y Giovanello KS Ibrahim JG 2015 BFLCRM: A bayesian functional linear cox regression model for predicting time to conversion to alzheimer‚Äôs disease The Annals of Applied Statistics 9 2153 2178 26900412
Li J Ma S 2013 Survival Analysis in Medicine and Genetics Chapman &amp; Hall/CRC
Li S Okonkwo O Albert M Wang M-C 2013 Variation in variables that predict progression from mci to ad dementia over duration of follow-up American Journal of Alzheimer‚Äôs Disease 1 12 28
Li Y Wang N Carroll RJ 2010 Generalized functional linear models with semiparametric single-index interactions Journal of the American Statistical Association 105 621 633 20689644
Morris JS 2015 Functional regression Annual Reviews of Statistics and its Application 2 321 359
Petersen RC 2004 Mild cognitive impairment as a diagnostic entity Journal of Internal Medicine 256 183 194 15324362
Qu S Wang J Wang X 2016 Optimal estimation for the functional cox model Annals of Statistics page to appear
Reiss PT Ogden RT 2007 Functional principal component regression and functional partial least squares Journal of the American Statistical Association 102 984 996
Reiss PT Ogden RT 2010 Functional generalized linear models with images as predictors Biometrics 66 61 69 19432766
Risacher SL Saykin AJ 2009 Baseline MRI predictors of conversion from MCI to probable AD in the ADNI cohort Current Alzheimer Research 6 347 361 19689234
Xu J 2012 High-dimensional cox regression analysis in genetic studies with censored survival outcomes Journal of Probability and Statistics 1 14
Yao F M√ºller H-G Wang J-L 2005 Functional data analysis for sparse longitudinal data Journal of the American Statistical Association 100 577 590
Zhang J Chen J 2007 Statistical inference for functional data The Annals of Statistics 35 1052 1079
