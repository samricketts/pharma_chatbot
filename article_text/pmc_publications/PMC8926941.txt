LICENSE: This file is available for text mining. It may also be used consistent with the principles of fair use under the copyright law.


0370625
1170
Biometrics
Biometrics
Biometrics
0006-341X
1541-0420

34532859
8926941
10.1111/biom.13563
NIHMS1752152
Article
Evaluating the Association between Latent Classes and Competing Risks Outcomes with Multi-Phenotype Data
Fei Teng 1
Hanfelt John 2
Peng Limin 2*
1 Department of Epidemiology and Biostatistics, Memorial Sloan Kettering Cancer Center, 485 Lexington Avenue, New York, New York, 10017, U.S.A.
2 Department of Biostatistics and Bioinformatics, Emory University, 1518 Clifton Road Northeast, Atlanta, Georgia 30322, U.S.A
* lpeng@emory.edu
5 11 2021
3 2023
17 10 2021
17 3 2023
79 1 488501
This file is available for text mining. It may also be used consistent with the principles of fair use under the copyright law.
Summary:

Latent class analysis is an intuitive tool to characterize disease phenotype heterogeneity. With data more frequently collected on multiple phenotypes in chronic disease studies, it is of rising interest to investigate how the latent classes embedded in one phenotype are related to another phenotype. Motivated by a cohort with mild cognitive impairment (MCI) from the Uniform Data Set (UDS), we propose and study a time-dependent structural model to evaluate the association between latent classes and competing risk outcomes that are subject to missing failure types. We develop a two-step estimation procedure which circumvents latent class membership assignment and is rigorously justified in terms of accounting for the uncertainty in classifying latent classes. The new method also properly addresses the realistic complications for competing risks outcomes, including random censoring and missing failure types. The asymptotic properties of the resulting estimator are established. Given that the standard bootstrapping inference is not feasible in the current problem setting, we develop analytical inference procedures, which are easy to implement. Our simulation studies demonstrate the advantages of the proposed method over benchmark approaches. We present an application to the MCI data from UDS, which uncovers a detailed picture of the neuropathological relevance of the baseline MCI subgroups.

Competing risks
Cumulative incidence function
Estimating equation
Latent class analysis
Structural model

pmc1 Introduction

In chronic disease studies, data on multiple phenotypes are often captured to provide a comprehensive view of disease manifestation and progression. For example, the Uniform Data Set (UDS) has collected a large number of common clinical observations longitudinally from 39 National Institutes of Health (NIH)-supported Alzheimer’s disease centers (ADCs) nationwide. For participants diagnosed with mild cognitive impairment (MCI), the cognitive performance assessed by trained clinicians and assistants was documented at their first visits to ADCs. The clinical courses of these individuals were tracked over time. Upon occurrences of death, neuropathological findings, such as density of neuritic plaques, were recorded when brain autopsies were available. One question of interest in this multi-phenotype study is how the cognitive heterogeneity of MCI presented at baseline is associated with the progression of neuropathological features that reflect the brain etiology of the Alzheimer disease.

To address such an interest, an intuitive approach is to first perform latent class analysis (LCA) with baseline cognitive data (i.e. step 1), use the results from step 1 to cluster MCI patients into latent classes that manifest baseline cognitive heterogeneity (i.e. step 2), and then regress the subsequent neuropathological outcomes over the latent class memberships assigned in step 2 (i.e. step 3). This type of approach was referred to as a “classify-analyze” or “three-step” method and investigated by many authors (Clogg, 1995; Bolck et al., 2004, for example). An apparent issue with the three-step methods is that misclassification of the assigned latent class memberships can lead to biased estimation in the subsequent regression analysis. Strategies to mitigate such bias include applying random class assignments based on the posterior membership probabilities (Bandeen-Roche et al., 1997; Wang et al., 2005), using the classification error probabilities as weights for the latent class membership assignment (Bolck et al., 2004; Vermunt, 2010; Bakk et al., 2013), and generating augmented datasets that include replicates with latent classes assigned in proportion to the posterior membership probabilities (Bakk and Vermunt, 2016).

Alternatively, the intuitive three-step procedures can be streamlined into one-step or two-step approaches following the general framework discussed by Bakk and Kuha (2018). One-step approaches consider the models in step 1 and step 3 simultaneously and are usually carried out through examining the joint likelihood (Proust-Lima et al., 2009; Elliott et al., 2020). Two-step approaches keep the LCA in step 1 but skip the class membership assignment in step 2 through utilizing a direct link between the regression outcome in step 3 and the LCA parameters in step 1(Xue and Bandeen-Roche, 2002; Bakk and Kuha, 2018). They can account for the variability induced by plugging in the parameter estimates from step 1, for example, by using pseudo-maximum likelihood theory (Gong and Samaniego, 1981). As commented by Bakk and Kuha (2018), while one-step methods are generally more efficient than two-step methods, they typically involve intensive computation as well as ambiguous latent class interpretation. That is, when a one-step method is applied, every change in the model in step 3, such as adding or removing a covariate, can change the fit of the model in step 1 (e.g. baseline LCA model), leading to different implications regarding the latent classes. Two-step methods can greatly relieve the computational burden and avoid such an interpretation issue.

However, applying existing methods to the UDS example is hampered by several non-ignorable data complications. First, the neuropathological features were measured from brain autopsies that were only available in deceased subjects, meaning that they are inseparable from the survival outcomes of MCI patients. Each neuropathological feature is presented as one of mutually exclusive forms, such as different levels of neuritic plaque density, while sharing the same survival component. Therefore, one natural way to capture neuropathological features without losing information is to formulate them as competing risk outcomes, for example, time to death with none or sparse, moderate, or frequent neuritic plaque. Moreover, only a proportion of study participants were willing to donate their brains after death. As a result, the neuropathological data are missing in the deceased subjects without brain autopsies. Under the competing risks formulation, this causes the so-called missing failure type problem, which has been handled by multiple imputation methods (Lu and Tsiatis, 2001, for example), pseudo-likelihood approaches (Bakoyannis et al., 2020, for example), or the inverse probability weighting (IPW) and double robust techniques (Gao and Tsiatis, 2005; Lu and Liang, 2008, for example). This problem has not been tackled in settings involving latent classes.

Motivated by the UDS example, in this work we study a structural model that links latent classes defined using baseline phenotype data with subsequent competing risks outcomes in the presence of missing failure types. This model mimics the semiparametric direct binomial regression model for competing risks (Scheike et al., 2008). It flexibly allows for time-dependent latent class effects and is tailored to explore how MCI cognitive subgroups at baseline are associated with the time to death with a particular neuropathological feature. We devise and justify a simple strategy for incorporating LCA parameter estimates into the estimation of the effects of latent classes, thereby conferring a two-step estimation procedure without involving latent class membership assignment. Moreover, our method properly addresses the missing failure type problem with the technique of IPW. We establish desirable asymptotic properties of the resulting estimators. Our extensive simulation studies demonstrate satisfactory finite-sample performance of the proposed method, and clearly indicate that overlooking latent class misclassification or the issue of missing failure types can lead to substantial biases. Our application to the MCI data from UDS reveal a positive association between amnestic MCI group and frequent neuritic plaques at death, illustrating good practical utility of the proposed method.

2 Data, notation, and models

2.1 Data and notation

As explained in Section 1, we characterize the neuropathological endpoint of interest in the UDS example by a competing risks outcome, where the failure time T represents the time from baseline visit to death and the failure type ϵ represents one of the K (= 3) levels of neocortical neuritic plaque density measured from brain autopsies: none or sparse (ϵ = 1), moderate (ϵ = 2), and frequent (ϵ = 3). The observation of T is subject to censoring by C, which corresponds to the time to the last follow-up visit. The availability of the failure type ϵ is indicated by R, which equals 1 if a deceased study participant agreed to donate brain after death and 0 otherwise. The baseline data, Y, used to define baseline cognitive MCI subtypes, include ten standardized cognitive test scores collected at the first visit.

In addition, define X = T ∧ C, D = ϵ · R · I(T ⩽ C), and Dc = I(T ⩽ C), where ∧ is the minimum operator and I(·) is the indicator function. Define Fd(t∣V) = Pr(T ⩽ t, ϵ = d∣V), representing the type-d cumulative incidence function conditioning on the random vector V. The observed data consist of n iid replicates of (X, D, Dc, Y), denoted by {(Xi, Di, Dc,i, Yi), i = 1, …, n}.

We assume (A1) C is independent of (T, ϵ) given Y; and (A2) R is independent of (ϵ, C) given Y and T. The assumption (A1) assumes conditional independent censoring given the baseline covariates. The assumption (A2) implies that the failure type ϵ is missing at random; the missing mechanism is specified later by model (5).

For the problem considered in this work, the latent classes of interest are defined based on the observed baseline covariates Y. The latent classes of interest (e.g. MCI subgroups defined by baseline cognitive performance) are represented by a set of binary indicators, {δl, l = 1, …, L}, where L is the number of latent classes, and δl = 1 if belonging to class l and 0 otherwise. Define Δ = {I(δ1 = 1), I(δ2 = 1),…,I(δL = 1)}T. In practice, one may follow the common practice of LCA to determine the value of L, for example, by employing domain knowledge alone, or in combination with an evaluation of the finite mixture model fit to data based on information criteria, statistical tests, entropy, replicability, or other criteria.

2.2 Assumed models

We assume that Δ follows a multinomial distribution, Multinomial{1, (p1, p2, …, pL)T}, where pl &gt; 0 and ∑l=1Lpl=1. Given being in class l, Y is assumed to follow a distribution with the density, f(Y; ξl), where ξl is an unknown vector of parameters (l = 1,…, L). The density of Y then takes the form, (1) f(Y;θ0)=∑l=1Lplf(Y;ξl)

with the h × 1 vector θ0=(p1,…,pL,ξ1T,…,ξLT)T.

To capture how the latent classes defined on the baseline covariates are associated with the progression of the competing risks outcome, we adopt a structural competing risks model, which formulates the effects of latent classes on the cumulative incidence function of the competing risks. Specifically, we assume that (2) Fd(t∣Δ,Y)=g{λ0,d(t)TΔ∗+β0,d(t)TY¯},

where g(·) is a known monotone and differentiable link function, λ0,d(t) is a L × 1 vector of unknown coefficients, Δ* = {1, I(δ2 = 1),…, I(δL = 1)}T, Y¯ is a q × 1 subvector of Y or Y itself (q ⩽ p), and β0,d(t) is a q × 1 vector of unknown coefficients. Both λ0,d(t) and β0,d(t) are unknown coefficient function of t. Note that Δ* has a one-to-one correspondence with Δ. The key interest under model (2) is λ0,d(t). The lth component of λ0,d(t) represents the difference in the g−1 transformed type-d cumulative incidence rate at time t between latent class l and the reference latent class 1 (l = 2, 3,…, L). Including the term, β0,d(t)TY¯, allows us to capture any remaining effects of baseline covariates, beyond the influence of the baseline latent class membership Δ (that captures the overall heterogeneity in the baseline data), on the type-d cumulative incidence function. When the cumulative incidence of competing risks can be fully explained by Δ, model (2) is satisfied with β0,d = 0. It is important to note that the structural competing risks model (2) is defined and interpreted conditionally on Δ = (I(δ1 = 1),…, I(δL = 1))T, which assumes a pre-specified L. This model set-up serves to evaluate the effects of pre-formulated latent classes on a competing risks outcome of interest, which is the main motivation of this work.

Model (2) takes the same form as the direct binomial regression model proposed by Scheike et al. (2008) but includes the unobservable latent class membership as a covariate. When g(x) = 1–exp{−exp(x)} and all non-intercept components of λ0,d(t) and β0,d(t) are constant over t, model (2) has the same form as Fine and Gray (1999)’s proportional subdistribution hazards model. For notation simplicity, in the sequel, we shall omit the subscript “d” in λ0,d(t) and β0,d(t) whenever a confusion does not arise.

To account for missing failure type, we utilize a logistic regression model to characterize the distribution of the indicator R given Y~=(1,Y,T)T. Specifically, the model assumes (3) π(Y~;γ0)≐Pr(R=1∣Y~)=eγ0TY~1+eγ0TY~,

where γ0 = (γ00, γ10,…, γp0, γ(p+1)0)T is a (p+2) × 1 vector of unknown regression coefficients. The odds of observing ϵ (i.e. R = 1) is increased by eγj0 with a unit increase in the j-th component of Y (j = 1, 2,…, p) and by eγ(p+1)0 with a unit increase in T.

3 Estimation and inference

Under the assumptions for LCA, the likelihood function for θ0 based on observations {Yi, i = 1,…, n} is given by L(θ)=∏i=1nf(Yi;θ). In practice, the maximum likelihood estimate θ^, which is the solution to ∂∂θlogL(θ)=0, often does not have a closed form. Alternatively, θ^ may be numerically solved by standard EM algorithm. Consider a common example where Y given δl = 1 follows the p-variate Normal distribution, i.e. f(Y;ξl)=(2π)−p∕2∣Vl∣−1∕2exp{−12(Y−μl)′Vl−1(Y−μl)},

with ξl = {μl, Vl}. In this special case, θ^ can be obtained by the EM algorithm developed for the finite Gaussian mixture model (McLachlan and Peel, 2000, p.48), which is implemented by the R package, mclust.

By the Bayes Rule, the posterior membership probability of subject i in class l is (4) δ~l(Yi;θ0)≐Pr(δl=1∣Yi)=plf(Yi;μl,Vl)∑j=1Lpjf(Yi;μj,Vj)=plf(Yi;μl,Vl)f(Yi;θ0).

This posterior membership probability can be estimated by δ~l(Yi;θ^), which is obtained by plugging in the maximum likelihood estimate θ^ into (4).

An entropy index is defined as 1−∑i=1n∑l=1Lδ~l(Yi;θ^)[−log{δ~l(Yi;θ^)}]∕nlogL, which is often calculated to evaluate the extent of separation of latent classes established by a latent class model (Muthén et al., 2002).

3.1 Estimation for the model for missing failure types

To estimate model (3), note that T and thus Y~ is not always observable. Nevertheless, as shown in Web Appendix B, model (3), coupled with assumption (A2), implies that (5) Pr(R=1∣Y~)=Pr(R=1∣Dc=1,Y∗)=eγ0TY∗1+eγ0TY∗,

where Y* = (1, Y, X)T. By this result, one can obtain a valid estimate for γ0 by performing standard logistic regression of responses Ri’s over the covariates (1, Yi, Xi)’s in subjects with uncensored Ti (i.e. Dc,i = 1). Hosmer-Lemeshow’s goodness-of-fit test (Hosmer Jr et al., 2013) can be conducted in the same group of subjects to assess the adequacy of model (5). Denote the resulting maximum likelihood estimate for γ0 by γ^. The asymptotic properties of γ^ follows the theory for the standard logistic regression (Agresti, 2003).

3.2 Estimation for the structural competing risks model

Estimating the λ0(t) in the structural competing risks model (2) is the key interest of this work. It is important to note that since Δ (or Δ*) is not observable, the existing methods for the direct binomial regression (Scheike et al., 2008) cannot be directly applied.

A critical step to tackle this difficulty is to note that (6) Fd(t∣Y)=E{Fd(t∣Δ,Y)∣Y}=∑l=1Lg{λ0(t)Tκl+β0(t)TY¯}Pr(δl=1∣Y),

where κl is a L × 1 vector with the first and the lth elements equal to 1 and the rest of elements equal to 0 (l = 1,…, L). To deal with the random censoring to T and missing failure types, by employing the technique of inverse censoring probability weighting, we can show that under assumptions (A1) and (A2), (7) E{{I(X⩽t,D=d)G(X∣Y)π(Y~;γ0)∣Y}=Fd(t∣Y),

where G(x∣Y) = Pr(C ⩾ x∣Y); please see Web Appendix C for more detailed justifications.

Motivated by the facts (6) and (7), writing α(t) = {λ(t)T, β(t)T}T, we propose the following estimating equation for α0(t) ≐ {λ0(t)T, β0(t)T}T: (8) Un{α(t),θ^,t}=0,

where Un{α(t), θ, t} equals n−1∕2∑i=1n(∑l=1Lg′{α(t)TWl,i}Wl,iδ~il(θ))[I(Xi⩽t,Di=d)G^(Xi∣Yi)π^i−∑l=1Lg{α(t)TWl,i}δ~il(θ)].

Here g′(·) denotes the derivative function of g(·), Wl,i=(κlT,Y¯iT)T, δ~il(θ)=δ~l(Yi;θ) and G^(⋅∣Y) is a reasonable estimator of G(·∣Y), which may be obtained through additional regression modeling of C over Y, for example, by a Cox proportional hazards model. For the simplicity of presentation, we shall further assume C is independent of Y and thus G^(Xi∣Yi) can be replaced by G^(Xi), where G^(⋅) is the simple Kaplan-Meier estimator of the marginal survival function of C. The estimation and inference presented hereafter can readily be generalized to permit the dependency between C and Y.

To solve the estimating equation Un{α(t),θ^,t}=0, we find the solution by minimizing the following objective function: Sn{α(t),t}=∑i=1n(∑l=1Lg{α(t)TWl,i}δ~il(θ^))[I(Xi⩽t,Di=d)G^(Xi)π^i−12∑l=1Lg{α(t)TWl,i}δ~il(θ^)],

the derivative of which with respect to α(t) is Un(α(t),θ^,t). Since Sn(α(t), t) is a nonconvex function of α(t) given t, the standard Newton-Raphson algorithm may require multiple initializations to find the global minimum. Thus, we solve equation (8) by utilizing the differential evolution algorithm (Ardia et al., 2011), which searches global optimum in a prespecified range of α(t) with automatically generated multiple initial values and is implemented in R function DEoptim.

In practice, it is often of interest to predict the cumulative incidence function of each failure type for a new patient. Suppose the new patient has baseline covariates, Y. We can first use formula (4) to calculate the posterior latent class membership probabilities, δ~l(Y;θ^)=π^lf(Y;μ^l,V^l)∑jπ^jf(Y;μ^j,V^j), l = 1,…, L. By formula (6), we may predict the cumulative incidence functions for the new patient by F^d(t∣Y)=∑l=1Lg{λ^(t)Tκl+β^(t)TY¯}δ~l(Y;θ^), d = 1,…, K.

3.3 Asymptotic properties of the proposed estimator

We establish the uniform consistency and weak convergence of the proposed estimator α^(t) for t ∈ [l, u]. The technical notation and regularity conditions are presented and discussed in the Supplementary Materials (see Web Appendices D and E). The asymptotic results are stated in the following theorems:

THEOREM 1: Suppose conditions C1 - 4 (in Web Appendix D) hold and θ^ is a consistent estimator of θ0. Then for n large enough, there exists a uniformly bounded solution of Un{α(t),θ^,t}=0, α^(t), such that supt∈[l,u]‖α^(t)−α0(t)‖→0 in probability.

THEOREM 2: Suppose conditions of Theorem 1 and condition C5 (in Web Appendix D) hold, and there exist iid random functions {ϕi(θ0)}i=1∞ such that ‖n(θ^−θ0)−n−1∕2∑i=1nϕi(θ0)‖→p0 and supi∣ϕi(θ0)∣ &lt; ∞. Then n{α^(t)−α0(t)} converges weakly to a zero-mean Gaussian process for t ∈ [l, u] with covariance function Σ(s, t) = E{Q1(s)Q1(t)T}, where Qi(t)=J(t)−1[AiGπ{α0(t),θ0,t}−Ξ1i(t)−Ξ2i(t)−H(t)ϕi(θ0)], i = 1,…, n.

Theorem 2 provides a closed form for the asymptotic covariance function Σ(s, t), which explicitly involves the influence function ϕi(θ0) that determines the variability of θ^. This reflects how the proposed inference properly accounts for the uncertainty in the estimated posterior probabilities δ~il(θ^). The specific form of ϕi(·) can be derived under the standard likelihood framework (see an example in Boldea and Magnus (2009) for Gaussian mixture model). Detailed proofs of the two theorems are provided in Web Appendix E. All quantities involved in the definition of Qi(t) are defined at the beginning of the proof of Theorem 2.

3.4 Inference procedures

Inferences about α0(t) are of practical importance. Conducting bootstrapping in LCA is often subject to the so-called label switching issue. More specifically, the latent classes identified in different runs of resampling may not have clear correspondences. To circumvent this challenge, we develop an analytical approach to deriving the estimator of Σ(s, t), the asymptotic covariance of α^(t) established in Theorem 2.

Let α^(t) be the consistent estimate of α0(t). Define Ai{α(t),θ,t}=(∑l=1Lg′{α(t)TWl,i}Wl,iδ~il(θ))[I(Xi⩽t,Di=d)G^(Xi)π^i−∑l=1Lg{α(t)TWl,i}δ~il(θ)].

Suppose there exists statistics ϕ^i(θ^) satisfying supi‖ϕ^i(θ^)−ϕi(θ0)‖→p0. Let Q^i(t)=J^(t)−1[Ai{α^(t),θ^,t}−Ξ^1i(t)−Ξ^2i(t)−H^(t)ϕ^i(θ^)],Σ^(s,t)=n−1∑inQ^i(s)Q^i(t)T,

where J^(t)=1n∑i=1n∂αΨi{α^(t),θ^,t}⊗2,H^(t)=1n∑i=1n∂αΨi{α^(t),θ^,t}∂θΨi{α^(t),θ^,t}T,Ξ^1i(t)=I(Di=0)∑j=1nI(Xj≥Xi)∂αΨj{α^(t),θ^,t}I(Xj⩽t,Dj=d){G^(Xj)}−1π^i−1∑j=1nI(Xj≥Xi)Ξ^2i,(t)=1n∑j=1n∂αΨj{α^(t),θ^,t}I(Xj⩽t,Dj=d)(∂∂γπ^i)TG^(Xj)π^i2.

We show in the Supplementary Materials (Web Appendix E) that sups,t∈[l,u]‖Σ^(s,t)−Σ(s,t)‖→p0. The 95% pointwise confidence intervals can be constructed based on Σ^(s,t) with normal approximations. We can further construct simultaneous confidence bands over a time interval [tl, tu] using the same resampling strategy as that presented in Yin and Cai (2004). First, we generate nB samples, indexed by k, of nqˇk(t)≡n−1∕2∑i=1nQ^i(t)Zk,i for all t ∈ [tl, tu]. Second, for the lth element of α^(⋅),α^l(⋅), we find constant z1,0.05 which satisfies Pr{supk,t∈[tl,tu]∣α^l(t)nqˇl,k(t)Σ^l,l(t,t)∣&gt;zl,0.05}=0.05,

where qˇl,k(⋅) is the l1th element of qˇk(⋅) and Σ^l,l(⋅,⋅) is the (l, l) entry of Σ^(⋅,⋅). Then the confidence band for α^l(t) is constructed as α^l(t)∓zl,0.05σ^l,l(t,t)∕nα^l(t).

4 Simulations

4.1 Data generation and analysis procedures

Simulation studies were conducted to evaluate the finite-sample performance of the proposed method. With L = 3, we first generated latent class membership vector Δ = (δ1, δ2, δ3)T from a multinomial distribution with relative frequency (p1, p2, p3)T. Baseline covariates Y∈R2 was generated from a bivariate normal distribution specified for class l with δl = 1. Given the true latent class membership Δ, we further generated competing risks outcome with two failure types, following a simulation scheme similar to that in Scheike et al. (2008), with details provide in Web Appendix F.1. To simulate missing failure types, we generated the indicator of observing failure types, R, from Bernoulli{Pr(R = 1∣Y, T)}, where Pr(R=1∣Y,T)=exp(γTY−T)1+exp(γTY−T).

Three strategies were applied to analyze the simulated datasets: (i) the proposed method; (ii) a modal assignment method replacing δ~il(θ^) by I{l=arg max1⩽j⩽Lδ~ij(θ^)} in the estimating equation (8); (iii) an oracle naive method that directly implements Scheike et al. (2008)’s direct binomial regression by R package timereg, where true latent class labels are used as covariates and subjects with missing failure type are excluded. Compared to the proposed method, the modal assignment method ignored the uncertainty of the estimated class membership but accounted for missing failure types, while the direct binomial regression overlooked the missing failure types but used the correct class memberships as covariates. By comparing the three methods, it is straightforward to examine the sources of biases. We let the failure type of interest be ϵ = 1 and set L = 3. Unless specified otherwise, we evaluated the proposed method based on 1000 simulated datasets of sample size 2000.

4.2 Simulation scenarios

As shown in Table 1(a), we designed several simulation settings resulting in different data characteristics. By adjusting the relative frequency, p = (p1, p2, p3), of latent classes, the data were simulated with balanced or imbalanced latent class proportions. To create different extents of overlapping of Y among latent classes, we also specified several choices of class-specific mean, μl, l = 1, 2, 3, of Y. In addition, different γ parameters were used to simulate moderate (around 25%) to heavy (around 50%) rate of missing failure types given failure.

Based on the parameter configurations in Table 1(a), we evaluated the performance of the three methods via a series of investigations listed in Table 1(b). Controlling other factors as fixed, we conducted simulations under (A) different overlapping levels of Y; (B) different class proportions; (C) moderate or heavy rates of missing failure types. In addition, we investigated (D) how nuisance or noisy baseline covariates affected the analysis and (E) how our method performed under a setting similar to the UDS data. Performance under different choices of sample size was assessed in (F). For (E), Y∈R10 was generated from a multivariate normal distribution with the mean vector and covariance matrix equal to the estimates from fitting a 3-class finite Gaussian mixture model for the UDS data.

4.3 Simulation results

Figure 1 displays the simulation results from investigations (A)-(F), including the averages of relative biases (defined as empirical biases divided by the absolute values of true parameters) and the empirical coverage rates of 95% pointwise confidence intervals for t ∈ [0.1, 1.0], after excluding outlying estimates. The convergence of algorithm is discussed in Web Appendix F.2. We relegate other simulation results to Web Appendix F.3, including the empirical coverage rates of 95% confidence bands for t ∈ [0.1, 1.0] (Table S.2) and empirical standard deviations (SD) and average standard error estimates (SEE) (Tables S.3-S.7). Overall, the proposed approach not only achieves the smallest relative biases, but also obtain reasonable empirical coverage rates for both confidence intervals and confidence bands. Compared to the proposed method, the modal assignment method suffered from moderate biases caused by misclassification of latent classes, and the oracle naive method based on timereg yield more severe biases by ignoring missing failure types in uncensored subjects.

Figure 1(A) and 1(B) demonstrate how the results change as the data fuzziness increases, either due to more severe overlapping of Y or more imbalanced latent class proportions, respectively. The proposed method maintains small biases and rather accurate coverage rates even for cases with severe overlapping (entropy lower than 0.6) or severely imbalanced latent classes. In contrast, the empirical biases from the modal assignment method increase as the overlapping among latent classes increases. This may be explained by the increasing misclassification rate of modally assigned class labels. The oracle naive method, which uses the true class membership as the covariate, produces clearly biased estimates in (A) and (B). The biases are the same in (A) and (B) because these two investigations adopt the same missing failure type probability and the biases from the oracle naive method are solely caused by ignoring missing failure types.

Investigation (C) assesses the performance under moderate (25%) or heavy (50%) missing failure type proportion among the uncensored events. As suggested by Figure 1(C), the proposed method achieves the smallest biases among the three methods under both moderate and heavy missingness of failure types. The modal assignment method accounts for the missing failure type issue, and thus also shows similar performance between these two scenarios where the latent class pattern is unchanged. The oracle naive approach, which ignores missing failure types, produces much larger bias for λ^1(t) when a higher proportion of failure types are missing. From Figure 1(D) and 1(E), we observe that the proposed method has good performance even in the presence of nuisance variables and under a scenario based on real world data. This endorses our application of the proposed method to the MCI data from UDS. Moreover, Figure 1(F) shows promising finite sample performances at sample sizes 500 and 1000 under a rather challenging scenario where the entropy index is around 0.7. As the sample size grows, the proposed method achieves smaller biases, better coverage rates, and a higher estimation convergence rate.

4.4 Further simulation studies about selecting the number of latent classes

We conducted further simulation studies to investigate how well the integrated classification likelihood-BIC (ICL-BIC) criterion selects the number of latent classes. Specifically, we generated datasets of sample sizes N ∈ {500, 1000, 2000} from scenarios with varying degrees of overlapping among latent classes as considered under Investigation (A). Then we used ICL-BIC to select L among candidate values {1, 2, 3, 4} for each simulated dataset.

Table 2 presents the percentages of specific L values being selected. The results suggest that the ICL-BIC criterion works best when the sample size is large and the baseline covariates are mildly or moderately overlapped. When the latent classes present moderately severe (e.g. entropy around 0.7) or severe overlapping (e.g. entropy around 0.6), using the ICL-BIC criterion tends to select a value less than the true value of L (=3). This phenomenon is likely the consequence of ICL-BIC underestimating the true value of L when the fuzziness of the data is high, as reflected by the overall entropy index that is smaller than 0.7. Therefore, in practice, we recommend using information criteria together with domain knowledge to make the selection of the number of latent classes.

5 An application to the MCI data from UDS

We applied the proposed approach to analyze the Uniform Data Set (Beekly et al., 2007, UDS), collected between September 2005 and June 2015, which includes 6034 patients with MCI at the first visit. At the first visit, cognitive tests in ten different aspects were conducted to determine baseline phenotypes of MCI. There were 818 deaths during the follow-up, including 411 individuals who agreed brain donations.

In our analysis, we investigated the association between baseline cognitive MCI subtypes and density of neocortical neuritic plaques, a neuropathological feature obtained from brain autopsies. The density of neocortical neuritic plaques were classified into three levels, none or sparse, moderate, and frequent, according to the Consortium to Establish a Registry for Alzheimer’s Disease (CERAD) scores (Welsh et al., 1991). Existing knowledge has linked amnestic MCI population, with damaged brain domain related to memory functions, to frequent density of neuritic plaques (Dugger et al., 2015).

5.1 Baseline cognitive latent classes and missing mechanism of neuritic plaque density

As the first step, we conducted a LCA based on ten standardized baseline cognitive test scores adjusted for age, education, and race with respect to the reference group consisting of UDS cognitively normal participants (Hanfelt et al., 2011). The ten scores evaluated different perspectives of patients’ cognitive performance, which were described in details in the Section 2.2.1 of Hanfelt et al. (2018). Supplementary Figure S.2 in Web Appendix G.1 shows the histograms and kernel density estimates for the ten cognitive test scores.

The latent classes of baseline cognitive performance were defined based on a 3-class finite Gaussian mixture model with flexible covariance structure that captured the dependency between cognitive test scores. The number of latent classes was determined by the ICL-BIC criterion and domain knowledge of MCI. The detailed steps are provided in Web Appendix G.3. Table 3 summarizes the cognitive characteristics of the three subgroups derived by the 3-class LCA model and applying modal class assignment rule. Class 1 was interpreted as mildly impaired, with test scores showing the best overall cognition; class 2 was non-amnestic, with impairments in attention and executive function domains; class 3 was amnestic, identified by the heavier impairment in delayed memory. The overall entropy index for the fitted 3-class model was 0.70, indicating moderate-to-severe fuzziness in latent class separation. Further evaluations of class-specific entropy indices are discussed in Web Appendix G.4.

In order to account for missing neuropathological phenotypes in deceased subjects, we fit a logistic regression model of R using the ten baseline test scores and survival times. After variable selection based on Akaike information criterion, we obtained the final model Logit{Pr(R = 1)} = −0.39 + 0.06 · MMSE – 0.17 · Category Fluency – 0.07 · Trails A + 0.11 · Boston Naming + 0.13 · T. Based on this model, we calculated the estimated inverse probability weight π^i for each deceased subject. Hosmer-Lemeshow’s goodness-of-fit test indicates an adequate fit of this logistic regression model (p = 0.90).

5.2 Association between baseline cognitive latent classes and death with different levels of neuritic plaque density

Next, we fit the proposed structural competing risks model (2) for death presented with each level of neuritic plaque density (corresponding to failure type ϵ =1, 2, or 3) with the link function g(x) = 1 – exp{−exp(x)}. Discussions about the independent censoring assumption in this dataset can be found in Web Appendix G.2. For ϵ = d (d = 1, 2, 3), the three coefficient functions in model (2), λ^1,d(t), λ^2,d(t), λ^3,d(t), respectively represent g−1 transformed cumulative incidence at time t for latent class 1, the difference in the g−1 transformed cumulative incidence at time t between latent class 2 and class 1, and the difference in the g−1 transformed cumulative incidence at time t between latent class 3 and class 1. We obtained the point estimates for the true coefficient functions λl,d(t), denoted by λ^l,d(t), for t ∈ [0.25, 8], where t denotes time (in years) since first visit, and l = 1, 2, 3. The corresponding 95% confidence intervals were also computed based on the proposed estimator of asymptotic covariance function for λ^l,d(t), denoted by Σ^l,d(t,t). To compare the proposed method with alternative strategies, the point estimates were also obtained by the modal assignment method used in the simulation studies and a naive method that implements Scheike et al. (2008)’s procedure with the covariate being the modal membership assignment from the baseline LCA analysis and subjects with missing failure types excluded.

Figure 2 displays λ^l,d(t) and the corresponding 95% confidence intervals versus time for the three neuropathological phenotypes of interest (ϵ = 1, 2, 3). Similarly, Supplementary Figure S.3 (Web Appendix G.1) shows the estimated g−1 cumulative incidences. As observed in Figure 2, both the modal assignment and naive approaches may tend to underestimate the cumulative incidence differences between latent class 2 versus latent class 1 and those between latent class 3 versus latent class 1, captured by λ2,d(t) and λ3,d(t), d = 1, 2, 3. Compared to the modal assignment method which ignored latent class uncertainty, the naive approach further overlooked the problem of missing failure types and thus seemed to yield more biases.

To better display the separation in neuropathological features by the baseline MCI subgroups, we present in Figure 3 the estimated cumulative incidence functions based on the proposed method and the empirical cumulative incidence functions. According to the results from the proposed method, the amnestic group (class 3, red solid line) may be more likely to develop frequent neuritic plaques, as compared to non-amnestic (class 2, blue solid line) and mildly impaired (class 1, green solid line) groups in the 8-year follow-up period. In contrast, non-amnestic and mildly impaired MCI patients may be more likely to develop sparse or moderate neuritic plaques than the amnestic patients. These findings are consistent with existing knowledge of amnestic MCI’s high susceptibility of Alzheimer’s Disease (Adler et al., 2010). Moreover, the cumulative incidence estimates by the proposed method demonstrate different trends as compared to the naive empirical cumulative incidence estimates that overlook latent class uncertainty and missing neuropathological information.

In summary, the application of the proposed method provides useful insight about the neuropathological relevance of the baseline MCI subgroups. Our results successfully link the amnestic MCI group to higher risk of frequent neuritic plaques, which is consistent with existing knowledge about Alzheimer’s Disease. Interpretations of time-varying latent class effect estimates, and an illustration of using the proposed method to predict cumulative incidence function are discussed in Web Appendices G.5 and G.6. Similar analysis can readily be conducted on other neuropathological features of interests.

6 Discussion

In this paper, we propose a flexible approach to investigating how latent classes underlying baseline phenotype data are associated with subsequent competing risks outcomes measured from the same group of subjects. The proposed two-step procedure presents a simple strategy of replacing the unknown latent class membership in the structural competing risks model by the estimated posterior probabilities calculated from the first-step LCA. Our theoretical studies fully justify this intuitive idea and further enable analytic variance estimation that appropriately accounts for the variability induced by incorporating the posterior probability estimates. The proposed variance estimator requires the consistency of the LCA model parameter estimator, θ^, and the knowledge on its associated influence functions (see Theorems 1– 2). These requirements are generally met for likelihood-based LCA methods developed for the parametric finite-mixture model assumed in Section 2.2.

Worth further mentioning, the proposed method can be applied to handle single time-to-event outcomes by setting K = 1 (i.e. one failure type). In this case, the proposed model (2) reduces to the temporal covariate effect survival model studied by Peng and Huang (2007). When the non-intercept coefficients in α0(t) are constant over t, this model further boils down to the proportional hazards model when the link function g(x) = 1 – exp{−exp(x)} and the proportional odds model when the link function g(x) = exp(x)/{1 + exp(x)}. Since single time-to-event outcomes are not subject to the missing failure type issue, we do not need the missing failure type model (3). Accordingly, the proposed estimating equation (8) can be simplified by excluding π^i.

In the proposed estimation, we handle the problem of missing failure types by employing the simple IPW strategy. When sample size is small or the missing proportion of failure type is large, the proposed estimator may suffer from low statistical efficiency and instability due to a small inverse weight. In this case, one may develop augmented estimators from applying the double robust technique (Gao and Tsiatis, 2005) to improve estimation efficiency and robustness. It is also of interest to investigate whether the pseudo-likelihood approach (Bakoyannis et al., 2020) or the multiple imputation method (Lu and Tsiatis, 2001) can be adapted for the estimation of the structural competing risks model concerned in this work.

As guided by our comprehensive simulative studies, the proposed method performs reasonably well with a sample size as small as 500 when the overlapping among latent classes is not severe (e.g. entropy index is around 0.7 or higher). When the sample size is sufficiently large, say 2000, our method can have reasonably good performance even for very challenging data settings with overly fuzzy latent class pattern (e.g. entropy index around 0.6), combined with severely imbalanced latent class distribution and heavy missing failure types; see Web Appendix F.4 for results for scenario (1c) + (2d) + (3a). However, when the sample size is limited, the proposed method may yield unstable results in such challenging settings and caution is warranted.

Supplementary Material

Supplementary Materials

Acknowledgements

This work was supported by NIH grants R01 HL113548 and R01 AG055634. The authors wish to thank the associate editor and two referees for thoughtful comments that led to improvements in this paper, and National Alzheimer’s Coordinating Center (NACC) for making the Uniform Data Set available for the analysis. Detailed grant information about NACC database is provided in the Supplementary Materials.

Data Availability Statement

The data that support the findings in this paper are available upon request to the National Alzheimer’s Coordinating Center at https://www.alz.washington.edu/.

Figure 1. Simulation results for investigations (A)-(F), including average relative biases and coverage probabilities of 95% confidence intervals. Quantities associated with the three regression coefficients in λ0(t) are represented by solid, dashed and dotted lines. The proposed, modal assignment, and oracle naive method are respectively shown in black, red and blue lines.

Figure 2. Point estimates λ^l(i)(t), l = 1, 2, 3, i = 1, 2, 3, t ∈ [0.25, 8], for the l-th regression coefficient for the i-th competing risk outcome. Each column shows the three regression coefficients for the corresponding competing risk. Point estimates obtained by the proposed, modal and naive approaches are respectively represented by black, red and blue solid lines. Black dashed lines represent the 95% confidence intervals for the proposed estimator.

Figure 3. Cumulative incidence curves of death with the three CERAD phenotypes. Solid lines represent the predicted cumulative incidence by the proposed method. Dashed lines represent the empirical cumulative incidence curves. Mildly impaired, non-amnestic MCI and amnestic MCI groups are represented in green, blue and red, respectively.

Table 1 Detailed simulation configurations: (a) Settings and the corresponding interpretations; (b) Sets of investigations and the corresponding simulation scenarios.

(a)	
Settings	p = (p1, p2, p3)	Class proportions	
(1a)	(0.3,0.35,0.35)	balanced	
(1b)	(0.2,0.35,0.45)	moderately imbalanced	
(1c)	(0.15,0.35,0.5)	severely imbalanced	
Settings*	μ 2	μ 3	Overlapping (entropy)	
(2a)	(3,3)	(5,5)	mild (~† 0.9)	
(2b)	(2.5,2.5)	(4,4)	moderate (~ 0.8)	
(2c)	(2.25,2.25)	(3.5,3.5)	moderately severe (~ 0.7)	
(2d)	(2,2)	(3,3)	severe (~ 0.6)	
setting	γ	Missing failure type (missing rate)	
(3a)	(0.25,0.5)	moderate (~† 25%)	
(3b)	(−0.35,0.5)	heavy (~ 50%)	
* μ1 is fixed as (1,1).	
† Approximated levels observed from simulations.	
(b)	
Investigations	Scenarios simulated†	
(A) overlapping	(1b) + (2a) + (3a)	
(1b) + (2b) + (3a)	
(1b) + (2c) + (3a)	
(1b) + (2d) + (3a)	
(B) class proportion	(1a) + (2b) + (3a)	
(1b) + (2b) + (3a)	
(1c) + (2b) + (3a)	
(C) missing failure type	(1b) + (2b) + (3a)	
(1b) + (2b) + (3b)	
(D) nuisance covariates	(1a) + (2b) + (3a) + Y3∗ + Y4∗	
(E) real data scenario	Same distribution of Y as in UDS	
(F) Sample size	(1b) + (2c) + (3a)	
N ∈ {500, 1000, 2000}	
† Refer to Table 1(a)	
* Adding two independent nuisance covariates in Y.	

Table 2 Percentage of selecting L as 1, 2, 3, 4 by ICL-BIC under different simulation scenarios and sample sizes (N) based on 5000 simulations.

		Percentage of being selected (%)	
Scenarios	N	L = 1	L = 2	L = 3	L = 4	
(1b) + (2a) + (3a)	500	0	0.88	99.08	0.04	
mild overlapping	1000	0	0.06	99.94	0	
entropy around 0.9	2000	0	0	100	0	
(1b) + (2b) + (3a)	500	2.64	53.54	43.74	0.08	
moderate overlapping	1000	0.06	39.84	60.08	0.02	
entropy around 0.8	2000	0	21.72	78.28	0	
(1b) + (2c) + (3a)	500	30.68	60.82	8.50	0	
moderately severe ovarlapping	1000	12.36	78.58	9.06	0	
entropy around 0.7	2000	2.72	90.14	7.14	0	
(1b) + (2d) + (3a)	500	76.76	22.78	0.46	0	
severe ovarlapping	1000	73.94	25.82	0.24	0	
entropy around 0.6	2000	70.12	29.88	0	0	

Table 3 Mean values and standard deviations of the ten baseline standardized cognitive test scores by the three subgroups determined by the LCA of baseline cognitive data.

	Mean Values (Standard Deviation)	
Standardized scores	Class 1
mildly impaired	Class 2
non-amnestic	Class 3
amnestic	
Mini-Mental State Examination (MMSE)	−0.45 (1.04)	−2.24 (1.98)	−2.12 (1.82)	
Logical Memory: Immediate	−0.94 (1.08)	−1.34 (1.11)	−1.30 (1.06)	
Logical Memory: Delayed	−0.94 (1.10)	−1.38 (1.09)	−1.55 (1.13)	
Semantic Memory: Category Fluency	−0.64 (0.96)	−1.12 (0.98)	−0.96 (0.89)	
Attention: Trails A	0.16 (0.85)	1.72 (2.04)	0.01 (0.71)	
Attention: Digit Span Forward	−0.21 (1.02)	−0.49 (1.06)	−0.17 (1.00)	
Language: Boston Naming	0.00 (0.72)	−1.95 (2.28)	−1.15 (1.38)	
Executive: Trails B	0.40 (0.88)	3.08 (1.76)	0.20 (0.76)	
Executive: Digit Span Backward	−0.33 (0.98)	−0.72 (0.88)	−0.36 (0.99)	
Visuo-Motor: Digit Symbol	−0.58 (0.97)	−1.28 (1.15)	−0.51 (0.97)	
Note: The class memberships were assigned by modal assignment scheme.

For the trails A and trails B scores, a higher score indicates greater impairment.

For the other scores, a lower score indicates greater impairment.

Supporting Information

Web Appendices A-G referenced in Sections 3, 4 and 5 and documented R code are available with this paper at the Biometrics website on Wiley Online Library.


References

Adler CH , Caviness JN , Sabbagh MN , Shill HA , Connor DJ , Sue L , (2010). Heterogeneous neuropathological findings in parkinsons disease with mild cognitive impairment. Acta Neuropathologica 120 , 827–828.20838798
Agresti A (2003). Categorical Data Analysis, volume 482 . John Wiley &amp; Sons.
Ardia D , Boudt K , Carl P , Mullen K , and Peterson BG (2011). Differential evolution with deoptim: an application to non-convex portfolio optimization. The R Journal 3 , 27–34.
Bakk Z and Kuha J (2018). Two-step estimation of models between latent classes and external variables. Psychometrika 83 , 871–892.29150817
Bakk Z , Tekle FB , and Vermunt JK (2013). Estimating the association between latent class membership and external variables using bias-adjusted three-step approaches. Sociological Methodology 43 , 272–311.
Bakk Z and Vermunt JK (2016). Robustness of stepwise latent class modeling with continuous distal outcomes. Structural Equation Modeling: A Multidisciplinary Journal 23 , 20–31.
Bakoyannis G , Zhang Y , and Yiannoutsos CT (2020). Semiparametric regression and risk prediction with competing risks data under missing cause of failure. Lifetime Data Analysis 26 , 659–684.31982977
Bandeen-Roche K , Miglioretti DL , Zeger SL , and Rathouz PJ (1997). Latent variable regression for multiple discrete outcomes. Journal of the American Statistical Association 92 , 1375–1386.
Beekly DL , Ramos EM , Lee WW , Deitrich WD , Jacka ME , Wu J , Hubbard JL , Koepsell TD , Morris JC , Kukull WA , (2007). The national alzheimer’s coordinating center (NACC) database: the uniform data set. Alzheimer Disease &amp; Associated Disorders 21 , 249–258.17804958
Bolck A , Croon M , and Hagenaars J (2004). Estimating latent structure models with categorical variables: One-step versus three-step estimators. Political Analysis 12 , 3–27.
Boldea O and Magnus JR (2009). Maximum likelihood estimation of the multivariate normal mixture model. Journal of the American Statistical Association 104 , 1539–1549.
Clogg CC (1995). Latent class models. Handbook of Statistical Modeling for the Social and Behavioral Sciences pages 311–359.
Dugger BN , Davis K , Malek-Ahmadi M , Hentz JG , Sandhu S , Beach TG , (2015). Neuropathological comparisons of amnestic and nonamnestic mild cognitive impairment. BMC Neurology 15 , 146.26289075
Elliott MR , Zhao Z , Mukherjee B , Kanaya A , and Needham BL (2020). Methods to account for uncertainty in latent class assignments when using latent classes as predictors in regression models, with application to acculturation strategy measures. Epidemiology (Cambridge, Mass.) 31 , 194.31809338
Fine JP and Gray RJ (1999). A proportional hazards model for the subdistribution of a competing risk. Journal of the American Statistical Association 94 , 496–509.
Gao G and Tsiatis AA (2005). Semiparametric estimators for the regression coefficients in the linear transformation competing risks model with missing cause of failure. Biometrika 92 , 875–891.
Gong G and Samaniego FJ (1981). Pseudo maximum likelihood estimation: theory and applications. The Annals of Statistics 9 , 861–869.
Hanfelt JJ , Peng L , Goldstein FC , and Lah JJ (2018). Latent classes of mild cognitive impairment are associated with clinical outcomes and neuropathology: Analysis of data from the national alzheimer’s coordinating center. Neurobiology of Disease 117 , 62–71.29859866
Hanfelt JJ , Wuu J , Sollinger AB , Greenaway MC , Lah JJ , Levey AI , (2011). An exploration of subgroups of mild cognitive impairment based on cognitive, neuropsychiatric and functional features: Analysis of data from the national alzheimer’s coordinating center. The American Journal of Geriatric Psychiatry 19 , 940–950.22024618
Hosmer DW Jr , Lemeshow S , and Sturdivant RX (2013). Applied Logistic Regression, volume 398 . John Wiley &amp; Sons.
Lu K and Tsiatis AA (2001). Multiple imputation methods for estimating regression coefficients in the competing risks model with missing cause of failure. Biometrics 57 , 1191–1197.11764260
Lu W and Liang Y (2008). Analysis of competing risks data with missing cause of failure under additive hazards model. Statistica Sinica 18 , 219–234.
McLachlan G and Peel D (2000). Finite Mixture Models. John Wiley &amp; Sons.
Muthén B , Brown CH , Masyn K , Jo B , Khoo S-T , Yang C-C , (2002). General growth mixture modeling for randomized preventive interventions. Biostatistics 3 , 459–475.
Peng L and Huang Y (2007). Survival analysis with temporal covariate effects. Biometrika 94 , 719–733.
Proust-Lima C , Joly P , Dartigues J-F , and Jacqmin-Gadda H (2009). Joint modelling of multivariate longitudinal outcomes and a time-to-event: a nonlinear latent class approach. Computational Statistics &amp; Data Analysis 53 , 1142–1154.
Scheike TH , Zhang MJ , and Gerds TA (2008). Predicting cumulative incidence probability by direct binomial regression. Biometrika 95 , 205–220.
Vermunt JK (2010). Latent class modeling with covariates: Two improved three-step approaches. Political Analysis 18 , 450–469.
Wang C-P , Hendricks Brown C , and Bandeen-Roche K (2005). Residual diagnostics for growth mixture models: Examining the impact of a preventive intervention on multiple trajectories of aggressive behavior. Journal of the American Statistical Association 100 , 1054–1076.
Welsh K , Butters N , Hughes J , Mohs R , and Heyman A (1991). Detection of abnormal memory decline in mild cases of alzheimer’s disease using cerad neuropsychological measures. Archives of Neurology 48 , 278–281.2001185
Xue Q-L and Bandeen-Roche K (2002). Combining complete multivariate outcomes with incomplete covariate information: a latent class approach. Biometrics 58 , 110–120.11890305
