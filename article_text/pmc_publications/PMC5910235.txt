LICENSE: This file is available for text mining. It may also be used consistent with the principles of fair use under the copyright law.


9713490
21159
Med Image Anal
Med Image Anal
Medical image analysis
1361-8415
1361-8423

29574399
5910235
10.1016/j.media.2018.03.004
NIHMS952135
Article
Riemannian Metric Optimization on Surfaces (RMOS) for Intrinsic Brain Mapping in the Laplace-Beltrami Embedding Space
Gahm Jin Kyu
Shi Yonggang *
for the Alzheimer’s Disease Neuroimaging Initiative†
Laboratory of Neuro Imaging, Mark and Mary Stevens Neuroimaging and Informatics Institute, Keck School of Medicine of University of Southern California, Los Angeles, CA 90033
* Postal address: 2025 Zonal Ave., Los Angeles, CA 90033, United States. Tel.: +1 323 4427246. yshi@loni.usc.edu
† Data used in preparation of this article were obtained from the Alzheimers Disease Neuroimaging Initiative (ADNI) database (adni.loni.usc.edu). As such, the investigators within the ADNI contributed to the design and implementation of ADNI and/or provided data but did not participate in analysis or writing of this report. A complete listing of ADNI investigators can be found at: http://adni.loni.usc.edu/wp-content/uploads/how_to_apply/ADNI_Acknowledgement_List.pdf

21 3 2018
16 3 2018
5 2018
01 5 2018
46 189201
This file is available for text mining. It may also be used consistent with the principles of fair use under the copyright law.
Surface mapping methods play an important role in various brain imaging studies from tracking the maturation of adolescent brains to mapping gray matter atrophy patterns in Alzheimer’s disease. Popular surface mapping approaches based on spherical registration, however, have inherent numerical limitations when severe metric distortions are present during the spherical parameterization step. In this paper, we propose a novel computational framework for intrinsic surface mapping in the Laplace-Beltrami (LB) embedding space based on Riemannian metric optimization on surfaces (RMOS). Given a diffeomorphism between two surfaces, an isometry can be defined using the pullback metric, which in turn results in identical LB embeddings from the two surfaces. The proposed RMOS approach builds upon this mathematical foundation and achieves general feature-driven surface mapping in the LB embedding space by iteratively optimizing the Riemannian metric defined on the edges of triangular meshes. At the core of our framework is an optimization engine that converts an energy function for surface mapping into a distance measure in the LB embedding space, which can be effectively optimized using gradients of the LB eigen-system with respect to the Riemannian metrics. In the experimental results, we compare the RMOS algorithm with spherical registration using large-scale brain imaging data, and show that RMOS achieves superior performance in the prediction of hippocampal subfields and cortical gyral labels, and the holistic mapping of striatal surfaces for the construction of a striatal connectivity atlas from substantia nigra.

Laplace-Beltrami embedding
Cortex
Hippocampus
Striatum

1. Introduction

Surface mapping methods play an important role in various scientific discoveries from tracking the maturation of adolescent brains (Gogtay et al., 2004), mapping gray matter atrophy patterns in Alzheimer’s disease (AD) (Thompson et al., 2004), to studying early prenatal and postnatal brain development (Li et al., 2013; Nie et al., 2010). The backbone of surface mapping methods is the computational technique that establishes detailed one-to-one correspondences across different brain surfaces. In this work, we propose a novel computational framework for establishing surface correspondences in the Laplace-Beltrami embedding space (Rustamov, 2007). Our method is intrinsic to surface geometry, can incorporate various anatomical features, and is generally applicable to both cortical and subcortical structures.

To map brain surfaces from different subjects, both volume-based and surface-based registration methods have been developed. Using popular volume-based registration methods such as the Demons (Vercauteren et al., 2009; Thirion, 1998), and large deformation diffeomorphic metric mapping (LDDMM) (Beg et al., 2005), nonlinear maps can be computed between image volumes and thus obtain correspondences across different brain structures, but such methods may not accurately align the surface geometry. With LDDMM, sophisticated surface matching methods (Vaillant and Glaunès, 2005; Vaillant et al., 2007; Durrleman et al., 2009; Qiu et al., 2009; Charon and Trouve, 2013; Rekik et al., 2016) were further developed by deforming the ambient space, i.e., the 3D volume. In this approach, the surface correspondences are not optimized directly but rather obtained once the deformation is completed. The surface-based registration methods, on the other hand, optimize the detailed correspondences directly and utilize more of the intrinsic geometry on the surface instead of the 3D image space. This is in essence most related to the novel method we develop in this work, where we use intrinsic geometry that is isometry invariant to optimize surface correspondences. Previous surface mapping methods usually relied on parameterizing the surfaces with a canonical 2D domain such as the unit sphere (Fischl et al., 1999; Gu et al., 2004; Tosun and Prince, 2008; Davies et al., 2010; Yeo et al., 2010; Wang et al., 2012). After that, nonlinear warping was applied in this 2D domain to optimize the correspondences by matching anatomical or geometric features. This is the most widely used computational framework for popular tools such as FreeSurfer (Fischl et al., 1999) and FSL (Robinson et al., 2014), or entropy-based particle systems (Paniagua et al., 2012). There are, however, still fundamental numerical limitations with this framework. By mapping surfaces to a unit sphere that is drastically different from the original surface, large metric distortions are inevitable, which in turn will compromise the accuracy of all downstream calculations such as the numerical evaluation of gradients for nonlinear registration.

To overcome such limitation in spherical registration (Fig. 1), we propose a novel surface mapping framework based on the Laplace-Beltrami (LB) spectrum of anatomical surfaces, which has recently been successfully applied to various shape analysis tasks such as classification (Reuter et al., 2006; Lai et al., 2009; Konukoglu et al., 2013; Wachinger and Reuter, 2016), matching (Reuter et al., 2009; Shi et al., 2009), and topological modeling (Shi et al., 2008, 2013), and graph-based surface mapping (Lombaert et al., 2013a,b), where the graph Laplacian was used to compute the spectrum and match corresponding features on cortical surfaces. Using the eigen-system of the LB operator on triangular meshes, a novel embedding space was proposed for performing shape analysis (Rustamov, 2007; Lai et al., 2010). The fundamental advantage of this embedding space is that it is isometry invariant, which eliminates the metric distortion induced by conventional parameterization on unit sphere. Based on the equivalence of isometry and the minimization of the spectral-l2 distance in the LB embedding space proposed in Lai et al. (2010), we developed a novel surface mapping algorithm previously via conformal metric optimization on surfaces (CMOS) (Shi et al., 2014). One limitation of the CMOS approach, however, is that it only computes conformal maps and cannot incorporate rich geometric and anatomical features in the mapping process. To perform feature-driven surface mapping in the LB embedding space, we will develop in this paper novel algorithms to realize Riemannian metric optimization on surfaces (RMOS). Our new RMOS method is based on the equivalence of diffeomorphism and pullback metrics. Given any diffeomorphism between two surfaces, the pullback metric defines the isometry between two surfaces. For triangular meshes, the Riemannian metrics are weights defined on the edges and they fully determine the heat kernel on the triangular meshes (Zeng et al., 2012; Goes et al., 2014). Since the LB eigen-system is completely determined by the Riemannian metric, we can thus pose the computation of a diffeomorphism as a problem of finding the proper metric that minimizes an energy function in the LB embedding space. Unlike the conformal maps that have limited degree of freedom (Gu et al., 2004), we can easily incorporate the matching of desirable features during the RMOS process. For numerical implementation, our method iteratively updates the Riemannian metric on edges of triangular meshes to realize surface mapping in the LB embedding space. There is thus no need of worrying about numerical difficulties such as the flipping of triangles or self-intersection.

In our experimental results, we apply RMOS to map three critical neuroanatomical structures - the hippocampus, cortex, and striatum, and compare its performance with spherical registration. Large-scale datasets from the Alzheimer’s Disease Neuroimaging Initiative (ADNI) (Mueller et al., 2005) will be used in our hippocampal experiments. For the mapping of hippocampal surfaces, we use curvature features to drive the surface mapping process, and show that RMOS can achieve superior performance than spherical registration in predicting the subfield labels computed from the high resolution T2-weighted MRI from ADNI. For cortical surface mapping, the LONI Probabilistic Brain Atlas (LPBA40) (Shattuck et al., 2008) that consists of manually delineated cortical labels from 40 subjects will be used for validation. We demonstrate that our RMOS algorithm can generate better overlap of cortical labels than spherical registration. Using twenty subjects from the Human Connectome Project (HCP) (Essen et al., 2013), we also demonstrate RMOS on the holistic mapping of the striatal surfaces by comparing the performance of two types of vectorized features in constructing a substantia nigra (SN)-striatum connectivity atlas: anatomical neighboring context (ANC) (Gahm and Shi, 2017) and structural connectivity to cortical areas.

A preliminary version of this work appeared in conference papers (Gahm and Shi, 2016, 2017), where the focus was on quick application of the RMOS for surface mapping of specific subcortical structures such as the thalamus and striatum without a quantitative evaluation using large-scale data. Here we present the RMOS algorithm with more thorough algorithmic details and completely novel experimental results for the extensive validation of the RMOS mapping algorithm on both cortical and subcortical structures.

The rest of the paper is organized as follows. In Section 2, we introduce the mathematical background of LB embedding and Riemannian metric optimization. After that, we propose the RMOS framework and develop the numerical algorithms for energy minimization in Section 3. Experimental results will be presented in Section 4, where we compare the RMOS and spherical registration for the surface mapping of the hippocampus, cortex and striatum on large-scale data from ADNI, LPBA40 and HCP. Finally, conclusions will be made in Section 5.

2. Laplace-Beltrami Embedding and Riemannian Metrics on Triangular Meshes

In this section, we introduce the numerical computation of LB embedding on triangular meshes given their Riemannian metrics. After that, we derive the gradients of the LB embedding w.r.t. the Riemannian metrics that are critical for the metric optimization algorithm developed in Section 3.

Let ℳ = (𝒱, 𝒯) denote a triangular mesh where 𝒱 and 𝒯 are the set of vertices and triangles, respectively. For a triangular mesh, its Riemannian metric is denoted as a set of weights W = [w1, w2, ⋯, wm] on all m edges of the mesh (Zeng et al., 2012; Goes et al., 2014). For these weights to form a valid metric, they should be nonnegative and satisfy the triangular inequality on each triangle. As an illustration, we show in Fig. 2 the Riemannian metric on a triangle based on the metric induced from ℝ3, where the metric on an edge ViVj equals its length dij. Collectively the metrics on all edges form the weight vector W.

Given the Riemannian metric W, we can compute the LB eigen-system of ℳ by solving a generalized matrix eigenvalue problem (1) Qf=λUf,

where λ is an eigenvalue, f is an eigenfunction, and the matrices Q and U are defined as (Shi et al., 2014): Qij={12∑𝒱j∈𝒩(𝒱i)∑𝒯l∈𝒩(𝒱i,𝒱j)cot θlij,if i=j−12∑𝒯l∈𝒩(𝒱i,𝒱j)cot θlij,if 𝒱j∈𝒩(𝒱i)0,otherwise,

(2) Uij={16∑𝒯l∈𝒩(𝒱i)𝒜l,if i=j112∑𝒯l∈𝒩(𝒱i,𝒱j)𝒜l,if 𝒱j∈𝒩(𝒱i)0,otherwise,

where 𝒩(𝒱i) is the set of vertices in the 1-ring neighborhood of 𝒱i and 𝒩(𝒱i, 𝒱j) is the set of triangle sharing the edge (𝒱i, 𝒱j). As shown in Fig. 2, θlij is the angle in the triangle 𝒯l opposite to the edge (𝒱i, 𝒱j), and 𝒜l=12dikdjk sin θlij is the area of the triangle 𝒯l. Because of the dependence of the angles θlij and areas Al on the metrics, the matrices Q and U are functions of the Riemannian metric W, and thus we can derive the gradients of these two matrices w.r.t. the metrics as listed in Table 1.

By solving Eq. 1, we compute the LB eigen-system of the mesh ℳ. We denote the set of eigenfunctions as Φ = {f0, f1, f2, ⋯} and define an embedding IℳΦ:ℳ→ℝ∞ as proposed in Rustamov (2007): (3) IℳΦ(x)=(f1(x)λ1,f2(x)λ2⋯,fn(x)λn,⋯)∀x∈ℳ,

where λn and fn denote the n-th eigenvalue and eigenfunction, respectively. Based on the gradients of the matrices Q and U w.r.t. the metric W, we can also calculate the gradients of the LB embedding w.r.t. the metric. To compute the gradients of fn and λn w.r.t. a metric element wi ∈ W, we take the derivative on both sides of Eq. 1: (4) ∂Q∂wifn+Q∂fn∂wi=∂λn∂wiU fn+λn∂U∂wifn+λnU∂fn∂wi.

Following the numerical recipe in Nelson (1976), we calculate from Eq. 4 the gradient of λn w.r.t wi as: (5) ∂λn∂wi=fnT(∂Q∂wi−λn∂U∂wi)fn.

and the gradient of fn w.r.t. wi as the solution of an under-determined equation: (6) (Q−λnU)∂fn∂wi=Fn,

where we denote Fn=fnT(∂Q∂wi−λn∂U∂wi)fnU fn−(∂Q∂wi−λn∂U∂wi)fn.

In summary, we developed the numerical algorithm for the computation of the gradient of the LB eigen-system w.r.t. the Riemannian metric on a triangular mesh. This paves the way for the development of metric optimization algorithms that can compute surface maps in the LB embedding space while aligning anatomical or connectivity features.

3. RMOS-based Surface Mapping in the LB Embedding Space

With the aim of computing diffeomorphic surface maps that can effectively match the rich anatomical and functional features of brain structures, we develop the general RMOS framework for surface mapping in this section. Let us consider two brain surfaces as Riemannian manifolds: (ℳ1, g1) and (ℳ2, g2), where gi is the metric on ℳi(i = 1, 2). For any point p ∈ ℳ1, the metric g1(p) defines the inner product of vectors on the tangent plane at p. Let u : ℳ1 → ℳ2 be a diffeomorphic map from ℳ1 to ℳ2. Following the definition of diffeomorphism in differential geometry, we can map two vectors x1 and x2 on the tangent plane of p ∈ ℳ1 onto the tangent plane of u(p) ∈ ℳ2 and denote them as du(x1) and du(x2). We can then define the inner product of x1 and x2 as the inner product of du(x1) and du(x2) using the metric g2(u(p)) at u(p) ∈ ℳ2, which is called the pullback metric for ℳ1 induced by the map u. For every possible diffeomorphism from ℳ1 to ℳ2, we can thus induce an isometry between ℳ1 and ℳ2 via the pullback metric. Since the LB spectrum of a surface is completely determined by its Riemannian metric, the LB spectrum of ℳ1 generated by the pullback metric will match the LB spectrum of ℳ2. The pullback metric induced from a diffeomorphism shows mathematically the existence of Riemannian metrics that can align the LB embedding of ℳ1 and ℳ2. With the proposed RMOS framework, our goal is to search for the Riemannian metric that can minimize their distance in the LB embedding space while matching anatomical features, which will in turn produce the diffeomorphic maps between the two surfaces.

3.1. Energy Function

Let W1 and W2 denote their Riemannian metrics, i.e., the edge weights of two triangular meshes ℳ1 and ℳ2, respectively. We denote u1 : ℳ1 → ℳ2 as the map from ℳ1 to ℳ2 and u2 : ℳ2 → ℳ1 as the map from ℳ2 to ℳ1. Let ξ1j:ℳ1→ℝ and ξ2j:ℳ2→ℝ(j=1,2,⋯,L) denote the L feature functions on each surface (see Section 3.3). We define an energy function for feature-driven surface mapping with RMOS: (7) E=EF+γER,

where EF is the data fidelity term for matching given features, ER is the regularization term, and γ is the weight between the two terms. In this paper, we define the data fidelity term with an l2 energy as: (8) EF=∑j=1L[∫ℳ1(ξ1j−ξ2j○u1)2dℳ1+∫ℳ2(ξ2j−ξ1j○u2)2dℳ2].

This energy is symmetric w.r.t. both surfaces. It penalizes the mismatch between the original and mapped features.

We define the regularization term as: (9) ER=∑w1,i∈W1(w1,iw^1,i−1m1,i∑j∈𝒩1,iw1,jw^1,j)2+∑w2,i∈W2(w2,iw^2,i−1m2,i∑j∈𝒩2,iw2,jw^2,j)2,

where 𝒩1,i and 𝒩2,i are the sets of edges in the neighborhood (directly connected to the ith edge), m1,i and m2,i are the total numbers of the neighbor edges, and w1,i and w2,i (ŵ1,i and ŵ2,i) are the optimized metric (the standard metric induced from ℝ3, respectively) on the edge of ℳ1 and ℳ2. This term constrains the changes of metric ratios to be smooth.

3.2. Optimization Algorithm

We develop an iterative metric optimization algorithm to minimize the energy function and compute the surface maps. Given the metrics W1 and W2 at each iteration, we compute the eigen-systems of ℳ1 and ℳ2 up to the K-th order and denote them as (λ1,n, f1,n) and (λ2,n, f2,n)(n = 1, 2, ⋯, K), respectively. One of the common problem in constructing the LB embedding is the sign ambiguity of the eigenfunctions since there are 2K possible combinations of signs for the K eigenfunctions. A combination of the spectral-l2 distance and a multi-scale strategy was used in Shi et al. (2014) to resolve sign ambiguity. With feature-driven surface maps, we pick the sign combinations of the eigenfunctions that minimize EF as the initial embedding. Let Φ1 and Φ2 denote the set of eigenfunctions for ℳ1 and ℳ2, respectively, after removing the sign ambiguity. The LB embeddings of the two surfaces are then denoted as ℳ∼1=Iℳ1Φ1(ℳ1) and ℳ∼2=Iℳ2Φ2(ℳ2). In the embedding space, the maps are ũ1 : ℳ̃1 → ℳ̃2 and ũ2 : ℳ̃2 → ℳ̃1.

To minimize the energy function EF via metric optimization, we first construct a coarse correspondence, which we call a β-map, that transforms the energy into distance measurements in the embedding space. Let u∼1β:ℳ∼1→ℳ∼2 denote the β-map from ℳ̃1 to ℳ̃2, and u∼2β:ℳ∼2→ℳ∼1 denote the β-map from ℳ̃2 to ℳ̃1. We initialize the β-maps as the nearest point maps in the LB embedding space. After that, they are iteratively updated along the gradient descent direction in the tangent space of the meshes as follows: ∂EF∂u∼1β=−2∑j=1L(ξ1j−ξ2j○u∼1β)∇ℳ∼2ξ2j(u∼1β)

(10) ∂EF∂u∼2β=−2∑j=1L(ξ2j−ξ1j○u∼2β)∇ℳ∼1ξ1j(u∼2β),

where ∇ℳ̃1 and ∇ℳ̃2 are the intrinsic gradients on the surfaces ℳ̃1 and ℳ̃2. The β-maps are obtained by updating the maps for a fixed number of time steps.

Each point x ∈ ℳ̃1, u∼1β(x) can be discretized as a linear combination of vertex positions in ℳ̃2. Thus we can represent the β-maps: u∼1β and u∼2β as linear operators A and B, respectively. With the β-maps, we convert the data fidelity term EF into the distance energy ẼF in the embedding space defined in Shi et al. (2014): (11) E∼F(W1,W2)=∑n=1K((f1,nλ1,n−Af2,nλ2,n)TU1(f1,nλ1,n−Af2,nλ2,n)+(f2,nλ2,n−Bf1,nλ1,n)TU2(f2,nλ2,n−Bf1,nλ1,n)),

where the matrices U1 and U2 are defined in Eq. 2 with the metrics. Using the gradients of the LB eigen-system w.r.t. the Riemannian metrics derived in Section 2, we can compute the gradient of the energy w.r.t. to each element of the metrics. For example, the gradient of ẼF w.r.t. w1,i ∈ W1 is shown: (12) ∂E∼F∂w1,i=2∑n=1K[(1λ1,n∂f1,n∂w1,i−∂λ1,n∂w1,i(f1,n)T2λ1,n32)U1(f1,nλ1,n−Af2,nλ2,n)−(∂f1,n∂w1,iBTλ1,n−∂λ1,n∂w1,i(Bf1,n)T2λ1,n32)U2(f2,nλ2,n−Bf1,nλ1,n)].

By iteratively updating the metrics toward the gradient descent direction of ẼF, we deform the LB embedding of a surface toward its β-map, thus achieving the goal of minimizing the original energy in Eq. 8.

To minimize the energy ER w.r.t. the metric W1 and W2, we rewrite Eq. 9 in a matrix form: (13) ER=‖D1W1‖2+‖D2W2‖2,

and compute the gradients of ER as: (14) ∂ER∂Wh=2DhTDhWh(h=1,2),

where D1 and D2 are initially given and fixed because the mesh connectivity does not change during the optimization process. By combining the gradients of ẼF and ER, we obtain the final gradient descent direction to update the metrics as follows: (15) dWhdt=−(∂E∼F∂Wh+γ∼∂ER∂Wh)(h=1,2),

where γ̃ is the weight between ẼF and ER.

For the Riemannian metrics defined on the edges of triangular meshes to be valid, they also need to satisfy the triangular inequality on each face of the meshes. To meet this requirement, we use Rosen’s gradient projection method for linear constraints (Rosen, 1960), which projects the search direction onto the subspace tangent to any active constraints of triangular inequality. The active constraints are updated after every iteration of the metric optimization. For a triangle 𝒯l as illustrated in Fig. 2, we choose any constraint (dij + djk ≥ dik) as active if it satisfies dik &gt; ε (dij + djk), where the parameter ε sets the boundary band width. For all experiments in this paper, we set ε = 0.9. At each iteration, we assume there are r active constraints among a total of m edges on a mesh ℳh(h = 1, 2). These active constraints are represented as an m × r matrix Nh whose columns are the gradients of the constraints (−1, 0, or +1). A projection matrix Ph is then defined as: (16) Ph=I−Nh(NhTNh)−1NhT,

where I is the m × m identity matrix. For numerical efficiency, we calculate Ph using the QR factorization of Nh: (17) Ph=Q2,hTQ2,h,

where Q2,h is the matrix consisting of the last m − r rows of the Q factor matrix of Nh. Given the gradient descent direction dWh/dt computed in Eq. 15, we use Ph(dWh/dt) as the projected gradient descent direction to minimize E. Algorithm 1 RMOS at a given eigen-order K

Input: Surfaces ℳ1, ℳ2; feature functions ξ1, ξ2;	
Output: Optimized metrics: W1, W2; maps: μ1, μ2.	
1:	Initialize W1 and W2;	
2:	Compute the LB embedding of ℳ1 and ℳ2 with the current metric W1 and W2 after removing sign ambiguity in eigenfunctions;	
3:	Compute the β-maps: the nearest point maps A and B;	
4:	Update the β-maps: A and B for minimizing EF with the gradient of feature functions;	
5:	Calculate the gradients for minimizing E∼F:∂E∼F∂W1,∂E∼F∂W2;	
6:	Calculate the gradients for minimizing ER:∂ER∂W1,∂ER∂W2;	
7:	Form the final gradients dWhdt=−(∂E∼F∂Wh+γ^∂ER∂Wh) (h = 1, 2);	
8:	Compute the gradient projection matrices P1 and P2 for the constraints of triangular inequality;	
9:	Update the metric Wh with the projected gradients PhdWhdt (h = 1, 2);	
10:	Repeat Steps 2–9 until convergence of E;	
11:	Return the final maps μ1 and μ2 after Steps 2 and 3.	

In summary, the overall algorithm for surface mapping with RMOS at a given eigen-order is listed in Algorithm 1. To establish correspondences of the eigenfunctions between different surfaces before the iteration process, we search for the optimal embedding from possible sign combinations of the eigenfunctions as well as possible switching of the order of the eigenfunctions as done in CMOS (Shi et al., 2014). To map the surfaces at the maximum eigen-order Kmax specified by a user, we typically follow CMOS’ multi-scale strategy that starts with a low eigen-order Kinit and gradually increases the eigen-order to reach the maximum eigen-order Kmax. When we increase the eigen-order, the LB embedding and mapping results from the previous eigen-order are used as the initialization. The final maps are obtained via composition of the embeddings and the maps in the embedding space computed at the maximum eigen-order.

3.3. Anatomical and Connectivity Features for RMOS-based Mapping

The RMOS framework is flexible and can take general features to guide surface mapping in the LB embedding space. In this work we will demonstrate RMOS-based surface mapping using curvature features, and vectorized features of anatomical contextual information and connectivity. For the hippocampus and cortex, we will use the mean curvature (MC) to drive the surface mapping process, where the MC is computed on volume-normalized surfaces. For more challenging structures such as the striatum, we will use vectorized features that can better encode anatomically critical information than curvature features. One type of vectorized features is based on anatomical neighbor context (ANC) information that characterizes the geometric relation between neighboring brain structures. Given a surface ℳ and its C neighboring brain structures, we define the ANC feature at each vertex of ℳ as a vector of normalized distances to these neighboring structures. Let di (i = 1, 2, ⋯, C) denote the distance transform of the i-th (i = 1, ⋯, C) neighboring structure. Then, for each vertex Vj ∈ ℳ, its ANC is defined as: (18) ANC(Vj)=[d1(Vj)maxVk∈ℳd1(Vk),d2(Vj)maxVk∈ℳd2(Vk),⋯,dC(Vj)maxVk∈ℳdC(Vk)].

By normalizing each distance transform by its maximal value on the surface, we make the ANC feature invariant to scale differences.

Another type of vectorized features that may guide RMOS to achieve high-quality mapping is defined using brain connectivity. With the advance of human connectome research, there are great interests in computing brain surface maps with connectivity features (Gutman et al., 2014; Jiang et al., 2015). To define connectivity features on a surface, we first generate fiber tracts using probabilistic tractography with fiber orientation distributions (FODs) reconstructed from the multi-shell diffusion MRI data from HCP (Tran and Shi, 2015). Then we select multiple target regions that are topographically connected to different parts of the surface. For each target region, we define the connectivity at each vertex of the surface as the number of tracts that pass through the vertex neighborhood and reach the target region. Then we normalize the connectivity map to each target region by its maximal value on the surface, and form the vectorized feature of the connectivities at every vertex of the surface. Compared with local features derived from curvatures, the connectivity features as well as the ANC features help establish neuroanatomically more meaningful maps.

These rich features also boost our ability in resolving the sign and order ambiguities of the LB eigen-system, which is a critical step in shape analysis using the LB spectrum. During each step of the multi-scale strategy in (Shi et al., 2014), we compute the feature energy EF in Eq. 8 with the nearest point map in the embedding space to better estimate the right combination of the eigenfunctions between two different surfaces. This will help search for the optimal embedding in addition to the minimum spectral distance between the surfaces.

4. Experiments

In this section, we present experimental results to demonstrate the RMOS surface mapping algorithm and compare its performance with spherical registration on large-scale data from the ADNI1 and on the LPBA40 data. More specifically, we used T1-weighted and high resolution T2-weighted MRI scans from 380 subjects in ADNI, and the T1-weighted MRI of 40 subjects from LPBA40, and the connectome imaging data of 20 HCP subjects. The FreeSurfer segmentation results were used to extract the hippocampus masks from ADNI data in our experiments, and the mesh reconstruction method from the MOCA tool2 was applied to compute a genus zero representation of the hippocampus. Cortical surfaces from the LPBA40 data were reconstructed using the method in Shi et al. (2013). Hippocampal and cortical surfaces were resampled to 1K vertices (~2K edges) and 10K vertices (~20K edges), respectively, before running the surface mapping experiments. We also demonstrate RMOS mapping of the striatum using vectorized ANC and connectivity features to generate a surface-based connectivity atlas from 20 HCP subjects. Following the holistic approach of striatal mapping (Gahm and Shi, 2017), we obtained masks of the left striatum by merging the caudate, putamen and accumbens nuclei segmented out from T1-weighted MRI by FSL, and generated striatal surfaces with 1K vertices and 1996 edges using MOCA.

The RMOS method started with the standard metric induced from ℝ3, and iteratively updated the Riemannian metric until no more decrease of the energy could be achieved. In the experiments on hippocampal and striatal surfaces, we started with the eigen-order at 10 and iteratively increased the eigen-order by 5 until it reached 30 (and 60, respectively), where a maximum of 200 iterations was set at the final eigen-order. For cortical surface mapping, we fixed the eigen-order at 6 with a maximum of 200 iterations. For the selection of the regularization parameter, we used an adaptive approach that dynamically changes γ̃ at every iteration such that the maximum gradient magnitudes of ẼF and ER have a constant ratio γ̃, which we fixed as 0.1 in all our experiments. The RMOS computational process took about 2.5, 4, and 18 hours on a 16-core 2.6-GHz Intel Xeon CPU (multi-threading enabled) with maximal memory consumption around 900MB, 2GB, and 20GB for hippocampal, striatal, and cortical surfaces, respectively.

4.1. Hippocampal Mapping with Curvature Feature

In the first experiment, we demonstrate the RMOS algorithm and compare its performance with spherical registration on mapping a pair of left hippocampal surfaces from the ADNI data. The mesh representation of the hippocampal surfaces colored with their MC are shown in Fig. 3 (A) and (B). While the RMOS algorithm is symmetric with respect to both surfaces, we will reference one surface as the source and the other one as the target surface for convenience in our description. The two surfaces are clearly non-isometric, which leads to large differences in their LB eigenfunctions. For example, we show in Fig. 4 (A) and (B) the 5th and 7th eigenfunctions of both surfaces. The drastically different color patterns clearly illustrate the need of metric optimization if we want to match these two surfaces in the LB embedding space.

To visualize the results of RMOS, we first calculated a map of metric changes as the ratio of the optimized metric with respect to the original edge length. After that, we interpolated this map of metric changes onto the vertices for visualization on the surfaces as shown in Fig. 4 (C) and (D). With the optimized metrics, we can see the eigenfunctions of both surfaces become very well matched as plotted in Fig. 4 (E) and (F). From the optimized LB embeddings, we calculate the detailed surface maps as the point-wise correspondences in the embedding space. To visualize these maps, we projected the source surface onto the target surface, and pulled back MC from the target surface to the source surface as shown in Fig. 3 (C) and (D). We can see that RMOS is able to match the anatomical features very well while preserving the regularity of the mesh structure. To quickly demonstrate the improvement achieved by RMOS as compared to the CMOS algorithm(Shi et al., 2014), we applied the CMOS algorithm to the two hippocampal surfaces with the same eigen-order of 30 and 200 iterations. Using the CMOS map, we pulled back the MC features from the target surface onto the source surface and plotted the result in Fig. 3 (E). We can see that the CMOS method failed to accurately align the anatomical features of these two hippocampal surfaces, which is not surprising since no curvature feature was used in the CMOS algorithm.

As a comparison, we also applied spherical registration to map these two surfaces with the same MC feature. We combined two popular tools to achieve spherical registration of hippocampal surfaces. First we applied the SPHARM-MAT tool (Shen and Makedon, 2006) to compute the spherical map of hippocampal surfaces and rigidly align them on the unit sphere. The spherically mapped surfaces are shown in Fig. 5 (A). The large and irregular metric distortions are easily visible and indicate the challenges for downstream spherical registration. After that, we ran FreeSurfer’s mris_register (Fischl et al., 1999) to perform nonlinear registration on the sphere. The final maps between the hippocampal surfaces were computed by combining the spherical map and the nonlinear registration on the sphere. Similar to the RMOS results, we also projected the source surface onto the target surface with the map from the spherical registration, and pulled back MC from the target surface to the source surface as shown in Fig. 5 (B) and (C). From Fig. 5 (B), we can observe severe distortions are present in several parts of the projected mesh, which might explain the inaccuracy in the matching of the anatomical features as shown in Fig. 5 (C) (compared to Fig. 3 (A) and (D)). For a more quantitative evaluation of the mesh distortion during hippocampal mapping, we also calculated the ratio between the length of corresponding edges of the source mesh and its projection onto the target surface. The distributions of the edge length distortion ratio from the RMOS and spherical registration are plotted in Fig. 5. Taken together, RMOS clearly achieved superior performance with better matching of anatomical features and less metric distortion.

4.2. Prediction of Hippocampal Subfields

In the second experiment, we evaluate the performance of the proposed RMOS algorithm and the conventional spherical registration approach in the prediction of hippocampal subfields. For this purpose, we used the data from a pilot project in ADNI 2 that collected both T1-weighted and high resolution T2-weighted MRI from 380 subjects (105 normal controls (NC), 132 early mild cognitive impairment (EMCI), 92 late mild cognitive impairment (LMCI), and 51 patients with AD). All hippocampal surfaces were generated from FreeSurfer segmentation using only the T1-weighted MRI. In our experiments, the left hippocampal surfaces from the 380 subjects were used. The MC was used as the feature to drive both the RMOS and spherical registration methods that map an atlas surface (source), which was randomly selected from the 380 subjects, to every other surface (target) as shown in Fig. 6 (A) and (B). For both mapping methods, the same parameters and experimental setups as used in Sect. 4.1 were applied to this large-scale experiment.

Segmentation of the hippocampal subfields was generated from the high resolution T2-weighted MRI using a tool included in FreeSurfer 6.0 (Iglesias et al., 2015) at the same time of T1-weighted MRI reconstruction. Then we projected the subfield label volume onto the hippocampal surface by assigning the label of the closest voxel to each vertex on the surface. Using the maps from the atlas surface to each subject surface, we pulled back the subfield labels of each subject to the atlas surface. Figure 6 (C) and (D) shows an example of the pullback labels from one subject surface (B) to the atlas surface (A) with the maps computed by RMOS and spherical registration, respectively. We can clearly see that the pullback labels with the RMOS map agreed much better with the labels on the atlas surface in Fig. 6 (A). For quantitative evaluation of the performance of both surface mapping methods in the prediction of subfield labels, we computed the Dice coefficient (DC) between the pullback and atlas labels. As shown in Fig. 6 (A) and (B), several labels have scattered distribution that are unstable across subjects. We thus used three combined labels for our calculation of the DCs including Sub: subiculum + parasubiculum + presubiculum; CA1: CA1 + HATA; CA2/3/4: CA2/3 + CA4 + GC-DG + fimbria + fissure. For these three combined subfield labels, box plots of the DCs are shown in Fig. 6 (E) and (F). We can see that RMOS produced much higher DCs than the spherical registration method. Overall RMOS results generated a median DCs of 0.9 for the Sub and CA1 region, and 0.86 for the CA2/3/4 region. There was no statistically significant difference across the disease groups in terms of the DC. This shows that the RMOS method is able to align the subfields very well without using the high resolution T2-weighted MRI.

4.3. Validation of Cortical Surface Mapping

In this experiment, we compare the performance of RMOS and spherical registration on mapping cortical surfaces using data from the LPBA40 atlas(Shattuck et al., 2008). For each of the 40 subjects from the LPBA40 atlas, we extracted the left cortical surface, decimated it to 10K vertices, and projected the 24 manually delineated gyral labels onto the surface as shown in Fig 8. One randomly selected cortical surface was chosen as the atlas and its maps to all other surfaces were computed with RMOS and spherical registration. We computed the overlap of the gyral labels on the atlas surface and other subject surfaces to evaluate the performance of RMOS and spherical registration in aligning cortical anatomy. The RMOS algorithm was driven by the MC of each surface. The atlas surface (source) and one subject surface (target) are shown in Fig. 7 (A) and (B), respectively. Using the maps computed by RMOS, we projected the atlas surface onto the target surface (Fig. 7 (C)), and pulled back the MC from the target surface to the atlas surface (Fig. 7 (D)). For spherical registration, with the same decimated cortical surfaces, we first computed a spherical map for each surface using FreeSurfer’s mris_inflate and mris_sphere to generate projection of the surface onto the unit sphere as shown in Fig. 7 (E) and (F). Then we ran mris_register from the atlas sphere to the subject spheres using the same MC features with no additional features such as the sulcal depth, and computed the surface maps as the point-wise correspondences on the spheres. The pullback MC from the target to the source sphere and the pullback MC from the target to source surface by the spherical registration map are shown in Fig. 7 (G) and (H), respectively. By comparing the pull-back MC generated by the RMOS (Fig. 7 (D)) and spherical registration of FreeSurfer (Fig. 7 (H)) with the original MC of the atlas surface (Fig. 7 (A)), we can see that the results from spherical registration have significant mismatch, particularly on the precentral and postrcentral areas (highlighted by the dashed ellipsoids in Fig. 7 (D) and (H)).

For the quantitative comparison of the RMOS and spherical registration algorithm, we pulled back the cortical labels from all subjects using these surface maps to the atlas surface and compared their overlap with the corresponding label of the atlas surface. Note that we did not use sophisticated cortical labeling algorithm such as label fusion (Shi et al., 2014) and Markov random field (MRF) (Fischl et al., 2004). The raw overlap measure will serve as the prediction accuracy of gyral labels purely based on the surface maps. For each of the 24 regions, we computed the DC between the atlas label and the pullback labels from all other subjects generated the RMOS or spherical registration. The box plots of the DCs of each region and surface mapping method are shown in Fig. 8 (E). For each region, we also performed a t-test to compare if the difference of the DCs from RMOS and spherical registration is significant. Among the 24 cortical areas, RMOS achieved significantly better performance (p-value&lt;0.05) in 16 areas as marked with asterisks on the axis of the box plots in Fig. 8 (E). In particular, the improvements of RMOS as compared to spherical registration are highly significant in 9 of the 16 cortical regions as marked with double asterisks in Fig. 8 (E) that include the precentral and postrcentral areas we highlighted in Fig. 7 (D) and (H). In all other regions, RMOS also achieved slightly higher or similar level of accuracy as compared to results from spherical registration.

4.4. Striatal Surface Mapping with Vectorized Features

In this experiment, we demonstrate the RMOS algorithm on the holistic mapping of striatal surfaces with vectorized features which can be more powerful than curvature features in encoding anatomically critical information. Striatum is an essential part of the cortico-striatal-thalamo-cortical (CSTC) network that connects the cortex and other basal ganglia structures including substantia nigra (SN) (Shepherd, 2013). Conventional morphometry studies typically divide the striatum into three parts: the caudate, putamen, and accumbens nuclei (Muralidharan et al., 2014; Mamah et al., 2016). Recent connectivity research (Tziortzi et al., 2014; Jaspers et al., 2017) and animal studies(Burguière et al., 2013), however, indicate that striatum functions do not follow such subdivisions and it is more natural to map the striatum as a holistic structure (Gahm and Shi, 2017). With the holistic approach, we applied both the ANC and cortical connectivity features described in Section 3.3 to drive the RMOS algorithm to map the striatal surfaces and compare their performance in studying the connectivity between SN and striatum.

Brain imaging data from 20 HCP subjects were used in this experiment. For each subject, we first extracted the left striatal surfaces from the T1-weighted MRI, and then manually delineated a mask of the SN for constructing SN-striatum connectivity. We computed the ANC features with respect to the three neighbor structures: the lateral ventricle, insular cortex and pallidum (Gahm and Shi, 2017). We also generated on each striatal surface the connectivity feature maps to seven cortical regions: orbitofrontal (medial only), middle/inferior-frontal, superior-frontal, precentral, parietal, occipital and temporal cortices using probabilistic tractography based on FODs reconstructed from the multi-shell diffusion MRI data (Gahm and Shi, 2016, 2017). With the FOD-based tractography, we also generated an independent SN-striatal connectivity map on each striatal surface with SN as the seed and striatum as the target region (Fig. 9 (A)).

Then we computed the first set of RMOS maps between one reference striatal surface and the other 19 striatal surfaces using the three ANC features plus the MC feature. A second set of RMOS maps between the reference surface and the other 19 surfaces were computed with the connectivity features plus the MC feature. The same regularization parameters were used in the computation of both sets of RMOS maps. For RMOS maps computed with each type of features, the SN connectivity map on each surface was pulled back to the reference surface. At every vertex on the reference surface, we thus have a vector of 20 SN-striatal connectivity values, which was then binarized with a threshold (0.1). The probabilistic SN-striatum connectivity atlas is defined at each vertex on the reference surface as the summation of the binarized connectivity values divided by the total number of subjects. The probabilistic atlases of SN-striatum connectivity built with ANC-driven and connectivity-driven RMOS are shown in Fig. 9 (B) and (C), respectively, where the probabilistic atlas were thresholded at 50% to show the most concentrated connections. It is observed that SN is strongly connected to the dorsal striatum while there is little connection to the ventral striatum. More importantly, the atlas built with ANC-driven RMOS is comparable to that built with RMOS purely using connectivities to other cortical areas. This shows that the ANC features derived solely from T1-weighted MRI is able to guide the RMOS algorithm to achieve comparable mapping of anatomical regions without connectivity features from multi-shell diffusion MRI, which is not always available in clinical imaging research.

5. Discussion and Conclusion

In this paper we developed a novel computational framework for feature-driven surface mapping in the LB embedding space. The key idea in our method is the iterative optimization of the Riemannian metric on mesh edges to enable the matching of LB embeddings and associated anatomical features from different surfaces. Compared with conventional methods based on spherical registration, the main advantage of performing surface mapping in the LB embedding space is that there is no significant parameterization-induced distortion. All the metric deformation computed by the RMOS algorithm is for establishing the detailed correspondences across subjects, thus eliminating unnecessary distortions in classic parameterization.

Note that the motivation of surface mapping in the LB embedding space was that ideally there is no metric distortion during embedding. In practice we used a finite number of eigenfunctions in our numerical optimization for computational efficiency. Following Shi et al. (2014), we determined the number of eigenfunctions as a trade-off between embedding quality and computational cost by considering the metric distortion as a function of the number of eigenfunctions. As demonstrated in our experiments, such approximations can still generate high quality surface maps that outperform existing methods based on spherical registration. The ultimate value of surface mapping methods for brain imaging research also depend on the accurate segmentation of the brain structures under study. Errors in segmentation results can no doubt affect the downstream surface mapping algorithms, such as the correct alignment of brain structures on the sphere or the resolution of sign ambiguity in the proposed RMOS algorithm. With fast advances in MRI technology (higher resolution at 7T) and learning-based image segmentation, we anticipate more accurate segmentation tools will be available and further enhance the usability of surface-based mapping methods. In our cortical mapping experiments in Section 4.3, triangular meshes of 10K vertices were used, which were obtained by decimating the cortical surfaces generated by FreeSurfer. At this resolution, we showed that improved gyral labeling can be achieved with the proposed RMOS algorithm. For future work, we will focus on improving the computational efficiency of the RMOS algorithm with techniques such as multi-threading and GPU programming, and apply it to map cortical surfaces with higher spatial resolution.

While we demonstrated the RMOS algorithm on cortical and two subcortical structures: hippocampus and striatum, the mapping framework is general and applicable for other anatomical structures. In our future research, we will apply the RMOS algorithm to map brain structures with various structural and functional connectivity features. We will also conduct more extensive validation experiments on large-scale brain imaging studies of various patient populations to further our understanding of this general framework.

This work was in part supported by the National Institute of Health (NIH) under Grant R01EB022744, P41EB015922, U01EY025864, U01AG051218, P50AG05142, P01AG026572, and by the 2016 Boerger Research Fund for Alzheimers Disease and Neurocognitive Disorders Award from the Foundation of the ASNR.

Part of the data used in this project were provided by the Alzheimer’s Disease Neuroimaging Initiative (ADNI) (National Institutes of Health Grant U01 AG024904). ADNI is funded by the National Institute on Aging, the National Institute of Biomedical Imaging and Bioengineering, and through generous contributions from the following: AbbVie, Alzheimers Association; Alzheimers Drug Discovery Foundation; Araclon Biotech; BioClinica, Inc.; Biogen; Bristol-Myers Squibb Company; CereSpir, Inc.; Cogstate; Eisai Inc.; Elan Pharmaceuticals, Inc.; Eli Lilly and Company; EuroImmun; F. Hoffmann-La Roche Ltd and its affiliated company Genentech, Inc.; Fujirebio; GE Healthcare; IXICO Ltd.; Janssen Alzheimer Immunotherapy Research &amp; Development, LLC.; Johnson &amp; Johnson Pharmaceutical Research &amp; Development LLC.; Lumosity; Lundbeck; Merck &amp; Co., Inc.; Meso Scale Diagnostics, LLC.; NeuroRx Research; Neurotrack Technologies; Novartis Pharmaceuticals Corporation; Pfizer Inc.; Piramal Imaging; Servier; Takeda Pharmaceutical Company; and Transition Therapeutics. The Canadian Institutes of Health Research is providing funds to support ADNI clinical sites in Canada. Private sector contributions are facilitated by the Foundation for the National Institutes of Health (www.fnih.org). The grantee organization is the Northern California Institute for Research and Education, and the study is coordinated by the Alzheimers Therapeutic Research Institute at the University of Southern California. ADNI data are disseminated by the Laboratory for Neuro Imaging at the University of Southern California.

Part of the data used in this paper were also provided by the Human Connectome Project, WU-Minn Consortium (Principal Investigators: David Van Essen and Kamil Ugurbil; 1U54MH091657) funded by the 16 NIH Institutes and Centers that support the NIH Blueprint for Neuroscience Research; and by the McDonnell Center for Systems Neuroscience at Washington University.

Figure 1 A conceptual comparison of (A) the conventional method based on spherical registration and (B) the proposed metric optimization framework in the Laplace-Beltrami embedding space. In both (A) and (B), M1 and M2 denote the brain surfaces in the image space. In (A), M̃1 and M̃2 denote their spherical maps, and ũ1 and ũ2 denote the maps between the spherical maps of both surfaces. In (B), M̃1 and M̃2 denote the LB embeddings of M1 and M2, and ũ1 and ũ2 denote the maps between their LB embeddings. The fundamental advantage of the metric optimization framework in (B) is that there is no extra distortion induced by the parameterization process, and all the metric changes are induced to match the two surfaces. On the other hand, the spherical mapping process in (A) introduces large metric distortions purely for the parameterization step, which can lead to large errors in the final maps.

Figure 2 For a triangle 𝒯l ∈ 𝒯, which is composed of three vertices (𝒱i, 𝒱j, 𝒱k), the notations for its angles and metrics on each edge are shown.

Figure 3 RMOS mapping of two left hippocampal surfaces: (A) Source and (B) target surfaces colored with mean curvature, (C) Projection of the source onto the target surface, (D) The pullback mean curvature from the target surface onto the source surface. (E) CMOS mapping results: the pullback mean curvature from the target surface onto the source surface with the map from CMOS.

Figure 4 An illustration of the effect of RMOS on the LB eigenfunctions of surfaces. In (A) and (B), we show the 5th (left) and 7th (right) eigenfunctions before RMOS of the source and target surfaces, respectively. In (E) and (F), we show the 5th (left) and 7th (right) eigenfunctions after RMOS of the source and target surfaces, respectively. The optimized metrics for the source and target surfaces are plotted in (C) and (D), respectively.

Figure 5 Results from spherical mapping. (A) Spherical parametrization of the source (top) and target (bottom) mesh by SPHARM-MAT (colored with MC of the original mesh shown in Fig. 3 (A) and (B)). (B) Projection of the source onto target surface with the map computed by FreeSurfer. (C) The pullback MC from the target surface onto the source surface with the map from FreeSurfer. (D) Histogram of edge length distortion ratio (RMOS: 1.01 ± 0.29; Spherical Mapping: 1.09 ± 0.55 [Mean ± STD]).

Figure 6 Validation of hippocampal mapping algorithms with subfield labels generated from high resolution T2-weighted MRIs of 380 subjects. (A) The atlas surface colored by subfield labels. (B) An example subject surface used as the target surface. The colorbar on the right shows the complete list of subfield labels produced by FreeSurfer 6.0. The pullback labels from the target surface to the atlas surface with RMOS and spherical registration are shown in (C) and (D), respectively. Box plots of the Dice coefficients that measure the overlap of the pullback labels from each subject and the atlas surface labels with maps from RMOS and spherical registration are shown in (E) and (F), respectively. Three main labels are used. Sub: subiculum + parasubiculum + presubiculum; CA1: CA1 + HATA; CA2/3/4: CA2/3 + CA4 + GC-DG + fimbria + fissure. The results from different patients groups (Normal, EMCI, LMCI, and AD) are also plotted separately.

Figure 7 A comparison of mapping results between two left cortical surfaces based on RMOS and spherical registration. (A) Source and (B) target surfaces colored with mean curvature. (C) Projection of the source onto the target surface by the map from RMOS. (D) The pullback mean curvature from the target surface onto the source surface by the RMOS map. Spherical maps of the source (E) and target (F) surfaces as colored with the same mean curvature in (A) and (B), respectively. (G) The pullback mean curvature from the target sphere onto the source sphere by the map from the spherical registration of FreeSurfer. (H) The pullback mean curvature from the target surface onto the source surface using the map from spherical registration.

Figure 8 Validation of cortical mapping algorithms with manual labels from the LPBA40 atlas. Each cortical surface has 24 manually delineated gyral labels. Lateral and medial view of (A) the atlas surface, and (B) one of the subject surfaces. The pullback labels from the target surface onto the atlas surface with RMOS and FreeSurfer’s spherical registration are shown in (C) and (D), respectively. (E) Box plots of the Dice coefficients (DCs) between the pullback labels from each subject and the corresponding labels on the atlas surface with maps from RMOS and spherical registration are shown in (E). Labels with significantly different DCs between the two methods are marked with one asterisk (p-value&lt;0.05) or double asterisks (p-value&lt;0.005).

Figure 9 Construction of the probabilistic atlas of substantia nigra (SN)-striatum connectivity using data from 20 HCP subjects. (A) FOD-based tractography between the left SN and striatum from one HCP subject. (B) The probabilistic SN-striatum connectivity atlas built with ANC-driven RMOS maps. (C) The probabilistic SN-striatum connectivity atlas built with RMOS maps driven by cortical connectivity features.

Table 1 Non-zero gradient elements of Q and U w.r.t. the metric (length) of an edge 𝒱i𝒱j, i.e., dij. Because Q and U are symmetric, ∂Q/∂dij and ∂U/∂dij are also symmetric. Each edge has two neighboring triangles: 𝒯l1 and 𝒯l2, where 𝒜l1 and 𝒜l2 are their areas, and ℬl1 and ℬl2 are the product of their edge lengths. The third vertex in these two triangles are 𝒱k1 and 𝒱k2.See Fig. 2 for additional information about notations of the angles in triangles.

∂Qii∂dij=−14[(dij𝒜l1sin2θl1ij−dik1cos θl1jk1𝒜l1sin2θl1ik1)+(dij𝒜l2sin2θl2ij−dik2cos θl2jk2𝒜l2sin2θl2ik2)],	
∂Qii∂dij=14(dij𝒜l1sin2θl1ij+dij𝒜l2sin2θl2ij),	
∂Qii∂dij=−14[(dij𝒜l1sin2θl1ij−djk1cos θl1ik1𝒜l1sin2θl1jk1)+(dij𝒜l2sin2θl2ij−djk2cos θl2ik2𝒜l2sin2θl2jk2)],	
∂Qk1k1∂dij=14(dik1cos θl1jk1𝒜l1sin2θl1ik1+djk1cos θl1ik1𝒜l1sin2θl1jk1),	
∂Qk2k2∂dij=14(dik2cos θl2jk2𝒜l2sin2θl2ik2+dk2j cos θl2ik2𝒜l2sin2θl2jk2),	
∂Qik1∂dij=−14dik1cos θl1jk1𝒜l1sin2θl1ik1,∂Qjk1∂dij=−14djk1cos θl1ik1𝒜l1sin2θl1jk1,	
∂Qik2∂dij=−14dik2cos θl2jk2𝒜l2sin2θl2ik2,∂Qjk2∂dij=−14djk2cos θl2ik2𝒜l2sin2θl2jk2,	
∂Uii∂dij=124(ℬl1𝒜l1cos θl1ij+ℬl2𝒜l2cos θl2ij),	
∂Uij∂dij=148(ℬl1𝒜l1cos θl1ij+ℬl2𝒜l2cos θl2ij),	
∂Ujj∂dij=124(ℬl1𝒜l1cos θl1ij+ℬl2𝒜l2cos θl2ij),	
∂Uk1k1∂dij=124ℬl1𝒜l1cos θl1ij,∂Uk2k2∂dij=124ℬl2𝒜l2cos θl2ij,	
∂Uik1∂dij=124ℬl1𝒜l1cos θl1ij,∂Ujk1∂dij=124ℬl1𝒜l1cos θl1ij,	
∂Uik2∂dij=124ℬl2𝒜l2cos θl2ij,∂Ujk2∂dij=124ℬl2𝒜l2cos θl2ij	

1 Data used in the preparation of this article were obtained from the Alzheimers Disease Neuroimaging Initiative (ADNI) database (adni.loni.usc.edu). The ADNI was launched in 2003 as a public-private partnership, led by Principal Investigator Michael W. Weiner, MD. The primary goal of ADNI has been to test whether serial magnetic resonance imaging (MRI), positron emission tomography (PET), other biological markers, and clinical and neuropsychological assessment can be combined to measure the progression of mild cognitive impairment (MCI) and early Alzheimers disease (AD). For up-to-date information, see www.adni-info.org.

2 https://www.nitrc.org/projects/moca_2015


Beg MF Miller MI Trouvé A Younes L 2005 Computing large deformation metric mappings via geodesic flows of diffeomorphisms Int’l Journal of Computer Vision 61 139 157
Burguière E Monteiro P Feng G Graybiel AM 2013 Optogenetic stimulation of lateral orbitofronto-striatal pathway suppresses compulsive behaviors Science 340 1243 1246 23744950
Charon N Trouve A 2013 The varifold representation of nonoriented shapes for diffeomorphic registration SIAM Journal on Imaging Sciences 6 2547 2580
Davies RH Twining CJ Cootes TF Taylor CJ 2010 Building 3-D statistical shape models by direct optimization IEEE Trans. Med. Imag 29 961 981
Durrleman S Pennec X Trouvé A Ayache N 2009 Statistical models of sets of curves and surfaces based on currents Med. Image. Anal 13 793 808 19679507
Essen DCV Smith SM Barch DM Behrens TE Yacoub E Ugurbil K 2013 The WU-Minn human connectome project: An overview NeuroImage 80 62 79 23684880
Fischl B van der Kouwe A Destrieux C Halgren E Sagonne F Salat DH Busa E Seidman LJ Goldstein J Kennedy D Caviness V Makris N Rosen B Dale AM 2004 Automatically parcellating the human cerebral cortex Cerebral Cortex 14 11 22 14654453
Fischl B Sereno MI Dale AM 1999 Cortical surface-based analysis II: Inflation, flattening, and a surface-based coordinate system NeuroImage 9 195 207 9931269
Gahm JK Shi Y 2016 Riemannian metric optimization for connectivity-driven surface mapping Proc. Med. Image Comput. Comput. Assist. Interv., Part I 228 236
Gahm JK Shi Y 2017 Holistic mapping of striatum surfaces in the Laplace-Beltrami embedding space Proc. Med. Image Comput. Comput. Assist. Interv., Part I 21 30
Goes Fd Memari P Mullen P Desbrun M 2014 Weighted triangulations for geometry processing ACM Trans. Graph 33 28:1 28:13
Gogtay N Giedd JN Lusk L Hayashi KM Greenstein D Vaituzis AC Nugent TF Herman DH Clasen LS Toga AW Rapoport JL Thompson PM 2004 Dynamic mapping of human cortical development during childhood through early adulthood Proc. Natl. Acad. Sci. U.S.A 101 8174 8179 15148381
Gu X Wang Y Chan TF Thompson PM Yau ST 2004 Genus zero surface conformal mapping and its application to brain surface mapping IEEE Trans. Med. Imag 23 949 958
Gutman B Leonardo C Jahanshad N Hibar D Eschenburg K Nir T Villalon J Thompson P 2014 Registering cortical surfaces based on whole-brain structural connectivity and continuous connectivity analysis Proc. Med. Image Comput. Comput. Assist. Interv., Part III 161 168
Iglesias JE Augustinack JC Nguyen K Player CM Player A Wright M Roy N Frosch MP McKee AC Wald LL Fischl B Leemput KV 2015 A computational atlas of the hippocampal formation using ex vivo, ultra-high resolution MRI: Application to adaptive segmentation of in vivo MRI NeuroImage 115 117 137 25936807
Jaspers E Balsters JH Kassraian Fard P Mantini D Wenderoth N 2017 Corticostriatal connectivity fingerprints: Probability maps based on resting-state functional connectivity Hum. Brain Mapp 38 1478 1491 27859903
Jiang X Zhang T Zhu D Li K Chen H Lv J Hu X Han J Shen D Guo L 2015 Anatomy-guided dense individualized and common connectivity-based cortical landmarks (A-DICCCOL) IEEE Trans. Biomed. Eng 62 1108 1119 25420253
Konukoglu E Glocker B Criminisi A Pohl KM 2013 WESD – weighted spectral distance for measuring shape dissimilarity IEEE Trans. Pattern Anal. Machine Intell 35 2284 2297
Lai R Shi Y Dinov I Chan TF Toga AW 2009 Laplace-Beltrami nodal counts: A new signature for 3D shape analysis Proc. IEEE Int. Symp. Biomed. Imaging 694 697 21339849
Lai R Shi Y Scheibel K Fears S Woods R Toga A Chan T 2010 Metric-induced optimal embedding for intrinsic 3D shape analysis Proc. IEEE Comput. Soc. Conf. Comput. Vis. Pattern Recognit 2871 2878
Li G Nie J Wang L Shi F Lin W Gilmore JH Shen D 2013 Mapping region-specific longitudinal cortical surface expansion from birth to 2 years of age Cerebral cortex 23 2724 2733 22923087
Lombaert H Grady L Polimeni JR Cheriet F 2013a FOCUSR: Feature oriented correspondence using spectral regularization – a method for precise surface matching IEEE Trans. Pattern Anal. Machine Intell 35 2143 2160
Lombaert H Sporring J Siddiqi K 2013b Diffeomorphic spectral matching of cortical surfaces Proc. Inf. Process. Med. Imaging 376 389
Mamah D Alpert KI Barch DM Csernansky JG Wang L 2016 Subcortical neuromorphometry in schizophrenia spectrum and bipolar disorders NeuroImage Clin 11 276 286 26977397
Mueller S Weiner M Thal L Petersen RC Jack C Jagust W Trojanowski JQ Toga AW Beckett L 2005 The Alzheimer’s disease neuroimaging initiative Clin. North Am 15 869 877 xi xii
Muralidharan P Fishbaugh J Johnson HJ Durrleman S Paulsen JS Gerig G Fletcher PT 2014 Diffeomorphic shape trajectories for improved longitudinal segmentation and statistics Proc. Med. Image Comput. Comput. Assist. Interv., Part III 49 56
Nelson R 1976 Simplified calculation of eigenvector derivatives AIAA Journal 14 1201 1205
Nie J Guo L Li G Faraco C Miller LS Liu T 2010 A computational model of cerebral cortex folding Journal of theoretical biology 264 467 478 20167224
Paniagua B Bompard L Cates J Whitaker R Datar M Vachet C Styner M 2012 Combined SPHARM-PDM and entropy-based particle systems shape analysis framework Proc. SPIE Int. Soc. Opt. En 83170L
Qiu A Wang L Younes L Harms MP Ratnanather JT Miller MI Csernansky JG 2009 Neuroanatomical asymmetry patterns in individuals with schizophrenia and their non-psychotic siblings NeuroImage 47 1221 1229 19481156
Rekik I Li G Lin W Shen D 2016 Multidirectional and topography-based dynamic-scale varifold representations with application to matching developing cortical surfaces NeuroImage 135 152 162 27138207
Reuter M Wolter F Peinecke N 2006 Laplace-Beltrami spectra as Shape-DNA of surfaces and solids Comput. Aided Des 38 342 366
Reuter M Wolter FE Shenton M Niethammer M 2009 Laplace-Beltrami eigenvalues and topological features of eigenfunctions for statistical shape analysis Comput. Aided Des 41 739 755 20161035
Robinson EC Jbabdi S Glasser MF Andersson J Burgess GC Harms MP Smith SM Van Essen DC Jenkinson M 2014 MSM: A new flexible framework for multimodal surface matching NeuroImage 100 414 426 24939340
Rosen JB 1960 The gradient projection method for nonlinear programming. part I. linear constraints Journal of the Society for Industrial and Applied Mathematics 8 181 217
Rustamov RM 2007 Laplace-Beltrami eigenfunctions for deformation invariant shape representation Proc. Eurograph. Symp. on Geo. Process 225 233
Shattuck D Mirza M Adisetiyo V Hojatkashani C Salamon G Narr K Poldrack R Bilder R Toga A 2008 Construction of a 3D probabilistic atlas of human brain structures NeuroImage 39 1064 1080 18037310
Shen L Makedon F 2006 Spherical mapping for processing of 3D closed surfaces Image Vis. Comput 24 743 761
Shepherd G 2013 Corticostriatal connectivity and its role in disease Nat. Rev. Neurosci 14 278 291 23511908
Shi Y Lai R Krishna S Sicotte N Dinov I Toga A 2008 Anisotropic Laplace-Beltrami eigenmaps: bridging Reeb graphs and skeletons Proc. IEEE Comput. Soc. Conf. Comput. Vis. Pattern Recognit 1 7
Shi Y Lai R Toga A 2013 Cortical surface reconstruction via unified Reeb analysis of geometric and topological outliers in magnetic resonance images IEEE Trans. Med. Imag 511 530
Shi Y Lai R Wang D Pelletier D Mohr D Sicotte N Toga A 2014 Metric optimization for surface analysis in the Laplace-Beltrami embedding space IEEE Trans. Med. Imag 33 1447 1463
Shi Y Morra J Thompson PM Toga AW 2009 Inverse-consistent surface mapping with Laplace-Beltrami eigen-features Proc. Inf. Process. Med. Imaging 467 478
Thirion JP 1998 Image matching as a diffusion process: an analogy with Maxwell’s demons Med. Image. Anal 2 243 260 9873902
Thompson PM Hayashi KM de Zubicaray GI Janke AL Rose SE Semple J Hong MS Herman DH Gravano D Doddrell DM Toga AW 2004 Mapping hippocampal and ventricular change in Alzheimer disease NeuroImage 22 1754 1766 15275931
Tosun D Prince J 2008 A geometry-driven optical flow warping for spatial normalization of cortical surfaces IEEE Trans. Med. Imag 27 1739 1753
Tran G Shi Y 2015 Fiber orientation and compartment parameter estimation from multi-shell diffusion imaging IEEE Trans. Med. Imag 34 2320 2332
Tziortzi AC Haber SN Searle GE Tsoumpas C Long CJ Shotbolt P Douaud G Jbabdi S Behrens TE Rabiner EA 2014 Connectivity-based functional analysis of dopamine release in the striatum using diffusion-weighted MRI and positron emission tomography Cereb. Cortex 24 1165 1177 23283687
Vaillant M Glaunès J 2005 Surface matching via currents Proc. Inf. Process. Med. Imaging 1 5
Vaillant M Qiu A Glaunès J Miller MI 2007 Diffeomorphic metric surface mapping in subregion of the superior temporal gyrus NeuroImage 34 1149 1159 17185000
Vercauteren T Pennec X Perchant A Ayache N 2009 Diffeomorphic demons: Efficient non-parametric image registration NeuroImage 45 S61 S72 19041946
Wachinger C Reuter M 2016 Domain adaptation for Alzheimer’s disease diagnostics NeuroImage 139 470 479 27262241
Wang Y Shi J Yin X Gu X Chan T Yau ST Toga A Thompson P 2012 Brain surface conformal parameterization with the Ricci flow IEEE Trans. Med. Imag 31 251 264
Yeo B Sabuncu M Vercauteren T Ayache N Fischl B Golland P 2010 Spherical demons: Fast diffeomorphic landmark-free surface registration IEEE Trans. Med. Imag 29 650 668
Zeng W Guo R Luo F Gu X 2012 Discrete heat kernel determines discrete Riemannian metric Graph. Models 74 121 129
