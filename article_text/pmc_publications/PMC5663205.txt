LICENSE: This file is available for text mining. It may also be used consistent with the principles of fair use under the copyright law.


9885960
29671
IEEE Trans Pattern Anal Mach Intell
IEEE Trans Pattern Anal Mach Intell
IEEE transactions on pattern analysis and machine intelligence
0162-8828
1939-3539

27295651
5663205
10.1109/TPAMI.2016.2578317
NIHMS867183
Article
Parametric Surface Diffeomorphometry for Low Dimensional Embeddings of Dense Segmentations and Imagery
Tward Daniel Department of Biomedical Engineering at the Johns Hopkins School of Medicine, Baltimore, MD, 21218

Miller Michael Department of Biomedical Engineering at the Johns Hopkins School of Medicine, Baltimore, MD, 21218

Trouvé Alain Ecole Normale Supérieure de Cachan, Cachan Cedex, France

Younes Laurent Department of Applied Mathematics And Statistics at the Johns Hopkins University Whiting School of Engineering

24 4 2017
08 6 2016
6 2017
01 6 2018
39 6 11951208
This file is available for text mining. It may also be used consistent with the principles of fair use under the copyright law.
In the field of Computational Anatomy, biological form (including our focus, neuroanatomy) is studied quantitatively through the action of the diffeomorphism group on example anatomies – a technique called diffeomorphometry. Here we design an algorithm within this framework to pass from dense objects common in neuromaging studies (binary segmentations, structural images) to a sparse representation defined on the surface boundaries of anatomical structures, and embedded into the low dimensional coordinates of a parametric model. Our main new contribution is to introduce an expanded group action to simultaneously deform surfaces through direct mapping of points, as well as images through functional composition with the inverse. This allows us to index the diffeomorphisms with respect to 2-dimensional surface geometries like subcortical gray matter structures, but explicitly map onto cost functions determined by noisy 3-dimensional measurements. We consider models generated from empirical covariance of training data, as well as bandlimited (Laplace-Beltrami eigenfunction) models when no such data is available. We show applications to noisy or anomalous segmentations, and other typical problems in neuroimaging studies. We reproduce statistical results detecting changes in Alzheimer’s disease, despite dimensionality reduction. Lastly we apply our algorithm to the common problem of segmenting subcortical structures from T1 MR images.


I. Introduction

THE Computational Anatomy project has been the study of shape and form via the infinite dimensional diffeomorphism group, one-to-one smooth transformations between anatomical coordinate systems [1]–[13]. For comparison of coordinate systems we have been constructing geodesic positioning systems [14], defining diffeomorphic correspondences φ which transfers information from one anatomy to another and provides both geodesic coordinates as well as metric length between coordinate systems of the shapes. The Riemanian metric at the basis of diffeomorphometry has now been examined in multiple settings of smooth submanifolds including curves, surfaces and volumes [14]–[19]. We construct the geodesic positioning via the design of optimal control strategies flowing information from one anatomical coordinate system onto another. The flows of the coordinates t ↦ φt act to transfer the image information, with the controls, the vector fields t ↦ vt, acting as the push. They are related via the dynamics of the system φ˙=v∘φ. The fact that the geodesic paths are encoded by the initial vector field in the tangent at the identity provides us with geodesic coordinates.

For the study of neuroanatomy we have been focussing on shapes formed by the submanifolds, the subcortical and gyral structures in ℝ3. As we have demonstrated, the registration information which is supported on the interior to homogeneously colored subvolumes is ill-posed. The deformation is only uniquely determined normal to the level lines of the observed imagery. This is the normality condition described in [16]. This implies that only the discontinuity of the MR imagery supports registration information about the template coordinate system being mapped. At 1mm resolution the boundaries of the subcortical structures are informative about the anatomical phenotype as seen through the MR modality. We can view the proper solution of the mapping problem at 1mm scale as interpolating the discriminating registration information onto the boundaries of the level sets.

The natural probabilistic representations of the anatomical phenotype is therefore singular and supported on the boundaries of the subvolumes. So on the one hand, powerful parametric models for representing subcortical anatomical variation as observed in MRI as geometric dense subvolumes are models of the statistical variation of the boundaries of the substructures [20]–[23]. These are generated empirically via statistical characterization of 1000s of diffeomorphic mappings in empirical populations. On the other hand, most of the available large scale programs including - FreeSurfer [24], SPM [25], FSL [26], MRIStudio [27] to name some - for analyzing brains generate dense subvolume segmentations as outputs. Many of the large scale studies publish dense segmentations of structures, as well, examples being the ADNI and BIOCARD dementia studies, and PREDICT a Huntington’s disease study. In the first two cases the temporal lobe structures including amygdala, hippocampus and entorhinal cortex (ERC); in the latter it is the basal ganglia and motor areas.

This paper focusses on a method of going directly from parametric bases representing the statistical randomness of shape on the brain submanifolds to dense segmentations representing the interiors of shapes. We call this reduction of the high dimensional dense segmentation to a parametric representation parametric diffeomorphometry. This method also solves the problem associated to filtering noise from the segmentations, since it solves the Bayes problem of parametric mapping based on a robust prior distribution which accommodates anatomical variation but is of reasonable dimension. It is parametric diffeomorphometry because it replaces the high dimensional geodesic coordinates in the tangent space at the identity used for shooting the geodesic connection of one coordinate system to another, to a basis representation supported on the shapes. This as well turns the high dimensionality of dense imagery such as segmentation into parameters upon which statistics can be performed directly. The subcortical structures occupying order O(106) dimensions in our MRI (1/3 of the brain), are encoded via roughly O(102) dimensions via the basis.

Our method generalizes the notion of parametrizing the tangent space at the identity in a sum of sparse features, such as control points in Durrleman [28] vertices of discrete surfaces and curves in Glaunes et al. [29], [30] or originally labelled landmark matching in Joshi [31] or Vaillant et al. [32], so that the state is finite dimensional rather than the dimension of the diffeomorphism themselves. Instead of representation of the original state via singular points, here we use the geometries of the subcortical surfaces themselves to define a singular representation. Upon this, complete orthonormal bases are defined using empirical statistics or Laplace-Beltrami eigenfunctions. A significant departure from our previous surface based work, is that we extend the state also to include the dense image which is transported, allowing us to define the matching term between the dense interior of the shape as it is transported and the target segmentation. This extends the approach of [33] from point clouds to surface structures with volumes forming the state. This solves the problem originally tackled by Qiu et al. [34] of doing shape analysis and large deformation diffeomorphic metric mapping (LDDMM) supported on substructures, but allowing us to perform the mapping directly onto segmentations rather than target surface meshes. In the setting proposed here, there is no triangulation step of the dense segmentations, and then subsequent surface mapping onto the subvolumes. This solves the high dimensionality problem of doing direct volume mapping as in Beg et al. [35] onto dense segmentations, while avoiding estimating a high dimensional nuisance parameter: the values of v over the homogeneous interiors of the shapes. The prior distribution providing the efficient encoding of the subcortical structures is directly brought to bear in associating coordinates to the target segmentations.

We show the application of this methodology for embedding essentially the infinite dimensional segmentation which are now commonly available in the community to parametric geodesic coordinates of structures from three commonly available datasets. These data sets include ADNI [36] and PREDICT-HD [37], with parcellations performed with FreeSurfer and University of Iowa’s quality controlled neural network technologies respectively, which are used to illustrate segmentations of subcortical structures which are now commonly available in large studies. We also include the BIOCARD [38] study of cognitive decline in preclinical normals. We focus on BIOCARD with its three temporal lobe structures analyzing hippocampus, amygdala, and entorhinal cortex segmentations, because we can carry out a complete statistical analysis demonstrating use of geodesic coordinate via our parametric basis representation for statistical hypothesis testing on the etiology of the disease. We analyze the use of the geodesic coordinates coupled to the prior distribution as providing automated methods for quality control, i.e. for outlier rejection and detection of common problems which occur in large neuroanatomical studies. In particular, we show example segmentations from the ADNI and PREDICT datasets that exhibit strong artifacts, demonstrating the robustness of this approach. The BIOCARD and grayscale image datasets analyzed consist of more carefully controlled data, and demonstrate typical performance.

II. Geodesic Positioning Relative to Submanifolds of Neuro-Anatomy

For purposes of computing the geodesic coordinates we generate our minimizing length geodesics as variational minimizers along the path of the Lagrangian or kinetic energy ℒ(φ,φ˙)=12||v||V2, paralleling the computation of geodesic to a least-action principle. For this we take pairs of diffeomorphisms in the group G, the identity and any other element (id, g) ∈ G × G, and construct flows which connect them via the least-action (1) infφ˙=v∘φ,φ0=id,φ1=g∫01||vt||V2dt.

We can represent the norm and inner product in V, a space of smooth vector fields, explicitly via L a matrix differential operator defining the linear form μ = Lv dual to the vector field, and defining the norm ||v||V2=(Lv|v) and inner-product between v,w ∈ V according to (2) (Lv|w)=˙∫ℝ3∑i=13wi(x)μi(dx).

When Lv(dx) = m(x)dx has a vector density m, then (Lv|w)=∑i∫ℝ3mi(x)wi(x)dx We call μ = Lv the “Eulerian momentum” and L : V → V*. W impose more structure on this V-spaceby defining it to be a reproducing Kernel Hilbert space with kernel K(·,·) the Green’s function of L. Throughout we define L implicitly by choosing K to be a shift invariant Gaussian with 4mm standard deviation times the identity matrix. It is a Hermitian positive definite highpass operator which enforces smoothness. Note that with this choice of kernel, L is not a classical differential operator, but acts on all (an infinite number of) derivatives.

Geodesic positioning and coordinates arise from the operation of finding optimizing geodesics associated to the least-action principle of (1) connecting two coordinate systems (diffeomorphisms). The Euler equation dictates the temporal evolution of the geodesics. Solving the Euler equation with initial condition Lv0 is geodesic positioning; solving for the initial condition matching the coordinate systems are the geodesic coordinates. This “inverse” relationship is referred to as the Riemannian exponential and logarithm.

Statement 1

Geodesic positioning is computed via the Riemannian exponential at the identity Expid(·) : V → G, which is a mapping from vector field to position in the group given by satisfying the following Eqn. (3) with initial condition vt=0 = v0; for all w ∈ V, (3) (Lvt|(Dφtw)∘φt−1)=(Lv0|w).

as described in [16], where D is defined by [Dφ]ij=∂φi∂xj. The operation applied to w is known as the push forward of a vector field under a diffeomorphism. It mixes the component functions of the vector field (e.g. rotates, scales), as well as deforming them. The Riemannian exponential is the geodesic φ˙=v∘φ of Eqn. (3): (4) Expid(v0)=φ1.

Conversely, geodesic coordinates are given by the mapping from the group to vector field which generates it (assuming uniqueness), denoted Logid(·) : G → V. The Riemannian logarithm is given by the vector field v at t = 0 satisfying geodesic connection to g of (1): (5) Logid(g)=v0.

A. The Inexact Matching Problem

We now introduce the geodesic positioning problem for inexact matching of coordinate systems. We represent subcortical structures in the brain as submanifolds ℳ⊂ℝ3, concentrating our statistical models as singular representations supported on the neuroanatomical structures. Our goal is to transfer the basis coordinates encoding variability of the population supported on the template structures onto the dense MRI image volumes as represented via their segmentations. The left two panels of Figure 1 depicts the subcortical templates over which the basis is defined. The right top shows four typical segmentations which are available from the ADNI and PREDICT-HD studies depicting thalamus, amygdala, putamen, and hippocampus. The right bottom shows corresponding triangulated meshes which have been rendered demonstrating the meshes are no better in quality. Notice the several appendages protruding from the surfaces.

The goal is to calculate geodesic coordinates of the dense segmentations. Our procedure embeds the finite-dimensional basis as a coordinate system on these segmentations. The resulting deformed template has an associated low-dimensional coordinate encoding.

We want to match the interior of the parameterized template shape with the target segmentations based on force coming from the boundaries of the subcortical structures. We fix, in the following, a set U of parameters and a measure η so that (U, η) is a measure space. We can think of the state of our system to be made up of both the surface local coordinate mappings, ℳ=f(U) for f : U → ℝ3, as well as a collection of C ∈ {1, 2,3,…} dense images concatenated into a single vector valued function with C components I: Ω ⊂ ℝ3 → ℝC, the images vanishing on the boundary of Ω. A typical situation is when U is a Euclidean subset U ⊂ R2, η is Lebesgue’s measure, and f is a surface parametrization. In place of an open subset, U can be another surface (e.g., the unit sphere), allowing for the parametrization of genus-zero closed surfaces. Another important practical example is when U is a finite set, say {1,…,M}, with η the counting measure, in which case a function f : U → ℝ3 is another way for representing a finite point set {f (1),…, f (M)} ⊂ ℝ3. This latter example is useful in particular when the considered objects are triangulated meshes, since we have used vertex representations as our surfaces in brain and cardiac studies [34], [39]–[45]. When considering multiple shapes at the same time, U is typically a disjoint union of sets, each of these sets parameterizing a surface. Generally, C corresponds to the number of subcortical structures being studied, each component of the image vector being a binary segmentation for one structure. For our grayscale image matching example, C = 1. We therefore include in the dynamical system the flow of the submanifolds and the template image t↦(ft=φt∘f0,It=I0∘φt−1), the state becoming qt = (ft, It). The control is the vector fields t ↦ vt ∈ V with system dynamics φ˙t=vt⋅φt, φ0 = id. The infinitesimal action of the flow q˙t=vt⋅qt, qt=0 = q0, induces an infinitesimal change in the state, given by (6) q˙=v⋅q=(v∘f,−DIv)

where the D=(∂∂x,∂∂y,∂∂z) operator places partial derivatives along rows, and the second term denotes matrix multiplication between DI(x) and v(x) at each x and takes values in ℝC. The notation here assumes images are differentiable, although since our implementation uses discrete derivatives this assumption is not necessary. The manifold flows in the direction of the velocity field, and the imagery follows the optical flow equation.

We force the flow so as to minimize the matching cost of the template I0 under the geodesic, to a target J : Ω ⊂ ℝ3 → ℝC, where each of the C target images contains a noisy observation of a corresponding segmentation (or J is a corresponding grayscale image and C = 1). We take as an endpoint matching term the integrated squared error (L2 norm) of the C segmentation images according to (7) ℰ(I1)=∑c=1C||I1c−Jc||L22/2σIc2,

with I1=Expid(v0)⋅I0=I0∘φ1−1 Here I1c(Jc) is the c-th component of the deformed atlas (target) image vector, and σIc2 is a positive scalar determining the relative weight of the c-th image in the cost function.

We solve the matching problem with an optimal control approach, the diffeomorphisms and vector fields are used as controls that push the forms (submanifolds or images). The optimal control minimizes the running cost or kinetic energy 12(Lvt|vt)=12||vt||V2, and the target image J contributes to the cost function through the endpoint matching term ℰ(⋅), which is assumed smoothly varying in its argument as is the case for integrated square error defined above.

Problem 1

Given dynamics φ˙t=vt∘φt, φ0=id and running cost 12||v0||V2, Exp satisfying (3) with smooth endpoint cost ℰ(⋅), the variational problem becomes (8) argminv0C(v0)=˙12||v0||V2+ℰ(Expid(v0)⋅I0)

Solving this problem gives the geodesic coordinates of anatomical shapes.

B. Controlling flows with singular geodesic coordinates

We notice that the coordinates for geodesic positions are high-dimensional objects v0 ∈ V. We reduce dimension and build robustness using PCA and computation of Laplace-Beltrami bases [46] which are supported on the gyral and subcortical structures. We control the behaviour of the geodesic positioning by considering a subset of geodesic flows, this subset of flows forms our prior model for Bayesian estimation of the geodesic positioning and generation of coordinates of the noisy segmentation. The initial vector fields for the geodesic are singular in the background space of ℝ3, supported over the manifolds via a prior parametric model which is of the form (9) v0(⋅)∫UK(⋅,f0(u))p0(u)dη(u)=˙K.fp0(⋅)

for some vector valued function (or more generally measure) p0 : U ⟶ ℝ3. In other words the surface at time 0, f0 (u), has a vector field supported on it, p0 (u), as illustrated in Fig. 2 left. For this reason we refer to p0 as the singular geodesic coordinates. We obtain a smooth velocity field v0, supported everywhere in space, by convolving p0dη with the reproducing kernel Hilbert space kernel K(·,·), as illustrated in Fig. 2 right. We will use the shorthand notation v0 = K·fp0 as well as (10) Kffp0(⋅)=˙∫UK(f(⋅),f(u))p0(u)dη(u),

(11) ||p0||Kff2=˙∫U∫Up0∗(u)K(f(u),f(u′))p0(u′)dη(u′)dη(u)

where * refers to a vector transpose (column to row).

Statement 2

With v0 = K.fp0 the geodesics are described through the time varying differential equation on pt [16] by (12) p˙t(⋅)=−Dvt∗(ft(⋅))pt(⋅)=−∫U∇1K(ft(⋅),ft(u))pt∗(u)pt(⋅)dη(u)f˙t(⋅)=vt∘ft(⋅)=∫UK(ft(⋅),ft(u))pt(u)dη(u)I˙t(⋅)=−DIt(⋅)vt(⋅)=∫UDI(⋅)K(⋅,ft(u))pt(u)dη(u)

where Dvt∗ refers to the transpose of the 3 × 3 Jacobian matrix of vt, ∇1K returns the gradient of the kernel in ℝ3 with respect to its first argument, as a column vector.

The constraint gives us our Constrained Variational Problem supported over the subset of geodesics.

Problem 2

Given dynamics φ˙t=vt∘φt,φ0 = id, and running cost 12||v0||V212||p0||Kff2 associated to constraint (9), with Exp satisfying (3) and smooth endpoint ℰ(⋅), the control problem becomes (13) argminp0C(p0)=˙12||p0||Kff2+ℰ(Expid(Kffp0)⋅I0)

Solving this problem gives the geodesic coordinates of anatomical shapes, constrained to anatomical submanifolds.

C. The MAP Estimation Problem for Parametric Diffeomorphometry

Our random orbit model is at hand. We need only generate random realizations of the initial vector fields parametrized by the p0 field, inducing a prior distribution on geodesic flows. We focus our empirical statistical modelling on the geodesic by statistically modelling the function p0 : U → ℝ3, through a low dimensional prior distribution, by expanding p0 through a mean b0 and N basis functions {bn, n = 1,…, N}, (14) p0=b0+∑n=1Nαnbn.

We consider the coefficients {αn} solving the control problem as the parametrization of the anatomical shape. The resulting procedure for mapping surfaces onto dense image segmentations is to reduce dimension by moving the vector field v0 which is supported on all of 3D space to the singular function p0 supported on the submanifolds as well as to model the p0 field as an element in a Hilbert space spanned via a lowdimensional basis.

To build our prior distribution, we use the matching technology to generate a large number of empirical maps on p0, and then use principal component analysis (PCA) to calculate statistics on the empirically observed random variables. Our Gaussian model is induced by taking αn Gaussian, zero-mean and finite trace so that E[(αn)2]=σαn2, ∑nσαn2 finite where E[·] denotes expectation. Then p0(·) is a Gaussian random field, mean b0 and induced covariance operator ∑p0p0:U×U→ℝ3×3 supported over the manifolds reconstructed from the PCA basis (15) ∑p0p0(u,u′)=∑n=1Nσαn2bn(u)(bn)∗(u′),

where * refers to the vector transpose, implying the covariance is a 3 × 3 matrix for each pair u, u′.

In turn this implies the vector fields v0(·) = K·f p0 ∈ V are Gaussian with mean field, and covariance operator (16) μv0=Kffb0,∑v0v0=K.f∑p0p0K⋅f∗.

where with some abuse of notation we define the linear operator ∑p0p0 through ∑p0p0p0=∫∑p0p0(⋅,u)p0(u)η(du). This gives us our Random Orbit Model.

Statement 3 (Random Subcortical Orbit Model)

We induce our random orbit model according to the geodesic equations

(17) {φ˙t=vt∘φt,φ0=id,vt=K.ftptp˙t=−(Dvt)∗(ft)pt,p0=b0+∑nαnbnf˙t=vt∘ft,I˙t=−DItvt.

Drawing Gaussian random field p0 with mean and covariance μp0, ∑p0p0, the geodesic solutions of (17) given by φ1=˙Expid(Kffp0) induced our Random Orbit Model.

By constraining the random orbit of geodesics supported over the subcortical structures in a PCA basis, we can state the MAP problem.

Statement 4 (MAP Estimation)

Our MAP estimator takes the form (18) argmaxp0C(p0)=˙−12||p0−b0||∑p0p0−12−ℰ(Expid(K.fp0)⋅I0)

In this work we consider basis functions determined through PCA as in [20], [21] with parameters α as Gaussian variates. Since our basis is chosen to be orthonormal in the space V*, i.e. (bi)* Kff bj = δij, we have (19) ∑p0p0−1=∑n=1N1σαn2Kffbn(bn)∗Kff.

We have also considered the inclusion of bases such as the eigenfunctions of the Laplace-Beltrami operator [46]. We trained on the order of 1000 surfaces, performing diffeomorphic surface mapping from a template ℳ onto the targets with inital velocity defined as in (9) [29]. We performed PCA on the functions p0 corresponding to each target, generating a basis representation of the anatomical surfaces. Shown in Fig. 3 are examples of temporal lobe structures defined through geodesic positioning Expid(v0)⋅ℳ within this model, revealing the generative nature of our prior distribution. The surfaces are laid out spatially according to the first 2 basis functions, with the mean shape in the center.

D. Solution via adjoint method

We consider the problem of minimizing the cost function, with the state q = (φ ○ f, I ○ φ− 1), not including the prior: (20) C(q1,p0)=12||p0||Kff2+ℰ(q1),q0=fixed

with dynamics written in matrix form (21) (q˙p˙)=(f˙I˙p˙)=(v∘f−DIv−(Dv)∗∘fp)=˙F(q,p)

Our approach is to enforce the dynamics using Lagrange multipliers.

Statement 5

We are given Lagrange multipliers, λ = (λq, λp), with λq = (λf, λI), λf(u) ∈ ℝ3, λI(x) ∈ℝC (i.e. one component for each of the C images being matched), and λp(u) ∈ ℝ3, and augmented cost function (22) ∫01(λ|(p˙q˙)−F(q,p))dt+12||p0||Kff2+ℰ(q1),

where (23) (λ|(q˙p˙)−F(q,p))=∫U(λf)∗(u)(f˙(u)−v∘f(u))dη(u)+∫U(λp)∗(u)(p˙(u)+(Dv)∗∘f(u)p(u))dη(u)+∫Ω(λI)∗(x)(I˙(x)+DI(x)v(x))dx.

Extremizing with respect to p, q, with perturbations (q,p) → (q,p) + δ(q,p), q0 fixed, gives the necessary conditions for an optimizer, with linear dynamics for λ and boundary conditions: (24) (λ˙+DF∗(q,p)λ|δ(q,p))=0

(25) (Kffp0−λ0p|δp0)=0

(26) (∂ℰ(q1)∂q1+λ1p|δq1)=0,(λ1p|δp1)=0.

Algorithm 1

Parametric Geodesic Coordinates.

1)	Initialize α	
2)	Calculate co-state p0=b0+∑n=1Nbnαn	
3)	Given p0 solve (q˙,p˙)T=F(q,p), giving (q1,p1)T.	
4)	Given q1, solve boundary terms
λ1q=−∂ℰ(q1)∂q1, λ1p=0	
5)	Backsolve adjoint equation for λ given by
λ˙t=−DF∗(qt,pt)λt	
6)	Using the quadratic form defined by 12||p0−b0||∑p0p0−12, compute gradient term, giving the update
αnewn←αoldn+ε(σαn2(bn)∗λ0p−αoldn)
with ε = step-size and set α = αnew	
7)	Repeat steps 2 to 6 until convergence.	

We may solve these equations using the adjoint algorithm as in [14], [20], [21], [47]–[50]. For the parametric case the perturbations are spanned by the basis according to p0 → p0+bnδαn, n = 1,…, N giving us a new Eqn. (25) satisfying (27) (∑p0p0−1p0−λ0p|biδαi)=0.

We summarize these results in Algorithm 1. Our specific implementation, where anatomical manifolds are discretized as triangulated meshes, is discussed in the appendix.

Because we choose to work with eigenfunctions, the covariance is diagonalized and each entry in the matrix inverse is taken separately by fractional inverse giving the update in step (6). Equation (24) and step (5) for the differential −DF*λ is given by the equations (28). (28) λ˙f(u)=−∫U∇1K(f(u),f(u′))(λf)∗(u)p(u′)dη(u′)−∫U∇2K(f(u′),f(u))(λf)∗(u′)p(u)p(u)dη(u′)+∫Ω∇2K(x,f(u))(λI)∗(x)DI(x)p(u)dx+∫U(p∗(u′)p(u))D1∇1K(f(u),f(u′))λp(u)dη(u′)+∫U(p∗(u′)p(u))D1∇2K(f(u′),f(u))λp(u′)dη(u′)λ˙I(x)=−div[λI(x)v(x)]λ˙p(u)=−∫UK(f(u′),f(u))λf(u′)dη(u′)+∫ΩK(x,f(u))DI∗(x)λI(x)dx+∫Up(u′)D1K(f(u′),f(u))λp(u′)dη(u′)+∫Up(u′)D1K(f(u),f(u′))λp(u)dη(u′)

The discrete implementation is shown in the Appendix.

III. Experiments

We first apply our algorithm, with I0 and J as a set of segmentations, to an analysis of the temporal lobe structures hippocampus, amygdala, and entorhinal cortex, in populations of patients being studied for neurodegenerative disease. The ADNI data set is also being examined in the temporal lobe and contains amygdala and hippocampus only, with segmentation coming from the automated segmentation methods. The PREDICT-HD data set allows us to focus on motor structures and includes hippocampus but not amygdala. We build a model by performing PCA on the surface mappings of left side structures from the BIOCARD dataset as described in [21]. Templates from which the mappings are performed are constructed using surface template estimation from the population of structures as in Ma [51]. The template is mapped via surface mapping onto each element in the population, from which covariances are empirically generated. We choose the first 47 eigenfunctions of the covariance for our basis functions {bn}, accounting for 95% of the covariance’s trace. We have observed that this cutoff is near the saturation point for mapping quality metrics as a function of dimension. In fact, our deformed template vertices are on average within 0.4 mm of those obtained with 160 dimensions which is well past the saturation point. This distance should be considered in the context of a typical 1mm resolution for our applications, and an average distance of 1.4 mm between vertices on the same face of our triangulated surfaces.

For each of the three datasets, a template segmentation image I0 was constructed for each structure at the same resolution as the target segmentations. This corresponds to 0.97 × 0.97 × 2 mm (with low resolution in the anterior-posterior direction) for the BIOCARD dataset, and 1 × 1 × 1 mm for the other datasets. The template surfaces contouring hippocampus, amygdala, and entorhinal cortex, are depicted in the center of Figure 3.

Last we apply our algorithm with I0 and J as grayscale T1 MR images. Our goal is to simultaneously identify parametric geodesic coordinates of each subcortical motor structure (caudate, putamen, globus pallidus, as well as the thalamus), from the T1 image data directly. To this end we include a dataset obtained as part of a study of children with attention deficit disorder and autism spectrum disorder [52]. Patients have a mean age of 10.2 yrs, and T1-weighted 3D-volume MPRAGE coronal images were acquired from a Philips 3T Achieva MRI scanner (Best, the Netherlands) using an 8-channel head coil (TR = 7.99 ms, TE = 3.76 ms, Flip angle = 8°, voxel size = 1mm isotropic). Eight subcortical structures were segmented manually. Triangulated atlas surfaces, f0, were constructed from the manual segmentations. We use the 30 smoothest (corresponding to the smallest eigenvalues) Laplace-Beltrami eigenfunctions per structure as a basis for dimensionality reduction, since we do not have training data for PCA. We take b0 =0 and σαn2 given by the reciprocal of one plus the magnitude squared of the eigenvalue of bn. For typical triangulated surfaces with about 1000 vertices, this is a 100-fold reduction in the dimensionality of the problem. As compared to the full 256 × 200 × 256 image this is a roughly 10000-fold reduction in the dimensionality of the problem.

A. Parametrization of target segmentations

For each subject we rigidly align the set of left temporal lobe binary segmentations to the template’s space using trilinear interpolation. For the BIOCARD dataset we use manually placed landmarks to calculate this rigid transform, while for the other datasets we use unlabelled segmentation data only.

We apply our implementation of algorithm 1 using the available segmentations as image data, with σI2=0.5. The algorithm computes the transformation of state q1=(f1=φ1(f),I1=I∘φ1−1), where I is the template image, f is the template surface. Figure 4 shows examples from the PREDICT-HD dataset of the overlap of the interior segmentation of the template hippocampus I0∘φ1−1 superimposed on the target. The target segmentation is shown in yellow with the deformed hippocampus shown in blue. The region where they overlap is shown in white. The target image contains noisy components (appendages or leaks on the lateral aspect of the hippocampal body, a typical unwanted artifact in this dataset), which are filtered out by the finite dimensional representation of the shape in the geodesic coordinates of the PCA basis.

For another pair of examples, this time from the ADNI study and including hippocampus and amygdala, Fig. 5 shows the segmentation data I1 as isosurfaces. The target image contains noisy components (blobs, disconnected parts, a typical unwanted artifact in this dataset produced by FreeSurfer) which are filtered out by the finite dimensional representation the shape in the geodesic coordinates of the PCA basis. The other aspect of the state, the surfaces f1, are shown with the first two components of their geodesic coding (bottom). Here the deformed atlas hippocampus/amygdala is shown in blue/red, and the target in yellow/cyan.

For the BIOCARD dataset we performed mappings onto the entorhinal cortex as well. One example from the BIOCARD dataset is shown in Fig. 6. The top left depicts the overlap of the template I1 with the target J. In addition to the color scheme described, green depicts the deformed template entorhinal cortex, while magenta depicts the target entorhinal cortex. White depicts agreement, while other colors (RGB sums of template and target) depict misclassification errors. The middle left shows isosurfaces of I1 compared to isosurfaces of the target J. The deformed template surfaces f1 and first two parameters of their encoding are shown at the bottom left.

To examine the effect of the 47-dimensional prior distribution, we mapped the template onto the greater than 300 scans in all 110 subjects. To examine accuracy we computed the volume of each structure and the closeness of the mapped surfaces onto each of the three structures. Shown in the right of Fig. 6 are the comparisons between volumes generated by the finite-dimensional basis and the original triangulation of the quality-controlled segmentations used for studying the disease already published in [23]. If these are identical then every sample will lay exactly on the black line. The greatest discrepancies occurs for the entorhinal cortex which is a very thin laminar structure, often only two voxels in laminar thickness at the original resolution, and generally not reliably characterized by volume. To view these discrepancies in context we calculated the variability which can be expected by examining volumes calculated from the dense voxel segmentation, versus calculated from the triangulated surface. We see for amygdala and hippocampus that the error is on the order of the noise of the boundary, roughly 2–4%. For entorhinal cortex we see a slight increase in discrepancy.

B. Outlier Detection: Overlapping Segmentations, Poor Alignment, Extreme Shape

In large studies being able to detect large discrepancies between the mapping and the target is important. Having a prior distribution allows us to test the resulting solution against the prior for outliers. The three kinds of errors which the algorithm accommodates is overlap of structures, poor initial rigid alignment, and highly distorted shapes.

To study resolution of inconsistent segmentations, we use the BIOCARD dataset. Since each structure was labelled individually, there are cases where anatomical definitions overlap. We choose three examples where the amygdala and hippocampus segmentations overlap with a Dice score of 0.096, 0.072, 0.062 (roughly a 5–10 % overlap). The average overlap for the population was 0.0044, meaning that these examples overlap more than 10 times the average. Shown in the top row of Figure 7 are these examples. Notice that instead of a clear boundary between the yellow hippocampus, and the cyan amygdala, there exists a large zone colored green. This region corresponds to voxels which have been identified as belonging to both the hippocampus and the amygdala. The segmentations generated by the algorithm shown in the bottom row do not overlap (beyond the linear interpolation applied when generating these slices). The algorithm assigns unique labels to each voxel for three example cases, including those in the green zone. The boundary identified between the two structures will be the most likely, given our prior model for the shape of our temporal lobe structures.

Figure 8 shows examples of misregistered target segmentations depicted via isosurfaces of deformed templates I1 and targets J which are overlayed with transparency. The misorientation becomes apparent by noticing that the body of the target hippcampus is curved the “wrong” way relative to the template. The deformed template surfaces, f1 are shown in the bottom row, together with the first two dimensions of their coordinates, which are seen to take extreme values. In these examples, the registration is incorrectly rotated around the anterior-posterior axis by about 180 degrees. The segmentation performance is quite poor, but these cases represent quality control errors in the analysis of a large population. The prior as represented by the value of the cost 12‖p0−b0‖∑p0p0−12 signals these outliers. Examining a set of 10 correctly registered cases and 5 misregistered cases leads to a signal to noise ratio of 2.81 between the two groups.

Figure 9 shows two extreme segmentation examples taken from the PREDICT-HD dataset. Again we use 12‖p0−b0‖∑p0p0−12 as a signal to separate 8 normal from 5 extreme surfaces, leading to a signal to noise ratio of 1.83.

C. Statistical analysis pipeline

We have been using LDDMM as part of statistical analyses of large populations by quality controlling poor segmentations and triangulating them, before applying surface mapping and performing statistics. In this section we apply the parametric representation of the coordinates of the temporal lobe structures to the BIOCARD segmentations, removing the extra steps of triangulation and surface mapping. We compare the use of geodesic coordinates of the basis representation to previously published results on local (log Jacobian of φ1 at each vertex) and volume measures [23].

The BIOCARD dataset [23] consists of the three temporal lobe structures associated to 342 brain MRI scans, consisting of 110 unique patients at up to 5 timepoints. They are divided into 3 groups: 11 clinical subjects who were diagnosed with Alzheimer’s disease (AD) at the time of their last MR scan, 19 preclinical subjects who were not diagnosed with AD at the time of their last MR scan but were later diagnosed with AD, and 80 controls who did not develop AD. The temporal lobe structures were segmented and quality controlled, and a template surface generated, using procedures described in [23].

We performed statistical analyses comparing the amygdala, entorhinal cortex and hippocampus subvolumes between the two groups (controls vs. preclinical AD), modelling the local shape markers via linear and mixed effects. The model previously used in Younes et al. [42] takes the absolute volume and atrophy rate of the linear model as a function of age as different between the two groups. The mixed effects as used by Bernal-Rusiel et al. [53] corresponds to representing the noise in the measuring shape marker as corresponding to two different processes, one associated to the time series within a subject, and the second noise associated to the cross-sectional variation from subject to subject. The analysis includes age, gender and log intracranial volumes (calculated using coronal SPGR scans in Freesurfer 5.1.0) as covariates, and computes statistics at each vertex of the triangulated template surface returning p-values corrected for multiple comparisons using permutation testing [54]. The analysis uses a mixed linear effects model for each vertex v, scan j and subject s. For this, each subject’s left and right structures (controls and patients) has been registered to the template, resulting in the computation of a normalized deformation marker measuring how much expansion/atrophy at vertex v of the template surface in registering it to subject s for scan j. The raw expansion/atrophy measure is defined as the logarithm of the local expansion/reduction in surface area around the vertex, interpreted mathematically as a log-Jacobian on the template surface. This measure is then normalized for variations due to gender and intracranial volume by fitting a linear regression model that predicts the former by the latter, and taking the residual. This normalization is group independent.

We model the group variables g(s) as equalling 1 if subject s belongs to the preclinical AD group and zero if the subject belongs to the control group. Our deformation marker model is given by the equation (29) ysi(⋅)=(α(⋅)+α′(⋅)asi)+(β(⋅)+β′(⋅)asi)gs+εsi(⋅),

for field of markers (·) (either vertex or volume), MRI scan i = 1, … of subject s at age a. ε represents the noise, and is modeled as ε = n + η where n is a “random effect” that measures between-subject variation and η measures within-subject variation. Both processes are assumed to be centered Gaussian, with variance ρσ2 and σ2, respectively. Parameters α, α′, β, β′, ρ, σ are estimated via maximum-likelihood. We test the null hypothesis β = β′ = 0, correcting for multiple comparisons. The test-statistic is the difference between the log-likelihoods at the maximum-likelihood estimators: (30) S(⋅)=LH1(⋅;α,α′,β,β′,ρ,σ)−LH0(⋅;α,α′,0,0′,ρ,σ).

The joint test statistic is computed from Eqn. (29) with familywise error rate calculated by evaluating the maximum S* ≐ max S(·) over the field of statistics. The maximum value is compared to those obtained by performing the same computation a large number of times, with group labels randomly assigned to subjects. The p-value is given by the fraction of times the values of S computed after permuting the labels is larger than that obtained with the true groups. The p-values that were observed via the linear effects modeling of deformation markers are provided. The volume statistics shown provides p-values for the same linear effects model, also evaluated via permutations, in which the y is replaced by the structure volume, for which no multiple testing correction is required.

To demonstrate the validity of using the PCA basis, we performed the statistics using the original procedure already published and generated filtered surfaces based on fitting all of the subjects multiple images with the deformed templates f1. From these surfaces, the identical procedure described above was run. Shown in Table I are a comparison of these results.

The first two columns in the table show volume and vertex results from the already published methodology. We see for the preclinical subjects only the vertex measures are signalling in the entorhinal cortex. Shown in the right two columns are p-values generated identically but from the filtered surfaces generated using the parametric basis mappings. We see almost identical results. It appears as if the volumes in ERC are on the border of discriminating. As well the vertex measures are virtually identical in p-value (.03625 versus .0291).

D. Grayscale image matching

We choose a set of 5 skullstripped T1 images for this study. After intensity normalization and linear alignment (rigid motion and scale), each of the five atlases were mapped pairwise to the remaining four. Laplace Beltrami eigenfunctions and eigenvalues for dimensionality reduction and regularization were computed separately for each template.

Data for one example is shown in the figures below. Left side of Fig. 10 shows the deformed atlas as well as the target T1 images, in coronal and axial views. By design, the procedure produces an alignment which is good in the neighbourhood of the subcortical structures, but poor in regions distant to them. Notice that the resolution of this dataset results in blurring of tissue boundaries on the order of 2 to 3 voxels.

The matching quality can be observed more readily by considering the alignment of gold-standard manual segmentations. The deformed atlas surfaces f1, as well as isosurfaces of the manual segmentations for both template and target, are shown in Fig. 11. For more detail, the manual segmentations are shown as slices through image data in Fig. 10 right.

Based on the gold standard segmentations we determine accuracy using the Dice coefficient. The results for each structure, averaged across each atlas and target, are left/right caudate: 0.85/0.84, globus pallidus: 0.84/0.82, putamen: 0.87/0.88, thalamus: 0.92/0.92. The performance is greater than 0.8 for each structure examined, comparable to state of the art.

IV. Conclusion

Active contours or snakes as first introduced by Kass et al. [55] is a a common tool in computer vision for edge detection, shape modelling, segmentation and visual tracking to name but a few applications [56], [57]. Originally models assumed explicit parametrizations, where the deformation of an initially parametrized curve is computed by minimizing an energy functional composed of a smoothing term and a term that forces the curve towards the boundary where there is a considerable change in the image intensity. Intrinsic approaches for parametrization-free deformable methods emerged using level sets to allow evolving curves to automatically merge or split [58]–[60], work which was later extended to deal with two-dimensional surfaces [61], [62]. Region-based and region plus edge-based based methods have been developed in 2-D [63]–[73] and 3-D [74]–[78]. However, such approaches do not ensure that the evolving contour maintains important properties over time, like being simple, for example.

The general framework presented here departs significantly in that the equations of evolution are bound up with the notion that the shape is an element in a bigger metric space of shapes under flows of diffeomorphisms. This requires the vector fields satisfying the metric to have an associated number of derivatives inherited from the fact that the vector fields are in the reproducing kernel Hilbert space, and the evolution of the shape is geodesic under that metric. The focus on the indexing with respect to the submanifold boundaries implies the Hamiltonian methods of reduction which have emerged over the past 5 years in CA play a central role [48], [50].

The parametric embedding of diffeomorphisms results from the representation of the vector fields as a superposition of Green’s kernels centered on the surface locations defined by the state in the Hamiltonian system, whose role is played by the surface flowing under the diffeomorphism. This gives an extremely parsimonious representation and one for which the Gaussian random field modelling is extremely efficient.

One of our contributions is to extend the actions to states including both surface and volumes. This has allowed us to demonstrate, that for structures such as subcortical structures in the brain, efficient low-dimensional representations are obtained via Hilbert space representations based on PCA and Laplace Beltrami functions which are supported on the subcortical surface domains. This should be contrasted to other sparse methods based on point-clouds which are not as efficient for representing the local geometry of closed surface subcortical structures. To demonstrate this point, we have included an explicit result showing accuracy of mappings using only rigid alignment (6 parameters), an approach with 16 control points (48 dimensions), and our 47 dimensional prior. Control points were randomly initialized on the cortical surfaces in proportion to their surface area (4 on amygdala, 8 on hippocampus, 4 on entorhinal cortex), and forced to repel one another until they reach equilibrium, covering the entire structure as seen in Fig 12 left. We calculate the distribution of surface to surface distances between deformed template isosurfaces and target segmentation isosurfaces, for 6 examples from BIOCARD. The 95th percentile distances for amygdala are 2.2mm (rigid) 1.5mm (control points) and 1.1mm (surface basis expansion), for hippocampus they are 2.3, 1.6, and 1.1mm respectively, and for entorhinal cortex they are 4.3, 1.7, and 0.98 mm respectively. This shows higher performance with our method in every case. Additionally, the cumulative distribution function (CDF) of surface to surface distances for entorhinal cortex is shown in Fig. 12 right to emphasize the consistency of our method. For example, the 95%ile distance for the worst case for the surface method is 1.1mm, but for the worst control point case it is 2.4mm, an unacceptable level of error for a structure that is only 3mm thick.

This notion of exploration of embedding of the diffeomorphic flow in a basis supported over the initial shape manifold has been explored as well in several other papers now [20], [21]. The significant departure here is to introduce an image action which combines both surface evolution and extrinsic volume evolution, allowing for a parametric decomposition of the connected subregions supported over their boundaries, while matching volume interiors. This does not assume surface to surface matching, which makes the procedure extremely robust and efficient. In this sense this circles us back to the inside-outside methods referenced above, in this topological setting that has been explored deeply by the Computational Anatomy community.

This project was supported by the National Center for Research Resources and the National Institute of Biomedical Imaging and Bioengineering of the National Institutes of Health (NIH) through Grant Number P41 EB015909. The PREDICT project was supported by NIH grant U01 NS082085-01. The BIOCARD project was supported by NIH grant U01 AG033655.

Appendix: Discrete Implementation

We implement our algorithm using ℳ as the set of M vertex points in a triangulated surface, i.e. U is the index set {1, …, M}. We specify f by the points fm for m ∈ U. The quantities pm, λqfm and λpm basis function of our model, bn, will take a value bnm in ℝ3 at each vertex fm.

We discretize time to into 10 equal steps, Δt = 0.1, and update f, p, λqf, λp using Euler’s method. In this scenario the velocity field, as written in (9), is defined explicitly by (31) v0(⋅)=∑m=1MK(⋅,fm)p0m,

leading to dynamics for the fm, pm, as in equation (12) (32) f˙m=∑m′=1MK(fm,fm′)pm′p˙m=−∑m′=1M(pm)∗∇1K(fm,fm′)pm′

where ∇i denotes the derivative with respect to the i-th argument and returns a column vector in ℝ3 at each point.

The dynamics for λf, λp, as in (28), obtained by letting η be a counting measure, are (33) λ˙fm=∑m′=1M−((pm′)∗λfm+(pm)∗λfm′)∇1K(fm,fm′)+∑m′=1M(pm)∗(pm′)∇1D1K(fm,fm′)λpm+∑m′=1M(pm)∗pm′∇1D2K(fm′,fm)λpm′+∑i∇2K(xi,fm)(λI)∗(xi)DI(xi)pmλ˙pm=∑m′=1M−K(fm,fm′)pm′+∑m′=1M(λpm)∗∇1K(fm,fm′)pm′+∑m′=1M(λpm′)∗∇1K(fm′,fm)pm′+∑iDI∗(xi)λI(xi)K(xi,fm)

where Di denotes derivative with respect to the i-th argument and returns a row vector in ℝ3 at each point. Note that DI*λqI involves a sum over the C images. All image data is sampled on a rectangular grid, with voxel locations denoted xi. The endpoint conditions, as in (26) are (34) λ1fm=−∂ℰ(q1)∂f1m=0,λ1p=0λ1Ic=−∂ℰ(q1)∂I1c=−(I1c−Jc)/σIc2.

For numerical and computational reasons, we approach the evolution of image data indirectly. Rather than solving for I˙=−DIv and λ˙qI=−div(vλqI), we introduce the diffeomorphisms φ0t−1 (and φ1t−1), which transform the images from the start point (and resp. endpoint) to time t. We compute them using semi-Lagrangian advection [79], with an Euler integration scheme and linear interpolation: (35) φ0,t+Δt−1(xi)=φ0t−1[xi−v(xi)Δt]φ1,t−Δt−1(xi)=φ1t−1[xi+v(xi)Δt].

We use this to explicitly solve for I and λqI (36) I=I0∘φ0t−1,λqI=λ1qI∘φ1t−1|Dφ1t−1|,

where spatial derivatives are calculated by centered difference.

The boundary condition at t = 0 necessary for an optimal solution, as in (27), for each n = {1, …, N} is written as (37) ∑m=1M(bnm)∗(∑p0p0−1p0−λ0pm)=(αn−∑m=1M(bnm)∗λ0pm)=0

We solve the optimizing equations (33) (34) (36) (37) through Algorithm 2.

Algorithm 2

Discrete Implementation of Parametric Geodesic Coordinates

1)	Initialize coefficients α	
2)	Calculate co-state p0=b0+∑n=1Nbnαn,	
3)	Given p0 solve the dynamical system forward using (37), giving (f1,p1).	
4)	Calculate velocity vector at each grid point and timestep v=∑m=1MpmK(⋅,fm). Calculate φ01−1, φ0t−1 using (35) and transform the imagery to time 1, I1=I0∘φ01−1.	
5)	Given q1, set boundary terms λ1fj=0, λIc=(I1c−Jc)/σIm2, λ1p=0	
6)	Calculate λtI=λ1I∘φ1t−1|Dφ1t−1|, and backsolve adjoint equation (33) for λf, λp.	
7)	Update the coefficients by the rule αnewn↦αoldn−ε(αoldn−σαn2∑m=1Mλ0pmbnm) for each n, with ε = step-size, and set α = αnew	
8)	Repeat steps 2 to 7 until convergence.	

Daniel Tward is a Ph.D. candidate in the department of biomedical engineering at Johns Hopkins University. He obtained his bachelor of science in biophysics at the University of Toronto in 2008. His research interests include computational anatomy and medical physics.

Michael Miller is the Herschel and Ruth Seder Professor of Biomedical Engineering, a Gilman Scholar, and the Director of the Center for Imaging Science at Johns Hopkins University. Miller earned a bachelors degree from the State University of New York at Stony Brook in 1976. He holds master’s and doctorate degrees from Johns Hopkins University in 1983, and joined the Johns Hopkins faculty in 1998. Miller is a biomedical engineer and pattern theorist whose research interests have focussed on brain mapping and neuroscience-neuroengineering of the brain.

Alain Trouvé is a professor at the Centre de Mathématiques et Leurs Applications at the École Normale Superiéure in Cachan, France. He completed his doctorate in 1993 at the University of Paris 11, Orsay. His research interests include shape spaces and applications, image processing and computational vision, computational biology, and biological imaging.

Laurent Younes is a professor and chair of the Applied Mathematics and Statistics department at Johns Hopkins University. He obtained a bachelor’s degree from École Normale Superiéure in 1984, and a master as doctorate from University of Paris 11 in 1985 and 1988. His research interests include statistical properties of Markov random fields, image analysis, deformation analysis, and shape recognition.

Fig. 1 The problem of associating geodesic coordinates to subcortical templates, to represent the dense segmentations, is depicted here. Left: depiction of subcortical manifolds representing amygdala, caudate, hippocampus, putamen, thalamus and ventricles. Second from left: sections through the MRI depicting the outlines of the surfaces striking the subvolume. Right: Segmentations (top) and corresponding isosurfaces (bottom) of thalamus, amygdala, putamen, hippocampus structures from the ADNI dementia study (columns 1,2) and PREDICT-HD Huntington’s disease study (columns 3,4).

Fig. 2 A patch of surface defined by the function f0 (u) (cyan) supports a function p0 (u) (red, left). The initial velocity field v0 (blue, right), is supported everywhere in space, and is obtained by convolving the measure p0dη with the reproducing kernel Hilbert space kernel K(·,·).

Fig. 3 The first two dimensions of our model for hippocampus, amygdala, and entorhinal cortex are shown here. The mean shape is shown in the center in grey, and each subsequent shape is shown by taking a step of one standard deviation in the direction of the first basis function (left/right or cyan/red) or the second basis function (up/down or blue/yellow).

Fig. 4 Two results (left/right) from PREDICT-HD showing a slice of the dense template image I1 (top row), target J (second row), and both together (third row) summed in RGB space such that overlap appears white.

Fig. 5 Two results (left/right) from ADNI. First row: isosurface of deformed template image I1. Second row: isosurface of target image J. Third row: both together. Fourth row: Deformed template surfaces f1 along with basis coefficients (in multiples of the eigenvalue standard-deviations).

Fig. 6 Results of mapping amygdala, entorhinal cortex, and hippocampus onto BIOCARD segmented structures. Top left: Slice through I1 and J. Correct overlap of template and target is depicted as white, while other errors are encoded via colors as described in the text. Middle left: Isosurfaces of segmentations I1 and J. Right: Volumes of deformed templates I1 and targets J for the three temporal lobe structures. The identity line is shown in black.

Fig. 7 Three overlapping segmentation examples from the BIOCARD dataset. Red ellipse indicates region of overlapping labels. Top: Target. yellow/cyan/magenta: hippocampus/amygdala/entorhinal cortex. Bottom: deformed template I1. blue/red/green: hippocampus/amygdala/entorhinal cortex.

Fig. 8 Two results (left/right) from ADNI illustrating misoriented surfaces by 180 degrees. Layout as in Fig. 5. Basis coefficients demonstrate the geodesic coordinates are outliers with respect to the prior.

Fig. 9 Two results (left/right) from PREDICT-HD illustrating extreme segmentations. Layout as in Fig. 5. Basis coefficients demonstrate the geodesic coordinates are outliers with respect to the prior.

Fig. 10 Left column: Corronal and axial slices of deformed template I1 / target J image: blue/yellow, when summed in RGB space a correct overlap results in grayscale. The overlap is only expected to be good in neighbourhood of the subcortical structures. Right column: Deformed template: cool colors, target: warm colors, when summed in RGB space a correct overlap results in white. This data was used only for evaluation, not in the mapping algorithm.

Fig. 11 Right-inferior-anterior view of deformed template and target structures. Left: deformed atlas surfaces f1. Right: Target segmentation isosurfaces. Data on right was used only for evaluation, not in the mapping algorithm.

Fig. 12 Left: The subcortical template with positioned control points (red: amygdala, blue: hippocampus, green: entorhinal cortex). Right: Distribution of entorhinal cortex surface to surface distance for rigid alignment (blue), alignment via control points (CP, cyan, 48 parameters), and alignment based on surface basis expansion (PCA, yellow, 47 parameters).

Table I p-VALUES FROM PERMUTATION TESTING, SHOWING PROBABILITY OF EVEN ONE FALSE POSITIVE IN A MULTIPLE COMPARISON SETTING.

Structure	Original Segmentations	Parametric Segmentations	
Volume	Jacobian	Volume	Jacobian	
Amygdala	0.489727	0.547545	0.395182	0.251455	
Entorhinal Cortex	0.419	0.0291	0.073188	0.03625	
Hippocampus	0.742636	0.132909	0.637727	0.159727	


1 Trouvé A An approach of pattern recognition through infinite dimensional group action Rapport de recherche du LMENS 1995 [Online]. Available: http://en.scientificcommons.org/43056763
2 Christensen G Miller MI Rabbit RD Deformable templates using large deformation kinematics IEEE Transactions of Medical Imaging 5 1435 1447 1995 [Online]. Available: http://en.scientificcommons.org/43056763
3 Dupuis P Grenander U Miller M Variation Problems on Flows of Diffeomorphisms for Image Matching Quarterly of Applied Mathematics 56 4 617 694 1998
4 Grenander M Miller M Pattern Theory: From Representation to Inference Oxford Press 2007 978-0199297061
5 Younes L Shapes and Diffeomorphisms Series: Applied Mathematical Sciences 2010 171 XVI
6 Grenander U Miller MI Computational anatomy: An emerging discipline Quarterly of Applied Mathematics 56 4 617 694 1998 [Online]. Available: http://portal.acm.org/citation.cfm?id=309082.309089
7 Toga A Thompson P Maps of the brain Anat Rec 265 2 37 53 4 2001 11323769
8 Miller MI Trouvé A Younes L On the metrics and euler-lagrange equations of computational anatomy Annual Review of Biomedical Engineering 4 1 375 405 2002 [Online]. Available: http://www.ncbi.nlm.nih.gov/pubmed/12117763
9 Thompson PM Toga AW A framework for computational anatomy Computing and Visualization in Science 5 1 13 34 2002 [Online]. Available: http://www.springerlink.com/openurl.asp?genre=article\&amp;id=doi:10.1007/s00791-002-0084-6
10 Miller M Computational anatomy: shape, growth, and atrophy comparison via diffeomorphisms Neuroimage 29 Suppl 1:S 19 33 2004
11 Ashburner J Friston KJ Computational anatomy Statistical Parametric Mapping The Analysis of Functional Brain Images Friston KJ Ashburner J Kiebel SJ Nichols TE Penny WD Academic Press 2007 49 100
12 Ashburner J Computational anatomy with the spm software Magnetic Resonance Imaging 27 1163 1174 10 2009 19249168
13 Pennec X From Riemannian Geometry to Computational Anatomy Elements 2011
14 Miller MI Younes L Trouv A Diffeomorphometry and geodesic positioning systems for human anatomy TECHNOLOGY 02 01 36 43 2014 [Online]. Available: http: //www.worldscientific.com/doi/abs/10.1142/S2339547814500010
15 Miller M Younes L Group Actions, Homeomorphisms, and Matching: A General Framework International Journal of Computer Vision 41 4 617 694 2001
16 Miller MI Trouvé A Younes L Geodesic Shooting for Computational Anatomy Journal of Mathematical Imaging and Vision 24 2 209 228 2006 [Online]. Available: http://www.pubmedcentral.nih.gov/articlerender.fcgi?artid=2897162\&amp;tool=pmcentrez\&amp;rendertype=abstract 20613972
17 Michor P Mumford D An overview of the riemannian metrics on spaces of curves using the hamiltonian approach 23 74 113 7 2007
18 Michor P Mumford D Shah J Younes L A metric on shape space with explicit geodesics Rend Lincei Mat Appl 9 2008
19 Micheli M Michor PW Mumford D Sobolev metrics on diffeomorphism groups and the derived geometry of spaces of submanifolds r Izv RAN Ser Mat 77 109 138 2013
20 Qiu A Younes L Miller M Principal component based diffeomorphic surface mapping Medical Imaging, IEEE Transactions on 31 2 302 311 2 2012
21 Tward DJ Ma J Miller MI Younes L Robust diffeomorphic mapping via geodesically controlled active shapes International Journal of Biomedical Imaging 2013 2013
22 Younes L Ratnanather J Brown T Aylward E Nopoulos P Johnson H Magnotta V Paulsen J Margolis R Albin R Miller M Ross C P-H Investigators, and C. of the Huntington Study Group Regionally selective atrophy of subcortical structures in prodromal hd as revealed by statistical shape analysis Hum Brain Mapp 35 79280 2014
23 Miller MI Younes L Ratnanather JT Brown T Trinh H Postell E Lee DS Wang M-C Mori S O’Brien R Albert M the BIOCARD Research Team Diffeomorphometry of temporal lobe structures Neuroimage Clinical 3 352 360 2013 24363990
24 FreeSurfer http://surfer.nmr.mgh.harvard.edu/. [Online]. Available: http://surfer.nmr.mgh.harvard.edu/
25 SPM http://www.fil.ion.ucl.ac.uk/spm/. [Online]. Available: http://www.fil.ion.ucl.ac.uk/spm/
26 FSL http://fsl.fmrib.ox.ac.uk/fsl/. [Online]. Available: http://fsl.fmrib.ox.ac.uk/fsl/
27 MRIStudio https://mristudio.org/. [Online]. Available: https://mristudio.org/
28 Durrleman S Pennec X Trouvé A Ayache N Sparse approximation of currents for statistics on curves and surfaces Medical Image Computing and Computer-Assisted Intervention 11 Pt 2 390 398 2008 [Online]. Available: http://www.ncbi.nlm.nih.gov/pubmed/18982629 18982629
29 Glauns J Qiu A Miller MI Younes L Large deformation diffeomorphic metric curve matching International Journal of Computer Vision 80 3 317 336 2008 20419045
30 Vaillant M Glauns J Surface matching via currents Proceedings of Information Processing in Medical Imaging (IPMI2005), number 3565 in Lecture Notes in Computer Science 2005 381 392
31 Joshi S Miller M Landmark matching via large deformation diffeomorphisms IEEE Trans Image Process 9 8 1357 70 2000 18262973
32 Vaillant M Miller MI Younes AL A. T. D Statistics on diffeomorphisms via tangent space representations NeuroImage 23 2004 2004
33 Durrleman S Prastawa M Korenberg J Joshi S Trouv A Gerig G Topology preserving atlas construction from shape data without correspondence using sparse parameters Medical Image Computing and Computer-Assisted Intervention MICCAI 2012, ser Lecture Notes in Computer Science Ayache N Delingette H Golland P Mori K Springer Berlin Heidelberg 2012 7512 223 230 [Online]. Available: http://dx.doi.org/10.1007/978-3-642-33454-2_28
34 Qiu A Fennema-Notestine C Dale A Miller M Regional shape abnormalities in mild cognitive impairment and alzheimer’s disease Neuroimage 45 3 656 661 4 2009 19280688
35 Khan AR Wang L Beg MF Freesurfer-initiated fully-automated subcortical brain segmentation in mri using large deformation diffeomorphic metric mapping NeuroImage 41 3 735 746 2008 18455931
36 ADNI http://adni.loni.usc.edu/dataset. [Online]. Available: http://adni.loni.usc.edu/dataset
37 PREDICT-HD https://www.predict-hd.net/. [Online]. Available: https://www.predict-hd.net/
38 BIOCARD http://www.alzresearch.org/biocard.cfmdataset. [Online]. Available: http://www.alzresearch.org/biocard.cfmdataset
39 Haller J Banerjee A Christensen G Gado M Joshi S Miller M Sheline Y Vannier M Csernansky J Three-dimensional hippocampal mr morphometry with high-dimensional transformation of neuroanatomic atlas Radiology 202 2 504 10 2 1997 9015081
40 Qiu A Adler M Crocetti D Mahone E Denckla M Miller M Mostofsky S Basal ganglia volume and shape in children with attention deficit hyperactivity disorder American Journal Psychiatry 166 1 74 82 1 2009
41 Ardekani S Jain A Jain S Abraham TP Abraham MR Zimmerman S Winslow RL Miller MI Younes L Matching sparse sets of cardiac image cross-sections using large deformation diffeomorphic metric mapping algorithm Statistical Atlases and Computational Models of the Heart Imaging and Modelling Challenges, ser Lecture Notes in Computer Science Camara O Konukoglu E Pop M Rhode K Sermesant M Young A Springer Berlin Heidelberg 1 2012 7085 234 243 [Online]. Available: http://link.springer.com.proxy1.library.jhu.edu/chapter/10.1007/978-3-642-28326-0_24
42 Younes L Ratnanather J Brown T Aylward E Nopoulos P Johnson H Magnotta V Paulsen J Margolis R Albin R Miller M Ross C PREDICT-HD Investigators and Coordinators of the Huntington Study Group Regionally selective atrophy of subcortical structures in prodromal hd as revealed by statistical shape analysis Human Brain Mapping 2012
43 Du J Younes L Qiu A Whole brain diffeomorphic metric mapping via integration of sulcan and gyral curves, cortical surfaces, and images Neuroimage 56 1 162 173 2011 21281722
44 Li X Samel E Williams CH Segars WP Tward DJ Miller MI Ratnanather JT Paulson EK Frush DP Effects of protocol and obesity on dose conversion factors in adult body ct Medical Physics 39 11 6550 6571 2012 23127050
45 Segars W Bond J Frush J Hon S Eckersley C William CH Feng J Tward DJ Ratnanather J Miller M Population of anatomically variable 4d xcat adult phantoms for imaging research and optimization Medical Physics 40 4
46 Qiu A Bitouk D Miller MI Smooth functional and structural maps on the neocortex via orthonormal bases of the laplace-beltrami operator IEEE Trans Med Imaging 25 10 1296 1306 2006 [Online]. Available: http://dblp.uni-trier.de/db/journals/tmi/tmi25.html#QiuBM06 17024833
47 Allassonnière S Trouvé A Younes L Geodesic shooting and diffeomorphic matching via textured meshes EMMCVPR 2005 Springer 2005 365 381 [Online]. Available: http://www.springerlink.com/index/767185l420344280.pdf
48 Vialard F-X Risser L Rueckert D Cotter CJ Diffeomorphic 3D Image Registration via Geodesic Shooting Using an Efficient Adjoint Calculation International Journal of Computer Vision 97 2 229 241 2011 [Online]. Available: http://www.springerlink.com/index/10.1007/s11263-011-0481-8
49 Niethammer M Huang Y Vialard F-X Geodesic regression for image time-series Medical Image Computing and Computer-Assisted Intervention-MICCAI 2011 Springer 2011 655 662
50 Durrleman S Allassonnière S Joshi S Sparse adaptive parameterization of variability in image ensembles Int J Comput Vision 101 1 161 183 1 2013 [Online]. Available: http://dx.doi.org/10.1007/s11263-012-0556-1
51 Ma J Miller MI Younes L A bayesian generative model for surface template estimation International Journal of Biomedical Imaging 2010 2010
52 Ceritoglu C Tang X Chow M Hadjiabadi D Shah D Brown T Burhanullah MH Trinh H Hsu J Ament KA Crocetti D Mori S Mostofsky SH Yantis S Miller MI Ratnanather JT Computational analysis of lddmm for brain mapping Frontiers in Neuroscience 7 151 2013 [Online]. Available: http://www.frontiersin.org/brain_imaging_methods/10.3389/fnins.2013.00151/abstract
53 Bernal-Rusiel JL Greve DN Reuter M Fischl B Sabuncu MR Statistical analysis of longitudinal neuroimage data with linear mixed effects models NeuroImage 66 0 249 260 2013 [Online]. Available: http://www.sciencedirect.com/science/article/pii/S1053811912010683 23123680
54 Nichols T Hayasaka S Controlling the familywise error rate in functional neuroimaging: a comparative review Stat Methods Med Res 12 5 419 446 2003 14599004
55 Kass M Witkin A Terzopoulos D Snakes: Active contour models International Journal of Computer Vision 1 4 321 331 1988 [Online]. Available: http://dx.doi.org/10.1007/BF00133570
56 Caselles V Catt F Coll T Dibos F A geometric model for active contours in image processing Numerische Mathematik 66 1 1 31 1993 [Online]. Available: http://dx.doi.org/10.1007/BF01385685
57 Malladi R Sethian J Vemuri B Shape modeling with front propagation: a level set approach Pattern Analysis and Machine Intelligence, IEEE Transactions on 17 2 158 175 2 1995
58 Osher S Sethian JA Fronts propagating with curvature-dependent speed: Algorithms based on hamilton-jacobi formulations Journal of Computational Physics 79 1 12 49 1988 [Online]. Available: http://www.sciencedirect.com/science/article/pii/0021999188900022
59 Kichenassamy S Kumar A Olver P Tannenbaum A Yezzi A Gradient flows and geometric active contour models Computer Vision 1995 Proceedings., Fifth International Conference on, Jun 1995 810 815
60 Yezzi J Kichenassamy AS Kumar A Olver P Tannenbaum A A geometric snake model for segmentation of medical imagery Medical Imaging, IEEE Transactions on 16 2 199 209 4 1997
61 Caselles V Kimmel R Sapiro G Sbert C Minimal surfaces based object segmentation Pattern Analysis and Machine Intelligence, IEEE Transactions on 19 4 394 398 4 1997
62 Memoli F Sapiro G Thompson P Implicit brain imaging NeuroImage 23 179 188 2004 15110008
63 Staib L Duncan J Boundary finding with parametrically deformable models IEEE Transactions on Pattern Analysis and Machine Intelligence 14 11 1061 1075 1992
64 Grenander U Miller MI Representations of knowledge in complex systems Journal of the Royal Statistical Society Series B (Methodological) 56 4 549 603 1994 [Online]. Available: http://www.jstor.org/stable/2346184
65 Chan T Vese L Active contours without edges Image Processing, IEEE Transactions on 10 2 266 277 2 2001
66 Cremers D Tischhuser F Weickert J Schnrr C Diffusion snakes: Introducing statistical shape knowledge into the mumford-shah functional International Journal of Computer Vision 50 3 295 313 2002 [Online]. Available: http://dx.doi.org/10.1023/A%3A1020826424915
67 Grenander U Chow Y Keenan DM Hands: A Pattern Theoretic Study of Biological Shapes New York, NY, USA Springer-Verlag New York, Inc 1991
68 Zhu S-C Yuille A Region competition: unifying snakes, region growing, and bayes/mdl for multiband image segmentation Pattern Analysis and Machine Intelligence, IEEE Transactions on 18 9 884 900 9 1996
69 Alexandrov O Santosa F A topology-preserving level set method for shape optimization Journal of Computational Physics 204 1 121 130 2005 [Online]. Available: http://www.sciencedirect.com/science/article/pii/S0021999104004103
70 Chen Y Tagare H Thiruvenkadam S Huang F Wilson D Gopinath K Briggs R Geiser E Using prior shapes in geometric active contours in a variational framework International Journal of Computer Vision 50 3 315 328 2002 [Online]. Available: http://dx.doi.org/10.1023/A%3A1020878408985
71 Michailovich O Rathi Y Tannenbaum A Image segmentation using active contours driven by the bhattacharyya gradient flow Image Processing, IEEE Transactions on 16 11 2787 2801 11 2007
72 Paragios N A level set approach for shape-driven segmentation and tracking of the left ventricle Medical Imaging, IEEE Transactions on 22 6 773 776 6 2003
73 sundaramoorthi G Yezzi A Global regularizing flows with topology preservation for active contours and polygons Image Processing, IEEE Transactions on 16 3 803 812 3 2007
74 Cremers D Fluck O Rousson M Aharon S A probabilistic level set formulation for interactive organ segmentation 65 120V 65 120V-9 2007 [Online]. Available: http://dx.doi.org/10.1117/12.708609
75 Gu L Peters T 3d segmentation of medical images using a fast multistage hybrid algorithm International Journal of Computer Assisted Radiology and Surgery 1 1 23 31 2006 [Online]. Available: http://dx.doi.org/10.1007/s11548-006-0001-4
76 Le Guyader C Vese L Self-repelling snakes for topologypreserving segmentation models Image Processing, IEEE Transactions on 17 5 767 779 5 2008
77 Rousson M Cremers D Efficient kernel density estimation of shape and intensity priors for level set segmentation Medical Image Computing and Computer-Assisted Intervention MICCAI 2005, ser Lecture Notes in Computer Science, J Duncan and G Gerig, Eds Springer Berlin Heidelberg 2005 3750 757 764 [Online]. Available: http://dx.doi.org/10.1007/11566489_93
78 Schwarz T Heimann T Wolf I Meinzer H 3d heart segmentation and volumetry using deformable shape models Computers in Cardiology, 2007 9 2007 741 744
79 Staniforth A Côté J Semi-lagrangian integration schemes for atmospheric models-a review Mon Wea Rev 119 9 2206 2223 9 1991 [Online]. Available: http://dx.doi.org/10.1175/1520–04931991119〈2206:SLISFA〉2.0.CO;2
