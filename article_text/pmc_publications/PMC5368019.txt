LICENSE: This file is available for text mining. It may also be used consistent with the principles of fair use under the copyright law.


9215515
20498
Neuroimage
Neuroimage
NeuroImage
1053-8119
1095-9572

28143775
5368019
10.1016/j.neuroimage.2017.01.052
NIHMS848327
Article
Bayesian longitudinal low-rank regression models for imaging genetic data from longitudinal studies
Lu Zhao-Hua a
Khondker Zakaria b
Ibrahim Joseph G. b
Wang Yue b
Zhu Hongtu c*
for the Alzheimer’s Disease Neuroimaging Initiative
1a Department of Biostatistics, St. Jude Children’s Research Hospital, Memphis, TN, USA
b Department of Biostatistics, University of North Carolina at Chapel Hill, Chapel Hill, NC, USA
c Department of Biostatistics, University of Texas MD Anderson Cancer Center, Houston, TX, USA
* Corresponding author: hzhu5@mdanderson.org (Hongtu Zhu)
1 Data used in preparation of this article were obtained from the Alzheimer’s Disease Neuroimaging Initiative (ADNI) database (adni.loni.usc.edu). As such, the investigators within the ADNI contributed to the design and implementation of ADNI and/or provided data but did not participate in analysis or writing of this report. A complete listing of ADNI investigators can be found at: http://adni.loni.usc.edu/wp-content/uploads/howtoapply/ADNIAcknowledgementList.pdf.

4 2 2017
29 1 2017
01 4 2017
01 8 2017
149 305322
This file is available for text mining. It may also be used consistent with the principles of fair use under the copyright law.
To perform a joint analysis of multivariate neuroimaging phenotypes and candidate genetic markers obtained from longitudinal studies, we develop a Bayesian longitudinal low-rank regression (L2R2) model. The L2R2 model integrates three key methodologies: a low-rank matrix for approximating the high-dimensional regression coefficient matrices corresponding to the genetic main effects and their interactions with time, penalized splines for characterizing the overall time effect, and a sparse factor analysis model coupled with random effects for capturing within-subject spatio-temporal correlations of longitudinal phenotypes. Posterior computation proceeds via an efficient Markov chainMonte Carlo algorithm. Simulations show that the L2R2 model outperforms several other competing methods. We apply the L2R2 model to investigate the effect of single nucleotide polymorphisms (SNPs) on the top 10 and top 40 previously reported Alzheimer disease-associated genes. We also identify associations between the interactions of these SNPs with patient age and the tissue volumes of 93 regions of interest from patients’ brain images obtained from the Alzheimer’s Disease Neuroimaging Initiative.

Genetic variants
Longitudinal imaging phenotypes
Low-rank regression
Markov chain Monte Carlo
Spatiotemporal correlation

1. Introduction

Many longitudinal neuroimaging studies concomitantly collect genetic and recurrent imaging data to track individual changes in brain structure and function over time. Several neurodegenerative disorders, including Alzheimer disease (AD), are hypothesized to occur from abnormal development of the brain, which may be caused by the additive and/or interactive effects of various risk genes and environmental risk factors, each contributing small individual effects. Thus, recurrent neuroimaging measures may lead to discoveries of the genetic pathways and the causal genes associated with the specific brain changes underlying such neurodegenerative disorders (Scharinger et al., 2010; Paus, 2010; Peper et al., 2007; Chiang et al., 2011a,b; Saykin et al., 2015).

A standard statistical method used in longitudinal imaging and genetics studies is the massive marginal association (MMA) framework (Li et al., 2013; Zhang et al., 2014; Guillaume et al., 2014; Hibar and et al, 2011; Shen et al., 2010; Bernal-Rusiel et al., 2013; Zhang et al., 2014). This approach repeatedly fits a linear mixed effects model (or generalized estimating equations) for paired imaging phenotypes and genetic markers. Because the MMA framework entails numerous comparisons, it can detect only phenotype-marker pairs with extremely strong signals.

Several attempts have been made to more precisely investigate the effect of multiple genotypes on longitudinal phenotypes. Chen and Wang (2011) proposed functional mixed-effect models with penalized splines and varying coefficients, but they focused on small number of predictors and number of response variables in a low-dimensional setting. Wang et al. (2011) used a sparse multitask regression to examine the association between genetic markers and longitudinal neuroimaging phenotypes. However, their model focused on subjects with the same number of repeated measures and ignored the spatiotemporal correlations of imaging phenotypes. Therefore, the multitask regression model may lead to loss of statistical power to detect phenotype-marker pairs with moderate to weak signals. Vounou et al. (2011) and Silver et al. (2012) proposed that a sparse reduced-rank regression model using penalized regression can detect the main genetic effects on longitudinal phenotypes. They, however, did not account for the spatiotemporal association among the longitudinal phenotypes, which is important for estimation and prediction accuracy. Moreover, none of these studies explored SNP-age interactions, which can reveal dynamic genetic effects on phenotypes.

Several important statistical concerns are associated with the joint analysis of neuroimaging phenotypes and a set of candidate genotypes obtained from longitudinal imaging and genetic studies. First, the number of regression coefficients can be much larger than the sample size, denoted as N. Specifically, let d and p be the dimension of the responses and the number of covariates, respectively. Fitting a multivariate linear mixed effects model usually requires estimating a d × p matrix of regression coefficients, which can be much larger than N, even for moderately high d and p. Second, as illustrated in Fig. 1a, to improve prediction accuracy (Breiman and Friedman, 1997), it is critically important to account for unstructured, within-subject spatial correlations among multivariate neuroimaging phenotypes. Third, as illustrated in Fig. 2a, to improve both estimation and prediction accuracy, it is also important to account for within-subject temporal correlation. Fourth, as shown in Fig. 2b,c, the temporal growth pattern varies across regions of interest (ROIs) in the brain. Accounting for the overall longitudinal change of ROIs is required to increase the detection power of the genetic effects. Fifth, as shown in Fig. 2b, the genetic effects on ROI volumes can vary across time.

Here, we have developed a Bayesian longitudinal low-rank regression (L2R2) model for the joint analysis of high-dimensional longitudinal responses and covariates. We integrated multiple robust methods to explicitly address the new challenges described previously. Our study has four major methodological contributions that were previously undescribed:

To the best of our knowledge, L2R2 is the first model of its kind for jointly analyzing high-dimensional longitudinal responses and covariates, although several approaches have been used for high-dimensional responses and covariates in cross-sectional studies (Rothman et al., 2010; Vounou et al., 2010; Zhu et al., 2014). The L2R2 model also provides a set of standard inference tools (e.g. standard deviation) for determining various unknown parameters. Zipunnikov et al. (2014) proposed a functional principle components analysis for high dimensional (&gt; 10, 000) longitudinal responses, where the intercepts and slopes of time for all voxels were modeled by a few basis functions. However, their methods cannot handle high-dimensional responses and covariates simultaneously because the dimension of the covariance matrix that requires time-consuming spectral decomposition equals the product of the dimensions of the responses and covariates.

The temporal growth patterns of high dimensional responses were characterized by a penalized spline method. Although the spline method has been widely used in other studies (Eilers and Marx, 1996; Ruppert et al., 2003; Wood, 2006; Wu and Zhang, 2006; Lang and Brezger, 2004; Guo, 2002; Morris and Carroll, 2006; Greven et al., 2010), most of these studies focused on univariate responses. We included a new set of coefficients for the high-dimensional gene-age interactions to model the genetic effects on longitudinal trajectories of responses, which were different from previously reported coefficients corresponding to the main genetic effects that were time-invariant (Marttinen et al., 2014; Zhu et al., 2014). A low-rank regression model not only reduces the number of unknown coefficients, but also captures the low-rank structure of the regression coefficient matrix.

To efficiently model the correlation structure and increase the detection power of association between response and covariates, we used a sparse factor model (Bhattacharya and Dunson, 2011) to capture the spatial correlation and the structured random effects to model the temporal correlation of the longitudinal response variables.

We have developed a downloadable L2R2 package, which is available at http://odin.mdacc.tmc.edu/bigs2/.

2. Methods: L2R2 model formulation

Let yik(tij) be the j–th observation at time tij of the kth neuroimaging measurement (e.g. volume of ROI) for the ith subject for i = 1, … , n, j = 1, … , mi and k = 1, … , d, xi = (xi1, · · · , xip)T be a p × 1 vector of genetic predictors (e.g. p/2 genetic markers and p/2 gene-age interactions), and N=∑i=1nmi be the total number of observations. To address the challenges of concomitantly analyzing high-dimensional longitudinal responses and covariates, we proposed the following L2R2 model: For each k, we have

(1) yik(t)=xiTβk+μk(t)+w2,i(t)Tγ2,k+zi(t)Tbik+εik(t),

where βk is a p×1 vector of coefficients for the genetic predictors, μk(t) is a nonparametric function of t that characterizes the overall trajectories of the kth measurement across all subjects, w2,i(tij) = (w2,i1(tij), · · · , w2,iq2(tij))T is a q2 ×1 vector of time-variant or time-invariant prognostic factors (e.g. age, gender), and γ2,k is a q2 × 1 vector of coefficients for the prognostic factors. Moreover, bik is a pb×1 vector of latent random effects that characterize the within-subject correlation of the ith subject for the kth measurement, and zi(t) is the related pb × 1 vector of covariates characterizing the correlation structure, and εik(t) is an error term. Let bi = (bi1, … , bid) such that

vec(bi)~N(0,∑b)andεi(t)~Nd(0,∑e=Θ-1),

where 0 is a vector of zero of appropriate dimension, and Σb and Σe are pbd × pbd and d × d covariance matrices, respectively. We assumed that bi and εi(t) = (εi1(t), … , εid(t))T are independent for all i and t, bi and bi′ are independent for i ≠ i′, and εi(t) and εi′(t′) are independent for i ≠ i′ or t ≠ t′.

To address the challenges described above, we first incorporated the gene-age interactions into xi to model the dynamic genetic effects on individual brain development trajectories. The individual effect of a risk gene on brain development may vary across time. We used data published by the Alzheimer’s Disease Neuroimaging Initiative (ADNI) to show the estimated trajectories with local polynomial regression (LOESS, Cleveland and Devlin, 1988) of subjects with and without the minor alleles for two selected phenotype-single nucleotide polymorphism (SNP) pairs (Fig. 2b,c). There was a strong interaction effect of the SNP rs769451 and age on the right hippocampus. Ignoring such interaction in model (1) may inflate errors, decrease the detection power of important main genetic effects, and miss the age-dependent genetic effects on imaging phenotypes. In contrast, the interaction effect of SNP rs439401 and age on the left hippocampus was small. We need to efficiently distinguish the important interaction effects from others with negligible interaction effects.

We considered the p × d coefficient matrix B = [β1 · · · βd] that characterizes the time-dependent and main genetic effects on the longitudinal phenotypes across all subjects and time points. Given the large d and p, the number of elements in B could be much larger than that of N. Moreover, as shown in Fig. 1a,b, the elements in yi(t) = (yi1(t), … , yid(t))T and xi were highly correlated because of the spatial pattern of brain structure and the linkage disequilibrium structure of SNPs, respectively. Therefore, the estimate of B was unstable and often exhibited horizontal- and vertical-banded structures (Fig. 1c). These structures were more apparent after setting unimportant (i.e. insignificant) elements to zero (Fig. 1d). Applying the characteristics of the coefficient matrix, we introduced a low-rank model for B as follows: (2) B=UΔVT=∑l=1rBl=∑l=1rδlulvlT,

where r is the rank or number of layers of B; Bl = δlulvlT is the lth layer for l = 1, … , r; Δ = diag(δ1, … , δr); U = [u1, · · · , ur] is a p × r matrix; and V = [v1, · · · , vr] is a d×r matrix. Moreover, ul and vl may be viewed as the coefficient of the linear combination of yi(t) and xi, respectively. Rather than investigating the correlation between all phenotype-SNP pairs, we examined the relation between important linear combinations of similar phenotypes and those of similar SNPs. Because only a few sets of genetic variants were expected to be associated with each longitudinal phenotype, a relatively small r ≪ min(p, d) and a sparse U were considered sufficient to represent the important structure of B. Model (2) considerably reduced the number of unknown parameters of B from pd to (d + p + 1)r and increased the power for detecting the important associations.

We used μk(t) to characterize the overall trajectory for the kth neuroimaging measure without consideration of any effects of genomic variables and prognostic factors. The solid curves in Fig. 2b,c depict the LOESS estimates of the development trajectories of the right and left hippocampal volumes, respectively. We used a penalized spline model (Eilers and Marx, 1996; Ruppert et al., 2003; Lang and Brezger, 2004) to model μk(t) with a polynomial of degree s given by

(3) μk(t)=γk,0t0+⋯+γk,sts+∑m=1q1-s-1γk,s+mBm(t;T0)=w1(t)Tγ1,k,

where Bm(t;T0) is a basis function of t; T0 is a vector of predetermined knots over the range of the tij’s (e.g. the sample percentiles); γ1,k = (γk,0, · · · , γk,q1−1)T ; and w1(t) = (1, t, · · · , ts,B1(t;T0), · · · , Bq1−s−1(t;T0))T. Various spline basis functions may be considered for Bm(t;T0), such as the B-spline basis (Eilers and Marx, 1996), truncated power basis (Ruppert et al., 2003), and wavelet basis (Morris and Carroll, 2006). Using μk(t) and the basis functions to flexibly capture the overall trajectories of the longitudinal ROIs measurements increases the detection power of the SNPs and SNP-age interactions and improves the prediction accuracy of responses at later time points.

Another issue in longitudinal studies that must be accounted for is the within-subject correlation among repeated measurements of each phenotype (Verbeke and Molenberghs, 2009; Hyun et al., 2016). Various correlation structures can be formulated through zi(t)Tbik and Σb. We examined the trajectories of all phenotypes across all subjects for the longitudinal data set obtained from the ADNI. The within-subject association mainly occurred from the subject-specific intercept. The trajectories of the left lateral ventricle volume across all subjects are depicted in Fig. 2a. To generate these trajectories, we used a univariate random effect for each ROI by setting pb = 1, zi(t) = 1, and Σb = τbId, where Id is a d × d identity matrix. In this case, the random effects of different ROIs were assumed to be independent.

The correlation structure among the multivariate phenotypes was modeled with another component in (1). The covariance matrix of phenotypic measurements across all subjects and all time points is depicted in Fig. 1a. Phenotypic variables usually exhibit group correlation structures; therefore, we used latent factors to capture these correlation structures. Specifically, we considered an exploratory method of using the sparse factor model (Bhattacharya and Dunson, 2011) for εi(t) as follows: (4) εi(t)=Ληi(t)+ξi(t),

where ∇ is a d × ∞ factor loading matrix, ηi(t) ~ N∞(0, I∞), and ξi(t) ~ N(0,Σξ) with ∑ξ=diag(σξ,12,…,σξ,d2). The structure of ∇ and the number of factors were directly gleaned from the data.

The L2R2 in (1) with (2) – (4) incorporated can be rewritten in the matrix form

(5) Y=XUΔVT+WΓ+Zb+E.

The notational definitions, prior distributions of the parameters and the technical details of the posterior computation were provided in the appendix.

3. Simulation study

3.1. Simulation setup

We used simulations to examine the finite-sample performance of the L2R2 model. We simulated Y according to model (5). We considered four cases with various dimensions and priors: (i) p = 50, d = 50; (ii) p = 100, d = 100; (iii) p = 200, d = 100; and (iv) p = 400, d = 100. The dimensions of these cases were comparable with the ADNI data set used in this study and with other related neuroimaging and genetic studies (Wang et al., 2011; Zhu et al., 2014; Marttinen et al., 2014). We chose the first n = 100 subjects from the ADNI data set and selected the top p/2 SNPs from the top 40 genes reported by AlzGene database (www.alzgene.org) as of June 10, 2010. Each subject was observed mi times to replicate the ADNI data set, resulting in N = 422 records. We used the p/2 SNPs and their interactions with age to form the X in model (5). The Win (5) contains q = 15 columns, including the intercept, the standardized intracranial volume, sex, education, handedness, and the basis function of age. The basis function consists of age, age2, age3, and the B-spline basis given the jth percentile, j = 0, 10, 20, … , 100. The elements of b were independently generated from a N(0, 1) distribution.

The following parameters in (5) were used in the simulation: The low-rank coefficient matrix B was generated with the true rank r0 = 3 in a moderately sparse case with 65% zero elements and in an extremely sparse case with 95% zero elements. Specifically, we set B = UΔV, where U = (ujl), Δ = diag(δll) = diag(100, 80, 60), and V = (vlk) as p × 3, 3 × 3, and 3 × d matrices, respectively. Moreover, we generated all elements ujl and vlk independently from a N(0, 1)×binomial(1, p1) distribution and then normalized the columns of U and V to have zero mean and unit variance. The value of p1 was tuned so that approximately 65% of the elements of B were zeros. Each element of Γ was independently generated as a γjk ~ N(0, 1) × binomial(1, 0.5). We simulated εi(t) ~ Nd(0,Σe), where the precision matrix Σe was first generated by a d × d matrix A = (ajj′) with ajj = 1 and ajj′ = uniform(0, 1) × binomial(1, p2) for j ≠ j′, setting Σe = AAT, and standardizing Σe into a correlation matrix. The value of p2 was tuned so that approximately 20% of the elements in Σe were zeros, yielding the mean of the absolute correlations of Σe at approximately 0.40.

For each case, 100 simulated data sets were generated. For each simulated data set, we ran the Gibbs sampler for 10, 000 iterations after 5000 burn-in iterations. We chose noninformative priors for the hyperparameters and set a0 = b0 = c0 = d0 = e0 = f0 = 10−6. For the covariance parameter Σe, we chose moderately informative priors to impose the positive-definite constraint.

Besides modeling the trajectories of the response variables to improve detection power of the genetic variables, the splines in W could also be used to predict the response variables at later time points. We calculated the mean of the response variables XpredUΔVT + WpredΓ + Zpredb for every the subjects at one year after their last observation, where Xpred, Wpred, and Zpred contain the corresponding predictors for these subjects at the later time points. The prediction was based on Xpred Û Δ̂ V̂T +WpredΓ̂ + Zpredb̂, where the hat represents the posterior means of the parameters and random effects. We compared the means and predicted means to check the prediction accuracy using the splines in W.

3.2. Comparison with four other state-of-the-art methods

We compared the L2R2 model with four state-of-the-art methods that were developed to establish the association between high-dimensional responses and predictors. First, we considered MMA analysis between the high-dimensional response variables and predictors. Each phenotype was regressed on the covariate matrix W and the residue was associated with each SNP in X with regression. We used the lme4 R package (Bates et al., 2015) for MMA.

Second, we considered the group-sparse multitask regression and feature-selection (G-SMuRFS, Wang et al., 2011) method, which is a representation of associating high dimensional imaging and genetic variables with regularization methods. The longitudinal volumes of ROIs were used as the response variables, and the X and W in L2R2 were combined as the matrix of predictors in G-SMuRFS. The spline basis in W modeled the overall longitudinal trajectories of the ROI volumes, and the SNP-age interactions in X represented the SNP effects on the longitudinal trajectories of ROIs. The large matrix of coefficients was estimated with penalty functions and optimization. Each covariate, SNP and SNP-age interaction formed a group in the penalty function. We used exp(−7), exp(−6), … , exp(2) as possible values of the tuning parameters in the G-SMuRFS method and performed a five-fold cross validation to choose the tuning parameters. G-SMuRFS did not make any assumption on the distribution and correlation structure of the response variables. In our longitudinal study, G-SMuRFS method did not explicitly account for the within-subject temporal correlations and spatial correlations. Also, G-SMuRFS did not use dimension reduction for the coefficient matrix like the low-rank representation of B in L2R2.

Third, we considered the Bayesian canonical correlation analysis (BCCA Klami et al., 2013) to obtain linear combinations of the response variables Y and the predictor X. The coefficients of the linear combinations were conceptually similar to U and V in (5), and we denoted their estimates by Ũ and Ṽ, respectively. The coefficient matrix B was estimated by Ũ ṼT. Gamma mixture multivariate normal distributions were assigned to U and V, and the correlation structure of the response variables and the SNPs were characterized by a factor model. We used the default setting of the companion R package and used eight components in the BCCA method. The R package cannot run a continuous predictor; therefore, we excluded the SNP-age interactions in X. Also, the package does not process covariates like W. Therefore, we regressed Y on W and applied the BCCA method to the residue and X. Unlike the L2R2 model, the BCCA method does not account for within-subject structural correlation or the interactions between SNPs and age.

Fourth, we considered the Bayesian reduced-rank regression (BRRR) method developed by Marttinen et al. (2014). Because the BRRR software package does not allow continuous predictors, we excluded the SNP-age interaction terms in X. We also set the rank to three and ran all of the other program parameters at their default settings. The BRRR method can process W directly, so we did not need to regress Y on W beforehand. In contrast with the L2R2 model, the BRRR method does not account for SNP-age interactions or within-subject structural correlation.

3.3. Evaluation

To evaluate the finite-sample classification performances of all five of the methods, we calculated the sensitivity and specificity scores of selecting the nonzero elements in the coefficient matrix B for each method. The following criteria were used for the selection of the coefficients in each method. As the G-SMuRFS method does not provide standard error estimate for each coefficient, the importance of the association between each pair of ROI and SNP/SNP-age interaction was determined by the absolute values of the coefficient estimates. For all other methods, the coefficients were selected if the absolute values of their standardized estimates (coefficient estimate over its standard error commonly used to account for the estimation uncertainty) were larger than a threshold. The sensitivity and specificity scores for a given threshold T0 were defined as

Se(T0)=TP(T0)TP(T0)+FN(T0)andSp(T0)=TN(T0)TN(T0)+FP(T0),

where TP(T0), FN(T0), TN(T0), and FP(T0) were the numbers of true positives, false negatives, true negatives, and false positives, respectively. Changing the threshold T0 produced different sensitivity and specificity scores, generating the receiver operating characteristic (ROC) curves. In each ROC curve, the sensitivity was plotted against one minus specificity.

3.4. Results

The ROC curves of all four methods and the L2R2 model are depicted in Fig. 3. ROC curves that are closer to the upper-left corner are more likely to identify true positives and control for false positives.

In all simulation settings, the L2R2 model outperformed the four competing methods because the L2R2 model was designed to specifically address the challenges described above. Among the four previously developed methods, the G-SMuRFS method had the best performance. However, the G-SMuRFS method did not characterize the correlation structure among the response variables like the L2R2 model did. Therefore, the G-SMuRFS method potentially increased the number of false positives. Consequently, when the number of phenotypic variables increased, the difference between the L2R2 model and the G-SMuRFS method for d = 100 was larger in terms of main effects and interactions than that for d = 50.

The BRRR and BCCA methods cannot process SNP-age interactions because of the limitations of their companion R packages. Therefore, they increase modeling error and reduce the power of detecting important main genetic effects in the presence of the SNP-age interactions. These limitations are worsened as the number of SNPs increases. Although the model setup of the BRRR method was similar to that of the L2R2 model, the prior setting for the BRRR method was more subtle and appeared to be more suitable for small numbers of responses and predictors. Thus, the BRRR method is very sensitive to the number of responses and predictors. The MMA method performed the worst, as it did not account for the correlation structure of responses and predictors or the spatio-temporal correlation structure of the longitudinal phenotypes.

Selected spline functions in the true coefficients (Γ) and their corresponding estimates obtained from the L2R2 model and the G-SMuRFS method are shown in Fig. 4a–b. It is apparent from these splines that the bias of the L2R2 model was smaller than that of the G-SMuRFS method. The estimated trajectories with smaller bias enabled us to better predict the response variables of later time points. A scatter plot of the true means at later time points versus the predicted means across all subjects and response variables in a randomly selected data set is shown in Fig. 4c. The true and predicted means were close to each other, indicating that model (5) can accurately predict longitudinal responses.

We examined the Markov chainMonte Carlo (MCMC) convergence through calculation of Gelman and Rubin’s shrink factors for all the parameter estimates obtained from three MCMC chains with different start values of parameters (Fig. 4d). The MCMC chains appeared to converge after 2000 iterations, as the shrink factors for all the parameters were less than 1.2. Generating 4000 MCMC samples after discarding 4000 burn-in samples for the L2R2 model to fit the four cases (i.e. p=50, d=50; p=100, d=100; p=200, d=100; and p=400, d=100) took approximately 6, 14, 16, and 22 min, respectively, with a single core of an Intel Xeon E5520 CPU. In comparison, the G-SMuRFS method took 8, 18, 30, and 90 s to fit the four cases, respectively. However, the MCMC samples of the L2R2 model allowed us to make statistical inferences on all parameter estimates, whereas this could not be performed with the G-SMuRFS method. It is important to note that statistical inferences made under a high-dimensional setting require some resampling and splitting procedures (Meinshausen and Bühlmann, 2010). In this case, the G-SMuRFS method would require processing of thousands of subsamples, which may be computationally demanding.

4. Real data analysis

4.1. ADNI data description

The ADNI was launched in 2003 as a 5-year public-private partnership by the National Institute on Aging, the National Institute of Biomedical Imaging and Bioengineering, the Food and Drug Administration, private pharmaceutical companies, and nonprofit organizations. The primary goal of the ADNI is to test whether serial magnetic resonance imaging (MRI), positron emission tomography, other biological markers, and clinical and neuropsychological assessments can be combined to measure the progression of mild cognitive impairment and early AD. Determination of sensitive and specific markers of very early AD progression may aid researchers and clinicians in developing new treatments and monitoring their effectiveness, as well as reduce the time and cost of clinical trials.

4.2. Preprocessing

The MRI data were collected across a variety of MRI scanners with individualized protocols for each scanner to obtain standard T1-weighted images, volumetric 3-dimensional sagittal magnetization prepared gradient-echo sequences, or equivalent images with various resolutions. The typical imaging protocol included inversion time=1000 ms, repetition time=2400 ms, flip angle=8°, and field of view=24 cm with a 256×256×170 acquisition matrix in the x–, y–, and z–dimensions, yielding a voxel size of 1.25 × 1.26 × 1.2 mm3. Standard steps such as anterior commissure and posterior commissure correction, skull stripping, cerebellum removing, intensity inhomogeneity correction, segmentation, and registration (Shen and Davatzikos, 2004) were used to preprocess the MRI data. We then carried out automatic regional labeling for the template and transferring the labels after the deformable registration of subject images. After labeling 93 ROIs, we computed the ROI volumes for each subject.

The Human 610-Quad BeadChip (Illumina, Inc., San Diego, CA) was used to genotype the subjects whose images in the ADNI database we analyzed, resulting in a set of 620,901 SNP and copy number variation markers. Because the Apolipoprotein E (APOE) SNPs rs429358 and rs7412 are not included in the Human 610-Quad Bead-Chip, they were genotyped separately. These two SNPs define a three allele haplotype, namely the ε2, ε3, and ε4 variants, and the presence of each variant was available in the ADNI database for all subjects. We used EIGENSTRAT software (package 3.0) to calculate the population stratification coefficients of all subjects. To reduce population stratification effects, we used images from only white subjects who had at least one imaging sample available (749 of 818 subjects in the ADNI data set).

We also performed quality control on this initial set of genotypes (Wang et al., 2011). To input the missing genotypes into our analysis, we used MACH4 software (version 1.0.16) with default parameters to infer the haplotype phase. We also included the APOE-ε4 variant, coded as the number of observed ε4 variants. We removed SNPs with more than 5% missing values and entered the mode for the missing SNPs. In the final quality-controlled genotype data, we removed SNPs with a minor allele frequency smaller than 0.1 and a Hardy-Weinberg p-value&lt; 10−6.

4.3. Data analysis

The aim of our analysis was to apply the L2R2 model to establish an association between the SNPs in the top AD-risk genes reported by AlzGene (http://www.alzgene.org/) and the volumes of 93 brain ROIs collected by the ADNI. We used the L2R2 model to carry out formal statistical inferences, such as the identification of significant SNPs and SNP-age interactions. In this data analysis, we included data from n = 749 subjects and N = 2817 MRI measurements, resulting in an unbalanced data set. Among the subjects, 41 had only one observation and another 67 had only two observations. A random effect was used to account for the subject-specific intercept. For the age effect, we used a quadratic penalized spline with 11 knots that were based on the percentiles of standardized age. We also included intracranial volume, sex, education, and handedness as covariates in W to adjust the ROI volumes.

We considered two sets of top AD-risk genes. First, we used the 114 SNPs in the top 10 genes reported by the AlzGene database. After we performed quality control to the data set, 87 SNPs, APOE-ε4, and their interaction with age were included in the model (1). Second, we selected the 1224 SNPs in the top 40 AD-risk genes by the AlzGene database. After applying quality control to the data, we included 1072 SNPs and their interactions with age in our analysis. A map of the linkage disequilibrium among the 1072 SNPs revealed a clear clustering pattern of SNPs (Fig. 1b). Specifically, the correlations among SNPs within each gene were large (&gt; 0.7), whereas those among SNPs in different genes were relatively small.

We fitted the L2R2 model (1) to the ADNI data as follows: To determine the rank of B, the L2R2 model was run up to r = 10 layers. By comparing the five different selection criteria in Zhu et al. (2014), we chose r = 3 layers as the optimal rank for the final data analysis. We ran the Gibbs sampler for 20, 000 iterations after 20, 000 burn-in iterations. For the G-SMuRFS method, we used the same Y matrix, combined the W and X matrices into a single predictor matrix, and then used the five-fold cross validation to choose the optimal penalty.

On the basis of the MCMC samples, we calculated the posterior median and median absolute deviations of U, V, and B, and used 1.4826 × median absolute deviations to compute the robust standard errors for each element of B. To determine the important coefficients, we used the standardized estimates Bstd, which were the absolute values of the estimates over their standard errors. To validate the low-rank structure of B, we used the results of the top 10 genes and set the elements of B to zero if their absolute standardized estimates were larger than a threshold (Fig. 5). The sparsely distributed points along the horizontal and vertical directions indicated that the low-rank model was suitable for characterizing the association between the neuroimaging and genetic variables in the ADNI data set. We used a pragmatic approach to calculate the threshold for the Bayesian estimates, which resembled the Bonferroni correction in a frequentist approach. The threshold was the F(1−0.025/(pr/2+dr+r)), and F was the quantile function of standard normal distribution, where the denominator was the total number of parameters in the low-rank structure Uint, Δ, and V. Uint was the matrix of coefficients of interaction terms. The thresholds for the top 10 genes and top 40 genes were 3.912 and 4.339, respectively. We referred the SNPs that passed the thresholds as significant SNPs though the meaning is different from frequentist significance.

4.4. Results

We determined the longitudinal trajectories of the neuroimaging ROI volumes, the effects of the significant SNPs on such longitudinal trajectories, and the dynamic genetic effects on the trajectories. We estimated the trajectories of all standardized ROI volumes on the basis of Γ̂ and W (Fig. 6). ROIs with decreasing volumes occurred in many regions of the brain, including the left and middle temporal gyri, the left and superior temporal gyri, and the left and right amygdala. ROIs with increasing volumes occurred in the hollow areas of the brain and areas of white matter and included the left and right lateral ventricles, the left and right frontal lobe white matter, and the left and right temporal lobes. Moreover, the trajectories of most ROIs demonstrated structural symmetry.

Because hippocampal atrophy and ventricular enlargement are consistent findings in patients with AD and mild cognitive impairment (Apostolova et al., 2012), we depicted the effects of some SNPs on the longitudinal trajectories of the left and right lateral ventricles and the left and right hippocampi (Fig. 7). Let A and a denote the major and minor alleles of a specific SNP, respectively. For each ROI, we depicted the mean trajectory associated with a selected SNP (black solid curves) and the mean trajectory corresponding to the three allelic combinations (i.e. AA, Aa, and aa) of the SNP (Fig. 7). The minor allele of SNP rs10501608 increased the rate of hippocampal atrophy, whereas the SNP rs1354106 minor allele had the opposite effect. Moreover, the minor allele of SNP rs10501608 increased the rate of ventricular enlargement, yet the SNP rs10501604 minor allele had the opposite effect.

We plotted the primary SNP-age interaction effects, whose absolute standardized estimates were larger than the predetermined threshold, on the longitudinal trajectories corresponding to the top 10 genes (upper row) and the top 40 genes (lower row) (Fig. 8). The plots revealed a generally symmetric pattern for the left and right hemispheres, which indicated the genetic effects on the longitudinal change of ROI volumes were symmetric. Some asymmetric longitudinal genetic effects also occurred. For example, in the analysis of the SNPs from the top 40 genes, only the left nucleus accumbens and the right subthalamic nucleus were associated with SNP rs2273684, whereas their contralateral counterparts were not substantially correlated with any SNP. With exception of the left and right lateral ventricles, the genetic effects on most ROIs in the left and right hemispheres occurred in the same direction. Because both the number of parameters and the threshold for significance increased with the number of top genes, the number of significant SNP-age interactions decreased with the number of top genes. However, the effects of significant SNP-age interaction detected for the top 40 genes were more substantial.

The significant SNP-age interaction effects of the ROIs depicted in Fig. 8 formed SNP-specific networks that we visualized with BrainNet Viewer (Xia et al., 2013) in Fig. 9 and Fig. 10. Among all the networks, each SNP-specific network demonstrated spatially adjacent patterns. Some SNPs were associated with many ROIs, although other SNPs were associated only with ROIs in a specific brain area. The networks could be considerably different for different SNPs in a gene. In each network the sizes of genetic effects on various ROIs was relatively homogeneous, whereas the those across different networks may be substantially different. The most significant SNPs were close to the ventricular system. Some ROIs in the frontal lobe were also associated with SNPs that exhibited small growth effects, but ROIs near the prefrontal cortex were not strongly associated with the SNPs in the top 10 and top 40 genes.

We used MMA based on linear mixed effects models where each SNP, its interaction with age, and the covariates in W were regressed on each ROI volume. The p-values of the significant coefficients are smaller than 0.05/(pr/2 + dr + r) (Bonferroni correction with the number of parameter in the L2R2), even though the true number of regression parameter is much larger (pd). The number of significant coefficients is smaller if the true number of parameters is used for correction. We compared the important estimated associations with L2R2. The two ROIs identified in the case with top 10 genes were the left and right lateral ventricles. Twelve ROIs were found in the case with top 40 genes, ten of which were found by L2R2. The number of significant associations identified by MMA were much less than that of L2R2. L2R2 provided more power in identifying important pairs of ROIs and SNP-age interactions and revealed more SNPs that may alter the longitudinal trajectories of ROIs.

The results of G-SMuRFS were not directly comparable to those of L2R2 and MMA because G-SMuRFS does not provide standard error estimates or a cut-off for all pairs of association as in L2R2 and MMA. The importance of the SNPs and SNP-age interactions was ranked by the sum of the absolute values of the estimated coefficients across all ROIs. Nonetheless, we found the top ROIs and SNP-age interactions, and some of them overlap with those from L2R2 in the case with top 40 genes.

We built the networks of ROIs with two criteria to study the structure of the longitudinal volumes of ROIs. Let Bint be the part of B corresponding to the SNP-age interactions, and Bint,std be the standardized Bint. Firstly, we selected the ROIs corresponding to the large diagonal elements of Bint,stdTBint,std to form a network. The change of each ROI in the network was heavily associated with the SNPs. The network was a collection of important ROIs which were affected by the time-dependent SNP effects. Secondly, we constructed networks based on the absolute values of every columns of the standardized Vstd, which is the standardized V. Each network was an important combination of the longitudinal ROI measurements, and was strongly associated with the joint effect of a weighted combination of SNPs and age-SNP interactions quantified by the corresponding column of U. The top 10 ROIs in the networks were listed in Table 1 and Table 2 for the top 10 and 40 genes, respectively. Such networks were mostly symmetric for the left and right hemispheres, which also illustrated the genetic effects on the longitudinal volumes of ROIs are largely symmetric.

The imaging phenotypes provided quantitative measurements of the morphometric changes of the ROIs, which may characterize the underlying degenerative process of AD and capture information mirroring patients’ diagnostic status. We used a generalized linear-mixed model with logit link to determine the associations between longitudinal diagnostic status and the ROI volume. We found that 70 of 93 ROIs and 69 ROI and age interactions were significantly correlated with longitudinal diagnostic status after applying the false discovery rate correction with the significant level 0.05. Tissues with ROIs that correlated with longitudinal diagnostic status included the hippocampus, cingulate cortex, amygdala, and lateral ventricles, in addition to many other areas of the brain. Moreover, most of the ROIs identified by the L2R2 model in Figure 8 were among the 69 ROIs that demonstrated age-dependent interactions. The SNPs used in the L2R2 model were previously reported in a genome-wide association study of the diagnostic status of patients with AD. Our findings show that the longitudinal trajectories of many ROIs are highly associated with the longitudinal patterns of diagnostic status; therefore, these ROIs may serve as consistent surrogates for measuring AD progression.

The L2R2 model elucidated some ROI-SNP pairs that were reported in previous genome-wide association studies on the basis of diagnostic status, cognitive scores, and imaging measurements. For example, the SNP rs1354106, which occurs in the CD33 gene, was associated with a slower declining rate of the AD assessment scale cognitive score (Sherva et al., 2014). Biffi et al. (2010) reported that SNP rs1408077, which occurs in the CR1 gene, was associated with disease status. Moreover, the SNP rs1408077 was related to the entorhinal cortex thickness (Biffi et al., 2010) and hippocampal atrophy (Lazaris et al., 2015). The SNP rs6088662, which occurs in the PRNP gene, was associated with reduced hippocampal volume and cognitive performance in healthy individuals (Li et al., 2016).

Multivariate imaging measurements may provide additional information compared with univariate measurements, such as diagnostic status. Some ROIs that were not associated with diagnostic status in the generalized linear mixed model were associated with certain SNPs in the L2R2 model, such as the left and right thalamus, right medial frontal gyrus, and right lateral front-orbital gyrus. More ROI measurements yielded additional variation in the SNPs compared with that of diagnostic status. Thus, integrating multivariate imaging measurements with genetic variables and diagnostic status may provide a clearer picture of the biological processes occurring in AD (Zhao and Castellanos, 2016).

4.5. Random effects

We examined the usefulness of incorporating random effects into our model by investigating the distribution of the estimated random effects over all subjects for each ROI. We generated histograms and quantile-quantile plots of the random effects obtained from two randomly selected ROIs from the L2R2 model that were fitted to the top 10 genes (Fig. 11). The variances of the estimated random intercepts were substantial compared with the scale of the response variables, which coincided with the subject-specific intercepts of the neuroimaging measurements (Fig. 2a). Moreover, these distributions did not severely deviate from the normal distribution.

To statistically test the presence of the subject-specific random effects Zb, we refitted the data with a restricted L2R2 model without the presence of Zb and then compared the log likelihood ratio of the full and restricted L2R2 models. The inclusion of random effects decreased the log likelihood function by 14,000 (or 5%), and the number of parameters increased by 93. Therefore, incorporating random effects into the L2R2 model was useful for characterizing the correlation structure of the imaging phenotypes and improved the detection of the association between imaging phenotypes and genetic variants.

5. Discussion

We have developed a Bayesian L2R2 model to determine the association between longitudinal imaging responses and covariates with applications in imaging genetic data. We used this model to approximate the large association matrix. We combined a sparse latent factor model and random effects to flexibly capture the complex spatiotemporal correlation structure. We incorporated splines to capture the effect of aging and combined a traditional coefficient estimation with a low-rank approach. The L2R2 model dramatically reduced the number of parameters to be sampled and tested, leading to a remarkably faster sampling scheme and efficient inference. The simulation studies demonstrated that the L2R2 model has higher power in detecting important time-dependent and main genetic effects. Age-dependent genetic effects are useful for characterizing age-related degenerative disorders like AD. When strong genetic effects modify changes in brain morphology over time, it is critically important to account for SNP-age interaction effects and to improve the detection of time-invariant main genetic effects. Although our findings confirmed the important role of well-known genes, such as APOE-ε4, in the pathology of AD, they also elucidated other potential candidate genes that warrant further investigation.

The L2R2 model effectively established associations between phenotypic markers present in neuroimaging data and the presence of high-risk AD alleles. However, many considerations still merit further research. First, it is important to consider the joint effect of genetic markers and environmental factors on high-dimensional imaging phenotypes (Thomas, 2010). Second, it is of great interest to incorporate rare variant genetic markers (Bansal et al., 2010) with the L2R2 model. Third, the key features of the L2R2 model may be adapted to more complex data structures (e.g. twin and family sequencing studies) and other parametric and semiparametric models. Fourth, the L2R2 model may be extended to combine different imaging phenotypes calculated from other imaging modalities (e.g. diffusion tensor imaging, functional MRI, and electroencephalography) in concomitant imaging and genetic studies. Fifth, group structures among SNPs (i.e. gene-based grouping)could be incorporated to improve the efficiency of modeling-correlated SNPs by choosing group priors for U.

One important feature of L2R2 is the inclusion of SNP-age interactions to model the genetic effects on the longitudinal change of ROIs. The interactions can also be viewed as the age-dependent genetic effects. The total age-varying genetic effects of the jth SNP xij is βj + β2jtij, which assumes that the effect is a linear function of age. This assumption can be relaxed by modeling the effects as more flexible functions of age, e.g., polynomial functions and nonparametric functions, which is known as the varying-coefficient models (Hastie and Tibshirani, 1993; Fan and Zhang, 1999, 2008). Varying-coefficient models have been used to study the time-dependent genetic effects and gene-environment interactions (Gong and Zou, 2012; Wu and Cui, 2013; Li et al., 2015). Compared to L2R2, these studies only modeled univariate response variables. Extending L2R2 to incorporate more flexible varying genetic effects is helpful to better understand the genetic impact on the complex diseases at different age and under various states of environment factors.

It is worth noting that in Fig. 2b, the volume of right hippocampal formation appeared to increase in the three-year visit for subjects with minor allele of rs768451. This phenomenon is less expected in studies of Alzheimer’s disease but it may be explained by the following reasons. We included healthy subjects, MCI and AD patients from the ADNI data set in our analysis. The volumes for the healthy subjects may be relatively stable. Moreover, several studies in the literature (Erickson et al., 2011; Leavitt et al., 2014; Niemann et al., 2014) reported that exercises were associated with the increase of hippocampal volume in older adults. Also, the number of subjects in the three-year visit was smaller than those in the previous visits, and the average of the hippocampal volumes for these subjects was larger than the average for all subjects at the initial visit. The dropout during the last visit may be informative. These factors warrant further investigation in the future studies.

Supplementary Material

This material was based upon work partially supported by the NSF grant DMS-1127914 to the Statistical and Applied Mathematical Science Institute. The research of Dr. Zhu was partially supported by NSF grants SES-1357666 and DMS-1407655, NIH grant MH086633, and a grant from Cancer Prevention Research Institute of Texas.

7. Appendix: technical details

7.1. Matrix formulation of L2R2

The L2R2 can be rewritten in the matrix form (5)

Y=XUΔVT+WΓ+Zb+E,

where yi(t) = (yi1(t), . . . , yid(t))T, yi = (yi(ti1), . . . , yi(timi))T, Y = (y1T, . . . , ynT)T, 1mi be a mi × 1 vector of ones, and tmi = (ti1, . . . , ti,mi)T. Let xi∗ be the SNPs for the ith subject, Xmain=(x1∗⊗1m1T,…,xn∗⊗1mnT)T,Xint=(x1∗⊗tm1T,…,xn∗⊗tmnT)T, and X = (Xmain,Xint). Moreover, let Zi = (zi(ti1), . . . , zi(timi))T, Z be an N × npb block diagonal matrix with diagonal elements Z1, . . . ,Zn, and b = (bik) be an npb × d block matrix with elements bik. We defined wi(t) = (w1(t)T,w2,i(t)T)T, Wi = (wi(1), . . .wi(timi))T, and W = (W1T, . . . ,WnT)T. Let εi(t) = (εi1(t), . . . , εid(t))T, Ei = (εi(ti1), . . . , εi(timi))T, and E = (E1T, . . . ,EnT)T. Consequently, Y is an N × d matrix of imaging measurements; X is an N × p matrix of genetic predictors; W is an N × q matrix of covariates with fixed effects; Z is an N × npb matrix of covariates with random effects; and E is an N × d matrix of error terms, where q = q1 + q2. Γ is a q × d matrix and its first q1 row consists of Γ1 = (γ1,1, . . . , γ1,d), and its last q2 columns consist of Γ2 = (γ2,1, . . . , γ2,d). In model (5), we primarily made statistical inferences from B (equivalently U,Δ,V) and Γ.

7.2. Priors

We consider priors on the elements of B. Let Ga(a, b) be a gamma distribution with scale a and shape b. We choose L2 priors on the parameters at each layer Bl as follows: δl~N(0,τδ-1),τδ~Ga(a0,b0),ul~Np(0,p-1Ip),andvl~Nd(0,d-1Id),

where a0 and b0 are prespecified hyperparameters. Although, we have used the same precision parameter for each element of ul, group information can be incorporated by choosing separate precision parameters for each group. The number of predictors p (or d) is included in the hyperprior of ul (or vl) to have a positive definite covariance matrix of high dimensional ul (or vl). Moreover, this data driven approach for the priors of ul and vl requires no additional hyperparameters to choose. because we standardize all predictors to have zero mean and unit variance, a single prior suffices for all elements of ul. Moreover, because we rescale all of the responses, we use the same dispersion for all components of vl. Since we focus on exploiting the potential two-way correlations among the estimated coefficients, we choose the L2 priors, which tend to borrow strength from correlated neighbors and force the coefficients towards each other to produce two highly correlated coefficients. Moreover, the posterior computations are simpler and faster under the L2 priors.

We consider priors on the elements of Γ = (γjk). We also choose the L2 prior on the γjks as follows: γjk~N(0,τγ-1)andτγ~Ga(c0,d0),

where c0 and d0 are hyperparameters. For the subject-specific random coefficients, we also choose independent and identically distributed normal priors as

τb~Ga(e0,f0),

where e0 and f0 are hyperparameters.

For the sparse factor model (4), we assign the multiplicative gamma process shrinkage prior (Bhattacharya and Dunson, 2011) on Λ to automatically determine the dimension of the factors needed to characterize the error covariance structure. The shrinkage prior increasingly shrinks the factor loadings towards zero with the column index and avoids identifiability of the order of the factor in ηi(t). Specifically, these priors are summarized as follows: Λ={λkh},k=1,…,d,h=1,…,∞,λkh∣ϕkh,τλh~N(0,ϕkh-1τλh-1),ϕkh~Ga(v/2,v/2),τλh=∏l=1hψl,ψ1~Ga(a1,1),ψl~Ga(a2,1),l≥2,σξ,k-2~Ga(aσk,bσk),

where v, a1, a2, aσk, and bσk are prefixed hyperparameters, τλh is a global shrinkage parameter for the h-th column, and the ϕkhs are local shrinkage parameters for the elements in the h-th column. When a2 &gt; 1, the τλhs increase stochastically with the column index h, which shrinks the elements of the loading matrix to zero as the column index progresses and determines the effective dimension of Λ.

7.3. Posterior computation

The joint posterior for the L2R2 model with the above priors can be written as

(6) p(U,Δ,V,Γ,b,Θ∣data)∝τδa0+12r-1τγc0+12qd-1τbe0+12npbd-1e-b0τδ-d0τγ-f0τbexp{-12∑l=1r(τδδl2+dvlTvl+pulTul)}+exp{-12Tr(τγΓΓT+τbbbT)}exp{-12Tr(Y-XUΔV-WΓ-Zb)Θ(Y-XUΔV-WΓ-Zb)T},

where Tr(·) is the trace of the matrix.

We propose a straightforward Gibbs sampler for posterior computation, which converges rapidly. Starting from the initiation step, the Gibbs sampler at each iteration proceeds as follows:

For l = 1, . . . , r, update ul from the full conditional distributions p(ul∣-)~Np(δl∑ulXTYB,lΘvl,∑ul),

where YB,l=Y-X∑l′≠lrBl-WΓ-Zb and ∑ul={pIp+δl2(vlTΘvl)XTX}-1.

Update vl from p(vl∣-)~Nd(δl∑vlΘYB,lTXul,∑vl),

where ∑vl={dId+δl2(ulTXTXul)Θ}-1.

Update δl from p(δl∣-)~N(σδl2ulTXTYB,lΘvl,σδl2),

where σδl2={τδ+(vlΘTvl)(ulTXTXul)}-1.

Update τδ from p(τδ∣-)~Ga(a0+0.5r,b0+0.5∑l=1rδl2).

Update γk (i.e. the kth column of Γ) from p(γk∣-)~Nd(∑γkWT{yΓ,kθkk+(YΓ,-k-WΓ-k)θk,∑γk),

where ΣΓk = {θkkWTW+ τγIq}−1. yΓ,k is the kth column of YΓ = Y − XB − Zb; YΓ,−k is the matrix after dropping the kth column of YΓ; θkk is the element for the kth row and kth column of Θ; θk is the kth column of Θ after dropping θkk; and Θ−kk is the matrix after dropping kth row and kth column of Θ.

Update τγ from p(τγ∣-)~Ga(c0+0.5qd,d0+0.5∑j=1q∑k=1dγjk2).

Let b̃k be the kth column of b. Update b̃k from p(b∼k∣-)~N(∑bkZT{yb,k-(Yb,-k-Zb-k)θk},∑bk2),

where Σbk = (θkkZTZ + τbInpb)−1. yb,k is the kth column of Yb = Y–XB–WΓ, and Yb,−k is the matrix after dropping the kth column of Yb.

Update τb from p(τb∣-)~Ga(eo+0.5npbd,f0+0.5∑i=1n∑j=1pb∑k=1dbijk2).

Let k* be a integer large enough to approximate the number of factors in the factor model (4), and εit=Λ∗ηit∗+ξit be the corresponding approximation. Update Λk∗, which is the kth row of Λ*, from its full conditional distribution p(Λk∗∣-)~N((σξ,k-2ΩTΩ+Dk-1)-1ΩTσξ,k-2Ek,(σξ,k-2ΩTΩ+Dk-1)-1),

where Ω = (η11, . . . , η1m1 . . . , ηnmn)T, Ek is the kth column of E = Y–XB–WΓ−Zb, and Dk=diag(ϕk1-1τλ1-1,…,ϕkk∗-1τλk∗-1) for k = 1, . . . , d.

Update ϕkh from its full conditional distribution p(ϕkh∣-)~Ga(v+12,v+λkh2τλh2).

Update σξ,k-2, k = 1, . . . , d, from its full conditional distribution p(σξ,k-2∣-)~Ga(aσk+n2,bσk+12∑i=1n∑t=1mi(εitk-Λk∗Tηit∗)2),

where εitk is the element in E for the ith subject at time t and kth response variable.

Update ψ 1 from its full conditional distribution p(ψ1∣-)~Ga(a1+12dk∗,1+12∑g=1k∗τλg(1)∑k=1dϕkgλkg2),

where τλg(1)=∏t=2gψt for h = 1, . . . , k*.

Update ψ h, h ≥ 2 from its full conditional distribution p(ψh∣-)~Ga(a2+12d(k∗-h+1),1+12∑g=hk∗τλg(h)∑k=1dϕkgλkg2),

where τλg(h)=∏t=1,t≠hgψt for h = 1, . . . , k*.

Update ηit for t = 1, . . . , mi, i = 1, . . . , n from the conditionally independent posteriors p(ηit∣-)~N((Ik∗+ΛT∑ξ-1Λ)-1Λk∗T∑ξ-1εit,(Ik∗+ΛT∑ξ-1Λ)-1),

where εit is the row of E corresponding to the ith subject at time t.

7.4. Full conditional distributions of L2R2

7.4.1. Full conditional distribution for Δ

From equation (6), we can write

p(δl∣-)∝exp(-12τδδl2)etr{(YB,l-δlXulvl)Θ(Yb,l-δlXulvl)T}∝exp(δlulTXTYB,lΘvl-12δl2(τδ+vlΘTvl)(ulTXTXul));p(τδ∣-)∝τδa0+12r-1exp(-(b0+12∑l=1rτδδl2)).

This implies

p(δl∣-)~N(σδl2ulTXTYB,lΘvl,σδl2)andp(τδ∣-)~Ga(a0+12r,b0+12∑l=1rδl2),

where σδl2={Tδ+(vlΘTvl)(ulTXTXul)}-1 and YB,l = Y − WΓ − Zb − Σl′≠l δl′Xul′vl′T.

7.4.2. Full conditional distribution for U

From equation (6), we can write

p(ul∣-)∝exp(-12pulTul)etr{(YB,l-δlXulvl)Θ(YB,l-δlXulvl)T}∝etr(ulTδlXTYB,l-12ulT(pIp+δl2vlTΘvlXTX)ul).

This implies

p(ul∣-)~Np(δl∑ulXTYB,lΘvl,∑ul),

where ∑ul={pIp+δl2(vlTΘvl)XTX}-1.

7.4.3. Full conditional distribution for V

From equation (6), we can write

p(vl∣-)∝exp(-12vlT(dId)vl)etr((YB,l-δlXulvl)Θ(YB,l-δlXulvl)T)∝exp(vlTδlΘYB,lTXul-12vlT(pIp+δl2ulTXTXulvlXTX)vl).

This gives

p(vl∣-)~Nd(δl∑vlΘYB,lTXul,∑vl),

where ∑vl={dId+δl2(ulTXTXul)Θ}-1.

7.4.4. Sampling Γ by columns

Sampling the coefficient matrix one element at a time would be time consuming and less attractive in high-dimensional settings. Another approach is to convert the whole matrix into a vector and sample the vector at once, but this requires a covariance matrix with dimension qd × qd, which can be quite large and requires considerable memory making it infeasible. We propose a columnwise sampling scheme, which allows for computationally efficient sampling with a feasible dimension of the conditional covariance matrix (Khondker et al., 2013). Let YΓ = Y − XUΔV − Zb, we can write YΓ = WΓ+ E. For k = 1, ⋯, d, we can reorder and partition

YΓ=(yΓ,kYΓ,-k),Γ=(γkΓ-k),andΘ=(θkkθkθkTΘ-kk).

In the above partition, yΓ,k is the kth column of YΓ, and YΓ,−k and Γ−k are the matrices after dropping the kth column of YΓ and Γ, respectively. θkk is the element for the kth row and kth column of Θ; θk is the kth column of Θ after dropping θkk; and Θ−kk is the matrix after dropping the kth row and kth column of Θ. We can write

p(γk∣-)∝etr{-12(YΓ-WΓ)T(YΓ-WΓ)Θ}exp(-12τγγkTIqγk)∝etr(-12(yΓ,k-Wγk)T(yΓ,k-Wγk)θkk)×etr((yΓ,k-Wγk)T(YΓ,-k-WΓ-k)θk)exp(-12γkT(τγIq)γk)∝exp(γkTWT{yΓ,kθkk+(YΓ,-k-WΓ-k)θk}-12γkT(θkkWTW+(τγIq))γk).

This gives us

p(γk∣-)~Nd(∑γkWT{yΓ,kθkk+(YΓ,-k-WΓ-k)θk,∑γk),

where Σγk = {θkkWTW+ (τγIq)}−1.

7.4.5. Sampling b

Given that vec(bi) ∼ N(0,Σb) with Σb = τbId, the full conditionals for b can be derived in a similar way to Γ. Let b̃k be the kth column of b. Update b̃k from

p(b∼k∣-)~N(∑bkZT{yb,k-(Yb,-k-Zb-k)θk},∑bk2),

where Σbk = (θkkZTZ+τbInpb)−1. yb,k is the kth column of Yb = Y–XB–WΓ; and Yb,−k and bk is the matrix after dropping the kth column of Yb and b, respectively.

Full conditionals for all other parameters are straightforward.

Fig. 1 The characteristics of the ROIs and SNPs from the ADNI data set and their association.

Fig. 2 The longitudinal characteristics of the ROI volumes in the ADNI data set. (a) The trajectories of the volumes of left lateral ventricle for all subjects. (b) and (c) The LOESS estimates of two volume trajectories based on the subjects with different SNP alleles.

Fig. 3 Simulation results depicting the estimated ROC curves of the true positive rates and false positive rates for B. The four columns correspond to the settings (i) p = 50, d = 50; (ii) p = 100, d = 100; (iii) p = 200, d = 100; (iv) p = 400, d = 100. The first row shows the coefficients of the SNPs and the second row shows the coefficients of the interactions between the SNPs and subject age. The lines represent the L2R2 (black solid), BRRR (red dotted), BCCA (purple dashed), G-SMuRFS (blue dot-dash), and MMA (green dashed).

Fig. 4 Simulation results from one randomly selected replication with p = 50, d = 50, and moderately sparse B. (a) and (b) The true and estimated splines for a randomly selected standardized ROI volume. (c) The scatterplot showing the true mean versus the predicted mean at one year after the subject’s last observation using model (5). (d) The Gelman and Rubin’s shrink factors at different iterations for all the parameters in B.

Fig. 5 The thresholded estimates of the main genetic effects and the SNP-age interaction effects on ROIs based on the ADNI data set with the top 10 genes.

Fig. 6 The estimated spline functions for (a) and (b) all the ROIs, (c) and (d) selected ROIs with declining volumes, and (e) and (f) selected ROIs with increasing volumes based on the SNPs from the ADNI data set with the top 10 genes and top 40 genes, respectively.

Fig. 7 The effects of SNP alleles on the trajectories of two ROIs in the ADNI analysis. Black solid line represents the overall effects characterized by the basis functions and coefficients in Γ. The blue dashed, magenta dot-dash, and red dotted lines are the trajectories of the ROIs altered by the SNP with AA, Aa, and aa, respectively. ‘A’ represents the major allele and ‘a’ represents the minor allele of a SNP.

Fig. 8 Heatmaps of the standardized estimates of the SNP-age interaction coefficients in the (a) and (c) left and (b) and (d) right brain hemispheres. (a) and (b) represent the estimates with the top 10 genes, and (c) and (d) represent the estimates with the top 40 genes. Standardized estimates with absolute value smaller than the threshold were set to zero.

Fig. 9 The SNP-specific networks of ROIs based on the ADNI data set with the top 10 genes. The first row depicts the locations of ROIs that are correlated with the SNPs rs10501604, rs475639, rs677909, and rs10501608 in gene PICALM; the second row shows those of rs3826656, rs3865444, rs988337, rs1354106 in gene CD33; the third row shows those of rs3752237 and rs3752240 in gene ABCA7 and rs12734030 and rs650877 in gene CR1; the last row shows those of APOE34 (APOE), rs880436 (BIN1) and rs6458573 (CD2AP). The sizes of the dots represent the absolute magnitudes of the regression coefficients. Warmer and cooler colors represent ROIs located in superior and inferior anatomical sites of the brain, respectively.

Fig. 10 The SNP-specific networks of ROIs based on the ADNI data set with the top 40 genes, which show the locations of ROIs that are correlated with SNPs rs4513489 (CCR2), rs2273684 (PRNP) and rs6088662 (PRNP). The sizes of the dots represent the absolute magnitudes of the regression coefficients. Warmer and cooler colors represent ROIs located in superior and inferior anatomical sites of the brain, respectively.

Fig. 11 Histograms and QQ plots of the posterior means of the random effects for two random selected ROIs over all subjects in the analysis of ADNI data set with the top 10 genes.

Table 1 Top-ranked ROIs based on the diagonal of BbinTBbin and columns of V based on the top 10 genes.

Bint,stdTBint,std	V 1	V 2	V 3	
sup.t.gy.R	mid.t.gy.R	caud.neuc.L	prec.L	
sup.t.gy.L	mid.t.gy.L	thal.L	per.cort.L	
mid.t.gy.L	sup.t.gy.R	caud.neuc.R	tmp.pl.L	
mid.t.gy.R	hiopp.R	glob.pal.L	per.cort.R	
inf.t.gy.L	amyg.R	post.limb.R	ent.cort.R	
parah.gy.L	unc.L	putamen.L	mid.f.gy.R	
inf.f.gy.R	unc.R	nuc.acc.R	ling.gy.R	
lat.f-o.gy.L	inf.t.gy.R	post.limb.L	sup.f.gy.L	
inf.f.gy.L	sup.t.gy.L	insula.R	pec.R	
unc.R	inf.t.gy.L	subtha.nuc.L	sup.p.lb.L	

Table 2 Top-ranked ROIs based on the diagonal of BbinTBbin and columns of V based on the top 40 genes.

Bint,stdTBint,std	V 1	V 2	V 3	
insula.R	hiopp.R	per.cort.R	glob.pal.R	
insula.L	hiopp.L	sup.p.lb.L	post.limb.R	
amyg.R	inf.t.gy.R	per.cort.L	thal.L	
hiopp.L	sup.t.gy.R	tmp.pl.R	caud.neuc.R	
sup.t.gy.R	unc.L	sup.p.lb.R	caud.neuc.L	
unc.L	mid.t.gy.R	me.f.gy.L	nuc.acc.R	
unc.R	insula.R	lat.ve.R	ant.caps.R	
mid.t.gy.L	amyg.R	pstc.gy.L	glob.pal.L	
hiopp.R	mid.t.gy.L	prec.L	subtha.nuc.L	
mid.t.gy.R	inf.o.gy.L	tmp.pl.L	subtha.nuc.R	


Apostolova LG Green AE Babakchanian S Hwang KS Chou YY Toga AW Thompson PM 2012 Hippocampal atrophy and ventricular enlargement in normal aging, mild cognitive impairment (mci), and alzheimer disease Alzheimer Disease &amp; Associated Disorders 26 17 27 22343374
Bansal V Libiger O Torkamani A Schork NJ 2010 Statistical analysis strategies for association studies involving rare variants Nature Reviews Genetics 11 773 785
Bates D Mächler M Bolker B Walker S 2015 Fitting linear mixed-effects models using lme4 Journal of Statistical Software 67 1 48 10.18637/jss.v067.i01
Bernal-Rusiel J Greve D Reuter M Fischl B Sabuncu MR 2013 Statistical analysis of longitudinal neuroimage data with linear mixed effects models NeuroImage 66 249 260 23123680
Bhattacharya A Dunson DB 2011 Sparse bayesian infinite factor models Biometrika 98 291 306 23049129
Biffi A Anderson CD Desikan RS Sabuncu M Cortellini L Schmansky N Salat D Rosand J 2010 Genetic variation and neuroimaging measures in Alzheimer Disease Archives of neurology 67 677 685 10.1001/archneurol.2010.108 20558387
Breiman L Friedman J 1997 Predicting multivariate responses in multiple linear regression Journal of the Royal Statistical Society 59 3 54
Chen H Wang Y 2011 A penalized spline approach to functional mixed effects models analysis Biometrics 67 861 870 21155747
Chiang MC Barysheva M Toga AW Medland SE Hansell NK James MR McMahon KL de Zubicaray GI Martin NG Wright MJ Thompson PM 2011a Bdnf gene effects on brain circuitry replicated in 455 twins NeuroImage 55 448 454 21195196
Chiang MC McMahon KL de Zubicaray GI Martin NG Hickie I Toga AW Wright MJ Thompson PM 2011b Genetics of white matter development: A dti study of 705 twins and their siblings aged 12 to 29 NeuroImage 54 2308 2317 20950689
Cleveland WS Devlin SJ 1988 Locally weighted regression: An approach to regression analysis by local fitting Journal of the American Statistical Association 83 596 610 10.1080/01621459.1988.10478639
Eilers PHC Marx BD 1996 Flexible smoothing with B-splines and penalties Statistical Science 11 89 121 10.1214/ss/1038425655
Erickson KI Voss MW Prakash RS Basak C Szabo A Chaddock L Kim JS Heo S Alves H White SM Wojcicki TR Mailey E Vieira VJ Martin SA Pence BD Woods JA McAuley E Kramer AF 2011 Exercise training increases size of hippocampus and improves memory Proceedings of the National Academy of Sciences 108 3017 3022 10.1073/pnas.1015950108
Fan J Zhang W 1999 Statistical estimation in varying coefficient models Ann Statist 27 1491 1518 10.1214/aos/1017939139
Fan J Zhang W 2008 Statistical methods with varying coefficient models Stat Interface 1 179 195 18978950
Gong Y Zou F 2012 Varying coefficient models for mapping quantitative trait loci using recombinant inbred intercrosses Genetics 190 475 486 10.1534/genetics.111.132522 22345613
Greven S Crainiceanu C Caffo B Reich D 2010 Longitudinal functional principal component analysis Electron J Statist 4 1022 1054
Guillaume B Hua X Thompson PM Waldorp L Nichols TE 2014 Fast and accurate modelling of longitudinal and repeated measures neuroimaging data NeuroImage 94 287 302 24650594
Guo W 2002 Functional mixed effects models Biometrics 58 121 128 11890306
Hastie TJ Tibshirani RJ 1993 Varying-coefficient models J Roy Statist Soc B 55 757 796
Hibar D 2011 Voxelwise gene-wide association study (vgenewas): Multivariate gene-based association testing in 731 elderly subjects Neuroimage 56 1875 1891 21497199
Hyun JW Li Y Huang C Styner M Lin W Zhu H Alzheimer’s Disease Neuroimaging Initiative 2016 Stgp: Spatio-temporal gaussian process models for longitudinal neuroimaging data NeuroImage 134 550 562 27103140
Khondker Z Zhu H Chu H Lin W Ibrahim J 2013 The bayesian covariance lasso Statistics and its Interface 6 243 259 24551316
Klami A Virtanen S Kaski S 2013 Bayesian canonical correlation analysis The Journal of Machine Learning Research 14 965 1003
Lang S Brezger A 2004 Bayesian P-Splines Journal of Computational and Graphical Statistics 13 183 212
Lazaris A Hwang KS Goukasian N Ramirez LM Eastman J Blanken AE Teng E Gylys K Cole G Saykin AJ Shaw LM Trojanowski JQ Jagust WJ Weiner MW Apostolova LG 2015 Alzheimer risk genes modulate the relationship between plasma apoE and cortical PiB binding Neurology: Genetics 1 10.1212/NXG.0000000000000022
Leavitt VM Cirnigliaro C Cohen A Farag A Brooks M Wecht JM Wylie GR Chiaravalloti ND DeLuca J Sumowski JF 2014 Aerobic exercise increases hippocampal volume and improves memory in multiple sclerosis: Preliminary findings Neurocase 20 695 697 10.1080/13554794.2013.841951 24090098
Li J Wang Z Li R Wu R 2015 Bayesian group lasso for nonparametric varying-coefficient models with application to functional genome-wide association studies Ann Appl Stat 9 640 664 http://dx.doi.org/10.1214/15-AOAS808 10.1214/15-AOAS808 26478762
Li M Luo Xj Landén M Bergen SE Hultman CM Li X Zhang W Yao YG Zhang C Liu J Mattheisen M Cichon S Mühleisen TW Degenhardt FA Nöthen MM Schulze TG Grigoroiu-Serbanescu M Li H Fuller CK Chen C Dong Q Chen C Jamain S Leboyer M Bellivier F Etain B Kahn JP Henry C Preisig M Kutalik Z Castelao E Wright A Mitchell PB Fullerton JM Schofield PR Montgomery GW Medland SE Gordon SD Martin NG Group TSBS Rietschel M Liu C Kleinman JE Hyde TM Weinberger DR Su B Consortium M 2016 Impact of a cis-associated gene expression SNP on chromosome 20q11.22 on bipolar disorder susceptibility, hippocampal structure and cognitive performance The British Journal of Psychiatry 208 128 137 10.1192/bjp.bp.114.156976 26338991
Li Y Gilmore JH Shen D Styner M Lin W Zhu H 2013 Multiscale adaptive generalized estimating equations for longitudinal neuroimaging data NeuroImage 72 91 105 23357075
Marttinen P Pirinen M Sarin AP Gillberg J Kettunen J Surakka I Kangas AJ Soininen P OReilly P Kaakinen M Khnen M Lehtimki T Ala-Korpela M Raitakari OT Salomaa V Jrvelin MR Ripatti S Kaski S 2014 Assessing multivariate gene-metabolome associations with rare variants using Bayesian reduced rank regression Bioinformatics 30 2026 2034 10.1093/bioinformatics/btu140 24665129
Meinshausen N Bühlmann P 2010 Stability selection Journal of the Royal Statistical Society: Series B (Statistical Methodology) 72 417 473
Morris JS Carroll RJ 2006 Wavelet-based functional mixed models J R Stat Soc Ser B Stat Methodol 68 179 199
Niemann C Godde B Voelcker-Rehage C 2014 Not only cardiovascular, but also coordinative exercise increases hippocampal volume in older adults Frontiers in Aging Neuroscience 6 170 10.3389/fnagi.2014.00170 25165446
Paus T 2010 Population neuroscience: Why and how Human Brain Mapping 31 891 903 20496380
Peper JS Brouwer RM Boomsma DI Kahn RS Pol HEH 2007 Genetic influences on human brain structure: A review of brain imaging studies in twins Human Brain Mapping 28 464 473 17415783
Rothman AJ Levina E Zhu J 2010 Sparse multivariate regression with covariance estimation Journal of Computational and Graphical Statistics 19 947 962 24963268
Ruppert D Wand MP Carroll RJ 2003 Semiparametric regression Cambridge University Press Cambridge 10.1017/CBO9780511755453
Saykin AJ Shen L Yao X Kim S Nho K Risacher SL Ramanan VK Foroud TM Faber KM Sarwar N Munsie LM Hu X Soares HD Potkin SG MTP Kauwe JS Kaddurah-Daouk R Green RC Toga AW Weiner MW Alzheimer’s Disease Neuroimaging Initiative 2015 Genetic studies of quantitative mci and ad phenotypes in adni: Progress, opportunities, and plans Alzheimer’s &amp; Dementia 11 792 814
Scharinger C Rabl U Sitte HH Pezawas L 2010 Imaging genetics of mood disorders NeuroImage 53 810 821 20156570
Shen DG Davatzikos C 2004 Measuring temporal morphological changes robustly in brain mr images via 4-dimensional template warping NeuroImage 21 1508 1517 15050575
Shen L Kim S Risacher SL Nho K Swaminathan S West J Foroud TM Pankratz ND Moore JH Sloan SD Huentelman MJ Craig DW DeChairo BM Potkin SG Jack CR Weiner MW Saykin AJ ADNI 2010 Whole genome association study of brain-wide imaging phenotypes for identifying quantitative trait loci in mci and ad: A study of the adni cohort Neuroimage 53 1051 1063 20100581
Sherva R Tripodis Y Bennett DA Chibnik LB Crane PK de Jager PL Farrer LA Saykin AJ Shulman JM Naj A Green RC 2014 Genome-wide association study of the rate of cognitive decline in Alzheimer’s disease Alzheimer’s &amp; Dementia 10 45 52 10.1016/j.jalz.2013.01.008
Silver M Janousova E Hue X Thompson P Montana G 2012 Identification of gene pathways implicated in alzheimer’s disease using longitudinal imaging phenotypes with sparse regression Neuroimage 63 1681 1694 22982105
Thomas D 2010 Gene–environment-wide association studies: emerging approaches Nature Reviews Genetics 11 259 272
Verbeke G Molenberghs G 2009 Linear Mixed Models for Longitudinal Data Springer Series in Statistics Springer New York
Vounou M Janousova E Wolz R Stein JL Thompson PM Rueckert D Montana G ADNI 2011 Sparse reduced-rank regression detects genetic associations with voxel-wise longitudinal phenotypes in alzheimer’s disease NeuroImage 60 700 716 22209813
Vounou M Nichols TE Montana G the Alzheimer’s Disease Neuroimaging Initiative 2010 Discovering genetic associations with high-dimensional neuroimaging phenotypes: A sparse reduced-rank regression approach Neuroimage 53 1147 1159 20624472
Wang H Nie F Huang H Kim S Nho K Risacher SL Saykin AJ Shen L 2011 Identifying quantitative trait loci via group-sparse multitask regression and feature selection: an imaging genetics study of the adni cohort Bioinformatics 28 229 237 22155867
Wood SN 2006 Generalized additive models: An introduction with R Texts in Statistical Science Series Chapman &amp; Hall/CRC Boca Raton, FL
Wu C Cui Y 2013 A novel method for identifying non-linear gene–environment interactions in case–control association studies Human Genetics 132 1413 1425 http://dx.doi.org/10.1007/s00439-013-1350-z 10.1007/s00439-013-1350-z 23974428
Wu HL Zhang JT 2006 Nonparametric Regression Methods for Longitudinal Data Analysis John Wiley &amp; Sons, Inc Hoboken, New Jersey
Xia M Wang J He Y 2013 Brainnet viewer: A network visualization tool for human brain connectomics PLoS ONE 8 1 15 10.1371/journal.pone.0068910
Zhang Y Xu Z Shen X Pan W 2014 Testing for association with multiple traits in generalized estimation equations, with application to neuroimaging data NeuroImage 96 309 325 10.1016/j.neuroimage.2014.03.061 24704269
Zhao Y Castellanos FX 2016 Annual research review: Discovery science strategies in studies of the pathophysiology of child and adolescent psychiatric disorders - promises and limitations Journal of Child Psychology and Psychiatry 57 421 439 10.1111/jcpp.12503 26732133
Zhu H Khondker Z Lu Z Ibrahim JG 2014 Bayesian Generalized Low Rank Regression Models for Neuroimaging Phenotypes and Genetic Markers Journal of the American Statistical Association 109 977 990 10.1080/01621459.2014.923775
Zipunnikov V Greven S Shou H Caffo BS Reich DS Crainiceanu CM 2014 Longitudinal high-dimensional principal components analysis with application to diffusion tensor imaging of multiple sclerosis Ann Appl Stat 8 2175 2202 10.1214/14-AOAS748 25663955
