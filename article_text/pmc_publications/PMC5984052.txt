LICENSE: This file is available for text mining. It may also be used consistent with the principles of fair use under the copyright law.


9215515
20498
Neuroimage
Neuroimage
NeuroImage
1053-8119
1095-9572

28735012
5984052
10.1016/j.neuroimage.2017.07.030
NIHMS967405
Article
FGWAS: Functional GenomeWide Association Analysis1
Huang Chao a
Thompson Paul b
Wang Yalin c
Yu Yang d
Zhang Jingwen a
Kong Dehan e
Knickmeyer Rebecca C f
Colen Rivka R. g
Zhu Hongtu a
the Alzheimer’s Disease Neuroimaging Initiative*
a Department of Biostatistics, The University of Texas MD Anderson Cancer Center, Houston, TX and University of North Carolina at Chapel Hill, Chapel Hill, NC, USA
b Imaging Genetics Center, Stevens Institute for Neuroimaging and Informatics, University of Southern California, Marina del Rey, CA, USA
c School of Computing, Informatics, and Decision Systems Engineering, Arizona State University, Tempe, AZ, USA
d Department of Statistics and Operations Research, University of North Carolina at Chapel Hill, Chapel Hill, NC, USA
e Department of Statistical Sciences, University of Toronto, Toronto, Ontario, Canada
f Department of Psychiatry, University of North Carolina at Chapel Hill, Chapel Hill, NC, USA
g Department of Diagnostic Radiology, The University of Texas MD Anderson Cancer Center, Houston, TX, USA
The readers are welcome to request reprints from Dr. Hongtu Zhu. hzhu5@mdanderson.org; Phone: 346-814-0191
* Data used in preparation of this article were obtained from the Alzheimer’s Disease Neuroimaging Initiative (ADNI) database (adni.loni.usc.edu). As such, the investigators within the ADNI contributed to the design and implementation of ADNI and/or provided data but did not participate in analysis or writing of this report. A complete listing of ADNI investigators can be found at: http://adni.loni.usc.edu/wp-content/uploads/how_to_apply/ADNIAcknowledgementList.pdf

17 5 2018
20 7 2017
01 10 2017
01 6 2018
159 107121
This file is available for text mining. It may also be used consistent with the principles of fair use under the copyright law.
Functional phenotypes (e.g., subcortical surface representation), which commonly arise in imaging genetic studies, have been used to detect putative genes for complexly inherited neuropsychiatric and neurodegenerative disorders. However, existing statistical methods largely ignore the functional features (e.g., functional smoothness and correlation). The aim of this paper is to develop a functional genome-wide association analysis (FGWAS) framework to efficiently carry out whole-genome analyses of functional phenotypes. FGWAS consists of three components: a multivariate varying coefficient model, a global sure independence screening procedure, and a test procedure. Compared with the standard multivariate regression model, the multivariate varying coefficient model explicitly models the functional features of functional phenotypes through the integration of smooth coefficient functions and functional principal component analysis. Statistically, compared with existing methods for genome-wide association studies (GWAS), FGWAS can substantially boost the detection power for discovering important genetic variants and the gene-environmental interactions influencing brain structure and function. Simulation studies show that FGWAS outperforms existing GWAS methods for searching sparse signals in an extremely large search space, while controlling for the family-wise error rate. We have successfully applied FGWAS to large-scale analysis of data from the Alzheimers Disease Neuroimaging Initiative for 708 subjects, 30,000 vertices on the left and right hippocampal surfaces, and 501,584 SNPs.

Computational complexity
Functional genome wide association analysis
Multivariate varying coefficient model
Wild bootstrap

1. Introduction

For most neuropsychiatric and neurodegenerative disorders, existing genome-wide association studies (GWAS) based on disease phenotypes have been able to identify a few common genetic variants of large effect (e.g., APOE), but have had difficulty unraveling the genetic basis of such variants because each genetic variant may have only a small contribution to disease risk and may be very heterogeneous (Cannon and Keller, 2006; Scharinger et al., 2010; Domschke and Dannlowski, 2010; Bigos and Weinberger, 2010; Pezawas and Meyer-Lindenberg, 2010; Durston, 2010; Casey et al., 2010; Paus, 2010; Meyer-Lindenberg, 2009; Glahn et al., 2007; Zhao and Castellanos, 2016; Knickmeyer et al., 2014). Moreover, these neurological disorders often are regarded as the end result of abnormal trajectories of brain development, which may be caused by the additive and interactive effects of perhaps hundreds of risk genes and multiple environmental risk factors, each with small individual effects. A promising approach to overcome such difficulties is to discover genetic factors associated with brain changes that may lead to key insights in neurological disorders and our understanding of the origins of these conditions (Hibar et al., 2011; Chen et al., 2012; Ge et al., 2012; Thompson et al., 2013; Medland et al., 2014; Ge et al., 2015a,b; Hibar et al., 2015; Lin et al., 2014a; Huang et al., 2015; Tao et al., 2017). Such efforts may inspire new approaches to urgently needed preventions, diagnoses, and treatments.

Functional responses that frequently arise in neuroimaging studies have been widely used to characterize brain structure and function (Miller and Qiu, 2009; Smith et al., 2006; Styner et al., 2005; Fischl, 2012; Goodlett et al., 2009; Yushkevich et al., 2008). For instance, in diffusion tensor imaging, various diffusion properties (e.g., fractional anisotropy) have been extracted along major fiber bundles to reveal white matter tract maturation and integrity (Smith et al., 2006; Goodlett et al., 2009; Yushkevich et al., 2008). Shape analysis has been widely used to characterize features of brain cortical and subcortical structures, including cortical complexity, curvature, spectral content, and other indices (Miller and Qiu, 2009; Styner et al., 2005; Fischl, 2012). Thus, they have been widely used to better understand normal brain development and the neurological bases of neuropsychiatric and neurodegenerative diseases. Therefore, these functional responses may be effective phenotypes that facilitate the identification of causal genes and the mechanistic understanding of pathophysiological processes of neurological disorders (Zhao and Castellanos, 2016). Our primary research interest is to identify novel genetic effects on the local changes of various functional responses.

Statistically, we are interested in developing a fast and efficient statistical method to correlate functional phenotypes measured at tens of thousands of grid points (NV ∼ 103 – 106) with tens of millions of known genetic variants (NG ∼ 107), or so-called big data squared. Conventional analysis of such imaging–genetic data is based on methods for voxel-wise genome-wide association analysis studies (VGWAS). Such VGWAS methods primarily consist of three major steps: Gaussian smoothing of the functional responses across subjects, a total of NGNV (∼ 1010 – 1012) massive univariate analyses, and correction for multiple comparisons in an expanded image×gene search space with NGNV elements (Hibar et al., 2011; Shen et al., 2010; Huang et al., 2015; Medland et al., 2014; Zhang et al., 2014; Thompson et al., 2014; Liu and Calhoun, 2014). These methods are not only computationally extensive, but also involve major methodological limitations when searching for novel genetic markers associated with the local changes of functional phenotypes. Specifically, running VGWAS can pose significant computational challenges, including limited computer memory, finite CPU speed, and limited CPU nodes. For instance, for VGWAS, it is computationally intensive to compute all NVNG (∼ 1010 – 1013) test statistics for all M (∼ 103 – 104) bootstrapping replicates and to store and manage all NGNVM (∼ 1013 – 1017) test statistic images in a limited computer hard drive. Moreover, due to massive model fitting, the statistical power is usually very low after adjusting for multiple comparisons, while the spatial correlation and smoothness features in functional phenotypes are not considered, leading to difficult interpretation of the results.

We propose two important strategies to address several fundamental bottlenecks of constructing brain–genetic association maps for functional responses in large-scale imaging genetic studies. First, instead of repeatedly fitting a univariate model to each voxel and each genetic marker, we treat all image measures as a single functional response measured at all NV grid points and focus on testing the coefficient function of interest, which is intrinsically low rank. We develop some functional data analysis (FDA) methods to explicitly account for the three key features of the functional phenotypes: spatial smoothness, spatial correlation, and the low-dimensional representation of functional data. The key advantage of using FDA is to reduce the dimension of the functional responses from NV to an intrinsically low dimension, denoted as NV0, which is much smaller than NV. Second, we develop a new global sure independence screening (GSIS) procedure to eliminate most of the “noisy” genetic variants and a divide-and-conquer algorithm to efficiently perform multiple comparisons. The divide-and-conquer algorithm is critically important for performing FGWAS when NG is extremely large, such as for whole-genome sequencing.

The aim of this paper is to develop a FGWAS pipeline with several formal FDA tools as a novel extension of VGWAS for functional responses. A schematic overview of FGWAS is given in Fig. 1. Although FDA methods have been widely studied in the literature, most focus on one-dimensional curves. See Ramsay and Silverman (2005); Wang et al. (2016); Morris (2015) and references therein for a comprehensive review of FDA. Although there are a few methods for the association mapping of longitudinal phenotypes (Nicolae, 2016; Wu and Lin, 2006; Reimherr and Nicolae, 2014), little has been done on the association mapping of functional phenotypes of two or higher dimensions. Compared with existing methods in the literature, five major methodological contributions of this paper are as follows.

We use a multivariate varying coefficient model (MVCM) as a special function-on-scalar regression model to fit the functional phenotypes with a large number of genetic variants (Zhu et al., 2011; Di et al., 2009; Zipunnikov et al., 2011; Zhu et al., 2014; Guo, 2002; Lin et al., 2014b), while explicitly accounting for their three key functional features as discussed above. The use of the MVCM can project NV imaging measures into the NV0–dimensional space, leading to computational and efficiency gains on the order of O(NV/NV0).

Under MVCM, we use a local Wald-type test statistic to detect novel genetic variants that influence brain structure and function. Moreover, such a test statistic outperforms the test statistics used in other association mapping methods in terms of statistical power (Nicolae, 2016; Wu and Lin, 2006; Reimherr and Nicolae, 2014; Huang et al., 2015).

We introduce a GSIS procedure based on global test statistics to test the hypotheses of interest associated with functional phenotypes. The GSIS not only selects NG0 “important” genetic variants, but also offers the sure independence screening property (Fan and Lv, 2008) with a vanishing false selection rate. The use of GSIS can reduce the size of genetic variants from NG to NG0, leading to a computational gain on the order of O(NG/NG0).

We develop a divide-and-conquer algorithm coupled with parallel computing to efficiently perform multiple comparisons in order to detect subregion-locus pairs, while controlling for their family-wise error (FWE) rate. Compared with VGWAS, FGWAS achieves an extensive computational gain in terms of both memory and speed.

The package for FGWAS, along with its documentation, is freely accessible from the website “https://www.nitrc.org/projects/FVGWAS/”. To make it user-friendly, we developed a graphical user interface to package the code, which is also freely downloadable from the same website. Our FGWAS package can handle three types of functional phenotypes: curves, surfaces, and volumes in ℝ3. To facilitate its application to real data, we use three computing languages, Rcpp, Matlab, and Python, to develop the corresponding versions.

2. Method

Suppose that we observe functional responses, clinical covariates and genetic markers for n unrelated subjects. Without loss of generality, we focus on a compact set, denoted as D⊂ℝ3, (e.g., cortical and subcortical regions), which is general enough to cover curves, surfaces, and volumes in ℝ3. Let d be a grid point in D. It is assumed that there are NV common grid points d1,…,dNV across all subjects. Let g be a locus in the set of NG genetic markers, denoted as G={g1,…,gNG}. Specifically, for the i-th subject, we observe a J × 1 vector of imaging measurements at d, denoted as yi(d) = (yi1(d), …, yiJ(d))T, a pc × 1 vector of covariates (e.g., age and gender), denoted as xi with its first component being 1, and a pg ×1 vector associated with the genetic marker at the locus g and/or xi, denoted as zi(g)=(zi,1(g),…,zi,pg(g))T.

2.1. FGWAS

We developed the FGWAS pipeline to efficiently carry out the association mapping of functional phenotypes. A schematic overview of FGWAS is given in Fig. 1. Our FGWAS consists of three major components: (I) a multivariate varying coefficient model (MVCM);

(II) a global sure independence screening procedure;

(III) a test procedure based on the global and local test statistics.

We elaborate on these components below.

2·2. FGWAS (I): Multivariate Varying Coefficient Model

For the genetic marker at locus g, the MVCM is defined as (1) yij(d)=xiTβj(c)(d)+zi(g)Tβj(g)(d)+ηij(g)(d)+εij(d),

where βj(c)(d) is a pc × 1 vector of non-genetic fixed effects, βj(g)(d) is a pg × 1 vector of fixed genetic effects, ηi(g)(d)=(ηi1(g)(d),…,ηiJ(g)(d))T characterizes both subject-specific and location-specific variability, and εi(d) = (εi1(d), …, εiJ(d))T are measurement errors. It is also assumed that ηi(g) and εi(d) are mutually independent and identical copies of SP(0,∑η(g)) and SP(0, Σε), respectively, where SP(μ, Σ) denotes a stochastic process vector with mean function μ(d) and covariance function Σ(d, d′). Moreover, Σε(d, d′) takes the form of Ωε(d)1(d = d′), where Ωε(d) is a nonnegative function of d and 1(·) is an indicator function of an event.

Compared with the standard linear regression model, MVCM explicitly accounts for spatial smoothness, spatial correlation, and the low-dimensional representation of functional responses (Zhu et al., 2011; Zipunnikov et al., 2011; Zhu et al., 2014; Guo, 2002). The functional responses in neuroimaging studies can usually be regarded as a noisy version of a smooth function of d∈D. For spatial smoothness, it is reasonable to assume that βj(c)(⋅) and βj(g)(⋅) in MVCM may inherit the smooth feature from functional phenotypes and can be represented as a linear combination of a small number of basis functions, such as B-spline. For spatial correlation, it is assumed that ηij(g)(⋅)’s are smooth functions and allow for the Karhunen-Loeve expansion as follows: (2) ηij(g)(d)=∑l=1∞ξi,jlψjl(d)

where ψjl(·)’s are eigenfunctions of ∑jj(g)(⋅,⋅) such that ∑jj(g)(d,d′)=∑l=1∞λjlψjl(d)ψjl(d′) with ∑l=1∞λjl&lt;∞ captures the spatial correlation of ηij(g)(d). Moreover, ξi,jl is the (j, l)–th functional principal component score of the i–th subject such that E(ξi,jl) = 0 and Var(ξi,jl) = λjl. Thus, we can accurately approximate ηij(g)(d) by a small number of eigenfunctions such that ηij(g)(d)≈∑l=1Lξi,jlψjl(d), where L is a positive integer. Finally, we can obtain a low-dimensional representation of yij(d) as follows: (3) yij(d)≈xiTβj(c)(d)+zi(g)Tβj(g)(d)+∑l=1Lξi,jlψjl(d).

For each genetic marker, representation (3) ensures that the intrinsic dimension of yij(·) is much lower than NV. Moreover, since it is expected that βj(g)(d)=0 holds for most loci, the true search space should be much smaller than NV × NG.

Under model (1), we start with a hypothesis testing problem on βj(g)(d), j = 1, …, J, (4) H0:β(g)(d)=0v.s.H1:β(g)(d)≠0foreach(g,d),

where β(g)(d)=vec([β1(g)(d),…,βJ(g)(d)]), and vec(·) is the vectorization of a matrix.

As an example, in our analysis of data from the Alzheimers Disease Neuroimaging Initiative (ADNI), we are interested in detecting novel genetic markers that influence the radial distance and determinant of the Jacobian matrix of both the left and right hippocampal surfaces. We consider MVCM (1) on the hippocampal surfaces with (yi1(d), yi2(d))T = (radial distance, determinant)T, xi =(intercept, gender, age, apolipoprotein E (APOE) gene ε4, the top 5 principal component scores of all single-nucleotide polymorphisms [SNPs])T, and zi(g) =(SNP value).

We introduce a local Wald-type test statistic Tn(g, d) as follows: (5) Tn(g,d)=r(g)(d)T[{∑^η(g)(d,d)}−1⊗{ZXT(g)ZX(g)}−1]r(g)(d),

where r(g)(d)=β^(g)(d)−Bias(β^(g)(d)), ZX(g) = (I–X(XTX)−1XT)Z(g)T, X = (x1, …, xn)T, Z(g) = (z1(g), …, zn(g)), and ⊗ denotes the Kronecker product. The β^(g)(d) and ∑^η(g) are estimates of the corresponding parameters, Bias(β^(g)(d)) is the bias term of β^(g)(d). Moreover, under the null hypothesis H0, the limiting distribution of Tn(g, d) can be approximated by a weighted χ2 distribution (Zhang and Chen, 2007).

To estimate all unknown parameters in model (1), we employ a weighted least squares (WLS) method based on the multivariate local polynomial kernel smoothing technique (Fan and Gijbels, 1996; Zhang and Chen, 2007). Let K(·) be a kernel function, a⊗2 = aaT, and H be a bandwidth matrix with a simple diagonal form. We also denote that KH,m(d) = |H|−1K(H−1(dm – d)) and wH(dm – d) = (1, (dm – d)T H−1)T. For each j and a fixed bandwidth matrix Hβ, the WLS estimator of βj(g)(d) is given by (6) β^j(g)(d)={ZXT(g)ZX(g)}−1ZXT(g)∑m=1NVam(Hβ,d)y⋅, j(dm),

where am(Hβ,d)=eT[∑m=1NVKHβ,m(d){wHβ(dm−d)}⊗2]−1KHβ,m(d)wHβ(dm−d), e = (1, 0, 0, 0)T, and y·,j(d) = (y1,j(d), …, yn,j(d))T. Based on (6), for a fixed bandwidth matrix Hη, the WLS estimate of ηi,j(g)(d) is given by (7) η^i,j(g)(d)=∑m=1NVam(Hη,d){yij(dm)−xiTβ^j(c)(dm)−zi(g)Tβ^j(g)(dm)}

Finally, we can estimate ∑η(g)(d,d′) by using the sample covariance function of η^i(g)(d), denoted as ∑^η(g)(d,d′).

To select the optimal bandwidth in β^j(g)(d) (or η^i,j(g)(d)), we use the generalized cross-validation score method (Zhang and Chen, 2007; Zhu et al., 2012). We standardize all covariates to have mean zero and standard deviation one; thus, we may choose a common bandwidth for all covariates. Moreover, following the arguments of Fan and Zhang (1999), a small bandwidth leads to a small value of Bias(β^(g)(d)), which can be dropped from the test statistics hereafter.

Four big-data challenges stem from the calculations of Tn(g, d).

(B1) Calculating ∑^η(g)(d,d) across all loci and grid points (O(NVNG)) is computationally intensive.

(B2) Bandwidth selection in Tn(g, d) across all loci (O(NG)) can also be computationally intensive.

(B3) Substantial computer resources are required to store all NV × NG test statistics Tn(g, d).

(B4) Determining how to speed up the calculation of Tn(g, d).

To solve the computational bottlenecks in (B1)–(B4), we propose the following solutions: (S1) Calculate ∑^η(g)(d,d) under the null hypothesis H0 for all loci.

(S2) Divide all loci into multiple groups based on their minor allele frequencies (MAFs), and select a common optimal bandwidth for each group.

(S3) Develop a GSIS procedure to eliminate many ‘noisy’ loci based on a global Wald-type statistic.

(S4) Set up a parallel computing strategy so that processing large-scale genetic data can be technically feasible with limited computer resources.

The key idea of (S1) is to calculate ∑^η(g)(d,d) under the null hypothesis in (4), since it is expected that the null hypothesis H0 holds for most loci. Similar to the estimation procedure in (7), the estimate of ∑η(g)(d) under H0 is given by (8) ∑^η(g)(d,d)=n−1∑i=1n{η^i(d)−η¯(d)}⊗2,

where η^i(d)=∑m=1NVam(Hη,d){yiT(dm)−xiTβ^(c)(dm)}T and η¯(d)=n−1∑i=1nη^i(d). Since ∑^η(g)(d,d) is invariant across all loci, we only need to calculate ∑^η(g)(d,d) at each vertex d and denote it as ∑^η(d) from here on. Moreover, since ∑^η(d) in (8) is only related to the non-genetic covariates, the optimal bandwidth matrix Hη is calculated once at most for all loci. Thus, the total complexity of computing all {∑^η(d)} is at least min(NV, NG) times faster than calculating {∑^η(g)(d,d)}.

The key idea of (S2) is to select the common optimal bandwidth matrix Hβ in β^(g)(d) according to the MAFs. Specifically, we divide all the genetic markers into 6 groups according to their MAFs, including MAF ∈ (0.075, 0.15], MAF ∈ (0.15, 0.25], MAF ∈ (0.25, 0.35], MAF ∈ (0.35, 0.45], and MAF ∈ (0.45, 0.50]. For each MAF group, we randomly select kH SNPs (e.g., kH = 10), and calculate the optimal bandwidth in β^(g)(d) when each genetic marker is included in model (1). Consequently, the optimal bandwidth in each group is determined as the average of all the kH bandwidths. Moreover, the number of MAF groups can be larger than 6. We elaborate on (S3) and (S4) in the next subsection.

2.3. FGWAS (II): A Global Sure Independence Screening Procedure

The key idea of the GSIS procedure in (S3) is to detect potentially causal genetic markers by using a dimension reduction method and an approximation method (Huang et al., 2015). Specifically, since only a small number of causal genetic markers are expected to contribute to the imaging phenotypic measures, we consider a global Wald-type statistic to eliminate many loci with weak or even no genetic effects. Let w(d) be a prior distribution of d in D. The global Wald-type statistic at locus g, denoted as T (g), is an integral of Tn(g, d)w(d) with respect to d∈D; that is, T(g)=∫d∈DTn(g,d)w(d)dL(d), where L(d) is the Lebesgue measure. Selecting different w(d) allows us to introduce the prior information of specific regions of interest (ROIs). If there is no such prior information, then a uniform prior can be used. In this case, except for a constant scalar, T (g) can be approximated by (9) Tn(g)=1NVtr([∑m=1NVYw(dm){∑^η(dm)}−1YwT(dm)]⊗Qz|x−1(g)vec(ZXT(g))⊗2),

where Yw(d)=∑m=1NVam(Hβ,d)[y1,⋅(dm),…,yn,⋅(dm)]T, and Qz|x(g)=ZXT(g)ZX(g). At a specific locus g, if the area of the true genetic effect region, denoted by D∗(g), is relatively large and its corresponding measurements are moderate, then the value of Tn(g) should be relatively large. Thus, if the value of Tn(g) is large, then the locus g is more likely to be a causal locus.

Our GSIS procedure consists of the following steps: Step (II.1). Calculate XT X and PX with the computational complexity of O(npc2).

Step (II.2). Calculate ∑m=1NVYw(dm){∑^η(dm)}−1Yw(dm)T with the computational complexity of O(NV2n2).

Step (II.3). For the locus g, calculate Tn(g) with the computational complexity of O((pc + pg)2n2).

Step (II.4). Repeat Step (II.3) for all loci and calculate the p–value of Tn(g) using an approximation method (Zhang and Chen, 2007; Zhu et al., 2012; Huang et al., 2015). Specifically, Tn(g) can be approximated by a χ2–type random variable α1χ2(α2) + α3, where α1, α2, and α3 are respectively given by (10) α1=κ3(T)4κ2(T),α2=8κ23(T)κ32(T),andα3=κ1(T)−2κ22(T)κ3(T),

where κk(T), k = 1, 2, 3, are respectively the first three sample cumulants of Tn(g). Finally, the p–value of Tn(g) can be approximated by using P (χ2(α2) ≥ [Tn(g) – α3]/α1).

Step (II.5). Sort the −log10(p)–values of all Tn(g)s and select the top N0 loci (e.g., N0 = 1, 000), denoted by G0∗={g1∗,…,gN0∗}. From here on, we call G0∗ a candidate significant locus set. Usually, we choose a relatively large N0 so as to guarantee that all true positive loci are contained in G0∗ with high probability.

The computational complexity of GSIS is primarily associated with the number of loci, NG. If NG is of a super large scale (e.g., O(108)), the GSIS procedure can be very time consuming or even fail on a single computer core with limited computer memory. To address this issue, we propose a divide-and-conquer algorithm along with a parallel computing strategy, since the calculation of Tn(g) can be done independently. First, we divide the whole genetic data set into KG groups (e.g., each chromosome as a group). Then, we perform Steps (II.1)–(II.3) independently for each group of genetic markers. Finally, we combine the Tn(g)’s across all groups and approximate their corresponding p–values based on the method used in Step (II.4). Subsequently, we determine the candidate significant locus set G0∗. More details on the parallel computing strategy are provided in the next subsection.

2.4. FGWAS (III): A Test Procedure

The objectives of the test procedure are (O.1) to detect the genetic markers that are significantly associated with the functional phenotype as a whole; and

(O.2) to detect the subregion(s) (or compact set(s)) of the functional phenotype that are significantly associated with some genetic marker(s).

Note that it is important to detect significant voxel-locus pairs for VGWAS, but such detection is less meaningful for the functional responses, which are intrinsically smooth functions. Moreover, the existing GWAS methods for imaging phenotypes focus on (O.1), whereas we are particularly interested in (O.2).

To achieve (O.1), we calculate a maximum statistic of all Tn(g)’s across all loci as follows: (11) Tn,G=maxg∈GTn(g).

The maximum statistic Tn,G plays a crucial role in controlling the FWE rate.

To achieve (O.2), we resort to cluster size inference, which plays an important role in assessing the significance of each subregion that consists of interconnected grid points for which the p-values are greater than a given threshold, say αI = 0.005 or 0.001 (Smith and Nichols, 2009; Ge et al., 2012). For functional phenotypes, we prefer to replace the cluster by the subregion from here on. For the locus g, let p(g, d) be the p–value of Tn(g, d) at the grid point d and let A(g, αI) be the largest subregion at a given threshold αI based on the map of {p(g,d):d∈D}. To detect significant subregion-locus pairs, we consider a maximum subregion statistic, i.e., (12) A(G,αI)≐maxg∈GA(g,αI),

which, in practice, can be approximated by a local maximum subregion statistic A(G0∗,αI) in terms of both size and distribution (Huang et al., 2015).

We use the wild bootstrap method to approximate the null distribution of Tn,G and that of A(G0∗,αI) under the assumption that the null hypothesis H0 in (4) holds for all (g,d)∈G×D}. We propose an efficient wild bootstrap procedure to simultaneously detect significant loci and subregion-locus pairs as follows: Step (III.1). Calculate Tn(g*, d) for each pair (g∗,d)∈G0∗×D as (13) tr([Yw(dm){∑^η(dm)}−1YwT(dm)]⊗Qz|x−1(g∗)vec(ZXT(g∗))⊗2).

Step (III.2). Calculate the uncorrected p–values of Tn(g*, d) across all (g∗,d)∈G0∗×D based on the F distribution.

Step (III.3). Calculate A(g*, αI) based on the p-values of {Tn(g*, d)} obtained in Step (III.2).

Step (III.4). Apply the wild bootstrap method to the set G0∗. – Step (III.4.1). Fit model (1) under the null hypothesis H0, which yields β^(c)∗_(d), η^i∗_(d) and ε^i∗_(d) for all i and d.

– Step (III.4.2). Generate a random sample vib and υib(dm) from a N(0, 1) generator for i = 1, …, n and m = 1, …, NV. B bootstrap samples are constructed as yi(b)(dm)=xiTβ^_(c)∗(dm)+vibη^_i∗(dm)+υib(dm)ε^_i∗(dm),b=1,…,B

for all i and dm∈D.

– Step (III.4.3). For all g∈G, calculate the global Wald-type statistic Tn(b)(g) based on the bootstrap samples.

– Step (III.4.4). Sort all {Tn(b)(g)} according to their magnitudes and select the top N loci to form G0∗.

– Step (III.4.5). Calculate Tn,G(b)=maxg∈G{Tn(b)(g)}.

– Step (III.4.6). Calculate A(b)(G0∗(b),αI) based on {Tn(b)(g,d),(g,d)∈G0∗(b)×D}. For computational efficiency, we suggest directly comparing Tn(b)(g,d) with the 100(1−αI)th percentile of the F distribution in order to determine significant subregions at each locus g.

Step (III.5). Calculate the FWE corrected p–values of Tn(g) based on the empirical distribution of {Tn,G(b)}b=1,…,B. Since NG is much larger than the sample size, choose a significance level, say α = 0.5.

Step (III.6). For each locus g∈G0∗, calculate all possible subregions and their associated FWE corrected p–values based on the empirical distribution of {A(b)(G0∗(b),αI)}b=1,…,B.

Similar to the GSIS procedure, the computational issue still exists in the test procedure for large NG. We also use the divide-and-conquer algorithm here. Specifically, after generating bootstrap samples in Steps (III.4.1)–(III.4.2), we divide the whole genetic data set into KG disjoint groups such that G=∪k=1KGGk and Gk∩Gk′=ϕ for k ≠ k′. Then, Steps (III.4.3)–(III.4.6) are independently performed for bootstrap samples on each group of genetic markers. For each group, we can obtain the relevant {Tn,Gk(b),A(b)(G0,k∗(b),αI)}b=1B for k = 1, …, KG. Then the maximum statistics Tn,G(b) and A(G0,k∗(b),αI) across all groups are calculated as follows: (14) Tn,G(b)=max1≤k≤KG{Tn,Gk(b)},b=1,…,B,

(15) A(G0∗(b),αI)=max1≤k≤KG{A(b)(G0,k∗(b),αI)},b=1,…,B,

which lead to the empirical distributions of {Tn,G(b)}b=1B and {A(G0∗(b),αI)}b=1B under H0. Consequently, the corresponding corrected p–values are derived in Steps (III.5)–(III.6). In addition, this parallel computing strategy can be conducted on the bootstrap sampling level, which means calculations on different bootstrap samples in Step (III.4) can be carried out at the same time on different cores.

3. Simulation Studies

In this section, we use Monte Carlo simulations to evaluate the finite-sample performance of FGWAS. The hypothesis testing problem we focus on is to test the null hypothesis of no association for all the functional phenotypes at each locus. All computations for these numerical examples were done in Matlab on a Dell C6100 server. The computation for FGWAS is efficient even for large-scale imaging genetic data, as shown in the real data analysis.

We simulated imaging surface data at NV = 15, 000 vertices on the right hippocampus obtained from the publicly accessible ADNI data. More information on the ADNI data used in the current study is given in the next section. We only considered the additive genetic effect of SNPs on the right hippocampal surface data. The yi,j(d)s were generated from model (1) given by (16) yi,j(d)=xiTβj(c)(d)+∑g=1NGzi(g)βj(g)(d)+ηi,j(d)+εi,j(d)

for i = 1, …, n and j = 1, J = 2, where εi(d)~N(0,Ω=diag(σ12,σ22)), zi(g) were simulated genetic data as described below, and xi = (1, xi1, …, xi8)T were generated from U(0, 1) for continuous variables or from the Bernoulli distribution with a success probability of 0.5 for discrete variables. The true values of βj(c)(d) and ηi,j(d) were set to the estimates β^j(c)(d) and η^i,j(d) by fitting model (1) without genetic covariates to the real ADNI data set introduced in the next section. The elements in βj(g)(d) for j = 1 and 2 corresponding to the pre-specified pairs of causal SNPs and affected ROIs were set to affect magnitude {βj∗,j=1,2} and zero otherwise. In addition, the affected ROI associated with the causal SNPs was pre-fixed as a circular region with radius r (Fig. 2).

We simulated genetic data zi(g) as follows. We used linkage disequilibrium (LD) blocks defined by the default method (Gabriel, 2002) of Haploview (Barrett et al., 2005) and PLINK (Purcell et al., 2007) to form SNP sets. To calculate the LD blocks, n subjects were simulated by randomly combining haplotypes of HapMap CEU subjects. We used PLINK to determine the LD blocks based on these subjects. We randomly selected 2,000 blocks, and combined haplotypes of HapMap CEU subjects in each block to form genotype variables for these subjects. We randomly selected 10 SNPs in each block; thus, we had NG = 20, 000 SNPs for each subject. Moreover, we chose the first q SNPs as the causal SNPs. We set the sample size (n) and the number of causal SNPs (q) to be 1, 000 and 100, respectively. Finally, we used 100 Monte Carlo realizations.

First, we evaluate the finite sample performance of the proposed GSIS for different settings of (N0,β1∗,β2∗,Ω). Specifically, we set β1∗=0.01, β2∗=aβ1∗, in which a was chosen from the set {0.5, 1, 1.5, 2}, and N0 between 100 and 2,000. Moreover, we set the radius of the ROI as r = 6. We considered two different settings of Ω, including (i) Ω = diag(σ1 = σ2 = 0.5); and (ii) Ω = diag(σ1 = 0.8, σ2 = 1). We defined the causal SNP rate as the ratio of the number of causal SNPs in G0∗ over the total number of causal SNPs. Table 1 includes the causal SNP rates under different settings. As expected, the causal SNP rate increases as N0 and a increase. However, the causal SNP rate is low for small N0, especially when σ1 and σ2 are quite large. When N0 is set to be larger than 900, almost all causal SNPs are included in the set G0∗ for most settings of (β1∗,β2∗,Ω). See Table 1 for more details.

Second, we evaluated the finite sample performance of FGWAS in detecting the causal SNP and subregion pairs. We set n = 1, 000, q = 100, Ω = 0.5I2, (β1∗,β2∗)=(0.01,0.01), and r = 6. Moreover, we used an uncorrected αI = 0.005 p-value threshold to identify subregions consisting of contiguous supra-threshold vertices. If the vertices in a thresholded cluster overlapped with some vertices in the affected ROI at a causal SNP, then we call these vertices “true positive vertices”. If a thresholded subregion did not overlap with any vertices of the affected ROI at any causal SNP, we call such a subregion a “false positive” subregion. We summarized the results by using the Dice overlap ratio (DOR), the number of false positive subregions, and the size in the number of vertices in false positive subregions. DOR is the ratio between the number of true positive pixels over the size of the affected ROI (Huang et al., 2015). Thus, a higher DOR means a higher probability of detecting the affected ROI. As shown in Fig. 3, no false positive subregion is detected. These results further demonstrate that the GSIS procedure can effectively detect and localize relatively strong genetic effects. Moreover, the average DOR of N0 = 500 is higher than that of N0 = 100.

Third, we compared the proposed FGWAS method with other two methods, i.e., the standard functional GWAS (Reimherr and Nicolae, 2014) and the FVGWAS package (Huang et al., 2015). In order to make a fair comparison, we applied all three methods to the same simulated data sets. Since both standard functional GWAS and FVGWAS are feasible only for univariate imaging phenotypic measurements, we simplified model (16) by considering only one imaging measurement, i.e., (17) yi(d)=xiTβ(c)(d)+∑g=1NGzi(g)β(g)(d)+ηi(d)+εi(d),i=1,…,n.

Three factors are considered in the comparisons: (i) the genetic effect β*(d) in the affected region, (ii) the number of candidate significant loci N0, and (iii) the radius r of the affected ROI. In order to illustrate how each factor affects the finite sample performance of the three methods, we fixed two factors and chose different values for one factor in each setting. Fig. 4 presents the receiver operating characteristic (ROC) curves for all three methods, corresponding to three different cases. In case 1, the genetic effect is set to β* = 0.005 and β* = 0.01, whereas other parameters Ω, n, N0, and r are set to 0.5, 1,000, 1,000, and 6, respectively. In case 2, the number of candidate loci is set to N0 = 500 and N0 = 1, 000, whereas other parameters Ω, n, β*, and r are set to 0.5, 1,000, 0.01, and 6, respectively. In case 3, the radius of the affected ROI is set to r = 3 and r = 9, whereas other parameters Ω, n, N0, and β* are set to 0.5, 1,000, 1,000, and 0.01, respectively. It can be found that, for each case, as the factor increases, the areas under the ROC curves for all the methods increase as well. Moreover, FGWAS outperforms both the standard functional GWAS and FVGWAS in all three cases, indicating that compared with standard functional GWAS and FVGWAS, FGWAS dramatically boosts the power for detecting various settings of genetic effects and affected ROIs.

4. ADNI Hippocampal Surface Data Analysis

4.1. ADNI Data Description

Data used in the preparation of this article were obtained from the ADNI database (adni.loni.usc.edu). The ADNI was launched in 2003 by the National Institute on Aging, National Institute of Biomedical Imaging and Bioengineering, Food and Drug Administration, private pharmaceutical companies and non-profit organizations as a $60 million, 5-year public-private partnership. The primary goal of ADNI has been to test whether serial magnetic resonance imaging (MRI), positron emission tomography, other biological markers, and clinical and neuropsychological assessment can be combined to measure the progression of mild cognitive impairment (MCI) and early Alzheimer’s disease (AD). Determination of sensitive and specific markers of very early AD progression is intended to aid researchers and clinicians in developing new treatments and monitoring their effectiveness, as well as lessening the time and cost of clinical trials. The principal investigator of this initiative is Michael W. Weiner, MD, at the VA Medical Center and University of California, San Francisco. ADNI is the result of efforts of many coinvestigators from a broad range of academic institutions and private corporations, and subjects have been recruited from over 50 sites across the U.S. and Canada. The goal was to recruit 800 subjects, but the initial study (ADNI-1) has been followed by ADNI-GO and ADNI-2. To date, these three protocols have recruited over 1,500 adults, ages 55 to 90, to participate in the research, consisting of cognitively normal older individuals, people with early or late MCI, and people with early AD. The follow-up duration of each group is specified in the protocols for ADNI-1, ADNI-2 and ADNI-GO. Subjects originally recruited for ADNI-1 and ADNI-GO had the option to be followed in ADNI-2. For up-to-date information, see www.adni-info.org.

4.2. Data Processing

We applied FGWAS to the joint analysis of anatomical MRI and genetic data collected through ADNI-1. In this data analysis, we included 708 MRI scans from healthy controls and individuals with AD or MCI (186 AD, 388 MCI, and 224 healthy controls) from ADNI-1. The scans (from 462 men and 336 women, ages 75.42 ± 6.83 years), which were performed on a variety of 1.5 Tesla MRI scanners with protocols individualized for each scanner, include standard T1-weighted images obtained using volumetric 3-dimensional sagittal MPRAGE or equivalent protocols with varying resolutions. The typical protocol includes: repetition time = 2400 ms, inversion time = 1000 ms, flip angle = 8°, and field of view = 24 cm, with a 256×256×170 acquisition matrix in the x−, y−, and z−dimensions, which yields a voxel size of 1.25×1.26×1.2 mm3. We processed the MRI data by using standard steps, including anterior commissure and posterior commissure correction, skull-stripping, cerebellum removing, intensity inhomogeneity correction, segmentation, and registration. Subsequently, we carried out automatic regional labeling by labeling the template and by transferring the labels following the deformable registration of subject images. After labeling 93 ROIs, we were able to compute volumes for each of these ROIs for each subject.

We adopted a hippocampal subregional analysis package based on surface fluid registration (Shi et al., 2013) that uses isothermal coordinates and fluid registration to generate one-to-one hippocampal surface registration for computing the surface statistics. Then, we computed the various surface statistics on the registered surface, such as multivariate tensor-based morphometry statistics, which retain the full tensor information of the deformation Jacobian matrix, together with the radial distance, which retains information on the deformation along the surface normal direction. More details can be found in (Wang et al., 2011).

We considered the 818 subjects’ genotype variables acquired by using the Human 610-Quad BeadChip (Illumina, Inc., San Diego, CA) in the ADNI database, which includes 620,901 SNPs. To reduce the population stratification effect, we used data from 749 Caucasians among all 818 subjects with complete imaging measurements at baseline. Quality control procedures included (i) call rate check per subject and per SNP marker, (ii) gender check, (iii) sibling pair identification, (iv) the Hardy-Weinberg equilibrium test, (v) marker removal by MAF, and (vi) population stratification. The second line preprocessing steps included removal of SNPs with (i) more than 5% missing values, (ii) MAF smaller than 5%, and (iii) Hardy-Weinberg equilibrium p-value &lt; 10−6. Remaining missing genotype variables were imputed as the modal value. After the quality control procedures, 708 subjects and 501,584 SNPs remained in the final data analysis.

4.3. Data Analysis

The hippocampus is believed to be involved in memory, spatial navigation and memory, and behavioral inhibition. In AD, the hippocampus is one of the first regions of the brain to be affected, leading to the confusion and loss of memory so commonly seen in the early stages of the disease. Recent work has revealed that the hippocampus is structurally and functionally asymmetric, and hippocampal asymmetry changes with AD progression, with the left hippocampus affected first by dementia, followed by atrophy in the right hippocampus after a time lag.

The objective of this data analysis was to examine the genetic effect of each of 501,584 SNPs on either the left or right hippocampus and whether the genetic pathway of the left hippocampus overlaps with that of the right after partialing out the genetic effect of APOE ε4. To achieve this objective, we applied FGWAS with either the left or right hippocampal surface data as the functional phenotypes. Specifically, we chose the radial distance and determinant of Jacobian matrix as two different surface measurements. Moreover, in model (1), we included an intercept, gender, age, APOE ε4, and the top 5 principal component scores of all SNPs as covariates. We had 708 subjects, 30,000 vertices on the hippocampal surface (15,000 on each side), and 501,584 SNPs. The number of candidate loci was set as N0 = 2, 000. Then, the total computational time was 91,423s and 92,091s for the left and right hippocampi, respectively.

We have the following findings. Fig. 5 (a)–(d) shows the Manhattan and QQ plots of the GWAS results for the left and right hippocampal surfaces, respectively. Moreover, Fig. 6 (a)–(b) shows the density of the global Wald-type statistic and its χ2 approximation in the GSIS procedure, which are very close to each other, indicating the accuracy of the χ2 approximation. Tables 2 and 3 present the top 50 SNPs associated with the left and right hippocampal surfaces. At the 10−5 significance level, 11 SNPs were detected as being associated with the left hippocampal surface, while 17 SNPs were found to be associated with the right hippocampal surface. Fig. 7 (a)–(b) presents the LocusZoom plot (Pruim et al., 2010), which shows the regional association results near the top 1 SNP (rs657132 on gene HRH4, chr 18) from the GSIS procedure on the left hippocampal surface, and the top 1 SNP (rs4681527 on gene C3orf58, chr 3) on the right hippocampal surface. In particular, histamine receptor H4 (HRH4) is a protein-coding gene, and disease associated with HRH4 includes cerebellar degeneration. Moreover, cholinergic receptor M4 (CHRM) is an important paralog of HRH4, and the loss of M4 receptors has been found in the hippocampus of AD patients (Mulugeta et al., 2003). Further information about all top 2,000 SNPs on each side of the hippocampal surfaces are available online at http://odin.mdacc.tmc.edu/bigs2/software.html.

In Step (III), we first calculated the corrected p-values of Tn(g*, d) across all vertices and candidate loci in G0∗ to further detect significant vertex-locus pairs. In order to obtain the empirical distribution of Tn(g*, d) under H0, the wild bootstrap method was adopted. We set N0 = 2, 000 and generated B = 500 bootstrapped samples. We considered a parallel computing strategy and divided the genetic data into KG = 10 pieces. Fig. 6 (c)–(d) shows the density plots of Tn(g*, d) for N0 = 2, 000, corresponding to the left and right hippocampal surfaces, respectively, which are close to their χ2 approximations. Subsequently, we calculated the corrected p–values of Tn(g*, d). Fig. 8 (a) shows the corrected −log10(p) – values corresponding to the top 2 SNPs on the left and right hippocampal surfaces, where the color bar is presented as well.

In order to detect significant subregion-locus pairs, we set αI = 0.005 and calculated all possible subregions and their associated p-values against the top N0 = 2, 000 SNPs. Fig. 8 (b) shows the −log10(p)–values for significant subregions that correspond to the top 2 SNPs on both hippocampal surfaces, where the color bar is also presented. In particular, for the top 1 SNP, two subregions are found for the right hippocampal surface and one for the left hippocampal surface; whereas for the second top SNP, one subregion is found for each side of the hippocampal surfaces. Moreover, most significant subregions are likely to be symmetric across the left and right hippocampal surfaces. To specify the exact locations of significant subregions on the hippocampal surfaces, we recalled the cytoarchitectonic subregions mapped on blank MR-based models at 3T of the hippocampal formation (Duvernoy, 2005; Frisoni et al., 2008), which are presented in Fig. 9. It shows that all the significant subregions are found in the CA1 subfield. Specifically, the most significant subregion (blue region indicated in Fig. 8 (b)) is found on the lateral and medial aspects of the tail (CA1 subfield), and other subregions are found on the dorsolateral aspect of the head (CA1 subfield). It is interesting to note that volumes of similar hippocampal subregions were found to be affected in AD (Frisoni et al., 2008), indicating that the results obtained from FGWAS are in agreement with those of previous work.

We applied the rank-rank scatter plot (Plaisier et al., 2010) in order to investigate the connection between the genetic pathway for the left hippocampus and that for the right hippocampus. We first selected the top 2,000 genes in the GWAS result on each side of the hippocampal surface and combined them, i.e., 3, 562 genes in total. Note that the rank information of each gene was calculated based on the largest −log10(p)–value of SNPs associated with this gene. According to the rank information, the rank-rank scatter plot is presented in Fig. 10. It can be found that the two genetic pathways have weak connection. Specifically, only a few top genes have similar rank information on the left and right hippocampal surfaces, indicating that hippocampal asymmetry exists. In fact, the hippocampus was found to be structurally and functionally asymmetric in both healthy adults and AD patients (Shi et al., 2009; Maruszak and Thuret, 2013). Furthermore, different gene-environment interaction effects are found on different hippocampal subfields (Rabl et al., 2014). Therefore, the hippocampal asymmetry in our studies may be sound. Apart from the existence of hippocampal asymmetry, we wanted to examine whether any common genetic effect is associated with AD on both the left and right hippocampal surfaces. There is one gene, RBFox1, with similar rank information on both sides of the hippocampus (rank: 134 on the left hippocampal surface and 137 on the right hippocampal surface). Specifically, the amyloid precursor protein (APP) was found to be altered by transient RBFox1 expression in HEK293 and HeLa cells. Moreover, proteolytic processing of APP leads to the formation of β-amyloid (Aβ) peptides, which accumulate in the brains of those affected by AD (Ghiso and Frangione, 2002). Therefore, RBFox1, which presents a common genetic effect on both sides of the hippocampus, may play an important role in the progression of AD.

Finally, we calculated the polygenic risk score (PRS) at each vertex for multiple thresholds of p-values (i.e., 0.001, 0.01, 0.05, and 0.1). Then, we used a vertex-wise linear regression model and the coefficient of determination, R2, to assess the proportion of variation in each imaging measurement that is explained by the PRS. The estimated R2 values across all vertices for two different types of imaging measurements are reported in Fig. 11-12. As the threshold increases, the estimated R2 values across all vertices increase. When the threshold is 0.05 or 0.1, the estimated R2 values are all above 0.5. Interestingly, comparing Fig. 11-12 with Fig. 8 (b) reveals that the estimated R2 values in the significant subregions, which were detected in Step (III), are larger than those in other regions and more likely increase as the threshold increases.

5. Conclusion and Discussion

We have developed a FGWAS pipeline for efficiently carrying out genome-wide association analysis of surface-based imaging genetic data. Our proposed FGWAS consists of an MVCM, a GSIS procedure, and a detection procedure based on wild bootstrapping methods. Three key advantages of FGWAS have been discovered: (i) the spatial correlation structure of imaging data and variability of multiple phenotypic measurements considered in the multivariate varying coefficient model; (ii) much lower computational complexity compared to standard functional GWAS (Reimherr and Nicolae, 2014), and (iii) a parallel computing strategy that makes FGWAS feasible for super large-scale genetic data. Simulation studies have been conducted to evaluate the finite sample performance of FGWAS. We successfully applied FGWAS to hippocampal surface data and genetic data from the ADNI. Our FGWAS is a valuable statistical toolbox for fast, large-scale imaging genetic analysis.

There are two substantial issues to be addressed in our future research. First, since our FGWAS is still a single SNP analysis framework (Huang et al., 2015), the power of FGWAS may be undermined by unobserved causal SNPs, correlation among adjacent SNPs, and SNP-SNP interactions (Tzeng et al., 2011; Wu et al., 2011). It has been shown that alternative approaches for testing the association between a single SNP set and individual phenotypes are promising for improving the power of GWAS (Ge et al., 2012; Thompson et al., 2013). Therefore, it is of great importance to generalize our FGWAS for mapping the association between a SNP set and functional neuroimaging.

Second, in this paper, our FGWAS can only be used to detect the genetic markers that influence neuroimaging phenotypes. However, as in GWAS of AD, a question of interest is to test the null hypothesis of no association between functional phenotypes and the genotypes or genetic interactions (gene-environment), for example, genome-wide interaction analysis of relating SNPs to education level (Frost et al., 2016), case control conditions or memory scores (Yan et al., 2015). Meanwhile, detecting these interactions within genome-wide data can be challenging due to the loss in statistical power and computational efficiency. Therefore, generalizing our FGWAS for testing genetic interaction effects will be another aim in our future work.

The collection and sharing of data that we analyzed for this project were funded by the Alzheimer’s Disease Neuroimaging Initiative (ADNI) (National Institutes of Health Grant U01 AG024904) and DOD ADNI (Department of Defense award number W81XWH-12-2-0012). ADNI is funded by the National Institute on Aging, the National Institute of Biomedical Imaging and Bioengineering, and through generous contributions from the following: Alzheimers Association; Alzheimers Drug Discovery Foundation; Araclon Biotech; BioClinica, Inc.; Biogen Idec Inc.; Bristol-Myers Squibb Company; Eisai Inc.; Elan Pharmaceuticals, Inc.; Eli Lilly and Company; EuroImmun; F. Hoffmann-La Roche Ltd and its affiliated company Genentech, Inc.; Fujirebio; GE Healthcare; IXICO Ltd.; Janssen Alzheimer Immunotherapy Research &amp; Development, LLC.; Johnson &amp; Johnson Pharmaceutical Research &amp; Development LLC.; Medpace, Inc.; Merck &amp; Co., Inc.; Meso Scale Diagnostics, LLC.; NeuroRx Research; Neurotrack Technologies; Novartis Pharmaceuticals Corporation; Pfizer Inc.; Piramal Imaging; Servier; Synarc Inc.; and Takeda Pharmaceutical Company. The Canadian Institutes of Health Research is providing funds to support ADNI clinical sites in Canada. Private sector contributions are facilitated by the Foundation for the National Institutes of Health (www.fnih.org). The grantee organization is the Northern California Institute for Research and Education, and the study is coordinated by the Alzheimer’s Disease Cooperative Study at the University of California, San Diego. ADNI data are disseminated by the Laboratory for Neuro Imaging at the University of Southern California.

Fig. 1 Schematic overview of FGWAS

Fig. 2 Simulation settings: Green and blue regions in each panel respectively represent the right hippocampal surface and the affected ROI associated with the causal SNPs. From left to right, the radii of the affected ROIs are respectively set to 3, 6, and 9.

Fig. 3 Simulation results for the association between SNPs and subregions: (a) size in the number of vertices of false positive subregions in each causal SNP; (b) number of false positive subregions in each causal SNP; and (c) Dice overlap ratio (DOR) in each causal SNP. Parameters (β1∗,β2∗), Ω, and r are set to (0.01, 0.01), 0.5I2, and 6, respectively.

Fig. 4 Simulation results for comparisons among FVGWAS, standard functional GWAS, and FG-WAS in identifying significant voxel-locus pairs: (a) Case 1. ROC curves of all three methods with β* = 0.005 and β* = 0.01, whereas other parameters Ω, n, N0, and r are set to 0.5, 1000, 1000, and 6, respectively. (b) Case 2. ROC curves of all three methods with N0 = 500 and N0 = 1, 000, whereas other parameters Ω, n, β*, and r are set to 0.5, 1000, 0.01, and 6, respectively. (c) Case 3. ROC curves of all three methods with r = 3 and r = 9, whereas other parameters Ω, n, N0, and β* are set to 0.5, 1000, 1000, and 0.01, respectively.

Fig. 5 ADNI hippocampal surface GWAS: (a) Manhattan plot (left hippocampal surface); (b) Manhattan plot (right hippocampal surface); (c) QQ plot (left hippocampal surface); (d) QQ plot (right hippocampal surface).

Fig. 6 ADNI hippocampal surface GWAS: Density plot of Tn(g) and its χ2 distribution approximation from the GSIS procedure on the (a) left and (b) right hippocampal surfaces. The density plot of Tn(g*, d) and its χ2 distribution approximation from the bootstrapping procedure on (c) the left and (d) right hippocampal surfaces.

Fig. 7 ADNI hippocampal surface GWAS: LocusZoom plot showing the regional association results near (a) the top 1 SNP (rs657132) from the GSIS procedure on the left hippocampal surface and (b) the top 1 SNP (rs4681527) from the GSIS procedure on right hippocampal surface.

Fig. 8 ADNI hippocampal surface GWAS: (a) corrected −log10(p)–values across all vertices corresponding to top 2 SNPs on both the left and right hippocampal surfaces (rs657132 and rs604345 for the left hippocampal surface, rs4681527 and rs3108514 for the right hippocampal surface); (b) −log10(p)–values for significant subregions to top 2 SNPs on both the left and right hippocampal surfaces (rs657132 and rs604345 for the left hippocampal surface, rs4681527 and rs3108514 for the right hippocampal surface).

Fig. 9 ADNI hippocampal surface GWAS: Cytoarchitectonic subregions mapped on blank MR-based models at 3T of the hippocampal formation (Duvernoy, 2005; Frisoni et al., 2006, 2008).

Fig. 10 ADNI hippocampal surface GWAS: Rank-rank scatter plots. The rank information of both the top 2000 genes on the left hippocampal surface and those on the right hippocampal surface, which were calculated based on the largest −log10(p)–values of SNPs associated with each gene.

Fig. 11 ADNI hippocampal surface GWAS: Estimated R2 for the imaging measurement (radial distance) across all vertices in multiple thresholds of p-values ((a) 0.001, (b) 0.01, (c) 0.05, and (d) 0.1).

Fig. 12 ADNI hippocampal surface GWAS: Estimated R2 for the imaging measurement (determinant of Jacobian matrix) across all vertices in multiple thresholds of p-values ((a) 0.001, (b) 0.01, (c) 0.05, and (d) 0.1).

Table 1 Simulation results: causal SNP rates correspond to different settings of (N0, β*, Ω) in the affected ROI, with radius r = 6. The causal SNP rate is defined as the ratio of the number of causal SNPs in G0∗ over the total number of causal SNPs.

FFGWAS: ( β1∗=0.01, σ1 = 0.5, σ2 = 0.5)	
β2∗/β1∗	N 0	
	100	300	600	900	1200	1500	1800	2000	
0.5	0.16	0.32	0.45	0.52	0.60	0.69	0.75	0.76	
1	0.15	0.43	0.72	0.99	1.00	1.00	1.00	1.00	
1.5	0.18	0.44	0.76	0.98	1.00	1.00	1.00	1.00	
2	0.19	0.44	0.78	0.99	1.00	1.00	1.00	1.00	
	
FFGWAS: ( β1∗=0.01, σ1 = 0.5, σ2 = 1)	
β2∗/β1∗	N 0	
	100	300	600	900	1200	1500	1800	2000	
0.5	0.04	0.05	0.08	0.12	0.17	0.20	0.21	0.24	
1	0.16	0.32	0.45	0.52	0.59	0.69	0.74	0.76	
15	0.15	0.42	0.67	0.94	0.98	0.99	1.00	1.00	
2	0.18	0.44	0.72	0.98	1.00	1.00	1.00	1.00	

Table 2 ADNI hippocampal surface GWAS: selected top 50 SNPs associated with the left hip-pocampal surface

SNP	CHR	BP	p–value	SNP	CHR	BP	p–value	
rs657132	18	22053274	2.63E-08	rs4744321	9	96932414	3.75E-05	
rs604345	18	22003302	1.86E-07	rs9446340	6	71826158	3.96E-05	
rs582110	18	21995436	2.12E-07	rs10803652	2	237876320	4.00E-05	
rs546000	18	22003116	2.12E-07	rs4807347	19	2857287	4.15E-05	
rs489631	18	21989024	2.40E-07	rs2418828	10	108654356	4.19E-05	
rs16837577	1	194870594	9.62E-07	rs7043499	9	132280822	4.22E-05	
rs3812872	13	61986918	3.40E-06	rs12443328	15	59561741	4.27E-05	
rs6826085	4	76870229	3.47E-06	rs2709627	8	25174710	4.32E-05	
rs929714	7	132630046	4.85E-06	rs12113716	7	155975007	4.44E-05	
rs2042067	7	132651302	4.94E-06	rs730004	3	44221458	4.67E-05	
rs17197236	8	25193338	8.66E-06	rs368380	20	14814090	4.79E-05	
rs2890548	9	4105330	1.06E-05	rs7322967	13	109910248	4.91E-05	
rs9783081	1	247016787	1.32E-05	rs11174620	12	63111885	5.17E-05	
rs628674	18	22077035	1.37E-05	rs4909112	7	157962887	5.18E-05	
rs10495737	2	23238004	1.73E-05	rs1328531	9	80389921	5.23E-05	
rs12518980	5	175168827	1.76E-05	rs10821312	9	96944581	5.30E-05	
rs2459144	19	51790992	2.44E-05	rs2800219	1	247055427	5.50E-05	
rs10418996	19	2860166	2.70E-05	rs2800221	1	247058705	5.50E-05	
rs9580112	13	19317385	2.80E-05	rs3781661	11	69999633	5.60E-05	
rs4838857	22	50601063	3.18E-05	rs2289672	17	42932244	5.75E-05	
rs887500	19	2862785	3.25E-05	rs10492041	12	126592053	5.77E-05	
rs3744405	17	7193255	3.36E-05	rs2037173	16	27126509	5.82E-05	
rs11730805	4	12174662	3.54E-05	rs2903222	4	101768637	5.83E-05	
rs732165	15	35354197	3.72E-05	rs7969873	12	128129387	6.15E-05	
rs1390931	4	101762475	3.75E-05	rs17030525	4	101792062	6.70E-05	

Table 3 ADNI hippocampal surface GWAS: selected top 50 SNPs associated with the right hippocampal surface

SNP	CHR	BP	p–value	SNP	CHR	BP	p–value	
rs4681527	3	144000439	1.72E-07	rs955690	3	135128608	2.61E-05	
rs3108514	2	151279247	5.31E-07	rs1719990	18	5560422	2.61E-05	
rs12264728	10	132139574	1.09E-06	rs7998345	13	112550205	2.64E-05	
rs652911	10	132139875	1.82E-06	rs1008012	12	33244179	2.78E-05	
rs10801705	1	89500382	2.38E-06	rs6577074	13	112553345	2.89E-05	
rs366346	10	132140841	2.41E-06	rs6540647	1	211208401	3.05E-05	
rs7312068	12	29435225	2.49E-06	rs3817959	1	14408015	3.07E-05	
rs7617465	3	143998527	3.01E-06	rs13277806	8	134412097	3.43E-05	
rs17605251	7	102745951	3.26E-06	rs6818877	4	183526528	3.68E-05	
rs749788	2	2846181	3.35E-06	rs3909532	16	82445635	3.79E-05	
rs2871213	2	98807030	6.01E-06	rs282268	2	224920176	3.87E-05	
rs823246	2	2849167	6.14E-06	rs2974154	2	80081856	4.32E-05	
rs16828194	2	151311055	6.36E-06	rs10163188	15	91953757	4.32E-05	
rs12635120	3	12304614	6.59E-06	rs12988342	2	2849451	4.64E-05	
rs4694691	4	75383332	6.82E-06	rs10843350	12	29385946	4.73E-05	
rs17141117	7	19349040	7.66E-06	rs4673085	2	224925417	4.92E-05	
rs11927997	3	135140012	9.03E-06	rs12644174	4	149878147	5.00E-05	
rs6798713	3	12305587	1.05E-05	rs4383561	3	46320462	5.09E-05	
rs937341	12	125093430	1.21E-05	rs9289050	3	116117409	5.10E-05	
rs4599142	2	101254300	1.36E-05	rs9300188	12	29388162	5.24E-05	
rs6542972	2	101257185	1.37E-05	rs11621737	14	95522834	5.26E-05	
rs1354316	3	143985479	1.59E-05	rs12355688	10	81055626	5.27E-05	
rs410852	19	54800371	1.96E-05	rs4674860	2	224921814	5.47E-05	
rs1566602	1	211191060	2.18E-05	rs2023910	7	21557854	6.13E-05	
rs7656798	4	75387973	2.34E-05	rs13263183	8	134392900	6.22E-05	

1 This work was partially supported by U.S. NIH grants MH086633 and MH092335, NSF grants SES-1357666 and DMS-1407655, and a grant from the Cancer Prevention Research Institute of Texas. The content is solely the responsibility of the authors and does not necessarily represent the official views of the NIH.


Barrett JC Fry B Maller J Daly MJ Haploview: analysis and visualization of ld and haplotype maps Bioinformatics 21 2 263 265 2005 15297300
Bigos KL Weinberger DR Imaging genetics: days of future past NeuroImage 53 804 809 2010 20080192
Cannon TD Keller MC Endophenotypes in the genetic analyses of mental disorders Annu Rev Clin Psychol 40 267 290 2006
Casey BJ Soliman F Bath KG Glatt CE Imaging genetics and development: Challenges and promises Human Brain Mapping 31 838 851 2010 20496375
Chen CH Gutierrez ED Thompson W Panizzon MS Jernigan TL Eyler LT Fennema-Notestine C Jak AJ Neale MC Franz CE Lyons MJ Grant MD Fischl B Seidman LJ Tsuang MT Kremen WS Dale AM Hierarchical genetic organization of human cortical surface area Science 335 1634 1636 2012 22461613
Di CZ Crainiceanu CM Caffo BS Punjabi NM Multilevel functional principal component analysis Annals of Applied Statistics 3 458 488 2009 20221415
Domschke K Dannlowski U Imaging genetics of anxiety disorders NeuroImage 53 822 831 2010 19944771
Durston S Imaging genetics in adhd NeuroImage 53 832 838 2010 20206707
Duvernoy HM The human hippocampus: functional anatomy, vascularization and serial sections with MRI Springer Science &amp; Business Media 2005
Fan J Gijbels I Local Polynomial Modelling and Its Applications Chapman and Hall London 1996
Fan J Lv J Sure independence screening for ultrahigh dimensional feature space (with discussion) J R Statist Soc B 70 849 911 2008
Fan J Zhang W Statistical estimation in varying coefficient models The Annals of Statistics 27 5 1491 1518 1999
Fischl B Freesurfer Neuroimage 62 2 774 781 2012 22248573
Frisoni GB Sabattoli F Lee AD Dutton RA Toga AW Thompson PM In vivo neuropathology of the hippocampal formation in ad: a radial mapping mr-based study Neuroimage 32 1 104 110 2006 16631382
Frisoni GB Ganzola R Canu E Rüb U Pizzini FB Alessandrini F Zoccatelli G Beltramello A Caltagirone C Thompson PM Mapping local hippocampal changes in alzheimer’s disease and normal ageing with mri at 3 tesla Brain 131 12 3266 3276 2008 18988639
Frost HR Shen L Saykin AJ Williams SM Moore JH Identifying significant gene-environment interactions using a combination of screening testing and hierarchical false discovery rate control Genetic Epidemiology 40 7 544 557 2016 27578615
Gabriel SB The structure of haplotype blocks in the human genome Science 296 5576 2225 2229 2002 12029063
Ge T Feng J Hibar DP Thompson PM Nichols TE Increasing power for voxel-wise genome-wide association studies: The random field theory, least square kernel machines and fast permutation procedures NeuroImage 63 858 873 2012 22800732
Ge T Nichols TE Ghosh D Mormino EC Smoller JW Sabuncu MR Alzheimer’s Disease Neuroimaging Initiative A kernel machine method for detecting effects of interaction between multidimensional variable sets: An imaging genetics application Neuroimage 109 505 514 2015a 25600633
Ge T Nichols TE Lee PH Holmes AJ Roffman JL Buckner RL Sabuncu MR Smoller JW Massively expedited genome-wide heritability analysis (megha) Proceedings of the National Academy of Sciences 112 8 2479 2484 2015b
Ghiso J Frangione B Amyloidosis and alzheimer’s disease Advanced drug delivery reviews 54 12 1539 1551 2002 12453671
Glahn DC Thompson PM Blangero J Neuroimaging endophenotypes: Strategies for finding genes influencing brain structure and function Human Brain Mapping 28 488 501 2007 17440953
Goodlett CB Fletcher PT Gilmore JH Gerig G Group analysis of dti fiber tract statistics with application to neurodevelopment NeuroImage 45 S133 S142 2009 19059345
Guo W Functional mixed effects models Biometrics 58 1 121 128 2002 11890306
Hibar DP Stein JL Kohannim O Jahanshad N Saykin AJ Shen L Kim S Pankratz N Foroud T Huentelman MJ Potkin SG Jack CR Weiner MW Toga AW Thompson PM ADNI Voxelwise gene-wide association study (vgenewas): multivariate gene-based association testing in 731 elderly subjects Neuroimage 56 1875 1891 2011 21497199
Hibar P Stein JL Renteria M Arias-Vasquez A Desrivieres S Jahanshad N Common genetic variants influence human subcortical brain structures Nature 520 224 229 2015 25607358
Huang M Nichols T Huang C Yang Y Lu Z Knickmeyer RC Feng Q Zhu HT Fvgwas: fast voxelwise genome wide association analysis of large-scale imaging genetic data NeuroImage 118 613 627 2015 26025292
Knickmeyer RC Wang JP Zhu HT Geng X Woolson S Hamer RM Konneker T Lin WL Styner M Gilmore JH Common variants in psychiatric risk genes predict brain structure at birth Cerebral Cortex 24 1230 1246 2014 23283688
Lin D Cao H Calhoun VD Wang YP Sparse models for correlative and integrative analysis of imaging and genetic data Journal of Neuroscience Methods 237 69 78 2014a 25218561
Lin J Zhu H Mihye A Sun W Ibrahim JG Functional-mixed effects models for candidate genetic mapping in imaging genetic studies Genetic epidemiology 38 8 680 691 2014b 25270690
Liu JY Calhoun VD A review of multivariate analyses in imaging genetics Frontiers in Neuroinformatics 8 2014
Maruszak A Thuret S Why looking at the whole hippocampus is not enough-a critical role for anteroposterior axis, subfield and activation analyses to enhance predictive value of hippocampal changes for alzheimer’s disease diagnosis Frontiers in cellular neuroscience 8 95 1 11 2013
Medland SE Jahanshad N Neale BM Thompson PM Whole-genome analyses of whole-brain data: working within an expanded search space Nature Neuroscience 17 6 791 800 2014 24866045
Meyer-Lindenberg A Neural connectivity as an intermediate phenotype: Brain networks under genetic control Human Brain Mapping 30 1938 1946 2009 19294651
Miller MI Qiu A The emerging discipline of computational functional anatomy NeuroImage 45 S16 S39 2009 19103297
Morris JS Functional regression Annual Review of Statistics and Its Application 2 321 359 2015
Mulugeta E Karlsson E Islam A Kalaria R Mangat H Winblad B Adem A Loss of muscarinic m4 receptors in hippocampus of alzheimer patients Brain Research 960 1–2 259 262 2003 12505680
Nicolae DL Association tests for rare variants Annual review of genomics and human genetics 17 117 130 2016
Paus T Population neuroscience: Why and how Human Brain Mapping 31 891 903 2010 20496380
Pezawas L Meyer-Lindenberg A Imaging genetics: Progressing by leaps and bounds NeuroImage 53 801 803 2010 20816317
Plaisier SB Taschereau R Wong JA Graeber TG Rank–rank hyper-geometric overlap: identification of statistically significant overlap between gene-expression signatures Nucleic Acids Research 38 17-e169 1 17 2010 19843612
Pruim RJ Welch RP Sanna S Teslovich TM Chines PS Gliedt TP Boehnke M Abecasis GR Willer CJ Locuszoom: regional visualization of genome-wide association scan results Bioinformatics 26 18 2336 2337 2010 20634204
Purcell S Neale B Todd-Brown K Thomas L Ferreira MAR Bender D Maller J Sklar P De Bakker PIW Daly MJ Plink: a tool set for whole-genome association and population-based linkage analyses The American Journal of Human Genetics 81 3 559 575 2007 17701901
Rabl U Meyer BM Diers K Bartova L Berger A Mandorfer D Popovic A Scharinger C Huemer J Kalcher K Pail J Haslacher H Perkmann T Windischberger C Brocke B Sitte HH Pollak DD Dreher J Kasper S Praschak-Rieder N Moser E Esterbauer H Pezawas L Additive gene–environment effects on hippocampal structure in healthy humans The Journal of Neuroscience 34 30 9917 9926 2014 25057194
Ramsay JO Silverman BW Functional Data Analysis Springer-Verlag New York 2005
Reimherr M Nicolae D A functional data analysis approach for genetic association studies The Annals of Applied Statistics 8 1 406 429 2014
Scharinger C Rabl U Sitte HH Pezawas L Imaging genetics of mood disorders NeuroImage 53 810 821 2010 20156570
Shen L Kim S Risacher SL Nho K Swaminathan S West JD Foroud T Pankratz N Moore JH Sloan CD Huentelman MJ Craig DW DeChairo BM Potkin SG Jack CR Jr Weiner MW Saykin AJ ADNI Whole genome association study of brain-wide imaging phenotypes for identifying quantitative trait loci in mci and ad: A study of the adni cohort NeuroImage 53 1051 1063 2010 20100581
Shi F Liu B Zhou Y Yu C Jiang T Hippocampal volume and asymmetry in mild cognitive impairment and alzheimer’s disease: Meta-analyses of mri studies Hippocampus 19 11 1055 1064 2009 19309039
Shi J Thompson PM Gutman B Wang Y Surface fluid registration of conformal representation: Application to detect disease burden and genetic influence on hippocampus NeuroImage 78 111 134 2013 23587689
Smith SM Nichols TE Threshold-free cluster enhancement: addressing problems of smoothing, threshold dependence and localisation in cluster inference NeuroImage 44 83 98 2009 18501637
Smith SM Jenkinson M Johansen-Berg H Rueckert D Nichols TE Mackay CE Watkins KE Ciccarelli O Cader MZ Matthews PM Behrens TE Tractbased spatial statistics: voxelwise analysis of multi-subject diffusion data NeuroImage 31 1487 1505 2006 16624579
Styner M Lieberman JA McClure DR Weinberger RK Jones DW Gerig G Morphometric analysis of lateral ventricles in schizophrenia and healthy controls regarding genetic and disease-specific factors Proceedings of the National Academy of Sciences USA 102 4872 4877 2005
Tao C Nichols TE Hua X Ching CRK Rolls ET Thompson PM Feng J Generalized reduced rank latent factor regression for high dimensional tensor fields, and neuroimaging-genetic applications NeuroImage 144 35 57 2017 27666385
Thompson PM Ge T Glahn DC Jahanshad N Nichols TE Genetics of the connectome NeuroImage 80 475 488 2013 23707675
Thompson PM Stein JL Medland SE Hibar DP Vasquez AA Renteria ME Toro R Jahanshad N Schumann G Franke B The enigma consortium: large-scale collaborative analyses of neuroimaging and genetic data Brain Imaging and Behavior 8 2 153 182 2014 24399358
Tzeng J Zhang D Pongpanich M Smith C McCarthy MI Sale MM Worrall BB Hsu FC Thomas DC Sullivan PF Studying gene and gene-environment effects of uncommon and common variants on continuous traits: A marker-set approach using gene-trait similarity regression The American Journal of Human Genetics 89 2 277 288 2011 21835306
Wang JL Chiou JM Muller HG Functional data analysis Annual Review of Statistics and Its Application 3 1 257 295 2016
Wang Y Song Y Rajagopalan P An T Liu K Chou YY Gutman B Toga AW Thompson PM Surface-based tbm boosts power to detect disease effects on the brain: An n = 804 adni study NeuroImage 56 1993 2010 2011 21440071
Wu MC Lee S Cai T Li Y Boehnke M Lin X Rare-variant association testing for sequencing data with the sequence kernel association test The American Journal of Human Genetics 89 1 82 93 2011 21737059
Wu R Lin M Functional mapping — how to map and study the genetic architecture of dynamic complex traits Nature Reviews Genetics 7 229 237 2006
Yan J Kim S Nho K Chen R Risacher SL Moore JH Saykin AJ Shen L Hippocampal transcriptome-guided genetic analysis of correlated episodic memory phenotypes in alzheimer’s disease Frontiers in genetics 6 2015
Yushkevich PA Zhang H Simon TJ Gee JC Structure-specific statistical mapping of white matter tracts Neuroimage 41 448 461 2008 18407524
Zhang J Chen J Statistical inference for functional data The Annals of Statistics 35 1052 1079 2007
Zhang YW Xu ZY Shen XT Pan W Testing for association with multiple traits in generalized estimation equations, with application to neuroimaging data NeuroImage 96 309 325 2014 24704269
Zhao Y Castellanos FX Annual research review: Discovery science strategies in studies of the pathophysiology of child and adolescent psychiatric disorders: promises and limitations Journal of Child Psychology and Psychiatry 57 421 439 2016 26732133
Zhu H Kong L Li R Styner M Gerig G Lin W Gilmore JH Fadtts: functional analysis of diffusion tensor tract statistics NeuroImage 56 1412 1425 2011 21335092
Zhu H Fan J Kong L Spatially varying coefficient model for neuroimaging data with jump discontinuities Journal of the American Statistical Association 109 977 990 2014
Zhu HT Li RZ Kong LL Multivariate varying coefficient model for functional responses Annals of Statistics 40 2634 2666 2012 23645942
Zipunnikov V Caffo BS Yousem DM Davatzikos C Schwartz BS Crainiceanu C Functional principal components model for high-dimensional brain imaging Neuroimage 58 772 784 2011 21798354
