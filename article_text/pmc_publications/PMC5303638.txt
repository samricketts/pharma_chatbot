LICENSE: This file is available for text mining. It may also be used consistent with the principles of fair use under the copyright law.


9215515
20498
Neuroimage
Neuroimage
NeuroImage
1053-8119
1095-9572

27915121
5303638
10.1016/j.neuroimage.2016.11.048
NIHMS844984
Article
Predicting Individual Brain Functional Connectivity Using a Bayesian Hierarchical Model
Dai Tian
Guo Ying
for the Alzheimer’s Disease Neuroimaging Initiative*
* Data used in preparation of this article were obtained from the Alzheimer’s Disease Neuroimaging Initiative (ADNI) database (adni.loni.usc.edu). As such, the investigators within the ADNI contributed to the design and implementation of ADNI and/or provided data but did not participate in analysis or writing of this report. A complete listing of ADNI investigators can be found at: http://adni.loni.usc.edu/wp-content/uploads/how_to_apply/ADNI_Acknowledgement_List.pdf

25 1 2017
01 12 2016
15 2 2017
15 2 2018
147 772787
This file is available for text mining. It may also be used consistent with the principles of fair use under the copyright law.
Network-oriented analysis of functional magnetic resonance imaging (fMRI), especially resting-state fMRI, has revealed important association between abnormal connectivity and brain disorders such as schizophrenia, major depression and Alzheimer’s disease. Imaging-based brain connectivity measures have become a useful tool for investigating the pathophysiology, progression and treatment response of psychiatric disorders and neurodegenerative diseases. Recent studies have started to explore the possibility of using functional neuroimaging to help predict disease progression and guide treatment selection for individual patients. These studies provide the impetus to develop statistical methodology that would help provide predictive information on disease progression-related or treatment-related changes in neural connectivity. To this end, we propose a prediction method based on Bayesian hierarchical model that uses individual’s baseline fMRI scans, coupled with relevant subject characteristics, to predict the individual’s future functional connectivity. A key advantage of the proposed method is that it can improve the accuracy of individualized prediction of connectivity by combining information from both group-level connectivity patterns that are common to subjects with similar characteristics as well as individual-level connectivity features that are particular to the specific subject. Furthermore, our method also offers statistical inference tools such as predictive intervals that help quantify the uncertainty or variability of the predicted outcomes. The proposed prediction method could be a useful approach to predict the changes in individual patient’s brain connectivity with the progression of a disease. It can also be used to predict a patient’s post-treatment brain connectivity after a specified treatment regimen. Another utility of the proposed method is that it can be applied to test-retest imaging data to develop a more reliable estimator for individual functional connectivity. We show there exists a nice connection between our proposed estimator and a recently developed shrinkage estimator of connectivity measures in the neuroimaging community. We develop an expectation-maximization (EM) algorithm for estimation of the proposed Bayesian hierarchical model. Simulations studies are performed to evaluate the accuracy of our proposed prediction methods. We illustrate the application of the methods with two data examples: the longitudinal resting-state fMRI from ADNI2 study and the test-retest fMRI data from Kirby21 study. In both the simulation studies and the fMRI data applications, we demonstrate that the proposed methods provide more accurate prediction and more reliable estimation of individual functional connectivity as compared with alternative methods.

Reliability
Predictability
Functional Connectivity
Resting-state fMRI
Bayesian Hierarchical Model
Shrinkage estimator

1 Introduction

Brain functional connectivity research based on fMRI, especially resting-state fMRI (rs-fMRI), has become an important approach for understanding brain organization and has revealed intrinsic neural functional connections that can be found consistently across groups of subjects and in repeated scanning sessions (Smith et al., 2009; Damoiseaux et al., 2006; Shehzad et al., 2009). Clinically, functional connectivity has also shown great promises for studying pathophysiology of the development and progression of psychiatric diseases and their response to treatments (Biswal et al., 1995; Greicius et al., 2003; Fox et al., 2005; Smith et al., 2009 among many others). Numerous studies have identified distinct patterns of functional connectivity in brain networks among subjects with psychiatric disorders as compared to a healthy comparison population that support a neuropathophysiology of cognitive/behavioral problems associated with these disorders (Wang et al., 2007; Woodward and Cascio, 2015). Studies report mental disorders such as Alzheimer’s disease affect brain functional connections across time with the disease progression (Damoiseaux et al., 2011; Yao et al. 2014). Furthermore, several studies have found significant pre- to post-treatment changes in brain connectivity following psychiatric treatments (Gay et al., 2014; Sarpal et al., 2015). These collective findings strongly implicate alterations in functional connectivity in the pathophysiology of psychiatric disorders and their responses to medical schooltreatment. This provides motivation for the potential utility of forecasting disease progression-related and treatment-related brain functional connectivity reflected in fMRI.

There has been some work aimed to link baseline brain connectivity to disease progression or the eventual clinical response to treatment (Damoiseaux et al., 2011; Yao et al. 2014). In a related manner, several authors (Brody et al., 1999; Goldapple et al., 2004; Kennedy et al., 2001; Lee et al., 2005; Mayberg et al., 2000, 2001; Moresco et al., 2000) showed that changes in brain activity across time were associated with disease progression or treatment response. Hence, important insights can be gained for disease progression or treatment response by evaluating baseline and follow-up scans. However, in clinical practice, these insights are offset due to the unavailability of follow-up scans at the early phase of disease occurrence or at the time when a clinician makes treatment decision for a particular patient. This pragmatic shortcoming suggests the utility of developing a statistical framework to predict disease-related or treatment-related brain alterations, which could then be combined with baseline scans and patients’ relevant risk factors to help inform clinical decision-making.

In this work, we present a general framework for predicting individual future resting-state functional connectivity (RSFC) based on his/her baseline rs-fMRI and relevant clinical and demographic characteristics, such as disease stage or treatment group. The proposed prediction method provides a useful tool to predict the changes in an individual’s brain connectivity with the progression of the disease or normal aging. It can also be applied to predict a patient’s brain connectivity after a specified treatment regimen to help inform individualized treatment plan. The proposed predictive model could potentially have important clinical applications by helping implement early intervention based on predicted disease progression trajectory to prevent severe outcomes from mental illnesses. The method can also help guide the development of a more effective individualized treatment plan by taking into account both the population-level effects as well as a patient’s distinct neural connectivity characteristics. Another utility of the proposed method is to provide a more reliable estimator for individual RSFC than the noisy subject-specific estimator in test-retest rs-fMRI data. A reliable RSFC estimate can provide important information about the properties of brain networks and is the basis for many complex network-related analyses. For example, Shou et al. (2014) and Mejia et al. (2015) have shown that by improving the reliability of RSFC estimates, one can improve the reproducibility of individual brain parcellation, which is generated from the RSFC.

The remainder of this paper is organized as follows. In the method section, we first present a general modeling and prediction framework for individual functional connectivity, and then illustrate the model specification for two types of imaging studies: longitudinal imaging studies which investigate disease progression and treatment-related changes in functional connectivity, and test-retest studies which aim to investigate and improve the reliability of estimates for individual RSFC. We conduct simulations studies to evaluate the accuracy of the proposed method using the K-fold cross-validation approach. We also illustrate the application of the proposed method using two imaging datasets: the longitudinal resting-state fMRI from ADNI2 study and the test-retest fMRI data from Kirby21 study (Landman et al., 2011).

2 Method

The need to predict a subject’s future brain connectivity often arises in medical research and clinical practice. Some examples include prediction on how neural connectivity pattern will be affected across time with the progression of a brain disorder or prediction on post-treatment brain connectivity due to treatment-related alterations on neural processing. A subject’s future brain connectivity depends on various factors including current disease status, type of treatment, his/her baseline brain connectivity and other relevant subject characteristics such as age, gender and family history, etc. Our aim is to develop an algorithm that utilizes information related to these relevant factors to provide accurate individualized prediction for future brain connectivity. Our approach is to develop a statistical model for characterizing the changes in functional connectivity using a training data set that includes both baseline and follow-up imaging scans. We then derive a prediction algorithm for future brain connectivity using a subject’s baseline images and clinical/demographic characteristics based on the developed statistical model. Once the prediction algorithm is established, researchers or clinical practitioners can apply it to predict the future brain connectivity for a new subject by inputting information derived from the subject’s baseline scans and relevant individualized traits. With the predicted future brain connectivity, researchers or clinical practitioners can find helpful information in forecasting alterations in a patient’s brain networks with the progression of the disease or in deciding whether a treatment is appropriate for a particular patient in the way that it can lead to favorable therapeutical alteration on the patient’s brain connectivity. We summarize our proposed approach for developing and applying the prediction algorithm in Figure 1. Prior to presenting our prediction algorithm, we describe the statistical model underlying the formulation of our prediction framework.

2.1 Bayesian Hierarchical Model (BHM) and Estimation

One of the most commonly used measures for functional connectivity in the neuroimaging community is pair-wise correlation between fMRI Blood-oxygen-level dependent (BOLD) signals obtained from pairs of brain locations or regions, which are called the nodes in the connectivity network (Biswal et al., 1995; Grecius et al., 2003; Fox et al., 2005, Fransson and Marrelec, 2008). We illustrate the proposed prediction method using correlation as the measure of functional connectivity but our method is general enough to be readily applied to alternative connectivity measures. We derive our predictive framework for brain functional connectivity using a Bayesian hierarchical model (BHM). The BHM is developed using subjects’ repeatedly measured brain connectivity derived from both baseline and follow-up imaging scanning sessions. The first level of BHM models within-subject session-specific connectivity measures obtained at multiple scans in terms of subject-specific effects, and the second level models subject-specific effects in terms of population parameters modulated by covariate effects. An expectation-maximization (EM) algorithm is developed to estimate the parameters in the model. The prediction algorithm is then derived based on the BHM model. The proposed method is applicable to various study designs. Specifically, our method can be applied to longitudinal studies where there are relatively long time intervals between different imaging scanning sessions and hence temporal changes are expected between connectivity measures at different sessions. The proposed method can also be applied to test-retest studies where repeated scanning sessions are very close to each other in time and hence no significant temporal changes are expected between the repeatedly measured connectivity. We start with presenting a general model structure and later we will provide detailed examples of how to adapt the proposed model to specific study designs.

Let i = 1, … , N index subjects, m = 1, … , M index nodes in the connectivity network, and k = 1, … , K index scanning sessions. For any node pair (m, m′), we denote the observed connectivity estimated using subject i’s brain images from the K scanning sessions as ri(m, m′) = (ri1(m, m′), … , riK(m, m′))T. In the paper, we illustrate our model using the commonly used correlation coefficient as the measure of brain connectivity and rik(m, m′) represents the Fisher’s z transformation of the correlation between the two node-specific fMRI time series extracted from images obtained at the kth scanning session. One can also select other measures such as partial correlation as the connectivity measure and rik(m, m′) would then represent the selected connectivity measure after proper transformation. The first-stage of BHM models the within-subject session-specific connectivity for a node pair (m, m′) as follows, (1) Level1:ri(m,m′)=Xi(1)Ri(m,m′)+ϵi(1)(m,m′),

where Xi(1) is the first-level covariate matrix with the dimension of K × q matrix and contains q session-specific covariates such as the time point corresponding to each of the K scanning sessions. Note that Xi(1) includes time-varying covariates that can change across the K scanning sessions. Ri(m, m′) is a q × 1 vector of subject-specific effects of interest corresponding to Xi(1),ϵi(1)(m,m′)=(ϵi1(1)(m,m′),⋯,ϵiK(1)(m,m′))T is the random error vector and is assumed to follow a zero-mean multivariate normal distribution N (0, Σ(1)(m, m′)). We assume that Ri(m,m′) and ϵi(1)(m,m′) are independent across all subjects. In the first-level model (1), Ri(m, m′) is a random variable, which represents the underlying connectivity between nodes m and m′ for subject i and captures the within-subject correlations among the session-specific connectivity measures repeatedly obtained across the K sessions. The random error ϵi(1)(m,m′) reflects the session-specific random variabilities after accounting for subject-specific connectivity characteristics. We assume that the random errors are independent across sessions, i.e. Σ(1)(m, m′) is a diagonal matrix, since within-subject correlations across session are already accounted for by the subject-specific effects. The variability of the random errors can be the same or different across various sessions depending on the study design. For example, if subjects’ images in different sessions are acquired under similar conditions (e.g. under the same protocol) and sessions are conducted very close in time such as in test-rest studies, it is reasonable to assume the variability of the random errors remain the same across sessions, hence the covariance matrix can be specified as Σ(1)(m, m′) = λ(1)(m, m′)IK , where λ(1) is the covariance hyper-parameter and IK is the identity matrix of order K. On the other hand, in longitudinal studies where sessions are conducted across relatively long time intervals, we can specify different error variability level to accommodate potentials temporal changes, e.g. for K=2,let∑(1)(m,m′)=λ1(1)(m,m′)[1000]+λ2(1)(m,m′)[0001] where λj(1)(m,m′) represents the error variability at the jth session (j = 1, 2).

At the second stage, we focus on modeling the subject-specific effects with respect to population parameters of interest, such as disease status, treatment assignment or other relevant patient characteristics (e.g., gender, age). The second-stage model is specified as follows (2) Level2:Ri(m,m′)=Xi(2)β(m,m′)+ϵi(2)(m,m′),

where Xi(2) is the second-level covariate matrix that contains subject-specific covariates that may be relevant to brain functional connectivity, such as disease status, treatment group, age, gender, etc. Unlike the first level covariate matrix Xi(1) which contains time-varying covariates, the second-level covariates Xi(2) include subject-specific covariates that remain the same across sessions. β(m, m′) represents the population effects of interest corresponding to Xi(2)(m,m′). The random variability ϵi(2)(m,m′) represents the deviation of subject-specific effects from the population mean adjusted with covariate effects. We assume the subject random variability follows a zero-mean multivariate normal distribution with the covariance matrix Σ(2)(m, m′). The specification of Σ(2)(m, m′) depends on the subject-specific effects Ri that we are interested in modeling. We will provide details on how to specify the covariance matrix for different study designs such as longitudinal studies and test-rest studies in the following sections. We note that the Level 2 model focuses on modeling subject-specific effects in terms of non-time varying covariates. In some studies, certain subjects’ covariates may vary across sessions such as clinical variables measured at each session, we can model their effects on connectivity via Level 1 model in equation (1). Specifically, we can either include these time-varying covariates in Xi(1) to model their effects via subject-specific effects or include them as additional covariates in Level 1 model which are associated with population-level parameters.

For the population level parameters β, we specify prior distributions given by N (ηβ, Σβ), where Σβ is a diagonal covariance matrix. If there is information available regarding β from previous studies, one can take a full Bayesian approach and treat the population parameters as know, i.e. by setting Σβ = 0. In practice, we usually have little, if any, prior information for these parameters and a parametric empirical Bayesian scheme with Σβ = ∞ (i.e. the diagonal variance terms are ∞) is appropriate (Friston et al., 2002). In this case, the prior expectations ηβ does not need to be specified (Appendix). In this case, the hyperparameters for our Bayesian hierarchical model only include the parameters in the covariance matrices Σ(1)(m, m′) and Σ(2)(m, m′), which we denote as λ(m, m′). These hyperparameters can be estimated from the data under parametric empirical Bayes scheme (Carlin and Louis, 2000; Friston et al., 2002).

The proposed Bayesian hierarchical model can be estimated using the expectation-maximization (EM) algorithm (Dempster et al., 1977 and 1981). Please see the Appendix for details. The EM algorithm offers a convenient approach to estimate both the parameters and hyperparameters in the model from the data. The E-step of EM algorithm involves estimating the conditional distribution of the parameters given the observed data, holding the hyperparameters λ(m, m′) fixed. The M-step finds the maximum likelihood estimates of hyperparameters, i.e. λ^(m,m′) that maximizes the marginal likelihood of the observed connectivity measures, where the marginal likelihood is obtained by integrating over the conditional distribution of the parameters obtained from the E-step. For a linear model under Gaussian assumptions such as ours and with the parametric empirical Bayes, the EM algorithm outputs the expectation and the covariance of the Gaussian posterior distribution of the parameters and the marginal maximum likelihood estimates of the hyperparameters (Appendix). The EM algorithm can also be adopted for full Bayes and maximum likelihood estimation (Carlin and Louis, 2000; Friston et al., 2002).

Under certain conditions, the proposed Bayesian hierarchical model can be rewritten in terms of a frequentist Linear Mixed Model (LMM) allowing for an unequal spacing of the time points and both baseline and time-varying covariates. One appealing feature related to BHM is that it provides the possibility of incorporating prior information, if available, into the models.

2.2 Prediction Algorithm

Based on the proposed Bayesian hierarchical model, we develop a prediction algorithm for forecasting individual brain connectivity in future scans. We arrange the connectivity vector across all scanning sessions as ri(m,m′)=(ri1T(m,m′),ri2T(m,m′))T. Here, ri1(m, m′) = (ri1(m, m′), … , riK1(m, m′))T is a K1 × 1 vector representing the earlier observed connectivity such as baseline or pre-treatment connectivity and ri2(m, m′) = (riK1 +1(m, m′), … , riK(m, m′))T representing the later connectivity we are interested in predicting such as connectivity in follow-up or post-treatment scans. The proposed algorithm uses information from the subject’s connectivity estimated from earlier scans ri1(m, m′) and also takes into account relevant subject’s characteristics such as disease status or treatment groups.

By collapsing the two levels of the proposed hierarchical model in (1) and (2), we first derive the following non-hierarchical marginal distribution for functional connectivity across all sessions, (3) ri(m,m′)=(ri1T(m,m′),ri2T(m,m′))T~N(μi⋆(m,m′),Σi⋆(m,m′)),

where μi⋆(m,m′)=Xi(1)Xi(2)β(m,m′) and ∑i⋆(m,m′)=∑(1)(m,m′)+Xi(1)∑(2)(m,m′)Xi(1)T. The marginal covariance matrix Σ⋆(m, m′) is the sum of the error covariance matrix Σ(1)(m, m′) from the first-stage model and the error covariance matrix Σ(2)(m, m′) from the second-stage model projected onto the measurement space by the first-stage design matrix Xi(1). Therefore, ∑i⋆(m,m′) consists of the variability of ri(m, m′) from both levels of the hierarchical model.

Based on the joint marginal distribution of ri1(m, m′) and ri2(m, m′) in (3), we derive the prediction algorithm for the later connectivity ri2(m, m′). The prediction algorithm provides the predictive distribution of ri2(m, m′) given the earlier connectivity ri1(m, m′), [ri2(m,m′)∣ri1(m,m′)]~N(μ2.1(m,m′),Σ2.1(m,m′)),

with (4) μ2.1(m,m′)=μi2⋆(m,m′)+Σ12⋆(m,m′)Σ11⋆−1(m,m′)[ri1(m,m′)−μi1⋆(m,m′)]

and (5) Σ2.1(m,m′)=Σ22⋆(m,m′)−Σ21⋆(m,m′)Σ11⋆−11(m,m′)Σ12⋆(m,m′)

where μi1⋆(m,m′) and μi2⋆(m,m′) are the subvectors of μi⋆(m,m′) that correspond to the mean of ri1(m, m′) and ri2(m, m′), respectively. And ∑11⋆(m,m′),∑22⋆(m,m′),∑12⋆(m,m′) and ∑21⋆(m,m′) are the submatrices of Σ⋆(m, m′) that correspond to the variances and covariances of ri1(m, m′) and ri2(m, m′).

By plugging in the estimator of the hyperparameters λ^(m,m′) and the posterior mean of the parameters provided from the EM algorithm into Equations (4) and (5), we obtain the estimated conditional mean μ^2.1(m,m′) and conditional variance Σ^2.1(m,m′). Based on the estimated conditional distribution, we propose the following BHM predictor for future connectivity, (6) r^i2B(m,m′)=μ^2.1(m,m′)=μi2⋆(m,m′)+Σ^12⋆(m,m′)Σ^11⋆−1(m,m′)[ri1(m,m′)−μ^i1⋆(m,m′)]

From Equation (6), one can see that the BHM predictor of a subject’s future connectivity consists of two components. The first component μi2⋆(m,m′) is the expected later connectivity based on subject’s relevant characteristics coded in Xi(2) which may include disease group, treatment assignment, age etc. This part represents the population-level expectation for the subject based on his/her characteristics and is shared by the subpopulation of subjects who have the same traits. The second component in (6) represents the adjustment to the population-level prediction for the particular subject using subject-specific effects revealed from his/her earlier observed scans. More specifically, subject-specific effects are estimated by the deviation of the subject’s earlier connectivity estimates from his/her earlier population-level expectation, i.e. ri1(m,m′)−μi1⋆(m,m′). The amount of the adjustment depends on the variability of earlier connectivity estimates and the association between earlier and later connectivity estimates: the lower the variability of the earlier connectivity estimates and the higher association they have with the later connectivity estimates, the larger the effect the earlier connectivity estimates have on the later connectivity prediction. Additionally, we can also construct a 100(1 − α)% prediction interval for ri2(m, m′) based on the estimated conditional variance Σ^2.1(m,m′).

In the following section, we will illustrate how to specify the hierarchical model for two commonly seen study designs involving repeated-measures fMRI, which are longitudinal studies and test-retest replication studies.

2.3 BHM Model Specification for Various Types of Studies

2.3.1 Model Specification for Longitudinal Studies

In longitudinal imaging studies, subjects are scanned repeatedly in multiple sessions that are separated by relatively long time intervals and temporal changes in neural processing across the sessions are expected and of interest. For example, longitudinal studies may be conducted to evaluate how brain functional connectivity changes with the disease progression or neurodevelopment. In other cases, longitudinal studies are used to investigate treatment-related changes by repeatedly scanning subjects at pre-treatment and post-treatment periods. When applying the proposed the BHM model to longitudinal studies, we model the population and subject effects on temporal change in connectivity as well as baseline connectivity. Specifically, suppose the longitudinal measurements of the connectivity ri(m, m′) = (ri1(m, m′), … , riK(m, m′))T are obtained at time TK = (t1, … , tK )T where t1 = 0 indicates the baseline. Assuming a constant change rate in the connectivity over time, the proposed BHM model in (1) and (2) can be specified as follows for the longitudinal study, (7) Level1:ri(m,m′)=[ri1(m,m′)⋮riK(m,m′)]=[1t1⋮⋮1tK][RiB(m,m′)RiΔ(m,m′)]+ϵi(1)(m,m′),Level2:[RiB(m,m′)RiΔ(m,m′)]=[XiB00XiΔ][βB(m,m′)βΔ(m,m′)]+[ϵiB(2)(m,m′)ϵiΔ(2)(m,m′)],

where RiB(m, m′) and RiΔ(m, m′) are the subject-specific baseline and change rate of connectivity, XiB and XiΔ include subjects’ covariates relevant to the baseline and change rate, respectively, βB(m, m′) and βΔ(m, m′) are population effects of interests related to the baseline and change rate. In this BHM model, we first model the repeatedly measured connectivity in terms of subject-specific baseline and change rate and then we model the subject-specific effects in terms of population parameters modulated by subjects’ covariates. For the random errors from first-level model, we assume that ϵi(1)(m,m′)~N(0,∑(1)(m,m′)) with Σ(1)(m, m′) = λ(1)(m, m′)IK. The random errors (ϵiB(2)(m,m′),ϵiΔ(2)(m,m′))T of the second-level model represent the deviation of the subject-specific baseline and change rate from the population mean after adjusting for subjects’ covariates effects. These random errors are assumed to follow a zero-mean multivariate normal distribution with the covariance matrix ∑(2)(m,m′)=λB(2)(m,m′)[1000]+λΔ(2)(m,m′)[0001], where λB(2)(m,m′) and λΔ(2)(m,m′) represents the between-subject variabilities in the baseline and change rate, respectively.

2.3.2 Model Specification for Test-retest Reliability Studies

In test-retest reliability studies, subjects are scanned repeatedly in multiple sessions that are separated by very short time intervals. The studies are usually conducted to quantify the reproducibility of the results obtained from statistical analysis using the scan-rescan imaging data. In recent years, there has also been strong interest in using test-retest imaging studies to develop more reliable estimator or predictor for individual neural features such as connectivity (Shou et al., 2014; Mejia et al., 2015). In test-retest studies, no disease-related or treatment-related temporal changes are expected given the short time interval between scanning. The proposed BHM model in (1) and (2) are hence specified as follows, (8) Level1:ri(m,m′)=1KRi(m,m′)+ϵi(1)(m,m′),Level2:Ri(m,m′)=Xiβ(m,m′)+ϵi(2)(m,m′),

where Ri(m, m′) is the subject-specific connectivity, Xi contains relevant subjects’ clinical or demographic characteristics that may be affect functional connectivity. In the BHM model (8), the level 1 model takes the similar form as the classical measurement error model (Carroll et al., 2006) where repeated measurements in ri(m, m′) from subject i are modeled in terms of the true underlying connectivity for the ith subject, i.e. Ri(m, m′), and measurement errors ϵi(1)(m,m′). Here, the measurement errors are assumed to follow a zero-mean multivariate Gaussian distribution with Σ(1)(m, m′) = λ(1)(m, m′)IK . At level 2 of the hierarchical model, we model the subject-specific connectivity in terms of population parameters modulated by a subject’s covariate effects. And the random error ϵi(2)(m,m′) represents between-subject variability and follows zero-mean normal distribution with a variance of λ(2)(m, m′).

Based on the hierarchical model (8), we can quantify the reproducibility of the estimated individual functional connectivity in the scan-rescan imaging data. Specifically, we can evaluate the reproducibility using the intraclass correlation coefficient (ICC) which is a commonly used reproducibility index. ICC ranges between 0 and 1 with higher ICC indicating the more reproducible a measurement is within a subject. From the BHM model, ICC for the connectivity measure between node pair (m, m′) can be derived as γB(m,m′)=λ(2)(m,m′)λ(1)(m,m′)+λ(2)(m,m′), which is the ratio of between-subject variability λ(2)(m, m′) to the total variability which includes the between-subject and within-subject variability, i.e. λ(1)(m, m′) + λ(2)(m, m′).

The proposed Bayesian hierarchical model and prediction algorithm can also help achieve another goal in test-retest imaging study, that is to develop more reliable estimator for individual functional connectivity. The approach is to develop an estimator for individual connectivity based on his/her first scan and evaluate it accuracy in estimating the subject’s connectivity in the second scan (Shou et al., 2014; Meija et al., 2015). Using our proposed methods, we can first train the Bayesian hierarchical model (8) using the scan-rescan data in the training data set and then apply the proposed predictor in equation (6) to derive an estimator for a new subject’s connectivity in the second scan based on his/her connectivity measured from the first scan. The proposed estimator for individual connectivity has the potential to improve the subject-specific connectivity estimate by not only using information from the subject’s own measurement from the first scan but also ”borrowing” strength from the group of subjects who shall similar characteristics with the current subject. To illustrate this, we consider a simple test-retest study with two scanning sessions (K = 2), in which researchers are interested in estimating subjects’ second-session connectivity based on their first-session fMRI scans. After fitting the Bayesian hierarchical model in (8), we can apply the predictor in (6) as an estimator of a subject’s functional connectivity in the second scan based on the data in the first scan. We show the predictor in (6) can be rewritten as follows, (9) r^i2B(m,m′)=γ^B(m,m′)ri1(m,m′)+(1−γ^B(m,m′))Xiβ^(m,m′).

where r^i2B(m,m′) is the estimated connectivity for subject i in the second scan, ri1(m, m′) is the observed connectivity measured from the ith subject’s first scan, γ^B(m,m′) is the estimated ICC obtained by plugging in the BHM model-based estimates of the between- and within-subject variability, i.e. γ^B(m,m′)=λ^(2)(m,m′)λ^(1)(m,m′)+λ^(2)(m,m′). Equation (9) shows the BHM estimator of the individual connectivity is a weighted average of the subject-level connectivity measurement, ri1(m, m′), and covariate-adjusted population expectation, Xiβ^(m,m′). The ICC weight γ^B(m,m′), which ranges between 0 and 1, represents the relative weight assigned to the subject-level estimate as compared to population expectation. The higher ICC, i.e. the more reproducible the within-subject connectivity estimates are, we would assign more weight to the same subject’s own connectivity estimate. On the other hand, with low ICC or low within-subject reproducibility, our predictor would place more weight on the population-level expected connectivity in estimating the subject’s connectivity. The implications from Equation (9) are that the BHM estimator for subject i’s connectivity not only depends on the subject’s own connectivity measured in the first scan but also borrows strength from the population-level expectation based on the subject’s covariates Xi, and that the relative weights assigned to the two parts are automatically adjusted based on the level of within-subject reproducibility.

In the empirical Bayes literature, the proposed estimator (9) is often known as the ”shrinkage estimator” (Efron and Morris, 1975; James and Stein, 1961), which has been shown to improve upon traditional estimators by shrinking the estimators towards some fixed constant value. In addition, the proposed estimator is similar to the best linear unbiased predictor (BLUP) of random effects in linear mixed models, except in the latter case, the weights depend on unknown values of variance components, which are replaced by sample-based estimates (Henderson, 1975 and Liu et al., 2008). The weight γ^B(m,m′) is referred to as the shrinkage factor since it controls how much we shrink the subject-level estimator towards the population mean. As ICC increases, subject-level information is more reliable and hence more weight is assigned to the subject-level estimate ri1(m, m′). On the contrary, as ICC decreases, subject-level information is less reliable and we should benefit more by ”borrowing” information from the population. As a shrinkage estimator, our predictor in (9) has a nice connection with the recently proposed shrinkage estimator (Shou et al., 2014; Mejia et al., 2015) for predicting future brain connectivity in test-retest imaging studies. Specifically, Shou et al. (2014) and Mejia et al. (2015) proposed a shrinkage estimator for individual functional connectivity as follows, (10) r^i2S(m,m′)=γ^S(m,m′)ri1(m,m′)+(1−γ^S(m,m′))r‒1(m,m′),

where r‒1(m,m′) is the sample mean of first-session estimate of connectivity across all subjects and γS(m, m′) is a shrinkage factor that takes value in [0, 1]. Shou (2014) and Mejia (2015) proposed a shrinkage factor estimator as γ^S(m,m′)=λ^(2)S(m,m′)λ^(1)S(m,m′)+λ^(2)S(m,m′). where λ^(1)S(m,m′) and λ^(2)S(m,m′) are moment estimators for within-subject and between-subject variance.

From (9) and (10), we can see the proposed BHM estimator r^i2B(m,m′) is closely related to the shrinkage estimator r^i2S(m,m′) by Shou et al. (2014) and Mejia et al. (2015). However, there are two major differences between the two methods. First, the population expectation in Shou’s estimator is the sample mean connectivity across all subjects. The population expectation in the BHM predictor is the model-based subpopulation mean based on subject’s covariates pattern. By taking into account covariate effects in population mean estimation, the BHM predictor can potentially provide more precise covariate-adjusted population-level expectation for a subject based on his/her clinical and demographic characteristics. Secondly, Shou’s shrinkage factor is derived empirically based on the moment estimators of the variance. In comparison, the shrinkage factor in BHM predictor is derived from the model-based variance estimates.

3 Experimental Methods

We illustrate the proposed BHM method and compare it with existing methods on simulated data and also on two real-world fMRI data examples.

3.1 Simulation Studies

We conducted two sets of simulation studies to evaluate the performance of the proposed BHM method in comparison with alternative methods for predicting brain connectivity for longitudinal imaging studies and test-retest reliability studies. Under each simulation scenario, we generated 100 data sets each with 100 subjects. We evaluated the accuracy of the prediction methods using the K-fold cross-validation. Specifically, we split the data into K = 5 subsets. In each iteration, we assigned K − 1 subsets as training data and the one remaining subset as the test data. The training data were used to develop the prediction algorithms based on the proposed BHM method and alternative methods and the test data were then used to evaluate the prediction accuracy. For example, to evaluate the prediction accuracy based on the proposed Bayesian hierarchical model, we first fit the model to the training data then predict the connectivity for subjects in the testing data using the estimated parameters from the training data. We repeated this procedure for the K different training and test data assignments to compute the predicted connectivity for all subjects. We measured the prediction error using average prediction mean square error (PMSE) between the true underlying connectivity and the predicted connectivity.

In the first setup, we simulated longitudinal data with three connectivity measurements within each subject from the hierarchical model in (7). For Level 2 model in (7), we considered two subject groups. We assume subjects from the two groups had the same baseline connectivity βB but potentially had different change rate across time with βΔ = [βΔ1, βΔ2]′. We considered three levels of between-group differences in the change rate with (βΔ1, βΔ2) specified as (0.2, −0.2), (0.1, −0.1), (0, 0), representing large, small and no group difference, respectively. The between-subject variability in the baseline and change rate, i.e. λB(2) and λΔ(2), were set at 0.03 and 0.01 respectively to mimic the real data. For Level 1 model in (7), the within-subject variance λ(1) was chosen so that the variance ratio of between-subject variance and total variance at baseline, i.e. λB(2)∕(λ(1)+λB(2)), varied from 0.1 to 0.9. We then applied various prediction methods to predict the connectivity at t3 based on the measurements observed at t1 and t2. For the longitudinal study, we compared the proposed BHM predictor with a raw predictor and a General Linear Model(GLM) predictor. Raw predictor predicted a subject’s future connectivity using the same subject’s baseline estimate. The GLM predictor was derived based on the following GLM model which models connectivity from all subjects with common population parameters and assumes independence among scans obtained at multiple sessions within a subject, i.e., (11) [ri1(m,m′)ri2(m,m′)ri3(m,m′)]=[1t11t21t3][XiB00XiΔ][βB(m,m′)βΔ(m,m′)]+ϵi(m,m′),

where ϵi(m, m′) ~ N (0, σ2(m, m′)I3). Estimates from the GLM are obtained using OLS. The predicted connectivity based on model (11) is r^i3(m,m′)=XiBβ^B(m,m′)+t3XiΔβ^Δ(m,m′), which only reflects group-level expectation and does not take into account of information obtained from the subjects’ previous scans.

In the second setup, we simulated data with two scan-rescan connectivity measurements for each subject from the test-retest BHM in (8). For Level 2 model in (8), we considered two subject groups with β = [β1, β2]′ representing the mean connectivity for group 1 and 2, specifically. We considered three levels of between-group differences with (β1, β2) specified as (0.6, 0.2), (0.4, 0.2), (0.2, 0.2), representing large, small and no group difference, respectively. We specified the between-subject variance λ(2) in Leven 2 model as 0.03, and let the within-subject variance λ(1) in Level 1 model vary so that the variance ratio of between-subject variance and total variance changed from 0.1 to 0.9. We applied the prediction methods to predict the connectivity in the second scan based on the measurement in the first scan. For the test-retest study setting, we compared the BHM estimator with the raw estimator, a mean estimator, the GLM estimator and the shrinkage estimator (Shou et al. (2014); Mejia et al. (2015)). Here, the mean estimator gave the prediction for a subject’s rescan connectivity using the group mean at the first scan. The GLM estimator is derived based on the following GLM, (12) [ri1(m,m′)ri2(m,m′)]=[11]Xiβ(m,m′)+ϵi(m,m′).

where ϵi(m, m′) ~ N (0, σ2(m, m′)I2). The GLM estimator based on (12) is r^i2(m,m′)=Xiβ^(m,m′), which only reflects group-level expectation.

3.2 Application to Longitudi nal rs-fMRI data in ADNI2 Study

3.2.1 Longitudinal rs-fMRI in ADNI2 Study and pre-processing steps

We first applied the proposed BHM method to the longitudinal rs-fMRI data from the Alzheimer’s Disease Neuroimaging Initiative 2 (ADNI2) study. One of the main purposes of ADNI2 project is to examine changes in neuroimaging and other biomarkers with the progression of mild cognitive impairment(MCI) and Alzheimer’s Disease(AD). Data used in our analysis were downloaded from ADNI website (http://www.adni.loni.usc.edu) and included longitudinal rs-fMRI images from eighty subjects that were collected at screening, 6 months and 1 year. A T1-weighted high-resolution anatomical image (MPRAGE) and a series of resting state functional images were acquired with a 3.0 Tesla MRI scanner (Philips Systems) during longitudinal visits. The rs-fMRI scans were acquired with 140 volumes, TR/TE=3000/30 ms, flip angle of 80 and effective voxel resolution 3.3×3.3×3.3 mm. Additional image acquisition parameters are described in details on http://www.adni-info.org. Quality control was performed on the fMRI images both by following the Mayo clinic quality control documentation (version 02-02-2015) and by visual examination. Among the 80 subjects, 23 were normal, 47 had MCI, and 10 were diagnosed with AD at baseline. Among normal/MCI/AC groups, 10(43%), 28(60%) and 4(40%) were male and the mean age was 73.7 ± 5.6, 71.4 ± 6.4, 70.8 ± 7.8, respectively. No significant age or gender differences were found across disease status groups (Age: p = 0.30; Gender: p=0.31).

The rs-fMRI data were preprocessed using the modified preprocessing script released from the 1000 Functional Connectomes Project. Specifically, skull stripping was performed on the T1 images to remove extra-cranial material, then the first four volumes of the functional time series were removed to stabilize the signal, leaving 136 volumes for subsequent preprocessing. The anatomical image was registered to the 8th volume of the functional image (slice time corrected) and subsequently spatially normalized to the MNI standard brain space. These normalization parameters from MNI space were used for the functional images, which were smoothed with a 6mm FWHM Gaussian kernel. Motion corrections were applied on the functional images. A validated confound regression procedure (Satterthwaite et al., 2015) was performed on each subject’s time series data to remove confounding factors including motions, global effects, white matter (WM) and cerebrospinal fluid (CSF) nuisance signals. The confound regression contained nine standard confounding signals (6 motion parameters plus global / WM / CSF) as well as the temporal derivative, quadratic term and temporal derivative of the quadratic of each. Furthermore, motion-related spike regressors were included to bound the observed displacement. Lastly, the functional time series data were band-pass filtered to retain frequencies between 0.01 and 0.1 Hz which is the relevant frequency range for rs-fMRI.

3.2.2 Brain network construction

To construct brain network, we chose the 264-node cortical parcellation system defined by Power et al. (2011). Each node is a 10mm diameter sphere in standard MNI space representing a putative functional area, and the collection of nodes provides good coverage of the whole brain. It is a finer spatial resolution than the commonly used Automated Anatomical Labeling (AAL) atlas (Tzourio-Mazoyer et al., 2002), but is not as granular as using a system of single voxels. This intermediate node scheme is recommended to balance the trade-off between increased spatial resolution and attenuate signal-to-noise ratio (Fornito et al., 2010; Power et al., 2011). Power et al. (2011) has shown that brain networks constructed based on the 264-node system demonstrated better reflection of brain organization than AAL-atlas based networks.

For our connectivity analysis of ADNI2 rs-fMRI data, we considered 258 of the 264 nodes that were within the gray matter mask derived from the data. To facilitate the understanding of the functional roles of the nodes, we assigned them to ten functional networks or modules that correspond to the major resting state networks (RSNs) described by Smith et al. (2009). The RSN maps, determined by ICA decomposition of a large database of activation studies (BrainMap) and rs-fMRI data, are coherent during both task activity and at rest. The functional modules include medial visual network (Med Vis), occipital pole visual network (OP Vis), lateral visual network (Lat Vis), default mode network (DMN), cerebellum (CB), sensorimotor network (SM), auditory network (Aud), executive control network (EC), and right and left frontoparietal networks (FPR and FPL). To determine the module membership at each node, we found the RSN map with the largest z-value in the node, above a certain threshold (z &gt; 3). 36 of the 258 nodes in the grey matter were not strongly associated with any RSN maps, and were therefore not included. Also, since too few nodes were contained in the cerebellum, this module and corresponding nodes were not included in the analysis as well. A visualization of the remaining 216 nodes that were used in subsequent analysis, classified by functional module, is shown in Figure 6. All brain visualizations were created using BrainNet Viewer (Xia et al., 2013).

To measure the connectivity between the nodes, we extracted the representative fMRI time series from each node by performing singular value decomposition (SVD) on the time series from all the voxels within that node. We then constructed a 216 × 216 symmetric connectivity matrix for each subject by calculating Pearson correlation between the representative time series extracted from each node. Fisher’s transformation was then applied to the correlation coefficients.

3.2.3 Bayesian hierarchical model for ADNI2 longitudinal study

We applied the proposed Bayesian hierarchical model in (7) to jointly model the longitudinal connectivity measures obtained at baseline, 6 months and 1 year at ADNI2 study. We modeled group effects in both change rate in connectivity across time as well as baseline connectivity. Let ri0(m, m′), ri1(m, m′) and ri2(m, m′) denote the connectivity measure between node m and m′ for subject i at at baseline, 6 months and 1 year, respectively. The hierarchical model for the ADNI2 study was specified as follows: Level1:[ri0(m,m′)ri1(m,m′)ri2(m,m′)]=[1ti01ti11ti2][RiB(m,m′)RiΔ(m,m′)]+[ϵi0(1)(m,m′)ϵi1(1)(m,m′)ϵi2(1)(m,m′)],Level2:[RiB(m,m′)RiΔ(m,m′)]=[IiNIiMIiA000000IiNIiMIiA][βBN(m,m′)βBM(m,m′)βBA(m,m′)βΔN(m,m′)βΔM(m,m′)βΔA(m,m′)]+[ϵiB(2)(m,m′)ϵiΔ(2)(m,m′)],

Here, in the first level of the BHM, we model the subject’s observed longitudinal connectivity measures in terms of subject-specific baseline effects and change rate represented by RiB(m, m′) and RiΔ(m, m′). In ADNI2 study, the longitudinal measurements were obtained at baseline, 6 months and 1 year for subjects, hence ti0 = 0, ti1 = 0.5, ti2 = 1. In the second level of BHM, we model the subject-specific baseline RiB(m, m′) and change rate RiΔ(m, m′) in terms of population parameters that code effects for the three disease groups: Normal, MCI and AD. Here, IiN , IiM and IiA are binary group indicators which equals 1 if the ith subject was in the normal control, MCI and AD group, respectively, and zero otherwise. Therefore, our model can capture the group differences not only in baseline connectivity but also in its temporal changes across time.

3.3 Application to Test-retest rs-fMRI data in Kirby21 Study

In this section, we illustrate the utility of the proposed method in test-retest imaging reproducibility studies with the Kirby21 data (Landman et al., 2011) which was used in previous work (Shou et al. (2014); Mejia et al. (2015)) to develop estimators for individual functional connectivity. The data set contains two 7-minute scan-rescan resting-state fMRI images for 21 healthy adults (11 M/10 F, aged 22-61). Each scanning session took about one hour. After the first scan, each subject exited the scan room for a short break, and then reentered the scan room for an identical second scanning session. A T1-weighted anatomical image and a series of rs-fMRI were acquired using a 3T MR scanner. Resting-state fMRI were collected using 2D EPI sequence with SENSE partial-parallel imaging acceleration to obtain 3 × 3mm in-plane resolution in thirty-seven 3mm transverse slices with 1mm slice gap (TR/TE = 2000/30 ms, FA=75).

The rs-fMRI data was preprocessed using the standard rs-fMRI pre-processing procedure that was described in the previous section. We applied the proposed Bayesian hierarchical model for test-retest studies presented in equation (8) to model the Kirby21 data. We then applied the proposed BHM predictor presented in equation (9) to estimate a subject’s functional connectivity in the second scan based on the data in the first scan.

We used 7-fold cross validation to evaluate the reliability of the BHM connectivity estimators. The reliability was measured by prediction mean square error (PMSE) between the observed and estimated connectivity for the second scan. In comparison to the BHM-based estimator, we considered four alternative methods: GLM, mean, raw and the shrinkage estimator.

4 Results

4.1 Simulation Studies

4.1.1 Simulation results for longitudinal studies

Figure 2 presents the average PMSEs across simulation runs to evaluate the prediction accuracy based on BHM, GLM and the raw estimator. We plot the PMSE against the variance ratio to see how the PMSE changes with respect to the between-subject variability in relative to the total variability. We evaluate the PMSE for the three simulation scenarios with large, low and no between-group differences in the change rate. Results show that the PMSE of the BHM predictor was always smaller as compared to GLM predictor and raw estimator. Specifically, both the BHM and GLM performed much better than the raw estimator when there is large between-group differences in the connectivity change rate since BHM and GLM took into account of the group information in the predictive model while the raw estimator doesn’t. Additionally, the PMSE of the BHM and GLM was also much lower than the raw estimator when the variance ratio is low indicating low within-subject correlation. This is because the raw estimator uses the same subject’s baseline connectivity to predict his/her follow-up connectivity and hence performs poorly when the baseline scan had a low correlation with the follow-up scan. Between BHM and GLM, we find that BHM performed better than GLM when the variance ratio increases, corresponding to higher within-subject correlation in the longitudinal measurements. This is because BHM takes into account of within-subject correlation while GLM doesn’t.

In addition to PMSE, We also present distributions of the predicted connectivity at t3 based on the three methods and compare them with the true distribution of the simulated connectivity (Figure 3). In Figure 3, the data were from the case where there was large between-group difference in the connectivity change rate and the variance ratio was 0.5. Results show that the box plots of the predicted connectivity based on the BHM predictor best resembled the true connectivity distribution at t3. In comparison, the GLM predictor did poorly in predicting individual-level connectivity although it successfully predicted the mean connectivity for the two groups. This is because GLM predictor didn’t account for individual variability in the prediction. The raw estimator failed to predict the difference between the two subject groups’ connectivity at time t3 due to the different change rates of the two groups. This is because the raw estimator simply used each subject’s baseline to predict his/her follow-up and didn’t account for any longitudinal changes across time in the connectivity. Due to the high within-subject as well as between-subject variability in rs-fMRI measurements, it is a challenging task to model and predict individual trajectories in longitudinal resting state connectivity. The proposed BHM predictor is based on both the population-level expectation as well as subject-specific effects. This allows the BHM predictor to effectively capture the between-subject as well as within-subject variability. Therefore, it does a good job in predicting both the group effects as well as individual trajectories in longitudinal connectivity.

4.1.2 Simulation results for test-retest studies

We present the simulation results in a similar manner for test-retest studies. In Figure 4, we plot the average PMSEs to evaluate the prediction accuracy based on BHM, GLM, the raw estimator, the mean estimator and the shrinkage estimator. We evaluated the PMSE for the three levels of between-group difference and also for various variance ratio (ICC) levels. Results show that the PMSE of the proposed BHM predictor was the smallest as compared to the other methods under all settings. As ICC increases indicating higher within-subject correlation, the PMSE of BHM, shrinkage and raw predictors decreased, and difference among these three methods also decreased. In comparison, the PMSE of GLM and mean predictors remained the same with ICC increases because these two methods don’t take into account within-subject correlation in the connectivity. When there was larger difference between two group means, the benefits of BHM and GLM predictors were more obvious, since these two methods take into account the group effects. Among the five methods, the BHM estimator and the shrinkage estimator demonstrated best performance in general. When there is large between-group difference in connectivity, the BHM estimator out performed the shrinkage estimator. The reason is that the BHM estimator takes into account group differences while the shrinkage estimator doesn’t. When there is no group difference but high ICC indicating high within-subject correlation among the same subject?s repeated measured scans, the raw estimator which is based on the same subject’s baseline scan actually had better performance than the GLM predictor which is a group-level predictor without exploiting the information from the same subject’s baseline scan.

Figure 5 presents the simulated distributions of connectivity at the scan and rescan time points and then present the distribution of the predicted connectivity at the rescan based on the five methods. The data were from the case where there was large between-group difference and the ICC was set at 0.5. The distribution of predicted values from BHM method best resembled that of the simulated data in terms of the group mean and between-subject variability. GLM predictor successfully differentiated the population means for different groups but performed poorly on individual-level prediction. Raw estimator also captured the difference in group means but was more variable than the true distribution because it didn’t pool information across subjects in prediction. Pooled mean predictor performed the worst since it ignored the large between-group difference. The shrinkage estimator did well except that there is slight misalignment between the group means of the shrinkage estimator and those in the true distribution. This is because the shrinkage estimator doesn’t formally model between-group differences in the prediction. As in Figure 3, Figure 5 shows that our proposed BHM predictor does a better job than the existing methods in accurately predicting both the group effects as well as individual trajectories in connectivity, because it models both the population-level effects as well as subject-specific effects.

4.2 Results for ADNI2 longitudinal study

The proposed EM algorithm was applied to estimate the parameters in the Bayesian hierarchical model for the ADNI2 longitudinal rs-fMRI study. In Figure 7 and Figure 8, we present BHM model-based estimates of baseline connectivity and temporal change rate in connectivity across time for the three disease groups. Specifically, Figure 7 (a)-(c) illustrates the estimated 216 × 216 baseline connectivity matrices for the three disease groups. In general, we observe similar connectivity patterns across the three disease groups at baseline. For example, edges within the same functional network mostly demonstrate positive connections; we also observe positive between-network connections such as connections between the three visual networks and connections between the auditory and sensorimotor networks.

In Figure 7, we present edges that were found to have considerable differences between the MCI and control group (Fig.7 (d)-(e)) and between the AD and control group (Fig.7 (f)-(g)).To identify edges that were different between the groups, we evaluate the posterior probability at each edge for having at least moderate between-group differences, which is defined as an absolute between-group difference in the correlation connectivity measure that is greater than 0.1. Edges that had an posterior probability of greater than 0.7 for having at least moderate between-group difference are shown in Figure 7 (d)-(g). To help understand the direction of the group differences, we present the results for positive and negative connections separately. Results show that there were more differences in baseline connectivity between AD and controls than between MCI and controls, indicating the baseline connectivity in AD patients is more distinctive from the control group as compared to the MCI. Compared to the control group, both the MCI and AD disease groups demonstrated weaker positive connectivity within the auditory and sensorimotor networks and also weaker positive connections between these two networks. Some previous studies have found altered activity and connectivity in these two networks that are related to the Alzheimer disease (Agosta et al, 2010; Goll et al. 2012; Salustri et al. 2013; Terranova et al. 2013; Ferreri et al. 2016).

In Figure 8, we compare the change rate in connectivity from baseline to one-year between the three disease groups. We first evaluate the posterior probabilities for demonstrating at least moderate temporal changes, which is defined as having an absolute change rate that is greater than 0.2. Figure 8 (a)-(c) show the edges where the posterior probabilities for demonstrating moderate or greater temporal changes are greater than 0.7. Results show that the AD group demonstrated much more significant temporal changes during the one year period as compared to the normal and MCI group. Specifically, we find very few edges had moderate or greater changes in the control and MCI group. While in the AD group, considerable changes were observed in many connections. To further illustrate the edges that showed significant changes across time, we selected 50 edges with the largest posterior probabilities for temporal changes in the AD group, and present their estimated connectivity at baseline and then one year in Figure 8 (d) and (e). In the figures, red lines and blue lines are used to denote positive and negative connections, respectively. The width of the lines reflects the magnitude of the estimated connectivity based on BHM. Some observations from these figures are that for the connectivity decreased between nodes in sensorimotor and auditory network and also between DMN and auditory network over the year for the AD patients.

We applied the proposed BHM prediction algorithm to forecast brain connectivity one year after baseline for each subject based on the subject’s observed images at baseline and 6 months in the ADNI2 study. Figure 9 presents the prediction accuracy based on BHM measured by the prediction mean square error (PMSE) between the observed and predicted connectivity based on 5-fold cross validation. In comparison to the proposed method, we also present the prediction accuracy based on GLM and that based on the raw estimator. Figure 9 shows BHM demonstrated the highest prediction accuracy among the three methods, with the PMSE generally below 0.06 and the average (SD) for PMSE being 0.045(0.011). GLM predictor, which used group mean for prediction, had an average PMSE of 0.050(0.014). The raw predictor, which used the subject’s baseline connectivity, demonstrated the worst performance with an average PMSE of 0.070(0.016). Another observation from these figures is that the prediction accuracy was lowest for forecasting connectivity within the executive control, frontoparietal left and right, and visual networks, indicating it is more challenging to accurately predict future connections in these networks as compared to the other networks. To further illustrate the prediction accuracy in individual subjects, we plotted the average PMSE across all edges for each subject based on the three methods in Figure 9(d)-9(f). Results show that our BHM-based predictor outperformed GLM predictor for most of the subjects (71 out of 80) and outperformed the raw predictor for all subjects. In this paper, we present the results for predicting connectivity in one-year following-up scans in the ADNI2 study based on the longitudinal data that were available at the time of our data analysis. As a reviewer pointed out, when more longitudinal scans become available from the study, it will be helpful to predict connectivity after a longer follow-up period such as 3-5 years when more clinically significant changes due to the progress of the Alzheimer’s disease are expected.

We further examined the coverage probabilities of the 95% prediction intervals for predicting one-year functional connectivity based on the Bayesian hierarchical model. Across all edges, 94.1% (with a standard error of 2.2%) of the observed connectivity measurements fell within the 95% prediction intervals.

4.3 Results for Kirby 21 test-retest fMRI study

Similar as the results from the simulation studies, our BHM predictor and the shrinkage estimator demonstrated the highest reliability among the five methods for the Kirby 21 data, where BHM had slightly lower PMSE as compared to the shrinkage estimator. GLM predictor and mean estimator showed reasonable reliability. The raw predictor which only used the subject’s own first-session scan showed the lowest reliability. Across all edges, 92.3% (with a standard error of 4.7%) of the observed connectivity measurements fell within the 95% prediction intervals for predicting individual functional connectivity based on the BHM method, indicating the proposed method produces satisfactory coverage level.

5 Discussion

In this paper, we present a general Bayesian hierarchical model for forecasting individual future functional connectivity based on the individual’s earlier fMRI scans and relevant clinical and demographical characteristics. The proposed method provide a general framework for investigating brain connectivity under various scenarios. The method can be applied to both task-related and resting state fMRI studies. Furthermore, our method can be applied to a range of connectivity metrics such as correlation, partial correlation, coherence after performing proper transformation on these metrics. The utility of the proposed approach is demonstrated for both longitudinal and test-retest imaging studies. Through simulation studies and a longitudinal imaging study, we show that the proposed method provides more accurate prediction and estimation for individual connectivity by both taking into account an individual’s distinct connectivity patterns and pooling information across the group of subjects who share similar characteristics. The predictive model can potentially have important applications in clinical practice. For example, by providing prediction for individual neural development trajectory, it can facilitate implementation of early intervention for brain disorders to mitigate a more severe mental illness evolving. The predictive model can also provide guidance for developing more effective individualized treatment plans by providing clinicians with predictive information concerning the effect of treatment on brain connectivity. A MATLAB toolbox for the proposed BHM predictive model will be made available at the website of the Center for Biomedical Imaging Statistics (CBIS) at Emory University.

For the proposed BHM-based prediction algorithm, most of the computation time is spent on the prediction algorithm development stage, i.e. estimation of the BHM model using the training data. Once the prediction algorithm is established, applying the algorithm to predict a new subject’s brain connectivity is quite rapid. For example, for the ADNI2 longitudinal data example which involves about 80 subjects and 216-by-216 connectivity matrices, the computation time for training the BHM model was about 1.3 hours on a single processor with Intel Core i7 CPU (2.4 GHz) and 8 GB RAM. The prediction based on the BHM for a new subject took no more than one second on the same processor.

The proposed Bayesian hierarchical model has an important advantage in handling missing data in the longitudinal studies. Unlike many other methods, the BHM doesn’t require removal of subjects who have missing data at certain time points but rather can estimate the parameters using all the data that are available from the subject. Specifically, in the presence of missing data, we will estimate the model by using the EM algorithm to maximize the likelihood based on all the observed data. In this way, BHM can make use of all the available information from the observed data (Verbeke and Molenberghs, 2000).

For test-retest imaging studies, the proposed method can provide a more reliable estimator for individual brain connectivity than alternative methods. We show that there is a nice connection between the BHM estimator and the recently developed shrinkage estimator (Shou et al. 2014; Mejia et al. 2015). Both methods are essentially a weighting procedure that ”borrow”s strength from a larger population to improve individual estimates. Compared with the existing methods, the new contributions of the proposed method based on the Bayesian hierarchical model include the following: the proposed method can account for covariate effects and thus can potentially provide more accurate estimates for heterogeneous population, e.g., when the study cohort consists of both patients and healthy controls, the proposed predictor provides a unified and model-based approach for determining the weighting factor which controls the relative contribution from the population-level and individual-level effects, finally, the proposed method allows for hypothesis testing and prediction intervals which can help provide inference for the connectivity estimates.

6 Acknowledgement

Research reported in this publication was supported by the National Institute Of Mental Health of the National Institutes of Health under Award Number ROI MH105561 and R01MH079448. The content is solely the responsibility of the authors and does not necessarily represent the official views of the National Institutes of Health. The ADNI data used in the analysis was collected and shared with the funding by the Alzheimer’s Disease Neuroimaging Initiative (ADNI) (National Institutes of Health Grant U01 AG024904) and DOD ADNI (Department of Defense award number W81XWH-12-2-0012).

ADNI is funded by the National Institute on Aging, the National Institute of Biomedical Imaging and Bioengineering, and through generous contributions from the following: AbbVie, Alzheimer’s Association; Alzheimer’s Drug Discovery Foundation; Araclon Biotech; BioClinica, Inc.; Biogen; Bristol-Myers Squibb Company; CereSpir, Inc.; Cogstate; Eisai Inc.; Elan Pharmaceuticals, Inc.; Eli Lilly and Company; EuroImmun; F. Hoffmann-La Roche Ltd and its affiliated company Genentech, Inc.; Fujirebio; GE Healthcare; IXICO Ltd.; Janssen Alzheimer Immunotherapy Research &amp; Development, LLC.; Johnson &amp; Johnson Pharmaceutical Research &amp; Development LLC.; Lumosity; Lundbeck; Merck &amp; Co., Inc.; Meso Scale Diagnostics, LLC.; NeuroRx Research; Neurotrack Technologies; Novartis Pharmaceuticals Corporation; Pfizer Inc.; Piramal Imaging; Servier; Takeda Pharmaceutical Company; and Transition Therapeutics. The Canadian Institutes of Health Research is providing funds to support ADNI clinical sites in Canada. Private sector contributions are facilitated by the Foundation for the National Institutes of Health (www.fnih.org). The grantee organization is the Northern California Institute for Research and Education, and the study is coordinated by the Alzheimer?s Therapeutic Research Institute at the University of Southern California. ADNI data are disseminated by the Laboratory for Neuro Imaging at the University of Southern California.

7 Appendix

This appendix describes an EM algorithm for estimating the proposed Bayesian hierarchical model. For a given node pair, the hierarchical model in (1) and (2) can be collapsed into the following representation for all N subjects: r=Wθ+ϵ(1)

where r=[r1T⋯,rNT]T is the connectivity from all N subjects. The covariate matrix W = [X(1), X(1)X(2)], where X(j)=diag(X1(j),⋯,XN(j)) for j = 1, 2. The parameter θ=[ϵ(2)T,βT]T with ϵ(2)=[ϵ1(2)T,⋯,ϵN(2)T]T. The parameter θ contains the population-level parameters and the error terms in the secondary-level of the model. Based on the model specification, θ is assumed to follow Gaussian distribution with the mean ηθ = E(θ) = [0T, ηβT]T and the covariance ∑θ=cov(θ)=[∑(2)00∑β] . The likelihood and priors under the Gaussian distribution assumptions are p(r∣θ)∝exp{−12(r−Wθ)TΣ(1)−1(r−Wθ)},p(θ)∝exp{−12(θ−ηθ)TΣθ−1(θ−ηθ)},

which lead to a Gaussian posterior density for θ, p(θ∣r)∝exp{−12(θ−ηθ∣r)TΣθ∣r−1(θ−ηθ∣r)},

where ∑θ∣r=(WT∑(1)−1W+∑θ−1)−1 and ηθ∣r=∑θ∣r(WT∑(1)−1r+∑θ−1ηθ).

When we adopt the empirical Bayesian scheme with Σβ = ∞, we have Σθ−1ηθ = 0 which means there is no need to specify the prior mean of β since they do not influence the posterior. Therefore, we only need to update the hyperparameters λ = [λ(1)T, λ(2)T]T in the error covariance matrices. To estimate the parameters and hyper-parameters in the above equations, we use the EM algorithm.

E Step

At the E step, we obtain the conditional distribution of the parameter θ given the observed data r and the current estimates of the hyper-parameters of the covariance components λ(m), i.e., p(θ|λ(m), r). Based on the model specification, the conditional distribution is Gaussian distribution with the mean and covariance of ∑θ∣r(m)=(WTΣ^(1)−1W+Σ^θ−1)−1 and ηθ∣r(m)=∑θ∣r(m)(WTΣ^(1)−1r+Σ^θ−1ηθ) where Σ^(1) and Σ^θ are based λ(m).

M Step

At the M step, we use the estimated conditional distribution of θ given r from the E-step to update the maximum likelihood (ML) estimates for the covariance hyper-parameters λ. Specifically, we find the λ(m+1) such that the log-likelihood F = lnp(r|λ) is maximized. This can be done using a Fisher-scoring iteration: λ←λ+(∂2F∂λ2)−1∂F∂λ

Figure 1 Schematic illustration of the development of the bayesian hierarchical model and construction of the proposed prediction algorithm for individual brain functional connectivity.

Figure 2 The prediction mean square error (PMSE) for predicting future brain connectivity in the simulation study with longitudinal data. Results are based on the proposed Bayesian hierarchical model (BHM), GLM and raw estimator. We consider three scenarios: (a) large between-group difference in connectivity change rates: (−0.2, 0.2); (b) small difference: (−0.1, 0.1); (c) no difference: (0.0, 0.0).

Figure 3 Comparison between the predicted connectivity distributions with the true connectivity distributions in the simulated data for longitudinal studies with large between-group difference in connectivity change rate. On the left panel, we present the distributions of simulated data for all three sessions in the longitudinal study. On the right panel, we present the distributions of predicted connectivity for session 3 by BHM, GLM and raw estimators.

Figure 4 The prediction mean square error (PMSE) for predicting future brain connectivity in the simulation study with test-retest data. Results are based on the proposed Bayesian hierarchical model (BHM), GLM, raw, mean and shrinkage estimator. We consider three scenarios: (a) large between-group difference in mean connectivity: (0.2, 0.6); (b) small difference: (0.2, 0.4); (c) no difference: (0.2, 0.2).

Figure 5 Comparison between the predicted connectivity distributions with the true connectivity distributions in the simulated data for test-retest studies with large between-group difference in mean connectivity. The horizontal reference lines correspond to the population means of connectivity for the two groups.

Figure 6 Visualization of 216 nodes associated with nine resting state networks (RSNs) described in Smith et al. (2009).

Figure 7 Group differences in baseline connectivity based on the bayesian hierarchical model (BHM) for ADNI2 study. Subfigures (a)-(c) present the BHM model-based estimates of 216 × 216 baseline connectivity matrices for normal controls (NC), mild cognitive impaired (MCI) and Alzheimer patients (AD). Each element in the connectivity matrix represents a node-pair or edge where the nodes are defined based on the Power node system and grouped by functional networks. Red edges indicate positive connectivity and blue edges indicate negative connectivity. Subfigures (d)-(g) present the edges that showed significant differences in the baseline connectivity between NC and MCI/AD groups. Yellow edges indicate a posterior probability of greater than 0.7 that the baseline connectivity in the patient group has considerably larger magnitude than NC, and green edges indicate a posterior probability of greater than 0.7 that baseline connectivity in patient group had considerably smaller magnitude than NC.

Figure 8 Group differences in connectivity change rate based on the bayesian hierarchical model (BHM) for ADNI2 study. Subfigures (a)-(c) present the BHM model-based estimates of 216 × 216 thresholded posterior probability matrices for demonstrating significant connectivity changes over 1 year in the three disease groups. Dark blue indicates edges that demonstrated at least moderate temporal change, i.e. having an absolute change rate of greater than 0.2, with posterior probability greater than 0.7. Results show that the AD group demonstrated much more significant temporal changes during the one year period as compared to the normal and MCI group. Specifically, considerable amount of edges demonstrated high posterior probabilities of temporal changes in the AD group, while very few edges in NC and MCI showed significant change. In subfigures (d) and (e), we display the baseline and one-year connectivities for 50 edges with the largest posterior probabilities of temporal change in the AD group. Red edges indicate positive connectivity and blue edges indicate negative connectivity. The size of the edges reflects the strength of connectivity.

Figure 9 Comparison of prediction mean square error (PMSE) for predicting one-year functional connectivity in ADNI2 study using different prediction methods. Subfigures (a)-(c) present the average PMSE matrices across all subjects using the BHM, GLM, and the raw estimator, respectively. Darker color represents larger PMSE, and lighter color represents smaller PMSE. In subfigures (d)-(f), we compare the performances of different prediction methods for each individual using average PMSEs across all edges. Results are presented separately for the normal control, MCI and AD disease groups.

Figure 10 Comparison of prediction mean square error (PMSE) for predicting individual functional connectivity in Kirby21 study using the Bayesian hierarchical model (BHM), shrinkage estimator, GLM, mean estimator and raw estimator, respectively. Darker color represents larger PMSE, and lighter color represents smaller PMSE.

This is a PDF file of an unedited manuscript that has been accepted for publication. As a service to our customers we are providing this early version of the manuscript. The manuscript will undergo copyediting, typesetting, and review of the resulting proof before it is published in its final citable form. Please note that during the production process errors may be discovered which could affect the content, and all legal disclaimers that apply to the journal pertain.


References

Agosta F Rocca MA Pagani E Absinta M Magnani G Marcone A Falautano M Comi G Gorno-Tempini ML Filippi M Sensorimotor network rewiring in mild cognitive impairment and Alzheimer’s disease Hum Brain Mapp 2010 31 4 515 525 19777557
Biswal B Zerrin Yetkin F Haughton VM Hyde JS Functional connectivity in the motor cortex of resting human brain using echo-planar MRI Magn. Reson. Med 1995 34 4 537 541 8524021
Damoiseaux JS Rombouts SARB Barkhof F Scheltens P Stam CJ Smith SM Beckmann CF Consistent resting-state networks across healthy subjects Proc. Natl. Acad. Sci 2006 103 37 13848 13853 16945915
Carlin BP Louis TA Bayes and empirical Bayes methods for data analysis 2000 CRC Press Chapman &amp; Hall 2nd
Damoiseaux JS Prater K Miller BL Greicius MD Functional connectivity tracks clinical deterioration in Alzheimer’s disease Neurobiol Aging 2012 33 4 828.e19 828.e30
Dempster AP Laird NM Rubin DB Maximum likelihood from incomplete data via the EM algorithm J. R. Stat. Soc. B 1977 39 1 38
Dempster AP Rubin DB Tsutakawa RK Estimation in covariance component models J. Am. Stat. Assoc 1981 76 341 353
Efron B Morris C Data analysis using Stein’s estimator and its generalizations J. Am. Stat. Assoc 1975 70 350 311 319
Ferreri F Vecchio F Vollero L Guerra A Petrichella S Ponzo D Määtta S Mervaala E Könönen M Ursini F Pasqualetti P Iannello G Rossini PM Di Lazzaro V Sensorimotor cortex excitability and connectivity in Alzheimer’s disease: A TMS-EEG Co-registration study Hum Brain Mapp 2016 37 6 2083 2096 26945686
Fornito A Zalesky A Bullmore ET Network scaling effects in graph analytic studies of human resting-state fMRI data Front. Syst. Neurosci 2010 4 22 20592949
Fox MD Snyder AZ Vincent JL Corbetta M Van Essen DC Raichle ME The human brain is intrinsically organized into dynamic, anticorrelated functional networks Proc. Natl. Acad. Sci 2005 102 27 9673 9678 15976020
Fransson P Marrelec G The precuneus/posterior cingulate cortex plays a pivotal role in the default mode network: evidence from a partial correlation network analysis NeuroImage 2008 42 3 1178 1184 18598773
Friston KJ Penny W Phillips C Kiebel S Hinton G Ashburner J Classical and Bayesian inference in neuroimaging: theory NeuroImage 2002 16 2 465 483 12030832
Gay CW Robinson ME George SZ Perlstein WM Bishop MD Immediate Changes After Manual Therapy in Resting-State Functional Connectivity as Measured by Functional Magnetic Resonance Imaging in Participants With Induced Low Back Pain J Manipulative Physiol Ther 2014 37 9 614 627 25284739
Goll JC Kim LG Ridgway GR Hailstone JC Lehmann M Buckley AH Crutch SJ Warren JD Impairments of auditory scene analysis in Alzheimer’s disease Brain 2012 135 190 200 Pt 1 22036957
Greicius MD Krasnow B Reiss AL Menon V Functional connectivity in the resting brain: a network analysis of the default mode hypothesis Proc. Natl. Acad. Sci 2003 100 1 253 258 12506194
Guo Y Bowman FD Kilts C Predicting the Brain Response to Treatment Using a Bayesian Hierarchical Model With Application to a Study of Schizophrenia Hum. Brain Mapp 2008 29 9 1092 1109 17924543
Henderson CR Best linear unbiased estimation and prediction under a selection model Biometrics 1975 18 21 2943 2959
James W Stein C Estimation with quadratic loss Proceedings of the Third Berkeley Symposium on Mathematics, Statistics and Probability 1961 1
Landman BA Huang AJ Gifford A Vikram DS Lim IA Farrell JA Bogovic JA Hua J Chen M Jarso S Smith SA Joel S Mori S Pekar JJ Barker PB Prince JL van Zijl PC Multi-parametric neuroimaging reproducibility: a 3-T resource study NeuroImage 2011 54 4 2854 2866 21094686
Liu XQ Rong JY Liu XY Best linear unbiased prediction for linear combinations in general mixed linear models Journal of Multivariate Analysis 2008 99 8 1503 1517
Liu Z Zhang Y Bai L Yan H Dai R Zhong C Wang H Wei W Xue T Feng Y You Y Tian J Investigation of the effective connectivity of resting state networks in Alzheimer’s disease: a functional MRI study combining independent components analysis and multivariate Granger causality analysis NMR Biomed 2012 25 12 1311 20 22505275
Mejia AF Nebel MB Shou H Crainiceanu CM Pekar JJ Mostofsky S Caffo B Lindquist MA Improving reliability of subject-level resting-state fMRI parcellation with shrinkage estimators NeuroImage 2015 112 14 29 25731998
Power JD Cohen AL Nelson SM Wig GS Barnes KA Church JA Vogel AC Laumann TO Miezin FM Schlaggar BL Petersen SE Functional network organization of the human brain Neuron 2011 72 4 665 678 22099467
Salustri C Tecchio F Zappasodi F Tomasevic L Ercolani M Moffa F Cassetta E Rossini PM Squitti R Sensorimotor Cortex Reorganization in Alzheimer’s Disease and Metal Dysfunction: A MEG Study Int J Alzheimers Dis 2013 2013 638312 24416615
Sarpal DK Robinson DG Lencz T Argyelan M Ikuta T Karlsgodt K Gallego JA Kane JM Szeszko PR Malhotra AK Antipsychotic treatment and functional connectivity of the striatum in first-episode schizophrenia JAMA Psychiatry 2009 72 1 5 13
Smith SM Fox PT Miller KL Glahn DC Fox PM Mackay CE Filippini N Watkins KE Toro R Laird AR Beckmann CF Correspondence of the brain’s functional architecture during activation and rest Proc. Natl. Acad. Sci 2009 106 31 13040 13045 19620724
Shehzad Z Kelly AMC Reiss PT Gee DG Gotimer K Uddin LQ Lee SH Margulies DS Roy AK Biswal BB Petkova E Castellanos FX Milham MP The resting brain: unconstrained yet reliable Cereb. Cortex 2009 19 10 2209 2229 19221144
Shou H Eloyan A Nebel MB Mejia A Pekar JJ Mostofsky S Caffo B Lindquist MA Crainiceanu CM Shrinkage prediction of seed-voxel brain connectivity using resting state fMRI NeuroImage 2014 102 2 938 944 24879924
Terranova C Sant’Angelo A Francesca M Rizzo V Allegra R Arena MG Ricciardi L Ghilardi MF Girlanda P Quartarone A Impairment of sensory-motor plasticity in mild Alzheimer’s disease Brain Stimulation: Basic, Translational, and Clinical Research in Neuromodulation 2013 6 1 62 66
Verbeke G Molenberghs G Linear mixed models for longitudinal data 2000 Springer Series in Statistics New York
Wang K Liang M Wang L Tian L Zhang X Li K Jiang T Altered functional connectivity in early Alzheimer’s disease: a resting-state fMRI study Hum. Brain Mapp 2007 28 10 967 78 17133390
Woodward ND Cascio CJ Resting-State Functional Connectivity in Psychiatric Disorders JAMA Psychiatry 2015 72 8 743 744 26061674
Xia M Wang J He Y BrainNet Viewer: a Network Visualization Tool for Human Brain Connectomics PLoS ONE 2013 8 7 e68910 23861951
Yao H Zhou B Zhang Z Wang P Guo Y Shang Y Wang L Zhang X An N Liu Y Alzheimer’s Disease Neuroimaging Initiative Longitudinal Alteration of Amygdalar Functional Connectivity in Mild Cognitive Impairment Subjects Revealed by Resting-State fMRI Brain Connectivity 2014 4 5 361 370 24846713
